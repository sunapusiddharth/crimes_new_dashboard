self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[437],{1917:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55);t.default=function(e,t){return r.makeServiceRequest("GetCalendarFolders",e,t)}},1934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),a=n(2259);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=a.default(e.request)),r.makeServiceRequest("GetCalendarFolderConfiguration",e,t)}},2259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetCalendarFolderConfigurationRequest:#Exchange"},e)}},2349:function(e,t,n){"use strict";n.r(t);var r=n(3794);n.d(t,"loadWorkloadScenarioSettings",function(){return r.a});n(6132),n(4814),n(5460)},2424:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(c,u){a?u(new Error("The function retry was cancelled")):(r++,e().then(function(e){return c(e)}).catch(function(e){t&&r>=t?u(e):setTimeout(function(){return i(c,u)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},3794:function(e,t,n){"use strict";var r=n(0),a=n(1),i=Object(a.action)("LOAD_WORKLOAD_SCENARIO_SETTINGS"),c=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",function(e){return{settings:e}}),u=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED"),o=n(67);function d(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l="ows/beta/ScenarioSettings";var s=71;function f(e){return 0!=(e&s)}var w=n(349);function v(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return e=["Owa"],f(t=Object(w.b)())&&(n=d(t),e.push(n)),a=function(e){var t=e.join(",");return l+"/?Scenarios="+t}(e),[4,Object(o.b)(a,void 0,void 0,void 0,!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS")];case 1:return i=r.sent(),c={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null},i.settings&&i.settings.forEach(function(e){var t;(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName?c.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)?function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)&&(c.timePanelSelectedCalendarView=e.selectedView):c.timePanelSelectedView=e.selectedView}),[2,c]}})})}var b=n(2424),O=Object(b.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(b.a)(1e4)}),S=null;Object(a.orchestrator)(i,function(){return r.__awaiter(void 0,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),S&&S.cancel(),[4,(S=O(v)).retriableFunc()];case 1:return e=t.sent(),c(e),[3,3];case 2:return t.sent(),u(),[3,3];case 3:return S=null,[2]}})})});function m(e,t){return l+"/"+e+"/"+t}function p(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return f(t=Object(w.b)())?(n=d(t),a=m(n,"TimePanelSelectedView"),i={ViewType:e},[4,Object(o.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function _(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=m("Owa","TimePanelCalendarIds"),n={CalendarIds:e},[4,Object(o.c)(t,n,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}function h(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return f(t=Object(w.b)())?(n=d(t),a=m(n,"SelectedCalendarListView"),i={ViewType:e},[4,Object(o.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}n.d(t,"a",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"d",function(){return p}),n.d(t,"c",function(){return _}),n.d(t,"b",function(){return h})},4814:function(e,t,n){"use strict";var r=n(3794),a=n(1);function i(e,t){if(0===t.length)return null;t[t.length-1]=e}var c=n(349),u=Object(a.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(2!==Object(c.b)()?"Calendar":"Tasks")});Object(a.mutator)(r.e,function(e){var t=e.settings;t.timePanelSelectedView&&i(t.timePanelSelectedView,u().panelViewStack.stack)});var o=Object(a.action)("pushTimePanelView",function(e){return{newView:e}}),d=Object(a.action)("updateTopTimePanelView",function(e){return{updatedView:e}}),l=Object(a.action)("popTimePanelView");Object(a.mutator)(o,function(e){var t;t=e.newView,u().panelViewStack.stack.push(t)}),Object(a.mutator)(d,function(e){i(e.updatedView,u().panelViewStack.stack)}),Object(a.mutator)(l,function(){var e=u().panelViewStack;e.stack.pop()});var s=n(0),f=n(2424),w=n(11),v=Object(f.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(f.a)(1e3)}),b=null;Object(a.orchestrator)(d,function(e){return s.__awaiter(void 0,void 0,void 0,function(){var t,n;return s.__generator(this,function(a){switch(a.label){case 0:if(t=e.updatedView,"Tasks"!==(i=t)&&"Calendar"!==i)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),b&&b.cancel(),[4,(b=v(function(){return Object(r.d)(t)})).retriableFunc()];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),w.c.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:b=null,a.label=5;case 5:return[2]}var i})})});var O={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",Tasks:"Tasks"};function S(e){return e?O[e]:null}function m(){return S(p())}function p(){var e,t=u().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function _(){return u().panelViewStack.stack.length}function h(){return-1!==u().panelViewStack.stack.indexOf("Conflicts")}function j(){return-1!==u().panelViewStack.stack.indexOf("AttendeeTracking")}function V(){var e=u().panelViewStack;return _()>=2?e.stack[_()-2]:null}n.d(t,"i",function(){return o}),n.d(t,"j",function(){return d}),n.d(t,"h",function(){return l}),n.d(t,"b",function(){return m}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return _}),n.d(t,"g",function(){return h}),n.d(t,"f",function(){return j}),n.d(t,"d",function(){return V}),n.d(t,"c",function(){return S})},5236:function(e,t,n){"use strict";var r=n(42),a=n(50),i=n(326);function c(){var e=0,t=Object(i.a)().selectedCalendars;if(t.forEach(function(t,n){t&&(e+=t.length)}),0==e){var n=Object(r.e)().primarySmtpAddress,c=Object(a.A)(n);c&&t.set(n,[c.id.id])}return t}n.d(t,"a",function(){return c})},5460:function(e,t,n){"use strict";var r=n(1),a=Object(r.action)("updateSelectedCalendarView",function(e){return{updatedView:e}}),i=Object(r.createStore)("calendarListSettingsStore",{selectedView:"Agenda"});function c(){return i().selectedView}var u=Object(r.action)("updateSelectedCalendarViewInStore",function(e){return{updatedView:e}}),o=(Object(r.mutator)(u,function(e){var t=e.updatedView;i().selectedView=t}),n(0)),d=n(3794),l=n(2424),s=n(11),f=Object(l.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(l.a)(1e3)}),w=null;Object(r.orchestrator)(a,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var t,n;return o.__generator(this,function(r){switch(r.label){case 0:t=e.updatedView,u(t),r.label=1;case 1:return r.trys.push([1,3,,4]),w&&w.cancel(),[4,(w=f(function(){return Object(d.b)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),s.c.warn("updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: "+n),[3,4];case 4:return w=null,[2]}})})});Object(r.orchestrator)(d.e,function(e){var t=e.settings;t.timePanelSelectedCalendarView&&u(t.timePanelSelectedCalendarView)});n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c})},6132:function(e,t,n){"use strict";var r=n(0),a=n(1),i=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",function(e){return{calendarIds:e}}),c=n(3794),u=n(2424),o=n(11),d=Object(u.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(u.a)(1e3)}),l=null,s=(Object(a.orchestrator)(i,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:t=e.calendarIds,r.label=1;case 1:return r.trys.push([1,3,,4]),l&&l.cancel(),[4,(l=d(function(){return Object(c.c)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),o.c.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+n),[3,4];case 4:return l=null,[2]}})})}),Object(a.createStore)("timePanelSelectedCalendarIdsStore",{calendarIds:null})),f=(Object(a.mutator)(c.e,function(e){var t=e.settings;t.timePanelCalendarIds&&t.timePanelCalendarIds.length>0&&(s().calendarIds=t.timePanelCalendarIds)}),Object(a.mutator)(i,function(e){var t=e.calendarIds;s().calendarIds=t}),n(5236)),w=n(42),v=n(7);function b(){var e=s().calendarIds;if(e&&0!=e.length){var t=new v.ObservableMap;return t.set(Object(w.e)().primarySmtpAddress,e),t}return Object(f.a)()}n.d(t,"a",function(){return b})}},0,[486,98,70,110,468,470]]);
//# sourceMappingURL=owa.WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();