self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[312],{10232:function(e){e.exports={a:"Ywb",b:"Zwb"}},10233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MarkAllItemsAsReadRequest:#Exchange"},e)}},10234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(10235);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("MarkAllItemsAsRead",e,t)}},10235:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MarkAllItemsAsReadJsonRequest:#Exchange"},e)}},1049:function(e,t,n){"use strict";n.d(t,"s",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"d",function(){return l}),n.d(t,"c",function(){return b}),n.d(t,"g",function(){return m}),n.d(t,"f",function(){return v}),n.d(t,"k",function(){return O}),n.d(t,"l",function(){return p}),n.d(t,"e",function(){return h}),n.d(t,"j",function(){return I}),n.d(t,"b",function(){return j}),n.d(t,"i",function(){return w}),n.d(t,"m",function(){return g}),n.d(t,"n",function(){return _});var r=n(3),o=n(1839);n.d(t,"a",function(){return o.a});var i=n(1842);n.d(t,"p",function(){return i.a});var a=n(1832);n.d(t,"q",function(){return a.a});var c=n(1840);n.d(t,"r",function(){return c.a});var u=n(1835);n.d(t,"o",function(){return u.a});var s=new r.c(function(){return Promise.all([n.e(4),n.e(8),n.e(23),n.e(21),n.e(314)]).then(n.bind(null,2938))}),d=new r.a(s,function(e){return e.initializeMeetingRequestViewStateAction}),f=Object(r.d)(s,function(e){return e.MeetingMessageInfo}),l=(Object(r.d)(s,function(e){return e.MeetingRequestActions}),Object(r.d)(s,function(e){return e.MeetingCancellationInfo})),b=Object(r.d)(s,function(e){return e.MeetingActionButton}),m=Object(r.d)(s,function(e){return e.MeetingDetailsTime}),v=Object(r.d)(s,function(e){return e.MeetingDetailsLocation}),O=Object(r.d)(s,function(e){return e.MeetingRequestInfo}),p=Object(r.d)(s,function(e){return e.MeetingRequestResponseEditor}),h=Object(r.d)(s,function(e){return e.MeetingDetails}),I=Object(r.d)(s,function(e){return e.MeetingRequestConflicts}),j=Object(r.d)(s,function(e){return e.EditEventLink}),w=Object(r.d)(s,function(e){return e.MeetingMessageSummary}),g=Object(r.d)(s,function(e){return e.PreviewSummary}),_=Object(r.d)(s,function(e){return e.SenderSummary})},1100:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(466);function o(e){return e&&0===e.indexOf(r.f)}function i(e){return e&&0===e.indexOf(r.e)&&!o(e)}function a(e){return e&&0===e.indexOf(r.e)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1292:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(21);function o(e){return Object(r.I)(e,r.j)}},1416:function(e,t,n){"use strict";var r,o=n(1),i=Object(o.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),a=n(286),c=n(8),u=n(25);n.d(t,"a",function(){return s}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return l});var s=Object(c.action)("addActionToUndoStack")(Object(c.select)({store:function(){return i}})(function(e,t,n){null!==e&&(r=e,n.store.hasUndoableAction=!0,n.store.undoableActionFolderId=t)})),d=Object(c.action)("clearLastUndoableAction")(Object(c.select)({store:function(){return i}})(function(e){r=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null})),f=Object(c.select)({store:function(){return i}})(function(e){return e.store.hasUndoableAction}),l=Object(u.b)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})(function(e){i.undoableActionFolderId?a.a.clearMapForFolder(i.undoableActionFolderId):a.a.removeAll();null!==r&&(r(),d())})},1651:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentPreviewsRequest:#Exchange"},e)}},1653:function(e){e.exports={a:"jab"}},1667:function(e){e.exports={a:"pub",b:"qub"}},1692:function(e){e.exports={a:"Xwb"}},1832:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",function(){return r})},1835:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",function(){return r})},1838:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemChange:#Exchange"},e)}},1839:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(8),o="deleteMeetingMessage";t.b=Object(r.action)(o)(function(e,t){})},1840:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",function(){return r})},1842:function(e,t,n){"use strict";function r(e){return e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",function(){return r})},1845:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetItemField:#Exchange"},e)}},1893:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(1651);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAttachmentPreviews",e,t)}},2252:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},2436:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"Message:#Exchange"},e)}},2449:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(2882);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("UpdateItem",e,t)}},2452:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemRequest:#Exchange"},e)}},2490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(2942);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("ApplyConversationAction",e,t)}},2491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApplyConversationActionRequest:#Exchange"},e)}},2492:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConversationAction:#Exchange"},e)}},286:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",function(){return s}),n.d(r,"remove",function(){return d}),n.d(r,"removeAll",function(){return f}),n.d(r,"getCount",function(){return l}),n.d(r,"getTombstonedReasons",function(){return b}),n.d(r,"clearMapForFolder",function(){return m}),n.d(r,"removeRowsFromTombstone",function(){return v});var o=n(0),i=n(1),a=Object(i.createStore)("tombstone",{folderTombstoneMap:{}}),c=(a(),n(15)),u=n(8),s=Object(u.action)("tombstoneOperations.add")(function(e,t,n){var r=a().folderTombstoneMap;t in r||(r[t]={});var o=r[t];e.forEach(function(e){var t=o[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):o[e]=[3]:o[e]=[n]})}),d=Object(u.action)("tombstoneOperations.remove")(function(e,t,n){var r=a().folderTombstoneMap;if(t in r){var o=r[t],i=o[e],c=i?i.indexOf(n):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");i.splice(c,1),0==i.length&&delete o[e],0==Object.keys(o).length&&delete r[t]}}),f=Object(u.action)("tombstoneOperations.removeAll")(function(){a().folderTombstoneMap={},Object(c.p)("TnS_RemoveAllFromTombstone")}),l=function(e,t){var n=a().folderTombstoneMap;if(!(e in n))return 0;var r=0,o=n[e];return Object.values(o).forEach(function(e){e==t&&r++}),r},b=function(e,t){var n=a().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},m=Object(u.action)("tombstoneOperations.clearMapForFolder")(function(e){var t=a().folderTombstoneMap;t[e]&&(Object(c.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])}),v=Object(u.action)("tombstoneOperations.removeRowsFromTombstone")(function(e,t){var n,r,i=a().folderTombstoneMap;if(t in i){var c=i[t];try{for(var u=o.__values(e),s=u.next();!s.done;s=u.next()){var d=s.value;d in c&&delete c[d]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}0==Object.keys(c).length&&delete i[t]}});t.a=r},2882:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemJsonRequest:#Exchange"},e)}},2942:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApplyConversationActionJsonRequest:#Exchange"},e)}},2973:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(12),i={markConversationAsRead:{name:function(e,t,n,r,o,i,a){var c="TnS_MarkConversation";return c+=n?"Read":"Unread",r||(c+="Background"),c},options:function(e,t,n,r,o,i,a){return r?{isCore:!0}:{}},customData:function(e,t,n,r,i,a,c){return[i,e.length,Object(o.m)(t),Object(o.I)(t)]},cosmosOnlyData:function(e,t,n,i,a,c,u){var s,d,f=[],l=Object(o.B)(e,t);try{for(var b=r.__values(l),m=b.next();!m.done;m=b.next()){var v=m.value;f.push(o.b.getItemIds(v,t))}}catch(e){s={error:e}}finally{try{m&&!m.done&&(d=b.return)&&d.call(b)}finally{if(s)throw s.error}}return JSON.stringify({itemIds:f,conversationIds:e})}},markItemReadUnread:{name:function(e,t,n,r,o,i){var a="TnS_MarkItem";return a+=n?"Read":"Unread",r||(a+="Background"),a},options:function(e,t,n,r,o,i){return r?{isCore:!0}:{}},customData:function(e,t,n,r,i,a){var c=e?e.tableQuery.type:null,u=e?Object(o.m)(e):null,s=e?Object(o.I)(e):null;return[c,t.length,u,s]},cosmosOnlyData:function(e,t,n,r,o,i){return JSON.stringify({itemIds:t})},actionSource:function(e,t,n,r,o){return o}}},a=n(142);var c=n(8),u=n(1),s=Object(u.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),d=Object(c.action)("AddMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return s}})(function(e,t){e.forEach(function(e){return t.store.suppressedItemIdsMap[e]=!0})})),f=Object(c.action)("RemoveMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return s}})(function(e,t){e.forEach(function(e){return delete t.store.suppressedItemIdsMap[e]})})),l=Object(c.action)("ClearMarkReadSuppressedMap")(Object(c.select)({store:function(){return s}})(function(e){e.store.suppressedItemIdsMap={}}));function b(e){for(var t=0;t<e.length;t++)if(!s.suppressedItemIdsMap[e[t]])return!1;return!0}var m=n(3894),v=n(9),O=n(1838),p=n.n(O),h=n(236),I=n.n(h),j=n(2449),w=n.n(j),g=n(2452),_=n.n(g),A=n(27);function y(e,t,n){var r=function(e,t){var n="AlwaysSend"!=Object(v.a)().UserOptions.ReadReceipt,r=Object(m.a)("IsRead",t),o=[];return e.forEach(function(e){return o.push(p()({Updates:[r],ItemId:I()({Id:e})}))}),_()({ItemChanges:o,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:n})}(e,t);return w()({Header:Object(A.getJsonRequestHeader)(),Body:r},n).then(function(e){var t=e.Body.ResponseMessages.Items[0],n=t.ResponseClass;if(void 0!==n&&"Success"!=n){var r=new Error("ResponseCode="+t.ResponseCode+", Stacktrace="+t.StackTrace);return r.fetchErrorType="ServerFailure",Promise.reject(r)}return Promise.resolve()}).catch(function(e){return Promise.reject(e)})}var R=n(4977),S=n(118),M=n(1204),P=n(224),k=n(11),C=n(25),T=Object(C.b)("markItemsAsReadBasedOnItemIds",i.markItemReadUnread)(function(e,t,n,i,c,u){return r.__awaiter(this,void 0,void 0,function(){var s,l,b;return r.__generator(this,function(r){return 0==(s=function(e,t){var n=[];return e.forEach(function(e){var r=a.a.items.get(e);Object(o.M)(r)&&r.IsRead!=t&&n.push(e)}),n}(t,n)).length?[2,Promise.resolve()]:(n?f(s):i?d(s):k.c.warn("Invalid scenario to implicitly mark item as unread."),l=e?e.id:null,Object(M.a)(s,n,i,l),R.a.import().then(function(t){t(e?e.tableQuery:null,!1,n,c,s)}),n?i?Object(S.o)("MarkAsRead",u):Object(S.o)("MarkAsReadImplicit",u):Object(S.o)("MarkAsUnread",u),b=Object(P.b)(e).requestOptions,[2,y(s,n,b)])})})}),E=Object(c.action)("autoMarkItemAsRead")(function(e,t){Object(o.f)(t)&&(b([e])||(T(t,[e],!0,!1,null,[]),l()))}),x=Object(c.action)("onItemPartDeselected")(function(e,t){t&&"OnSelectionChange"==Object(v.a)().UserOptions.PreviewMarkAsRead&&E(e,t)}),F=n(4572),U=n(4445),D=n(2491),V=n.n(D),q=n(2492),B=n.n(q),N=n(2490),H=n.n(N),L=n(1369);function G(e,t,n){var r=Object(U.a)(n),o=e.map(function(e){return function(e,t,n){return B()({Action:"SetReadState",ConversationId:I()({Id:e.conversationId}),IsRead:t,ConversationLastSyncTime:Object(F.a)(e.conversationLastSyncTimeStamp),SuppressReadReceipts:!0,ContextFolderId:n})}(e,t,r)});return V()({ConversationActions:o,ReturnMovedItemIds:!1})}var Q=n(1203),K=n(1522),W=n(3798);var J=Object(C.b)("markConversationsAsReadBasedOnConversationIds",i.markConversationAsRead)(function(e,t,n,i,a,c,u){var s=function(e,t,n){var r=[];return e.forEach(function(e){var i=Object(o.F)(e,t);i&&i.unreadCount>0===n&&r.push(e)}),r}(u,t.id,n);if(0==s.length)return Promise.resolve();if(1==e.length&&1==t.selectedRowKeys.size){var f=o.b.getRowIdString(s[0],t),b=Object(o.F)(r.__spread(t.selectedRowKeys.keys())[0],t.id);if(f==b.id){var m=b.itemIds;n?l():i?d(m):k.c.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(Q.a)(e,t.id,n,i),R.a.import().then(function(r){r(t.tableQuery,!1,n,a,e)}),n?i?Object(S.o)("MarkAsRead",c):Object(S.o)("MarkAsReadImplicit",c):Object(S.o)("MarkAsUnread",c);var v=Object(P.b)(t).requestOptions;return Object(o.e)(t)?function(e,t,n,i){var a=[];return t.forEach(function(t){a.push.apply(a,r.__spread(o.b.getItemIds(t,e)))}),y(a,n,i)}(t,s,n,v):function(e,t,n,r,i){var a=Object(K.a)(e),c=function(e,t,n,r){var o=G(e,t,n);return H()({Header:Object(L.getJsonRequestHeader)(),Body:o},r).then(function(e){return e.Body.ResponseMessages.Items[0]})}(t.map(function(t){return Object(o.h)(t,e.id)}),n,a,i),u=Object(o.Q)(e,n,r);return Object(W.d)(c,t,a,e,u)}(t,s,n,i,v)});var z=n(282),$=Object(c.action)("autoMarkConversationAsRead")(Object(c.select)({items:function(){return a.a.items}})(function(e,t,n){var r=Object(o.B)([e],t),i=Object(z.a)(r[0],t.id);if(i&&Object(o.f)(t)){var a=i.itemIds;b(a)||(0==Object.keys(s.suppressedItemIdsMap).length?J([e],t,!0,!1,null,[],r):a.forEach(function(e){!b([e])&&n.items.get(e)&&T(t,[e],!0,!1,null,[])}),l())}}));function X(e,t){var n=o.b.getRowIdString(e,t);switch(t.tableQuery.listViewType){case 0:$(n,t);break;case 1:E(n,t)}}var Y=n(85),Z=Object(c.action)("onReadingPaneClosed")(function(e,t){Object(Y.o)()&&!Object(Y.x)()&&Object(Y.w)()||k.c.error("onReadingPaneClosed should only be called when reading pane is closed in single line view."),"OnSelectionChange"==Object(v.a)().UserOptions.PreviewMarkAsRead&&X(e,t)}),ee=Object(c.action)("onSingleSelectionChanged")(function(e,t,n){var r=Object(v.a)().UserOptions;Object(Y.o)()||"OnSelectionChange"==r.PreviewMarkAsRead&&n&&X(e,t)}),te=Object(u.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",function(e,t,n,r,o){return{nodeIds:e,tableViewId:t,isReadValueToSet:n,isExplicit:r,actionSource:o}}),ne=Object(c.action)("markItemAsReadFromReadingPane")(function(e,t,n,r,i){var c=[],u=null;if(t){if(1==t.tableQuery.listViewType)c=Object(o.B)([e],t);else{var s=a.a.items.get(e).ConversationId.Id;c=Object(o.B)([s],t)}u=Object(o.k)(t)}T(t,[e],n,!0,i,r).then(function(){t&&Object(W.b)(c,u)}).catch(function(e){t&&(Object(W.b)(c,u),Object(W.c)(t))})}),re=n(1097),oe=Object(c.action)("markConversationsAsReadFromTable")(function(e,t,n,r){var i=Object(o.z)(e,t.id),a=Object(re.a)(e,t);return J(i,t,n,!0,r,a,e)}),ie=Object(c.action)("markItemsReadFromTable")(function(e,t,n,r,i){var a=Object(o.z)(e,t.id),c=Object(re.a)(e,t),u=T(t,a,n,r,i,c),s=Object(o.k)(t),d=Object(o.Q)(t,n,r);u.then(function(t){Object(W.b)(e,s,d)}).catch(function(n){Object(W.b)(e,s,d),Object(W.c)(t)})}),ae=n(1289),ce=Object(c.action)("toggleRowReadState")(function(e,t,n){var r=o.O.tableViews.get(t),i=o.b.getUnreadCount(e,r)>0;switch(r.tableQuery.listViewType){case 0:oe([e],r,i,n);break;case 1:ie([e],r,i,!0,n)}Object(ae.b)()}),ue=Object(c.action)("onNavigateAwayViaUpDown")(function(e,t){"OnSelectionChange"==Object(v.a)().UserOptions.PreviewMarkAsRead&&X(e,t)}),se=n(10232),de=n(1692),fe=n(1653),le=n(3506),be=n(4),me=n(271),ve=n(246),Oe=n(10233),pe=n.n(Oe),he=n(10234),Ie=n.n(he);var je=n(6309),we=n(106),ge=n(21),_e=n(711),Ae=n(1292),ye=n(15),Re=n(6),Se=Object(c.action)("markAsReadInTable")(function(e,t,n,i,a,c){var u=this;if(a.length&&n)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(t.length&&!n)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var s=c.tableQuery.folderId,d=ge.n.folderTable.get(s),f=n&&d&&d.UnreadCount>=je.b||Object(o.r)(c)&&a.length>=je.b,l=Object(o.p)(Object(o.m)(c),Object(o.q)(c.id),c.tableQuery.type,d&&d.DisplayName),b=i?Object(be.a)(de.a):Object(be.a)(fe.a),m=i?Object(be.b)(Object(be.a)(se.a),l):Object(be.b)(Object(be.a)(se.b),l);Object(ve.b)(b,m,!f,{delayCallbackAfterAnimation:!0,okText:Object(be.a)(le.a)}).then(function(d){return r.__awaiter(u,void 0,void 0,function(){var u,f,l;return r.__generator(this,function(r){if(d===ve.a.ok)if(_e.b(),n)u=Object(v.a)().UserOptions.ReadReceipt,f="DoNotAutomaticallySend"==u||"NeverSend"==u||Object(Ae.a)(s),l=Object(o.L)(s)?Object(Re.m)(o.O.inboxPausedDateTime):null,function(e,t,n){var r="TnS_MarkAllAs";r+=t?"Read":"Unread",Object(ye.o)(r,[e,Object(o.m)(n)])}(e,i,c),R.a.import().then(function(t){t(c.tableQuery,!0,i,e)}),Object(we.raiseAction)(me.e.MarkAllAsReadStoreUpdate)(c,i,t),function(e,t,n,r,o,i){var a=null!=n?n.map(function(e){return I()({Id:e})}):void 0;Ie()({Header:Object(A.getJsonRequestHeader)(),Body:pe()({ReadFlag:t,SuppressReadReceipts:r,FromFilter:null,FolderIds:[e],ItemIdsToExclude:a,ClientLastSyncTime:i&&i.toISOString()})},o).then(function(e){return e.Body.ResponseMessages.Items[0]})}(Object(o.j)(c),i,t,f,Object(P.b)(c).requestOptions,l);else switch(c.tableQuery.listViewType){case 0:oe(a,c,i,e);break;case 1:ie(a,c,i,!0,e)}return[2]})})})});var Me=n(353),Pe=Object(c.action)("setAutoMarkAsReadTimer")(Object(c.select)({markAsReadDelaytime:function(){return Object(v.a)().UserOptions.MarkAsReadDelaytime},store:function(){return s},userOptions:function(){return Object(v.a)().UserOptions}})(function(e,t){var n=Object(Me.a)();if(n&&Object(o.f)(n)){var r=t.markAsReadDelaytime,i=t.store;"Delayed"==t.userOptions.PreviewMarkAsRead&&(i.markAsReadTimerTask=setTimeout(function(){Ce(e,n)},1e3*r))}})),ke=Object(c.action)("clearAutoMarkAsReadTimer")(Object(c.select)({store:function(){return s}})(function(e){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)})),Ce=Object(c.action)("setMarkAsReadTimer:timeout")(function(e,t){switch(ke(),t.tableQuery.listViewType){case 0:$(e,t);break;case 1:E(e,t)}}),Te=n(5343),Ee=(Object(u.orchestrator)(te,function(e){var t=Object(Te.a)(e.nodeIds),n=o.O.tableViews.get(e.tableViewId);T(n,t,e.isReadValueToSet,e.isExplicit,e.actionSource,null)}),n(265)),xe=n(72),Fe=n(3701);Object(u.orchestrator)(Ee.q,function(e){var t=Object(Fe.b)(e.nodeIdToSelect);if(t){var n=Object(xe.b)().tableViews.get(e.tableViewId);E(t.ItemId.Id,n)}}),n.d(t,"onItemPartDeselected",function(){return x}),n.d(t,"onReadingPaneClosed",function(){return Z}),n.d(t,"onSingleSelectionChanged",function(){return ee}),n.d(t,"markItemsAsReadBasedOnNodeIds",function(){return te}),n.d(t,"markItemAsReadFromReadingPane",function(){return ne}),n.d(t,"toggleRowReadState",function(){return ce}),n.d(t,"onNavigateAwayViaUpDown",function(){return ue}),n.d(t,"markAsReadInTable",function(){return Se}),n.d(t,"clearAutoMarkAsReadTimer",function(){return ke}),n.d(t,"setAutoMarkAsReadTimer",function(){return Pe})},3506:function(e){e.exports={a:"kca"}},3701:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return f});var r=n(0),o=n(142),i=n(1516),a=n(181),c=n(9),u=n(340);function s(e){var t,n,c=e&&e.itemIds?e.itemIds.length:0;if(0==c)return[null,!1,!1];var s=null,d=2==Object(a.c)().type||!Object(a.b)();if(1==c){if(!(s=o.a.items.get(e.itemIds[0])))return[null,!1,!1];d=d||s.ParentFolderId&&s.ParentFolderId.Id==Object(a.b)()}else{var f=null;try{for(var l=r.__values(e.itemIds),b=l.next();!b.done;b=l.next()){var m=b.value,v=o.a.items.get(m);if(!v)return[null,!1,!1];if(v.ParentFolderId&&v.ParentFolderId.Id==Object(a.b)()){s=v,d=!0;break}Object(u.a)(v.ParentFolderId.Id,"sentitems")&&(f=v)}}catch(e){t={error:e}}finally{try{b&&!b.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}s||(s=f||o.a.items.get(e.itemIds[0]))}return[s,d,Object(i.a)(s.ParentFolderId.Id)]}function d(e,t,n){var r=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||r)&&t&&!n)}function f(e){var t=o.a.conversationNodes.get(e),n=r.__read(s(t),3),i=n[0],a=n[1];return d(i,n[2],a)?i:null}},3798:function(e,t,n){"use strict";var r=n(4994),o=n(0),i=n(4233),a=n(4234);function c(e,t,n,r,c){return e.then(function(e){if(Object(i.a)(t,n,c),e.ResponseMessages){var u=function(e,t){var n,r;try{for(var i=o.__values(e),c=i.next();!c.done;c=i.next()){var u=c.value;if(u&&"Success"!=u.ResponseClass){Object(a.a)(t);var s=new Error("ResponseCode="+u.ResponseCode+", Stacktrace="+u.StackTrace);return s.fetchErrorType="ServerFailure",s}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return null}(e.ResponseMessages.Items,r);return u?Promise.reject(u):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))}).catch(function(e){return Object(i.a)(t,n,c),Object(a.a)(r),Promise.reject(e)})}var u=n(4446);n.d(t,"d",function(){return r.a}),n.d(t,"e",function(){return c}),n.d(t,"a",function(){return u.a}),n.d(t,"b",function(){return i.a}),n.d(t,"c",function(){return a.a})},3894:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(2436),o=n.n(r),i=n(65),a=n.n(i),c=n(1845),u=n.n(c);function s(e,t){var n;return u()({Path:a()({FieldURI:e}),Item:o()((n={},n[e]=t,n))})}},4233:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(286);function o(e,t,n){n&&r.a.removeRowsFromTombstone(e,t)}},4234:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1453);function o(e){e&&Object(r.a)(e)}},4445:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(102),o=n.n(r),i=n(266),a=n.n(i);function c(e){return e?a()({BaseFolderId:o()({Id:e})}):null}},4446:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(29);function i(e){var t,n;if(!e)return Promise.reject(a("500","Server returned a null response!"));var i=Array.isArray(e)?e:[e];try{for(var c=r.__values(i),u=c.next();!u.done;u=c.next()){var s=u.value;if(s&&!Object(o.g)(s))return Promise.reject(a(s.ResponseCode,s.StackTrace))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return Promise.resolve()}function a(e,t){var n=new Error("ResponseCode="+e+", Stacktrace="+t);return n.fetchErrorType="ServerFailure",n}},4572:function(e,t,n){"use strict";function r(e){return e?new Date(e).toISOString():null}n.d(t,"a",function(){return r})},466:function(e,t,n){"use strict";n.d(t,"j",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"w",function(){return i}),n.d(t,"u",function(){return a}),n.d(t,"a",function(){return c}),n.d(t,"q",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return b}),n.d(t,"f",function(){return m}),n.d(t,"e",function(){return v}),n.d(t,"m",function(){return O}),n.d(t,"d",function(){return p}),n.d(t,"k",function(){return h}),n.d(t,"t",function(){return I}),n.d(t,"o",function(){return j}),n.d(t,"v",function(){return w}),n.d(t,"p",function(){return g}),n.d(t,"r",function(){return _}),n.d(t,"s",function(){return A}),n.d(t,"n",function(){return y});var r="multipart/signed",o="application/pkcs7-mime",i="application/x-pkcs7-mime",a=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",f=57,l=16,b=11,m="IPM.Note.SMIME.MultipartSigned",v="IPM.Note.SMIME",O="smime-",p="image",h="OwaToSmime",I="SmimeToOwa",j="en-US",w=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],g="https://ow2.res.office365.com/owasmime/20.19.701.1/owasmime.msi",_="OwaSmimeEdgeExtension.appxbundle",A="https://ow2.res.office365.com/owasmime/20.19.701.1/OwaSmimeEdgeExtension.appxbundle",y="https://ow2.res.office365.com/owasmime/20.19.701.1/SmimeOutlookWebChrome.msi"},4977:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c});var r=n(3),o=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(11),n.e(256)]).then(n.bind(null,8144))}),i=new r.b(o,function(e){return e.addMarkAsReadDiagnostics}),a=new r.b(o,function(e){return e.addUnreadCountNotificationDiagnostics}),c=new r.b(o,function(e){return e.addUnreadCountSubscriptionDiagnostics})},4994:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4233),o=n(4234),i=n(4446);function a(e,t,n,a,c){return e.then(function(e){return Object(r.a)(t,n,c),Object(i.a)(e)}).catch(function(e){return Object(r.a)(t,n,c),Object(o.a)(a),Promise.reject(e)})}},5343:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(3701);function i(e){var t,n,i=[];try{for(var a=r.__values(e),c=a.next();!c.done;c=a.next()){var u=c.value,s=Object(o.b)(u);s&&i.push(s.ItemId.Id)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}},556:function(e,t,n){"use strict";var r=n(1),o=Object(r.action)("ON_GET_NUDGES_COMPLETED",function(e){return{nudgedRows:e}}),i=Object(r.action)("ON_NUDGE_REMOVED",function(e){return{rowKey:e}}),a=Object(r.createStore)("nudgeStore",{nudgedRows:[]}),c=a();function u(e){return c.nudgedRows.filter(function(t){return t.tableViewId===e}).length}Object(r.mutator)(o,function(e){c.nudgedRows=e.nudgedRows}),Object(r.mutator)(i,function(e){for(var t=c.nudgedRows.length-1;t>=0;t--)c.nudgedRows[t].rowKey===e.rowKey&&c.nudgedRows.splice(t,1)});var s=n(1667),d=n(4);function f(e){var t=c.nudgedRows.filter(function(t){return t.rowKey===e})[0];switch(t.reason){case 0:return Object(d.b)(Object(d.a)(s.a),t.daysAgo);case 1:return Object(d.b)(Object(d.a)(s.b),t.daysAgo)}}function l(e){var t=c.nudgedRows.filter(function(t){return t.itemId===e});return 1==t.length?t[0].rowKey:null}function b(e,t){return 1==c.nudgedRows.filter(function(n){return n.rowKey===e&&n.tableViewId===t}).length}var m=n(12);function v(e,t){return b(e,t.id)&&!m.b.getIsPinned(e,t)}n.d(t,"c",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"b",function(){return l}),n.d(t,"f",function(){return v}),n.d(t,"e",function(){return b}),n.d(t,"d",function(){return a}),n.d(t,"g",function(){return o}),n.d(t,"h",function(){return i})},6309:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o});var r=1e4,o=25},711:function(e,t,n){"use strict";var r=n(42),o=n(12),i=n(29),a=n(28),c=n(21);function u(e,t){return!Object(o.t)()&&t&&t.type===r.a.UserMailbox&&!Object(i.z)(e)&&e!=Object(a.a)("recoverableitemsdeletions")&&!Object(c.I)(e,c.j)}var s=n(3),d=n(1416);n.d(t,"e",function(){return l}),n.d(t,"a",function(){return d.a}),n.d(t,"b",function(){return d.b}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d.c});var f=new s.c(function(){return n.e(425).then(n.bind(null,13484))}),l=new s.a(f,function(e){return e.undo})},745:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1100);function o(e){return e&&Object(r.b)(e.ItemClass)}},823:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("GET_FOLDER_DATA",function(e){return{folderId:e}})},874:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",function(){return y}),n.d(r,"getPreviews",function(){return R}),n.d(r,"getAttachmentsForConversationWell",function(){return M});var o=n(0),i=n(8),a=n(72),c=Object(i.action)("removeAttachmentPreviewsForRow")(function(e){var t=a.a.rowAttachmentPreviewWellViews,n=t.get(e);if(n){var r=a.a.attachmentViewStates;n.imageViewStateIds.forEach(function(e){r.delete(e)}),n.documentViewStateIds.forEach(function(e){r.delete(e)}),t.delete(e)}});var u=n(15),s=n(258),d=n(721),f=n(29),l=n(7);var b=Object(i.action)("createAndStoreAttachmentViewState")(function(e,t,n,r,i){return o.__awaiter(this,void 0,void 0,function(){var c,u,f,b=this;return o.__generator(this,function(m){switch(m.label){case 0:return c=function(e,t){return e+"_"+t}(e,n.AttachmentId.Id),u=a.a.attachmentViewStates.get(c),f=l.observable.object(o.__assign({},n.AttachmentId,{mailboxInfo:i})),[4,d.d.import().then(function(e){return o.__awaiter(b,void 0,void 0,function(){return o.__generator(this,function(o){switch(o.label){case 0:return u=u||e(f,n,!0,!0,!1,t),[4,s.i.import()];case 1:return n=o.sent()(f).model,a.a.attachmentViewStates.set(c,u),[4,s.o.import()];case 2:return o.sent()(n)?r.imageViewStateIds.push(c):r.documentViewStateIds.push(c),[2]}})})})];case 1:return m.sent(),[2]}})})});var m=Object(i.select)({listView:function(){return a.a}})(Object(i.action)("processAttachmentsForConversation")(function(e,t,n){var r=n.listView.conversationItems.get(e.ConversationId.Id);if(r)if(e.AttachmentPreviews){var o=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n],i=o.Attachment,a=-1;if(i.IsInline)for(var c=0;c<t.length;c++){var u=t[c];if(u.Attachment.IsInline&&u.Attachment.Name==i.Name&&u.ParentItemId.Id!=o.ParentItemId.Id){a=c;break}}-1==a&&t.push(o)}return t}(e.AttachmentPreviews.Previews);O(e.ConversationId.Id,o,t);var i=e.AttachmentPreviews.Previews.length-o.length;i>0&&Object(u.p)("IP_II_DP",[i])}else r.shouldShowAttachmentPreviews=!1,c(e.ConversationId.Id),Object(u.p)("IP_FP")})),v=Object(i.action)("processAttachmentPreviewsForItems")(function(e,t,n){var r=e.filter(function(e){return e.AttachmentPreviews}),i=[];r.forEach(function(e){i.push.apply(i,o.__spread(e.AttachmentPreviews.Previews))});var a={};i.forEach(function(e){var n=e.ParentItemId.Id;t.indexOf(n)>-1&&(a[n]||(a[n]=[]),a[n].push(e))}),t.forEach(function(e){var t=f.H.items.get(e);t?a[e]?O(e,a[e],n):(t.shouldShowAttachmentPreviews=!1,c(e)):delete a[e]})}),O=Object(i.action)("processAttachmentsForRow")(function(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var r,i=this;return o.__generator(this,function(c){switch(c.label){case 0:return r={documentViewStateIds:[],imageViewStateIds:[]},[4,Promise.all(t.map(function(t){return o.__awaiter(i,void 0,void 0,function(){return o.__generator(this,function(i){switch(i.label){case 0:return[4,b(e,o.__assign({},t.ParentItemId,{mailboxInfo:n}),t.Attachment,r,n)];case 1:return i.sent(),[2]}})})}))];case 1:return c.sent(),a.a.rowAttachmentPreviewWellViews.set(e,r),[2]}})})}),p=n(1893),h=n.n(p),I=n(1651),j=n.n(I);function w(e,t,n){var r=j()(o.__assign({},n,{ConversationIds:e}));return h()(r,t).then(function(e){return e})}var g=n(12),_=n(41),A=new Map,y=Object(i.select)({rowIdsToGetPreviewsMap:function(){return A}})(Object(i.action)("AttachmentPreviewsOperations.add")(function(e,t,n,r){var o=r.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId];o||(o={conversationsIdsArray:[],itemIdsArray:[]},r.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId]=o),-1==o.conversationsIdsArray.indexOf(t)&&o.conversationsIdsArray.push(t),-1==o.itemIdsArray.indexOf(n)&&o.itemIdsArray.push(n)})),R=Object(i.select)({rowIdsToGetPreviewsMap:function(){return A}})(Object(i.action)("AttachmentPreviewsOperations.getPreviews")(function(e,t,n){return o.__awaiter(this,void 0,void 0,function(){var r,i,a,c,u;return o.__generator(this,function(o){switch(o.label){case 0:if(!(r=n.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId]))return[2];i=r.conversationsIdsArray,a=r.itemIdsArray,c=Object(_.a)(),delete n.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,w(i,e&&e.requestOptions,{IncludeInlineAttachments:c})];case 2:return void 0!==(u=o.sent()).Conversations?1==t?v(u.Conversations,a,e):function(e,t){e.forEach(function(e){m(e,t)})}(u.Conversations,e):S(t,a,i),[3,4];case 3:return o.sent(),S(t,a,i),[3,4];case 4:return[2]}})})}));function S(e,t,n){1==e?t.forEach(function(e){var t=f.H.items.get(e);t&&(g.O.rowAttachmentPreviewWellViews.get(e)||(t.shouldShowAttachmentPreviews=!1))}):n.forEach(function(e){var t=e.Id,n=g.O.conversationItems.get(t);n&&(g.O.rowAttachmentPreviewWellViews.get(t)||(n.shouldShowAttachmentPreviews=!1))})}var M=Object(i.action)("AttachmentPreviewsOperations.getAttachmentsForConversationWell")(function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n,r,i,a;return o.__generator(this,function(c){switch(c.label){case 0:t=[e],n=[],r={},i={},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,w(t,e.mailboxInfo&&e.mailboxInfo.requestOptions,{FullPreviewsPerConversation:300,PreviewsPerConversation:300,MinimumAttachmentSize:0,IncludeInlineAttachments:!1})];case 2:return void 0!==(a=c.sent()).Conversations&&a.Conversations.forEach(function(t){t.ConversationId.Id==e.Id&&t.AttachmentPreviews&&t.AttachmentPreviews.Previews&&t.AttachmentPreviews.Previews.forEach(function(t){n.push(t.Attachment),r[t.Attachment.AttachmentId.Id]=o.__assign({},t.ParentItemId,{mailboxInfo:e.mailboxInfo}),i[t.Attachment.AttachmentId.Id]=t.ItemReceivedTime})}),[3,4];case 3:return c.sent(),[3,4];case 4:return[2,[n,r,i]]}})})}),P=n(224),k=n(87),C=n(466);var T=n(745);function E(e,t){if(t.folderId&&"junkemail"==Object(k.a)(t.folderId))return!1;if(Object(T.a)(e))return!1;var n=f.H.items.get(e.ItemId.Id);return n?n.shouldShowAttachmentPreviews:!(!e.HasAttachments&&!e.HasSharepointLink)&&(y(Object(P.c)(t),e.ConversationId,e.ItemId.Id),!0)}var x=Object(i.select)({listViewStore:function(){return g.O}})(function(e,t,n){var r,o,i,a=1==t.type,c=e.ConversationId,u=n.listViewStore.conversationItems.get(c.Id);if(t.folderId&&"junkemail"==Object(k.a)(t.folderId))return!1;if((r=e)&&r.ItemClasses&&r.ItemClasses.length>0&&r.ItemClasses.some(function(e){return 0===e.indexOf(C.e)}))return!1;if(a){if(u)return u.shouldShowAttachmentPreviews;o=i=!!e.HasAttachments}else{if(!e.HasAttachmentPreviews&&!e.HasSharepointLink)return!1;u?(o=u.globalItemIds.length!=e.GlobalItemIds.length,i=u.shouldShowAttachmentPreviews):(o=!0,i=!0)}return o&&y(Object(P.c)(t),e.ConversationId,null),i});n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return x}),n.d(t,"d",function(){return E})},915:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SortResults:#Exchange"},e)}}},0,[3,21,34,79,330,6,7,9,11,119,4,8,23,314,12,43,115,486,98,70,110,498,167,499,171,213,299,468,470]]);
//# sourceMappingURL=owa.MarkRead.js.map
self.scriptsLoaded['owa.MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MarkRead.js'] = (new Date()).getTime();