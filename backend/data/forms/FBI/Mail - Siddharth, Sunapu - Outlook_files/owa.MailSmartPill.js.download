self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[311],{1233:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});var r=n(1),a=Object(r.createStore)("UserVoiceNpsStore",{npsSurveyBody:"",npsSurveyRatings:"",isRatingSelected:!1,isSent:!1}),i=Object(r.createStore)("UserVoiceSuggestionStore",{message:"",isMessageEnabled:!1,isSent:!1,customFields:[]})(),o=Object(r.createStore)("userVoiceTrendingIdeasStore",{suggestions:[],pagination:{page:0,per_page:0,total_pages:0,total_records:0}})},1251:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("DEACTIVATE_HELP_CHARM")},12767:function(e){e.exports={a:"jJb"}},12768:function(e){e.exports={a:"hJb",b:"iJb"}},12769:function(e){e.exports={l:"XIb",f:"YIb",a:"ZIb",b:"_Ib",c:"$Ib",d:"aJb",e:"bJb",g:"cJb",h:"dJb",i:"eJb",j:"fJb",k:"gJb"}},12770:function(e,t,n){var r=n(12771),a=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},12771:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),t.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},1298:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("openPremiumDashboard")},1306:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("SHOW_QUICK_OPTIONS",function(){return{}})},1315:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("contactSupport")},1318:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.createStore)("whatsNewStore",{cards:null})},1321:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},1323:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("TRY_TODO_PANEL")},135:function(e,t,n){"use strict";var r=n(3),a=n(0),i=n(346),o=n(5),u=n(313),c=n(1),s=(Object(c.orchestrator)(i.c,function(){return a.__awaiter(void 0,void 0,void 0,function(){return a.__generator(this,function(e){return Object(o.e)("auth-PremiumDashboardApril")?u.e.importAndExecute("premium","features"):Object(o.e)("auth-PremiumDashboard")?u.e.importAndExecute("general","Premium"):window.open("https://premium.outlook.com","_blank"),[2]})})}),n(1315)),l=n(71),d=(Object(c.orchestrator)(s.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaHelp"):Object(l.c)(2)}),n(817));Object(c.orchestrator)(d.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaSettings"):Object(l.c)(4)}),n(1670);n.d(t,"b",function(){return m}),n.d(t,"e",function(){return p}),n.d(t,"c",function(){return g}),n.d(t,"d",function(){return b}),n.d(t,"h",function(){return h}),n.d(t,"l",function(){return v}),n.d(t,"n",function(){return S}),n.d(t,"f",function(){return y}),n.d(t,"q",function(){return O}),n.d(t,"g",function(){return P}),n.d(t,"r",function(){return j}),n.d(t,"p",function(){return T}),n.d(t,"o",function(){return _}),n.d(t,"m",function(){return w}),n.d(t,"a",function(){return I}),n.d(t,"j",function(){return R}),n.d(t,"k",function(){return E}),n.d(t,"i",function(){return x});var f=new r.c(function(){return Promise.all([n.e(1),n.e(5),n.e(517),n.e(66),n.e(259)]).then(n.bind(null,13610))}),m=Object(r.d)(f,function(e){return e.DiagnosticsPane}),p=Object(r.d)(f,function(e){return e.FeatureFlagsPane}),g=Object(r.d)(f,function(e){return e.FeatureFlagsHeader}),b=Object(r.d)(f,function(e){return e.FeatureFlagsList}),h=Object(r.d)(f,function(e){return e.HelpPane}),v=Object(r.d)(f,function(e){return e.MeCardPane}),S=Object(r.d)(f,function(e){return e.SettingsPane}),y=Object(r.d)(f,function(e){return e.FeedbackPane}),O=Object(r.d)(f,function(e){return e.WafflePane}),P=Object(r.d)(f,function(e){return e.GetStartedPane}),j=Object(r.d)(f,function(e){return e.WhatsNewPane}),T=Object(r.d)(f,function(e){return e.TodoPane}),_=Object(r.d)(f,function(e){return e.TimePanelPane}),w=Object(r.d)(f,function(e){return e.MiniMavenPane}),I=Object(r.d)(f,function(e){return e.ActivityFeedPane}),R=new r.a(f,function(e){return e.launchHelpPane}),E=new r.a(f,function(e){return e.showTodoPanelWithSubject}),x=new r.a(f,function(e){return e.toggleGetStartedPane})},13585:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),i=Object(a.action)("setSmartPillBlockVisibility",function(e,t){return{viewState:e,smartPillBlockVisible:t}}),o=Object(a.action)("setSmartPillFeedbackSubmitted",function(e,t){return{item:e,smartPillFeedbackSubmitted:t}}),u=n(11),c=n(5);function s(e){if(e){if("SmartDoc"===e.featureName)return!0;null==e.confidenceScore&&u.c.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+e.featureName+" EntityId: "+e.logData.mainPayload.EID);var t=e.confidenceScore;if(t>0){if(Object(c.e)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(c.e)("mc-smartPillConfidenceLevel_MID"))switch(e.featureName){case"SmartTime":case"SmartTask":return t>=70;default:return!0}else switch(e.featureName){case"SmartTime":case"SmartTask":return t>=90;default:return!0}}}return!1}function l(e){switch(e.logData.mainPayload.language){case"English":return!0;case"Spanish":return Object(c.e)("mc-smartReplySpanishMexico");default:return!1}}var d=n(830),f=n(822);function m(e){var t=e.featureName;if("SmartReply"===t)return Object(c.e)("mc-smartReply");if("SmartTime"===t)return Object(c.e)("mc-smartReplyWithCustomMeeting");if("SmartDoc"===t)return Object(c.e)("mc-smartReplyWithDoc");if("SmartTodo"===t||"SmartReminder"===t){var n=Object(f.a)()||Object(d.a)();return n||u.c.info("[isPillTypeEnabled] Disable Smart Todo - Todo/Time panel is unavailable."),Object(c.e)("mc-smartTask")&&n}return u.c.info("[isPillTypeEnabled] Unknown pill type: "+t),!1}function p(){var e=Object(c.e)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartDoc:3},arrangement:["SmartDoc"]},{aggregation:{SmartReply:2,SmartTime:1},arrangement:e?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartReply:1,SmartTodo:1,SmartReminder:1},arrangement:e?["SmartTodo","SmartReminder","SmartReply"]:["SmartReply","SmartTodo","SmartReminder"]},{aggregation:{SmartTodo:1,SmartReminder:1},arrangement:["SmartTodo","SmartReminder"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartTodo:1},arrangement:e?["SmartTodo","SmartReply"]:["SmartReply","SmartTodo"]},{aggregation:{SmartTodo:1},arrangement:["SmartTodo"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]}]}var g={arbitratePills:function(e){var t=[],n=[];e.forEach(function(e){m(e)?t.push(e):(e.logData.mainPayload.renderStory|=1,n.push(e))});var r=Math.min(t.length,3),a=t.slice(r,e.length);return a.forEach(function(e){e.logData.mainPayload.renderStory|=2}),{pillsToShow:t.slice(0,r),pillsToHide:a.concat(n),arbitratorId:"SimpleArbitrator"}}},b=1,h=2,v=3;function S(e){if(e)for(var t=function(e){var t,n,a={};try{for(var i=r.__values(e),o=i.next();!o.done;o=i.next()){var u=o.value;a[u.featureName]=void 0===a[u.featureName]?1:a[u.featureName]+1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}(e),n=p(),a=0;a<n.length;a++){for(var i=!0,o=n[a],u=0;u<o.arrangement.length;u++){if(o.aggregation[o.arrangement[u]]>(void 0===t[o.arrangement[u]]?0:t[o.arrangement[u]])){i=!1;break}}if(i)return o}return null}var y={selectPills:function(e){return function(e,t){var n=[];return t&&e.length>0&&t.arrangement.forEach(function(a){n.push.apply(n,r.__spread(function(e,t,n){return e.filter(function(e){return e.featureName===t}).slice(0,n)}(e,a,t.aggregation[a])))}),n}(e,S(e))}};function O(e,t,n,r){var a=[];return e.forEach(function(e){n(e)?a.push(e):(e.logData.mainPayload.renderStory|=r,t.push(e))}),a}var P={arbitratePills:function(e){var t=[],n=[];if(e){var a=O(e,n,m,1),i=O(a,n,l,8),o=O(i,n,s,4);if(o.length>0){if(Object(c.e)("mc-smartPillsRenderingStrategiesV2")){var u=y;t.push.apply(t,r.__spread(u.selectPills(o)))}else{var d=function(e){if(e){var t=e.some(function(e){return"SmartTime"===e.featureName}),n=e.some(function(e){return"SmartReply"===e.featureName}),r=e.some(function(e){return"SmartDoc"===e.featureName}),a=e.some(function(e){return"SmartTodo"===e.featureName}),i=e.some(function(e){return"SmartReminder"===e.featureName});if(r)return{smartDoc:{numOfPills:v}};if(t&&n)return{smartTime:{numOfPills:b},smartReply:{numOfPills:h}};if(a&&i&&n)return{smartReply:{numOfPills:b},smartReminder:{numOfPills:b},smartTodo:{numOfPills:b}};if(a&&n)return{smartTodo:{numOfPills:b},smartReply:{numOfPills:h}};if(a&&i)return{smartReminder:{numOfPills:b},smartTodo:{numOfPills:b}};if(a)return{smartTodo:{numOfPills:b}};if(t)return{smartTime:{numOfPills:b}};if(n)return{smartReply:{numOfPills:v}}}return null}(o);if(d)new Map([["SmartDoc",d.smartDoc],["SmartReply",d.smartReply],["SmartTime",d.smartTime],["SmartTodo",d.smartTodo],["SmartReminder",d.smartReminder]]).forEach(function(e,n){var a,i;e&&t.push.apply(t,r.__spread((a=n,i=e,o.filter(function(e){return e.featureName===a}).slice(0,i.numOfPills))))})}for(var f=function(r){var a=e[r];t.some(function(e){return e===a})||(a.logData.mainPayload.renderStory|=2,n.push(a))},p=0;p<o.length;p++)f(p)}}return{pillsToShow:t,pillsToHide:n,arbitratorId:"complexArbitrator"}}};var j=3;function T(e,t){void 0===t&&(t=j);var n=[],r=null;if(e)for(var a=Object.keys(e),i=0;i<a.length;i++)for(var o=e[a[i]],c=0;c<o.length;c++)if(r=o&&o[c]){if(!(n.length<t))return n;n.push(r)}else u.c.info("[extractAttachmentSuggestions] ReplyWithAttachmentSuggestion is null");return n}var _="EntityExtraction/SubstrateSearchSuggestions",w="EntityExtraction/ReplyWithQueryCoverage";var I=n(67),R="/ows/search/api/v1/";function E(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,o=this;return r.__generator(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),t=function(e){var t={},n=function(e){var t=[];if(null!=e.ReplyWithQueryCoverage)for(var n=JSON.parse(e.ReplyWithQueryCoverage.Value)[0],r=n.coverageCheckResults,a=Object.keys(r),i=0;i<a.length;i++){var o=a[i];r[o]||t.push(o)}return t}(e);return JSON.parse(e.SubstrateSearchSuggestions.Value)[0].requests.forEach(function(e){var r=e.InputText;if(!n.includes(r)){var a=function(e,t){for(var n,r,a=R+e,i=0;i<t.length;i++)n=t[i].Key,r=t[i].Value,a+=0==i?"?":"&",a+=n+"="+r;return a}(e.Endpoint,e.UrlParameters);t[r]=a}}),t}(e),n={},(a=Object.keys(t)).length>0?[4,Promise.all(a.map(function(e){return r.__awaiter(o,void 0,void 0,function(){var a,i;return r.__generator(this,function(r){switch(r.label){case 0:return a=n,i=e,[4,x(t[e])];case 1:return[2,a[i]=r.sent()]}})})}))]:[3,2];case 1:return c.sent(),[2,D(n)];case 2:return[3,4];case 3:return i=c.sent(),u.c.info("Failed to parse property, error: "+i.message),[3,4];case 4:return[2,null]}})})}function x(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:t=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(I.b)(e)];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),u.c.info("[getReplyWithSuggestions_executeAndLog3SQuery] Failed to make service call, error: "+n.message),[3,4];case 4:return[2,t]}})})}function D(e){try{var t={};return Object.keys(e).forEach(function(n){t[n]=e[n].Groups[0].Suggestions;for(var r=0;r<t[n].length;r++)t[n][r].Endpoint=0}),t}catch(e){return u.c.info("getSentenceToAttachmentSuggestionsMap: Failed to execute, error: "+e.message),null}}function k(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=null,(n=function(e){var t={SubstrateSearchSuggestions:null,ReplyWithQueryCoverage:null},n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var i=n[a];i.ExtendedFieldURI.PropertyName===_?t.SubstrateSearchSuggestions=i:i.ExtendedFieldURI.PropertyName===w&&(t.ReplyWithQueryCoverage=i)}return t}(e))?[4,E(n)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}})})}var A=Object(a.action)("createMessageWithAttachmentAction",function(e,t){return{item:e,attachment:t}}),N=n(4407);function C(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return(n=e.AttachmentSuggestions)?[3,2]:[4,k(e)];case 1:n=r.sent(),r.label=2;case 2:return(t=n)?[2,T(t).map(function(t,n){return function(e,t,n){var r=Object(N.b)("SmartDoc","suggestion"+n);return{ariaLabel:e.FileName,featureName:"SmartDoc",icon:{iconName:F(e.FileExtension)},onClick:function(){A(t,e)},logData:r,index:n,text:e.FileName}}(t,e,n)})]:[2,[]]}})})}function F(e){return e.indexOf("doc")>=0?"WordLogo":e.indexOf("ppt")>=0?"PowerPointLogo":e.indexOf("xls")>=0?"ExcelLogo":e.indexOf("pdf")>=0?"Pdf":"OfficeLogo"}var L=n(1507),M=n(3444);function U(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return n=null,Object(M.i)()!==M.c.NotLoaded?[3,2]:[4,M.k.import()];case 1:return r.sent()(function(r){n=V(Object(M.g)(),e),t(n)}),[3,3];case 2:n=V(Object(M.g)(),e),t(n),r.label=3;case 3:return[2]}})})}function V(e,t){var n=function(e){for(var t=0;t<e.length;t++)if(0===e[t].type)return e[t].model.Id;return u.c.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:L.a.CloudSuggestion,name:t.FileName,size:null,providerId:n,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var B=n(183);Object(a.orchestrator)(A,function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i=this;return r.__generator(this,function(o){switch(o.label){case 0:t=e.item,n=e.attachment,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,U(n,function(e){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(n){return function(e,t){r.__awaiter(this,void 0,void 0,function(){var n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return t?[4,B.z.import()]:[3,5];case 1:return n=r.sent(),[4,B.j.import()];case 2:return a=r.sent(),(i=Object(B.d)(e.ConversationId.Id))?[3,4]:[4,n({referenceItemOrId:e,isReplyAll:!0,useFullCompose:!1,actionSource:null,instrumentationContexts:null,conversationId:e.ConversationId.Id,body:null})];case 3:i=r.sent(),r.label=4;case 4:a([t],i,{isInline:!1,isHiddenInline:!1,shouldShare:!0},null,null,null,null),r.label=5;case 5:return[2]}})})}(t,e),[2]})})})];case 2:return o.sent(),[3,4];case 3:return a=o.sent(),u.c.error("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+a.message),[3,4];case 4:return[2]}})})});var W="EntityExtraction/SmartReplyForEmail",J=n(576);var H=Object(a.action)("cacheSmartReplyDataAction",function(e,t,n,r,a){return{item:e,validPropertyExists:t,smartReplies:n,loggableSmartReplies:r,smartReplyExtractionID:a}}),q="2018-06-20T00:00:00.0000000Z",z="@extractionTimeUtc",G="@EntityId",Q=3;function K(e,t){var n=!1;if(e&&t)try{var r=JSON.parse(t.Value)[0],a=r[z];if(a)Date.parse(a)>=Date.parse(q)&&(n=function(e,t){for(var n=t[G],r=[],a=[],i=!1,o=t.entities.length,c=0;c<o;c++)r.push(t.entities[c].value),a.push(t.entities[c].valueRaw||t.entities[c].value);n&&r.length==Q?H(e,i=!0,r,a,n):u.c.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+Q+" but found "+r.length);return i}(e,r));else u.c.info("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.")}catch(e){u.c.info("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+e.message)}else u.c.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item or property found.");e&&!n&&H(e,n)}function $(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){if(e){if(e.SmartReplyData||(t=function(e,t){var n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var i=n[a];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(e,W),K(e,t)),e.SmartReplyData&&e.SmartReplyData.ExtractionID)return[2,e.SmartReplyData.SmartReplies.map(function(t,n){return function(e,t,n,r,a){var i=Object(N.b)("SmartReply",n);return i.mainPayload.EID=r,i.mainPayload.confidenceScore=a+1,{ariaLabel:"Suggested reply: "+t,featureName:"SmartReply",onClick:function(){J.h.importAndExecute(e.ItemId.Id,e.ConversationId.Id,t,1)},logData:i,index:a,text:t,toolTip:t,confidenceScore:i.mainPayload.confidenceScore}}(e,t,e.SmartReplyData.LoggableSmartReplies[n],e.SmartReplyData.ExtractionID,n)})]}else u.c.info("[getSmartRepliesForItem] No item, cannot produce smart replies.");return[2,[]]})})}var Y=n(7),Z=(Object(a.mutator)(H,function(e){var t={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},n=e.item,r=e.validPropertyExists,a=e.smartReplies,i=e.loggableSmartReplies,o=e.smartReplyExtractionID;if(r){t={SmartReplies:a,LoggableSmartReplies:i,ExtractionID:o,SuggestionAppropriatenessMap:new Y.ObservableMap,FeedbackSubmitted:!1};for(var u=0;u<a.length;u++){var c=String(u);t.SuggestionAppropriatenessMap.set(c,"")}}n.SmartReplyData=t}),n(454)),X=n(256),ee=n(12767);var te="EntityExtraction/Events1.0";var ne=n(6),re=n(156);var ae=n(4),ie=Object(a.action)("cacheSmartTimeExtendedPropertyAction",function(e,t,n){return{item:e,validPropertyExists:t,smartTimesExtendedProp:n}}),oe="@EntityId",ue="confidence";function ce(e,t){e?e.SmartTimeExtendedProperty||function(e,t){var n,a;if(!e)return void u.c.info("getSmartTimeForItem_cacheAndParseSmartTimeProperty] Message item is unavailable.");if(!t)return void u.c.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.");var i=null,o=!1;try{var c=JSON.parse(t.Value);if(c&&c.length>0){var s=c[0][oe],l=c[0][ue];try{for(var d=r.__values(c),f=d.next();!f.done;f=d.next()){var m=f.value;if(m.times&&m.times.length>0){var p=m.times[0],g=p.beginingOfTimeRange,b=p.endOfTimeRange;i={beginingOfTimeRange:g,endOfTimeRange:b,duration:p.duration,entityId:s,hasIntent:!0,confidenceScore:l},o=!0}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}}catch(e){u.c.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+e.message)}finally{ie(e,o,i)}}(e,t):u.c.info("[getSmartTimeForItem_parseSmartTimeProperty] No item or property found.")}var se=n(7089);function le(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,o,s,l,d,f;return r.__generator(this,function(r){switch(r.label){case 0:return t=[],e?(e.SmartTimeExtendedProperty||(n=function(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some(function(e){return e.ExtendedFieldURI.PropertyName==te&&(t=e,!0)})}return t}(e),ce(e,n)),(a=e.SmartTimeExtendedProperty)?(i=a.entityId,o=100*a.confidenceScore,s=null,l=null,Object(c.e)("mc-smartReplyWithMeeting-SuggestedTimeToCAS")&&(s=function(e){var t=null;if(e&&e.SmartTimeExtendedProperty){var n=Object(re.g)();try{var r=Object(ne.cc)(e.SmartTimeExtendedProperty.beginingOfTimeRange),a=Object(ne.cc)(e.SmartTimeExtendedProperty.endOfTimeRange);r>=n&&(t={startTime:r,endTime:a})}catch(e){u.c.error("[getSmartTimeSuggestion] Unable to parse suggested time. "+e)}}return t}(e))?[4,Object(se.a)(e,s)]:[3,2]):[3,3]):[3,4];case 1:r.sent(),l=Object(Z.b)().conversationReadingPaneViewState.calendarInlineComposeViewState,r.label=2;case 2:f=function(e,t,n,r){var a=Object(N.b)("SmartTime",Object(ae.a)(ee.a)),i=null!=r,o=n.ToRecipients?n.ToRecipients.length:0,u=n.CcRecipients?n.CcRecipients.length:0;a.mainPayload.EID=e,a.mainPayload.confidenceScore=t,a.mainPayload.hasSuggestedTime=i,a.mainPayload.NumToRecipient=o,a.mainPayload.NumCCRecipient=u,i&&(a.mainPayload.suggestedStartTime=r.startTime,a.mainPayload.suggestedEndTime=r.endTime);return a}(i,o,d=e,s),t.push(function(e,t,n,r,a,i){return{ariaLabel:"Suggested time: "+t,featureName:"SmartTime",onClick:n,index:e,logData:r,text:t,toolTip:t,icon:i,confidenceScore:r.mainPayload.confidenceScore}}(t.length,Object(ae.a)(ee.a),function(){X.j.importAndExecute(e.ItemId.Id,l,!1,null,i,d.InternetMessageId)},f,0,{iconName:"DateTime2"})),r.label=3;case 3:return[3,5];case 4:u.c.info("[getSmartTimesForItem] No item, cannot produce smart times."),r.label=5;case 5:return[2,t]}})})}Object(a.mutator)(ie,function(e){var t={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0},n=e.item,r=e.validPropertyExists,a=e.smartTimesExtendedProp;r&&a&&(t={beginingOfTimeRange:a.beginingOfTimeRange,endOfTimeRange:a.endOfTimeRange,duration:a.duration,entityId:a.entityId,hasIntent:!0,confidenceScore:a.confidenceScore}),n.SmartTimeExtendedProperty=t});var de=n(12768),fe=n(687),me=n(135);function pe(e,t,n,r){var a=Object(N.b)("SmartTodo",n);return a.mainPayload.confidenceScore=e.confidenceScore,a.mainPayload.EID=e.entityId,{ariaLabel:"Suggested todo: "+e.description,featureName:"SmartTodo",icon:{iconName:"ToDoLogoOutline"},onClick:function(){!function(e,t,n){if(Object(f.a)())return void fe.i.importAndExecute("SmartTask",e,t,n);if(Object(d.a)())me.k.importAndExecute(e,t,n)}(e.description,t,e.entityId)},logData:a,index:r,text:n,toolTip:n,confidenceScore:e.confidenceScore}}var ge=Object(a.action)("cacheSmartTaskData",function(e,t,n){return{item:e,validPropertyExists:t,smartTasks:n}}),be="@EntityId",he="@sourceConfidenceScore";function ve(e,t){var n=!1;if(e&&t)try{n=function(e,t){var n=JSON.parse(t.Value),r=!1;if(!t)return u.c.info("[getSmartTaskForItem_parseSmartTaskProperty] No smart task extended property found."),r;var a=[];if(n&&n.length>0)for(var i=n.length,o=0;o<i;o++){var c=n[o];a.push({entityId:c[be],description:c.description,confidenceScore:100*Number(c[he])})}a.length>0?ge(e,r=!0,a):u.c.info("[getSmartTasksForItem_extractAndCacheSmartTaskFromProperty] There are zero smart tasks for this item");return r}(e,t)}catch(e){u.c.info("[getSmartTasksForItem_parseSmartTaskProperty] Malformed property, cannot parse. Error: "+e.message)}else u.c.info("[getSmartTasksForItem_parseSmartTaskProperty] No item or property found.");e&&!n&&ge(e,!1)}var Se,ye="EntityExtraction/RequestForAction1.0";function Oe(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){if(e){if(e.SmartTaskData||(n=function(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some(function(e){return e.ExtendedFieldURI.PropertyName==ye&&(t=e,!0)})}return t}(e),ve(e,n)),e.SmartTaskData&&e.SmartTaskData.SmartTasks)return[2,e.SmartTaskData.SmartTasks.map(function(n,r){return t==Se.Todo&&e.ItemId?pe(n,e.ItemId.Id,Object(ae.a)(de.a),r):function(e,t,n,r,a){var i=Object(N.b)("SmartReminder",r);return i.mainPayload.confidenceScore=e.confidenceScore,i.mainPayload.EID=e.entityId,{ariaLabel:"Suggested reminder: "+e.description,featureName:"SmartReminder",icon:{iconName:"AddEvent"},onClick:function(){X.j.importAndExecute(t,null,!1,null,e.entityId,n,!0)},logData:i,index:a,text:r,toolTip:r,confidenceScore:e.confidenceScore}}(n,e.ItemId.Id,e.InternetMessageId,Object(ae.a)(de.b),r)})]}else u.c.info("[getSmartTodosOrRemindersForItem] No item, cannot produce smart tasks.");return[2,[]]})})}!function(e){e[e.Todo=0]="Todo",e[e.Reminder=1]="Reminder"}(Se||(Se={}));Object(a.mutator)(ge,function(e){var t={SmartTasks:null},n=e.item;if(e.validPropertyExists){var r=e.smartTasks;t.SmartTasks=r}n.SmartTaskData=t});function Pe(e){var t=[];return t.push(function(e){return{buildPills:function(){return le(e)}}}(e)),t.push(function(e){return{buildPills:function(){return C(e)}}}(e)),t.push(function(e){return{buildPills:function(){return $(e)}}}(e)),t.push(function(e){return{buildPills:function(){return Oe(e,Se.Todo)}}}(e)),Object(c.e)("mc-smartTaskWithReminder")&&t.push(function(e){return{buildPills:function(){return Oe(e,Se.Reminder)}}}(e)),t}var je=Object(a.action)("mergeItemPropertiesAction",function(e,t){return{oldItem:e,newItem:t}}),Te=Object(a.action)("updateItemLanguageAction",function(e){return{item:e}}),_e=n(223),we=n.n(_e),Ie=20,Re="Language",Ee="Locale",xe="LanguageScores",De="@EntityId",ke="EntityExtraction/ExtractLanguage1.0",Ae=we()({PropertyName:ke,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Ne=we()({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),Ce=we()({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),Fe=we()({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),Le=we()({PropertyName:"EntityExtraction/SubstrateSearchSuggestions",DistinguishedPropertySetId:"Common",PropertyType:"String"}),Me=we()({PropertyName:"EntityExtraction/ReplyWithQueryCoverage",DistinguishedPropertySetId:"Common",PropertyType:"String"});var Ue=n(904),Ve=n(903),Be=n(453),We=n.n(Be);function Je(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return(t=function(e){var t=[];return e.stampedLanguage||t.push(Ae),e.SmartReplyData||t.push(Ne),e.SmartTimeData||t.push(Ce),e.AttachmentSuggestions||t.push(Le,Me),e.SmartTaskData||t.push(Fe),t.filter(function(t){return!function(e,t){if(e){var n=e.ExtendedProperty;if(n)for(var r=0;r<n.length;r++)if(n[r].ExtendedFieldURI.PropertyName==t)return!0}return!1}(e,t.PropertyName)})}(e)).length>0?(n=We()({BaseShape:"IdOnly",AdditionalProperties:t}),[4,Object(Ue.a)([e.ItemId.Id],n,null,null,e.MailboxInfo&&e.MailboxInfo.requestOptions)]):[3,2];case 1:if(a=r.sent(),Object(Ve.a)(a[0])&&(i=a[0])&&i.Items&&i.Items[0])return[2,i.Items[0]];r.label=2;case 2:return[2,null]}})})}function He(e){var t=[];return t.push(function(e){var t=this;return{preRun:function(){return r.__awaiter(t,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Je(e)];case 1:return(t=n.sent())&&je(e,t),e.stampedLanguage||Te(e),[2]}})})}}}(e)),t}function qe(e){var t=this;return{updateLogData:function(n){return r.__awaiter(t,void 0,void 0,function(){var t,a,i;return r.__generator(this,function(r){return e&&(t=e.stampedLanguage&&e.stampedLanguage.language,a=e.stampedLanguage&&e.stampedLanguage.locale,i=e.InternetMessageId,n.forEach(function(e){e.logData.mainPayload.language=t,e.logData.mainPayload.locale=a,e.logData.cosmosOnlyData=i})),[2]})})}}}var ze=n(12769);function Ge(e,t){var n;t.UniqueBody?n=t.UniqueBody.Value:t.NormalizedBody&&(n=t.NormalizedBody.Value);var r={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:n}},a=e.some(function(e){return"SmartTime"===e.featureName});return e.some(function(e){return"SmartReply"===e.featureName})?(r.subtitle=Object(ae.a)(ze.f),r.dSATOptions=a?[{logString:"They aren't relevant",uiString:Object(ae.a)(ze.a)},{logString:"They don't sound like me",uiString:Object(ae.a)(ze.c)},{logString:"They're offensive or rude",uiString:Object(ae.a)(ze.d)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(ae.a)(ze.i)},{logString:"I don't want help scheduling a meeting",uiString:Object(ae.a)(ze.k)},{logString:"Other",uiString:Object(ae.a)(ze.e)}]:[{logString:"They aren't relevant",uiString:Object(ae.a)(ze.a)},{logString:"The meaning isn't clear",uiString:Object(ae.a)(ze.b)},{logString:"They don't sound like me",uiString:Object(ae.a)(ze.c)},{logString:"They're offensive or rude",uiString:Object(ae.a)(ze.d)},{logString:"Other",uiString:Object(ae.a)(ze.e)}]):a?(r.subtitle=Object(ae.a)(ze.l),r.dSATOptions=[{logString:"The meeting is already on my calendar",uiString:Object(ae.a)(ze.g)},{logString:"A meeting suggestion isn't relevant",uiString:Object(ae.a)(ze.h)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(ae.a)(ze.i)},{logString:"I want to schedule the meeting later",uiString:Object(ae.a)(ze.j)},{logString:"I don't want help scheduling a meeting",uiString:Object(ae.a)(ze.k)},{logString:"Other",uiString:Object(ae.a)(ze.e)}]):r.subtitle=Object(ae.a)(ze.f),r}var Qe=n(18),Ke=n(7700),$e=n(2),Ye=n(12770),Ze=function(e){function t(t){var n=e.call(this,t)||this,r=n.props.item;return n.smartPillBuilders=Pe(r),n.smartPillArbitrator=Object(c.e)("mc-smartReplyWithDoc")||Object(c.e)("mc-smartReplyWithCustomMeeting")||Object(c.e)("mc-smartTask")?P:g,n.smartPillPreRunners=He(r),n.smartPillLogDataUpdaters=function(e){return[qe(e)]}(r),n}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.runSmartPillBuilders()},t.prototype.componentWillUnmount=function(){this.smartPillBuilders=null,this.smartPillArbitrator=null,this.smartPillData=null,i(this.props.viewState,!1)},t.prototype.render=function(){var e=this.props,t=e.item,n=e.viewState.smartPillBlockVisible;if(!!t.RightsManagementLicenseData||!n||!this.smartPillData||0==this.smartPillData.pillsToShow.length&&0==this.smartPillData.pillsToHide.length)return null;var r=this.smartPillData.pillsToShow.length>0;return $e.createElement("div",{className:r?Ye.bar:void 0},$e.createElement(Ke.a,{arbitratedPills:this.smartPillData,enableFeedbackForm:!t.smartPillFeedbackSubmitted,feedbackData:Ge(this.smartPillData.pillsToShow,t)}))},t.prototype.runSmartPillBuilders=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return u.c.info("[MailSmartPillBlock] Running smart pill builders"),e=this,[4,Object(N.a)(this.smartPillBuilders,this.smartPillArbitrator,this.smartPillPreRunners,this.smartPillLogDataUpdaters,5e3)];case 1:return e.smartPillData=t.sent(),this.smartPillData&&this.smartPillData.pillsToShow&&i(this.props.viewState,!0),[2]}})})},t=r.__decorate([Qe.observer],t)}($e.Component);Object(a.mutator)(i,function(e){e.viewState.smartPillBlockVisible=e.smartPillBlockVisible}),Object(a.mutator)(o,function(e){e.item.smartPillFeedbackSubmitted=e.smartPillFeedbackSubmitted}),Object(a.mutator)(je,function(e){var t=e.oldItem,n=e.newItem;n.ExtendedProperty&&n.ExtendedProperty.length>0&&(t.ExtendedProperty=t.ExtendedProperty.concat(n.ExtendedProperty))});function Xe(e){var t=function(e){var t=e.ExtendedProperty;if(t){var n=t.filter(function(e){return e.ExtendedFieldURI.PropertyName===ke});if(n.length>0)return n[0]}return null}(e),n=void 0,r=void 0,a=0,i=void 0;try{if(t){var o=JSON.parse(t.Value)[0],c=o[Re],s=o[xe];i=o[De],r=Object.keys(s)[0],n=c&&c[Ee]&&c[Ee].toLowerCase(),a=parseInt(Object.values(s)[0])}}catch(e){u.c.info("[getStampedLanguage] Failed to parse property, error: "+e.message)}return{locale:n,language:r,confidenceScore:a,entityId:i}}var et=n(15);Object(a.mutator)(Te,function(e){var t=e.item;t.stampedLanguage=Xe(t),Object(c.e)("mc-logMessagesInSpanish")&&function(e,t,n,r){void 0===r&&(r=Ie),function(e,t){return e.UniqueBody&&e.UniqueBody.Value.length>t||e.NormalizedBody&&e.NormalizedBody.Value.length>t}(e,r)&&e.stampedLanguage.language.toLowerCase()===t.toLowerCase()&&Object(et.o)(n,{entityId:e.stampedLanguage.entityId,confidenceScore:e.stampedLanguage.confidenceScore},{isCore:!0})}(t,"spanish","SpanishLanguageMessage")});n.d(t,"MailSmartPillBlock",function(){return Ze})},1670:function(e,t,n){"use strict";var r=n(1),a=n(1323),i=n(71),o=n(5);Object(r.orchestrator)(a.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaToDo"):Object(i.c)(9)})},3386:function(e,t,n){"use strict";var r=n(1),a=n(7),i=n(3478),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},u=Object(r.createStore)("fileProviderStoreV2",o);t.a=u},3390:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return o});var r=n(1),a=Object(r.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),i=Object(r.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),o=Object(r.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},3414:function(e,t,n){"use strict";var r=n(0),a=n(3910),i=n.n(a),o=n(3631),u=n.n(o);function c(e){var t=u()({ProviderType:e});return i()(t)}var s=n(3911),l=n.n(s),d=n(3632),f=n.n(d);function m(e){var t=f()({ProviderType:e});return l()(t)}var p=n(3879),g=n(5);n.d(t,"a",function(){return j}),n.d(t,"b",function(){return w});var b="code",h="token",v=3e3,S=3;function y(e){return{state:e}}function O(e){return e.state}function P(e){return e.code}function j(e,t,n,a,i){var o={providerType:e,getAuthUrlInfo:null,getCSRFToken:O,getOAuthCode:P};return function e(t,n,a,i,o,u,s){return r.__awaiter(this,void 0,void 0,function(){var l,d;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),l=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,m(t)];case 1:return d=r.sent(),l=d.AttachmentDataProviderCreator.ProviderAppKey,a=d.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,c(t)];case 3:d=r.sent(),l=d.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(p.d)(t,a,i,l,o,u),[3,6];case 5:return r.sent(),s>0&&setTimeout(function(){return e(t,n,a,i,o,u,--s)},v),[3,6];case 6:return[2]}})})}(e,o,t,n,a,i,S),o}var T=null;function _(){if(!T){(T={})[3]=j(3,"https://app.box.com/api/oauth2/authorize",Object(p.c)(3),b,y),T[2]=j(2,"https://www.dropbox.com/oauth2/authorize",Object(p.b)(2),b,y);var e=j(6,"https://www.facebook.com/dialog/oauth",Object(p.b)(6),h,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=O,e.getOAuthCode=function(e){return e.access_token},T[6]=e;var t=j(5,"https://accounts.google.com/o/oauth2/auth",p.a+"/ADPRedirect.aspx",b,function(e){var t={state:e,provider:5..toString(),url:Object(p.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},T[5]=t,T[1]=j(1,"https://login.live.com/oauth20_authorize.srf",Object(p.c)(1),b,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(g.e)("doc-fileProvider-wopiClient")&&(T[7]=j(7,"",Object(p.c)(7),b,y),T[8]=j(8,"",Object(p.c)(8),b,y),T[9]=j(9,"",Object(p.c)(9),b,y))}return T}function w(e){var t=_();return e in t?t[e]:null}},3436:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(0),a=n(3386),i=function(){return r.__spread(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},3444:function(e,t,n){"use strict";var r=n(3581),a=n(3544),i=(n(3386),n(3390)),o=n(3449),u=(n(3855),n(3815),n(3436));var c=n(3516),s=n(3),l=n(3478),d=n(3414);n.d(t,"k",function(){return m}),n.d(t,"m",function(){return p}),n.d(t,"j",function(){return g}),n.d(t,"l",function(){return b}),n.d(t,"a",function(){return o.b}),n.d(t,"b",function(){return r.a}),n.d(t,"f",function(){return d.b}),n.d(t,"c",function(){return l.a}),n.d(t,"d",function(){return i.a}),n.d(t,"e",function(){return i.b}),n.d(t,"h",function(){return a.a}),n.d(t,"i",function(){return c.a}),n.d(t,"g",function(){return u.b}),n.d(t,"n",function(){return i.c});var f=new s.c(function(){return Promise.all([n.e(6),n.e(7),n.e(11),n.e(16),n.e(218)]).then(n.bind(null,13682))}),m=new s.b(f,function(e){return e.loadProviders}),p=new s.b(f,function(e){return e.removeFileProvider}),g=new s.b(f,function(e){return e.addFileProvider}),b=new s.b(f,function(e){return e.removeAndAddFileProvider})},3449:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o});var r,a=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(a.__spread(i,[0,4,10]))},346:function(e,t,n){"use strict";var r=n(3),a=n(24),i=n(1318),o=n(1321);function u(){var e=Object(i.a)();return e.cards?Object.keys(e.cards).filter(function(t){return e.cards[t].status===o.a.Unread}).length:0}n(817);var c=n(1298);n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return c.a});var s=new r.c(function(){return n.e(436).then(n.bind(null,13590))}),l=Object(r.d)(s,function(e){return e.WhatsNewContainer}),d=new r.b(s,function(e){return e.initializeWhatsNew});Object(a.c)(function(){d.import().then(function(e){return e()})})},3478:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},3516:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3386);function a(){return Object(r.a)().loadState}},3544:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(3909),a=n(3814),i=n(3889),o=n(4),u=n(91);function c(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:case 1:return Object(o.a)(i.a);case 2:case 9:return Object(o.a)(r.b);case 3:case 7:return Object(o.a)(r.a);case 5:return Object(o.a)(r.e);case 6:return Object(o.a)(r.d);case 4:return Object(o.a)(r.f);case 10:return Object(o.a)(a.b);case 8:return Object(o.a)(r.c);default:return Object(u.a)(e)}}},3581:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},3631:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},3632:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},3814:function(e){e.exports={a:"CSa",b:"DSa"}},3815:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(9),a=n(41),i=n(91),o=n(5);function u(e){var t=Object(r.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||Object(o.e)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(o.e)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},3855:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(3449),a="file provider is not addable";function i(e){return r.a.indexOf(e)>-1}},3879:function(e,t,n){"use strict";var r=n(38),a=n(13);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return s});var o=Object(a.B)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function u(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.n)()+"/mail/"+n+t}function c(e){var t=Object(r.n)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),u=i(t,"client_id",r);if(u=i(u,"redirect_uri",n),u=i(u,"response_type",a),o){var c=o(e);u=Object.keys(c).reduce(function(e,t){return i(e,t,c[t])},u)}return{authUrl:u,redirectUrl:n,csrfToken:e}}}},3889:function(e){e.exports={a:"NSa"}},3909:function(e){e.exports={b:"HSa",a:"ISa",e:"JSa",d:"KSa",f:"LSa",c:"MSa"}},3910:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),a=n(3631);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},3911:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),a=n(3632);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},408:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("TOGGLE_CHARM",function(e){return{charm:e}})},418:function(e){e.exports={c:"Yaa",f:"Zaa",e:"_aa",b:"$aa",g:"aba",a:"bba",d:"cba"}},4407:function(e,t,n){"use strict";var r=n(0),a=2500,i=n(11);function o(e,t,n,o,u){return r.__awaiter(this,void 0,void 0,function(){var c,s,l;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),n?[4,Promise.all(n.map(function(e){return e.preRun()}))]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,Promise.all(e.map(function(e){return Promise.race([e.buildPills(),(t=u||a,new Promise(function(e){setTimeout(e,t,[])}))]);var t}))];case 3:return c=r.sent(),s=[].concat.apply([],c),o?[4,Promise.all(o.map(function(e){return e.updateLogData(s)}))]:[3,5];case 4:r.sent(),r.label=5;case 5:return[2,t.arbitratePills(s)];case 6:return l=r.sent(),i.c.warn("[getPillsToRender] Please investigate error: "+l.message),[2,{pillsToShow:[],pillsToHide:[],arbitratorId:void 0}];case 7:return[2]}})})}function u(e,t){return{mainPayload:{renderStory:0,loggableText:t,type:e}}}var c=n(128),s=n(470);function l(e,t,n){var r=new s.a(e,t,{isCore:!0,isCosmosDatapoint:!0});n&&r.addCosmosOnlyData(n),c.g.importAndExecute(r)}function d(e,t,n){var r=void 0;e.concat(t).forEach(function(e){!r&&e.logData.cosmosOnlyData&&(r=e.logData.cosmosOnlyData)});var a={data:e.map(function(e){return e.logData.mainPayload})},i={data:t.map(function(e){return e.logData.mainPayload})};l("SmartPillsRendered",[e.length,t.length,JSON.stringify(a),JSON.stringify(i),n],r)}function f(e,t,n,r,a,i,o){l("SmartReply_Rendered",[e,!1,t.join("$"),!1,n.toString(),r.toString(),a,i],o)}function m(e){var t={data:[e.logData.mainPayload]};l("SmartPillClicked",[JSON.stringify(t)],e.logData.cosmosOnlyData)}function p(e,t,n,r,a,i,o){l("SmartReply_Clicked",[e,t,n,!1,r,a,i],o)}n(15);n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"f",function(){return f}),n.d(t,"c",function(){return m}),n.d(t,"d",function(){return p})},566:function(e,t,n){"use strict";n.d(t,"f",function(){return c}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"b",function(){return d});var r=n(803);n.d(t,"a",function(){return r.m}),n.d(t,"c",function(){return r.n}),n.d(t,"e",function(){return r.o});var a=n(3),i=n(1233);n.d(t,"i",function(){return i.b});var o=n(1251);n.d(t,"d",function(){return o.a});var u=new a.c(function(){return Promise.all([n.e(1),n.e(3),n.e(5),n.e(7),n.e(431)]).then(n.bind(null,2275))}),c=new a.a(u,function(e){return e.launchInAppFeedback}),s=new a.b(u,function(e){return e.postSuggestionAndSendLogDatapoint}),l=new a.b(u,function(e){return e.showUserVoiceSuggestionDialog}),d=Object(a.d)(u,function(e){return e.UserVoiceNps})},687:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return u}),n.d(t,"j",function(){return c}),n.d(t,"h",function(){return s}),n.d(t,"f",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"i",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"d",function(){return p});var r=n(3),a=new r.c(function(){return Promise.all([n.e(21),n.e(550),n.e(19),n.e(25),n.e(413)]).then(n.bind(null,2309))}),i=Object(r.d)(a,function(e){return e.TimePanel}),o=Object(r.d)(a,function(e){return e.TimePanelHeaderBar}),u=new r.a(a,function(e){return e.preloadTimePanelData}),c=new r.a(a,function(e){return e.openTimePanel}),s=new r.a(a,function(e){return e.openEventDetailsView}),l=new r.a(a,function(e){return e.openAttendeeTrackingView}),d=new r.a(a,function(e){return e.closeAttendeeTrackingView}),f=new r.a(a,function(e){return e.openTasksView}),m=new r.a(a,function(e){return e.openConflictsView}),p=new r.a(a,function(e){return e.closeConflictsView})},71:function(e,t,n){"use strict";var r=n(1),a=Object(r.action)("DEACTIVATE_CHARM",function(e){return{charm:e}}),i=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(a,function(e){var t=e.charm,n=i();n.activeCharm===t&&(n.activeCharm=null)});var o=n(408);Object(r.mutator)(o.a,function(e){var t=e.charm,n=i();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t});var u=n(1306),c=(Object(r.orchestrator)(u.a,function(){Object(o.a)(4)}),Object(r.action)("HIDE_QUICK_OPTIONS",function(){return{}})),s=(Object(r.orchestrator)(c,function(){a(4)}),n(566));Object(r.orchestrator)(s.d,function(){a(2)});function l(){return i().activeCharm}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return o.a})},7700:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3),a=new r.c(function(){return n.e(399).then(n.bind(null,9096))}),i=(Object(r.d)(a,function(e){return e.SmartPill}),Object(r.d)(a,function(e){return e.SmartPillBlock}))},803:function(e,t,n){"use strict";n.d(t,"g",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"j",function(){return d}),n.d(t,"h",function(){return f}),n.d(t,"c",function(){return m}),n.d(t,"i",function(){return p}),n.d(t,"k",function(){return g}),n.d(t,"f",function(){return b}),n.d(t,"m",function(){return h}),n.d(t,"n",function(){return v}),n.d(t,"o",function(){return S}),n.d(t,"p",function(){return y}),n.d(t,"q",function(){return O}),n.d(t,"l",function(){return P}),n.d(t,"e",function(){return j}),n.d(t,"d",function(){return T});var r=n(0),a=n(418),i=n(4),o=n(560),u=n.n(o),c="N/A",s="",l="CheckErrorDetails",d="React/Nps",f="UVNpsRating",m="UVFeedback",p="React/Feedback",g="Search_{0}",b="NoUserMessage",h="https://outlook.uservoice.com/forums/{0}",v=601444,S=907141,y=4,O=15;function P(){return[{name:"NoResults",label:Object(i.a)(a.c)},{name:"SlowResults",label:Object(i.a)(a.f)},{name:"ResultsNotRelevant",label:Object(i.a)(a.e)},{name:"ItemNotFound",label:Object(i.a)(a.b)},{name:"SuggestionsNotUseful",label:Object(i.a)(a.g)},{name:"ClientUXHardToUse",label:Object(i.a)(a.a)},{name:"Other",label:Object(i.a)(a.d)}]}function j(e){return e?"1":"2"}function T(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,u()()];case 1:return[2,(e=t.sent()).ConsumerSubscriptions?e.ConsumerSubscriptions.join(","):s]}})})}},817:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1),a=Object(r.action)("OPEN_QUICK_SETTINGS")},822:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(5),a=n(26),i=n(38);function o(){return(!Object(i.u)()||!window.opener)&&(Object(r.e)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}},830:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(5),a=n(26),i=n(38);function o(){return(!Object(i.u)()||!window.opener)&&(Object(r.e)("todo-panel")&&!Object(r.e)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}}},0,[21,550,19,25,413,3,34,79,330,6,7,11,16,218,1,5,517,66,259,4,291,494,135,486,98,10,303,70,110,498,167,499,171,108,299,317,399,403]]);
//# sourceMappingURL=owa.MailSmartPill.js.map
self.scriptsLoaded['owa.MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailSmartPill.js'] = (new Date()).getTime();