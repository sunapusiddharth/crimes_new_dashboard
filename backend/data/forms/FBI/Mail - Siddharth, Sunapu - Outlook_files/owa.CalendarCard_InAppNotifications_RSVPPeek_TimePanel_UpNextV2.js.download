self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[25],{1057:function(e,t,n){"use strict";n.d(t,"g",function(){return o}),n.d(t,"f",function(){return c}),n.d(t,"k",function(){return u}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"l",function(){return f}),n.d(t,"m",function(){return v}),n.d(t,"a",function(){return p}),n.d(t,"h",function(){return _}),n.d(t,"b",function(){return b}),n.d(t,"e",function(){return I}),n.d(t,"j",function(){return m}),n.d(t,"i",function(){return y}),n.d(t,"o",function(){return g});var r=n(93),a=n(48),i=n(6);function o(e,t){return void 0===t&&(t=Object(i.Jb)()),s(Object(i.Ub)(t,e),r.a.DaysInOneWeek)}function c(e,t){var n=u(e,t),r=Object(i.B)(e),a=Object(i.e)(Object(i.C)(r,t),1);return s(n,Math.abs(Object(i.s)(n,a)-1))}function u(e,t){var n=Object(i.Tb)(e);return Object(i.Ub)(n,t)}function s(e,t){return{start:e,end:Object(i.e)(e,t-1)}}function d(e,t,n,r){switch(e){case a.a.Day:return s(Object(i.Qb)(t),1);case a.a.Month:var c=Object(i.Tb)(t),u=Object(i.B)(t);return s(c,Math.abs(Object(i.s)(c,u)-1));case a.a.Week:return o(n,t);case a.a.WorkWeek:return function(e,t,n){void 0===n&&(n=Object(i.Jb)());for(var r,a,c=o(e,n),u=0;u<=m(c);u++){var s=Object(i.e)(c.start,u);if(!r&&t.includes(Object(i.jb)(s))&&(r=s),s=Object(i.e)(c.end,-u),!a&&t.includes(Object(i.jb)(s))&&(a=s),r&&a)break}return{start:r,end:a}}(n,r,t)}}function l(e,t){var n=c(e,t);return Object(i.t)(n.end,n.start,t)}function f(e,t){var n;return s(n=t==a.a.WorkWeek?Object(i.k)(e.start,1):Object(i.e)(e.end,1),t==a.a.Month?Object(i.kb)(n):Object(i.s)(e.end,e.start)+1)}function v(e,t){var n,r;if(t==a.a.WorkWeek)n=Object(i.k)(e.start,-1),r=Object(i.k)(e.end,-1);else{r=Object(i.e)(e.start,-1);var o=t==a.a.Month?-Object(i.kb)(r):Object(i.s)(e.start,e.end)-1;n=Object(i.e)(e.start,o)}return{start:n,end:r}}function p(e,t){return e&&t&&0==Object(i.p)(e.start,t.start)&&0==Object(i.p)(e.end,t.end)}function _(e,t,n){if(!e||!t)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return n?Object(i.p)(e.start,t.start)<=0?Object(i.p)(e.end,t.start)>=0?0:1:Object(i.p)(t.end,e.start)>=0?0:-1:Object(i.p)(e.start,t.start)<0?Object(i.p)(e.end,t.start)>0?0:1:Object(i.p)(t.end,e.start)>0?0:-1}function b(e,t,n){return!(!e||!t)&&(n?Object(i.p)(e.start,t.start)<=0&&Object(i.p)(e.end,t.end)>=0:Object(i.p)(e.start,t.start)<0&&Object(i.p)(e.end,t.end)>0)}function I(e,t){return e&&t?{start:Object(i.p)(e.start,t.start)<0?e.start:t.start,end:Object(i.p)(e.end,t.end)>0?e.end:t.end}:null}function m(e){return Object(i.s)(e.end,e.start)}function y(e){return Math.floor(Object(i.v)(e.end,e.start)/24)+(Object(i.v)(e.end,e.start)%24>0?1:0)}function g(e,t){return Object(i.s)(e.start,t)<=0&&Object(i.s)(e.end,t)>=0}},1067:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(6),a=n(750);function i(e,t,n,i){var o=Object(a.a)(t,n,i);return Object(r.zb)(e,o)&&(o=Object(r.Kb)(t,e)),{start:e,end:o}}},1102:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"i",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return d}),n.d(t,"d",function(){return l}),n.d(t,"h",function(){return f});var r=n(484);function a(e){return e?l(e)?r.e:f(e)?r.A:s(e)?r.r:c(e)?r.a:d(e)?r.t:u(e)?r.c:r.p:r.p}function i(e){return c(e)||s(e)}function o(e){return u(e)||d(e)}function c(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.b}function u(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.d}function s(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.s}function d(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.u}function l(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.f}function f(e){return e&&e.RecurrencePattern&&e.RecurrencePattern.__type==r.B}},1221:function(e,t,n){"use strict";var r=n(861);n(1861);function a(e){var t=[];return e&&"string"!=typeof e&&t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),t}var i=n(9),o=n(66),c="en-us",u={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var s=", ";function d(e,t,n,r,a,i){var c=[];Object(o.b)(e)||(c[c.length]=e);var u="";return Object(o.b)(t)||(u=t),Object(o.b)(n)||(u=Object(o.b)(u)?n:u+i+n),Object(o.b)(r)||(u=Object(o.b)(u)?r:u+i+r),Object(o.b)(u)||(c[c.length]=u),Object(o.b)(a)||(c[c.length]=a),c}function l(e,t,n,r,a){var l=function(){var e=Object(i.a)(),t="";e&&e.SessionSettings&&!Object(o.b)(e.SessionSettings.UserCulture)&&(t=e.SessionSettings.UserCulture.toLowerCase());var n=u[t];return null==n&&(n=u[c]),n}(),f=[],v=s;switch(l){case"a_c_pc_pr_ctry":f=d(e,t,n,r,a,v);break;case"a_c_pr_ctry_pc":f=d(e,t,r,a,n,v);break;case"a_c_pr_pc_ctry":f=d(e,t,r,n,a,v);break;case"a_ctry_c_pr_pc":f=d(e,a,t,r,n,v);break;case"a_pc_c_pr_ctry":f=d(e,n,t,r,a,v);break;case"a_pc_pr_c_ctry":f=d(e,n,r,t,a,v);break;case"c_a_pc_pr_ctry":f=d(t,e,n,r,a,v);break;case"ctry_pc_pr_c_a":f=d(a,n,r,t,e,v);break;case"ctry_pr_c_pc_a":f=d(a,r,t,n,e,v);break;case"pc_ctry_pr_c_a":f=d(n,a,r,t,e,v);break;case"pc_pr_c_a_ctry":f=d(n,r,t,e,a,v)}return f.join(v)}function f(e){return e?l(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function v(e,t){return Object(o.b)(e)?f(t):e}var p=n(4);function _(e,t){var n=f(t);return Object(o.b)(e)?n:""==n?e:Object(p.b)("{0} ({1})",e,f(t))}var b=/\(([^)]*)\)/gi,I=/\([^)]*\)|[\0-\u001F\!-\/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,m=/\s+/gi;function y(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(b,"")).replace(I,"")).replace(m," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!=n.length&&(t+=n[0].charAt(0).toUpperCase()),t}var g=n(14),h=Object.keys(g.a).length/2;function O(e){if(!e)return null;for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),a=n%8;t^=(r<<a)+(r>>8-a)}return t%h}function E(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:y(e),textBoyColor:O(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}function j(e){if(e){var t=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),n=v(e.DisplayName,t);return"Room"==e.PersonaTypeString&&(t.LocationUri=e.EmailAddress.EmailAddress),{personaId:e.PersonaId&&e.PersonaId.Id,feedbackId:e.FeedbackId,displayName:n,postalAddress:t,emailAddress:e.EmailAddress,displayAddress:f(t),initials:y(n),textBoyColor:O(n),selectionSource:"LocationWell",personaType:Object(o.b)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity}}return null}var R=n(725);function T(e){if(e&&e.DisplayName&&e.PostalAddress){var t=v(e.DisplayName,e.PostalAddress),n=Object(R.a)(e.PostalAddress)&&!Object(o.b)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:n,displayAddress:f(e.PostalAddress),initials:y(t),textBoyColor:O(t),personaType:Object(R.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var C=n(0),A=n(2);function S(e,t,n,r){var a=Object(i.a)(),c="",u="",s="";return null!=a&&null!=a.ApplicationSettings&&null!=a.SessionSettings&&null!=a.PolicySettings&&a.PolicySettings.PlacesEnabled&&(c=a.ApplicationSettings.StaticMapUrl,u=a.ApplicationSettings.MapControlKey,s=a.SessionSettings.UserCulture),Object(o.b)(c)||Object(o.b)(u)||Object(o.b)(s)||!e||!t?"":Object(p.b)(c+"?centerPoint={0},{1}&pp={0},{1};51&ms={2},{3}&fmt=png&key={4}&c={5}",e,t,n,r,u,s)}var F=100,k=64,N=64;var D=n(18),w=n(2200),P=n(11),x=n(197),M=function(e){function t(t){var n=e.call(this,t)||this;return n.onCompleteDownload=function(e){n.setState({blobUrl:e}),e?n.requestStatus="success":(n.requestStatus="failed",P.c.warn("getLocationPhoto.downloadLocationPhoto failed"))},n.state={blobUrl:null},n}return C.__extends(t,e),t.prototype.componentDidMount=function(){this.fetchPersonaPhoto(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.fetchPersonaPhoto(e)},t.prototype.fetchPersonaPhoto=function(e){e.locationPersona.postalAddress&&e.locationPersona.postalAddress.Latitude&&e.locationPersona.postalAddress.Longitude&&!Object(o.b)(e.locationPersona.displayName)&&!this.state.blobUrl&&"pending"!=this.requestStatus&&"failed"!=this.requestStatus&&(this.requestStatus="pending",function(e,t){var n="";if(e.postalAddress&&e.postalAddress.Latitude&&e.postalAddress.Longitude&&(n=S(e.postalAddress.Latitude,e.postalAddress.Longitude,k,N)),Object(o.b)(n))t(null);else{var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="blob",r.onreadystatechange=function(){if(4===r.readyState){var e=null,n=!1;if(200===r.status){e=r.response;var a=r.getResponseHeader("Content-Type");n=a&&0==a.toLowerCase().indexOf("image")&&e instanceof Blob}var i=void 0;n&&e&&e.size>F&&(i=URL.createObjectURL(e)),t(i)}},r.send()}}(e.locationPersona,this.onCompleteDownload))},t.prototype.render=function(){var e=this.props,t=e.locationPersona,n=e.className,r=e.size,a=e.showPersonaDetails;if(t){var i={};return Object(o.b)(this.state.blobUrl)?x(i,{imageInitials:t.initials,initialsColor:t.textBoyColor}):x(i,{imageUrl:this.state.blobUrl,imageShouldFadeIn:!1}),A.createElement(w.a,C.__assign({className:n,presence:g.b.none,hidePersonaDetails:!a,size:r,text:t.displayName,secondaryText:t.displayAddress},i))}return null},t=C.__decorate([D.observer],t)}(A.Component),L="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}",U="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}";function K(e,t,n,r){return e&&t?Object(p.b)(L,e.toString(),t.toString(),n,r):n?Object(p.b)(U,n,r):null}var B=n(1432),V=n(95),q=n(461);function z(e){var t=e&&e.accessibleText&&e.accessibleText.msColorWhiteBackground||Object(V.g)().themePrimary,n=e?e.calDarker:Object(V.g)().themeDarker;return Object(q.a)({color:t,cursor:"pointer",selectors:{"&:hover":{color:n},"&:focus":{color:n}}})}var H=n(3);function W(e,t){return{Id:t,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:t,Type:"Business"}}}function G(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function J(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function Z(e,t,n,r){return e?{PostalAddress:{LocationUri:n,LocationSource:r,Type:t,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}function Q(e){return!Object(B.a)(e.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&\/\/=]*)/i.test(e.DisplayName)}function Y(e){return function(){var t=/^http*/i.test(e)?e:"//"+e;window.open(t,"_blank")}}n.d(t,"v",function(){return $}),n.d(t,"p",function(){return _}),n.d(t,"n",function(){return f}),n.d(t,"o",function(){return l}),n.d(t,"l",function(){return E}),n.d(t,"k",function(){return j}),n.d(t,"j",function(){return T}),n.d(t,"a",function(){return M}),n.d(t,"m",function(){return K}),n.d(t,"b",function(){return S}),n.d(t,"s",function(){return B.a}),n.d(t,"t",function(){return R.a}),n.d(t,"q",function(){return z}),n.d(t,"f",function(){return W}),n.d(t,"c",function(){return r.a}),n.d(t,"d",function(){return r.b}),n.d(t,"e",function(){return r.c}),n.d(t,"r",function(){return G}),n.d(t,"g",function(){return J}),n.d(t,"i",function(){return a}),n.d(t,"h",function(){return Z}),n.d(t,"w",function(){return Y}),n.d(t,"u",function(){return Q});var X=new H.c(function(){return n.e(824).then(n.bind(null,13916))}),$=new H.b(X,function(e){return e.createTxpPostalAddressFromLocationPersona})},1291:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3),a=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(11),n.e(16),n.e(230)]).then(n.bind(null,2954))}),i=new r.b(a,function(e){return e.logServiceCallForDiagnostics})},1319:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i});var r="cal-txp-invoice",a="cal-txp-serviceReservation",i="cal-txp-serviceReservationAdaptive"},140:function(e,t,n){"use strict";var r=n(1889),a=n(50);function i(e){return!(!e.EffectiveRights||!e.EffectiveRights.Modify||Object(a.I)(e.ParentFolderId.Id)||q(e)||C(e)&&"Private"==e.Sensitivity)}var o=function(e){return B(e)&&i(e)&&!e.IsCancelled},c=n(42),u=function(e){return e&&e.ParentFolderId&&e.ParentFolderId.mailboxInfo&&e.ParentFolderId.mailboxInfo.type==c.a.GroupMailbox};function s(e,t){if(!e)return!1;var n=!u(e),r=function(t){return t?n?t.filter(function(t){return!e.Organizer||t.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress}):t:[]},a=r(e.RequiredAttendees).length,i=r(e.OptionalAttendees).length;return t?a+i>0:a+i+r(e.Resources).length>0}function d(e){return e.IsDraft?s(e):e.IsMeeting||s(e)}var l=function(e){return!d(e)&&!e.IsOrganizer&&i(e)&&!e.IsCancelled},f=function(e){return!(!e.IsOrganizer||d(e)&&e.MeetingRequestWasSent||!i(e))},v=n(26),p=n(483);function _(e){var t=Object(a.r)(e.ParentFolderId.Id),n=Object(p.b)(e);return i(e)&&d(e)&&!([3,6,7].includes(t.CalendarFolderType)||n.IsMeetingPollEvent)}function b(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&i(e))}var I=function(e){return f(e)||o(e)||l(e)};function m(e){return!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&i(e)}function y(e){return 0==Object(v.f)().SessionSettings.WebSessionType&&m(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||O(e))}function g(e){return!e.IsOrganizer&&e.IsCancelled&&i(e)}function h(e){return!Object(r.a)(e.EntityNamesMap)&&e.IsOrganizer&&i(e)}function O(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function E(e){return"RecurringMaster"===e.CalendarItemType}function j(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function R(e){return u(e)&&!e.IsCancelled}var T=n(730);function C(e){if(e){var t=Object(a.r)(e.ParentFolderId.Id);if(t)return t.IsSharedWithMe||Object(T.b)(t)}return!1}var A=n(5);function S(e){return Object(A.e)("cal-recurrenceThisDateForward")&&(u(e)?Object(A.e)("cal-groupNotifications"):!C(e))}var F=function(e){var t=Object(a.r)(e.ParentFolderId.Id).CalendarFolderType;return(q(e)||i(e))&&(0==t||1==t||3==t||5==t)};function k(e){return e.IsMeeting}var N=function(e){if(!e)return!1;var t=e.ParentFolderId.mailboxInfo.deprecatedMailboxId;return D(e.RequiredAttendees,t)||D(e.OptionalAttendees,t)};function D(e,t){return e&&e.some(function(e){return e.Mailbox.EmailAddress.toLowerCase()==t})}var w=n(1219);function P(e){if(!e)return!1;var t=!1;return e.forEach(function(e){Object(w.a)(e.Mailbox.EmailAddress)||(t=!0)}),t}function x(e){return!(!e.EffectiveRights||!e.EffectiveRights.Read)}function M(e){if(!e)return!1;var t=Object(a.r)(e.ParentFolderId.Id);return t&&3==t.CalendarFolderType}function L(e){return"Exception"===e}function U(e){return"Occurrence"===e}function K(e){return U(e.CalendarItemType)||L(e.CalendarItemType)}function B(e){return e&&e.IsMeeting&&!e.IsOrganizer}function V(e){return e.IsMeeting&&e.IsOrganizer}function q(e){if(e&&e.ItemId&&e.ItemId.Id){var t=e.ClientSeriesId;return t&&(e.IsRecurring?t==e.InstanceKey:t==e.ItemId.Id)}return!0}function z(e){return q(e)&&d(e)}var H=n(6);function W(e,t){return e&&t&&!q(e)&&Object(H.Cb)(t.Start,e.Start)&&Object(H.Cb)(t.End,e.End)&&t.IsAllDayEvent==e.IsAllDayEvent}function G(e){return"RecurringMaster"===e}function J(e){return!(!e.IsMeeting||!e.IsOrganizer||!e.IsDraft&&e.MeetingRequestWasSent)}n.d(t,"j",function(){return _}),n.d(t,"c",function(){return b}),n.d(t,"d",function(){return I}),n.d(t,"o",function(){return m}),n.d(t,"l",function(){return y}),n.d(t,"m",function(){return g}),n.d(t,"h",function(){return h}),n.d(t,"H",function(){return O}),n.d(t,"I",function(){return E}),n.d(t,"x",function(){return j}),n.d(t,"b",function(){return R}),n.d(t,"a",function(){return S}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"i",function(){return F}),n.d(t,"k",function(){return i}),n.d(t,"n",function(){return k}),n.d(t,"p",function(){return s}),n.d(t,"q",function(){return N}),n.d(t,"r",function(){return P}),n.d(t,"s",function(){return x}),n.d(t,"t",function(){return M}),n.d(t,"u",function(){return d}),n.d(t,"v",function(){return K}),n.d(t,"w",function(){return L}),n.d(t,"y",function(){return B}),n.d(t,"z",function(){return C}),n.d(t,"A",function(){return V}),n.d(t,"B",function(){return q}),n.d(t,"C",function(){return z}),n.d(t,"D",function(){return U}),n.d(t,"E",function(){return u}),n.d(t,"F",function(){return W}),n.d(t,"G",function(){return G}),n.d(t,"J",function(){return J})},1432:function(e,t,n){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}n.d(t,"a",function(){return r})},1455:function(e){e.exports={a:"$ea"}},1458:function(e,t,n){"use strict";var r;!function(e){e[e.EventSharingFromCalendar=0]="EventSharingFromCalendar",e[e.EventSharingFromMail=1]="EventSharingFromMail",e[e.EmailReminder=2]="EmailReminder"}(r||(r={})),t.a=r},1463:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(575);function a(e,t,n){return Object(r.a)(e,t)==t&&n}},1467:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(1463),a=n(287),i=n(5),o=n(1319);function c(e){return Object(r.a)(e,a.d,Object(i.e)(o.a))}},1468:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(1463),a=n(287),i=n(5),o=n(1319);function c(e){return Object(r.a)(e,a.h,Object(i.e)(o.c)&&!Object(i.e)(o.b))}},1473:function(e,t,n){"use strict";function r(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,TxpObject:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,MeetingNotesWebUrl:void 0}}n.d(t,"a",function(){return r})},1491:function(e){e.exports={c:"uLb",a:"vLb",b:"wLb"}},151:function(e,t,n){"use strict";var r=n(0),a=n(64);function i(e,t){for(var n={start:e.Start,end:e.End},r=0;r<t.length;r++)if(0===Object(a.j)(t[r],n,!0))return!0;return!1}function o(e,t,n){var o=n.dateRangesToRetain,c=n.eventsToRetain;return function(e,t,n){for(var a=t.dateRangesToRetain,o=t.eventsToRetain,c=n.startIndex,u=n.endIndex,s=[{startIndex:c,removeCount:0,finished:!1}],d=0,l=c;l>=0&&l<=u&&l<=e.length;l++){var f=e[l];o[f.Key]||i(f,a)?s[d].finished=!0:s[d].finished?(s.push({startIndex:l,removeCount:1,finished:!1}),d+=1):s[d].removeCount+=1}var v=[];return s.filter(function(e){return 0!==e.removeCount}).reverse().forEach(function(t){var n=e.splice(t.startIndex,t.removeCount);v.push.apply(v,r.__spread(n.reverse()))}),v.reverse()}(t,{dateRangesToRetain:o.filter(function(t){return 0===Object(a.j)(t,e,!0)}),eventsToRetain:c},function(e,t){for(var n={startIndex:-1,endIndex:-1},r=0;r<e.length;r++){var i=Object(a.j)({start:e[r].Start,end:e[r].End},t,!0);if(0===i&&-1===n.startIndex)n.startIndex=r;else if(0!==i&&-1!==n.startIndex){n.endIndex=r-1;break}}return-1!==n.startIndex&&-1===n.endIndex&&(n.endIndex=e.length-1),n}(t,e))}function c(e,t,n){e=r.__spread(e);for(var a=[],i=t.length-1;i>=0&&e.length>0;i--){var o=t[i],c=e.indexOf(o.Key);if(-1!==c&&u(o,n)){var s=t.splice(i,1);a.push.apply(a,r.__spread(s)),e.splice(c,1)}else-1!==c&&e.splice(c,1)}return a.reverse()}function u(e,t){var n=t.dateRangesToRetain,r=t.eventsToRetain;return!i(e,n)&&!r[e.Key]}function s(e,t){t.locksInfo.get(e)||t.locksInfo.set(e,{lockedDateRange:null,lockedEvents:{}})}function d(e){return void 0===e&&(e=function(){return!0}),function(t,n){var a=r.__read(n,2),i=a[0],o=a[1];return e([i,o])&&Object.keys(o.lockedEvents).forEach(function(e){return t[e]=!0}),t}}function l(e){return void 0===e&&(e=function(){return!0}),function(t,n){var a=r.__read(n,2),i=a[0],o=a[1];return e([i,o])&&o.lockedDateRange&&t.push(o.lockedDateRange),t}}var f,v=function(e){return function(t){return r.__read(t,1)[0]!==e}};function p(e,t,n){s(t,n);var a=n.locksInfo.get(t),i=a.lockedDateRange,u=a.lockedEvents,p=r.__spread(n.locksInfo.entries()).reduce(l(e!==f.EventIds?v(t):function(){return!0}),[]),_=r.__spread(n.locksInfo.entries()).reduce(d(e!==f.DateRange?v(t):function(){return!0}),{});!i||e!==f.All&&e!==f.DateRange||(o(i,n.events,{dateRangesToRetain:p,eventsToRetain:_}),a.lockedDateRange=null);var b=Object.keys(u);b.length>0&&(e===f.All||e===f.EventIds)&&(c(b,n.events,{dateRangesToRetain:p,eventsToRetain:_}),a.lockedEvents={})}!function(e){e[e.All=0]="All",e[e.DateRange=1]="DateRange",e[e.EventIds=2]="EventIds"}(f||(f={}));var _=n(6);var b=n(197);function I(e,t,n){void 0===n&&(n=!1);t.Key;var a,i=r.__rest(t,["Key"]),o=n?i:(a=i,Object.keys(a).reduce(function(e,t){return void 0!==a[t]&&(e[t]=a[t]),e},{}));b(e,o)}var m=function(e){setTimeout(function(){h.import().then(function(t){return t(e)})},0)},y=n(3),g=new y.c(function(){return Promise.all([n.e(6),n.e(7),n.e(11),n.e(16),n.e(136)]).then(n.bind(null,13684))}),h=new y.b(g,function(e){return e.logCacheUpdateForDiagnostics});function O(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=!1),e=function(e,t,n){for(var r=function(e){return e.reduce(function(e,t,n){return e[t.Key]=n,e},{})}(t),a=[],i=[],o=0;o<e.length;o++){var c=e[o],u=r[c.Key];if(void 0!==u){var s=t[u];I(s,c,n),i.push(u),a.push(s)}else a.push(c)}return(d=i,l=d.reduce(function(e,t){return e[t]=t,e},{}),Object.keys(l).map(function(e){return l[e]})).sort(function(e,t){return t-e}).forEach(function(e){return t.splice(e,1)}),{newEventsToAdd:a};var d,l}(e,t,a).newEventsToAdd;for(var i=[{startIndex:-1,eventsToAdd:[],finished:!1}],o=n,c=0;o<t.length&&c<e.length;){var u=t[o],s=e[c],d=Object(_.p)(s.Start,u.Start),l=-1===d,f=1===d;0===d?(E(s,o,i),c++):l?(E(s,o,i),c++):f&&(i[i.length-1].finished=!0,o++)}if(c<e.length){var v=e.slice(c,e.length);i.push({startIndex:t.length,eventsToAdd:v,finished:!0})}i.filter(function(e){return 0!==e.eventsToAdd.length}).reverse().forEach(function(e){return t.splice.apply(t,r.__spread([e.startIndex,0],e.eventsToAdd))});var p=r.__spread(e);return function(e){e.sort(function(e,t){return Object(_.p)(e.Start,t.Start)})}(p),m({lockId:"",updateMessage:"Upserted "+p.length+" items in the cache"}),p}function E(e,t,n){var r=n[n.length-1];if(-1===r.startIndex)r.startIndex=t,r.eventsToAdd.push(e);else if(r.finished){var a={startIndex:t,eventsToAdd:[e],finished:!1};n.push(a)}else r.eventsToAdd.push(e)}var j=function(e,t){return Object(_.p)(e.Start,t.Start)};function R(e,t,n,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1),s(t,n);var o=n.events;if(a){var c=function(e,t){for(var n=null,r=0;r<t.length;r++)if(t[r].Key===e){n=t[r];break}return n?{event:n,index:r}:{event:null,index:-1}}(e.Key,o);c.event&&(o.splice(c.index,1),I(c.event,e,i),e=c.event)}var u=function(e,t,n){for(var r=0,a=0,i=t?t.length-1:0;a<=i;){var o=n(e,t[r=Math.floor((a+i)/2)]);if(0==o)return r;if(o<0){if(i=r-1,r<=a)return Math.max(a,i)}else if(a=r+1,r>=i)return a}return r}(e,o,j),d=u>=0?u:0,l=r.__read(O([e],o,d,i),1)[0];return n.locksInfo.get(t).lockedEvents[e.Key]=!0,m({lockId:t,updateMessage:"Event with startTime "+l.Start+" added to the lock"}),l}var T=n(11);function C(e,t,n,r){s(n,r);var i,o,c=r.locksInfo.get(n).lockedDateRange,u=c?c.start+" - "+c.end:"null";c&&(i=c,o=e,0==Object(a.j)(i,o,!0)||function(e,t){return 1==(Object(_.p)(e.start,t.start)<0?Object(_.w)(t.start,e.end):Object(_.w)(e.start,t.end))}(i,o))&&!Object(a.c)(e,c,!0)?Object(a.c)(c,e,!0)?T.c.info("[addEventsForLock]: Date range in lock "+n+" already contains the range to be added."):c=Object(a.f)(c,e):(T.c.info('[addEventsForLock] Replacing all items in cache for lock "'+n+'". Date range: '+e.start+" - "+e.end),p(f.DateRange,n,r),c=e);var d=O(t,r.events);return r.locksInfo.get(n).lockedDateRange=c,T.c.info('[addEvents] New range in cache for lock "'+n+'": '+c.start+" - "+c.end),m({lockId:n,updateMessage:d.length+" events added to the lock. Previous locked daterange: "+u+". New locked daterange: "+c.start+" - "+c.end}),d}function A(e,t,n){s(t,n);var i=n.locksInfo.get(t),c=i.lockedDateRange;if(c&&!Object(a.c)(e,i.lockedDateRange,!0)){m({lockId:t,updateMessage:"Now evicting events in cache except for events in date range "+e.start+" - "+e.end+". Current locked cache range: "+c.start+" - "+c.end});var u=r.__spread(n.locksInfo.entries()).reduce(l(v(t)),[e]),f=r.__spread(n.locksInfo.entries()).reduce(d(),{}),p=o(c,n.events,{dateRangesToRetain:u,eventsToRetain:f});T.c.info("[owa-events-cache:evictEventsExceptInDateRangeForLock] Evicted "+p.length+" events for lock '"+t+"'"),Object(a.c)(c,e,!0)?i.lockedDateRange=r.__assign({},e):i.lockedDateRange=function(e,t){var n=-1===Object(_.p)(e.start,t.start),r=1===Object(_.p)(e.end,t.end),a=e.start,i=e.end;n&&(a=t.start);r&&(i=t.end);return{start:a,end:i}}(e,c),m({lockId:t,updateMessage:"Evicted "+p.length+" events for lock. New locked cache range: "+c.start+" - "+c.end})}}function S(e,t){for(var n=t.events,a=0,i=[],o=n.length-1;o>=0;o--){var c=n[o];e(c)&&(i.push(c),n.splice(o,1),a++)}return function(e,t){r.__spread(t.locksInfo.keys()).forEach(function(n){var r=t.locksInfo.get(n);e.forEach(function(e){return delete r.lockedEvents[e.Key]})})}(i,t),m({lockId:"",updateMessage:"Unloaded "+a+" items from cache"}),i.reverse()}function F(e,t){var n,i,o=[];try{for(var c=r.__values(t),u=c.next();!u.done;u=c.next()){var s=u.value,d={start:s.Start,end:s.End},l=Object(a.j)(e,d,!0);if(0===l)o.push(s);else if(l>0)break}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return o}var k=n(19);function N(e,t,n){var r=n.locksInfo.get(t)||{},i=r.lockedDateRange,o=void 0===i?null:i,c=r.lockedEvents,u=void 0===c?[]:c;return null===o&&0===Object.keys(u).length?e.map(function(e){return null}):function(e,t,n){for(var r=n.locksInfo.get(t),i=r.lockedDateRange,o=r.lockedEvents,c=e.reduce(function(e,t){return e[t]=!0,e},{}),u={},s=0,d=0;d<n.events.length&&s<e.length;d++){var l=n.events[d],f={start:l.Start,end:l.End},v=!!i&&0===Object(a.j)(i,f,!0);c[l.Key]&&(v||o[l.Key])&&(u[l.Key]=l,s++)}return e.map(function(e){return u[e]||null})}(e,t,n)}var D=0;var w=n(7);function P(){return{events:[],locksInfo:new w.ObservableMap}}var x=n(1),M={calendarFolderEvents:new w.ObservableMap,fullItemsMruMap:new w.ObservableMap},L=Object(x.createStore)("calendarEventsStore",M);function U(e,t){var n=L().calendarFolderEvents.get(e);return n?n.events.filter(t):[]}function K(e,t){return void 0===t&&(t=null),t?r.__read(U(t,function(t){return t.ItemId.Id===e}),1)[0]||null:q(function(t){return t.ItemId.Id===e})}function B(e,t){return void 0===t&&(t=null),t?r.__read(U(t,function(t){return t.Key===e}),1)[0]||null:q(function(t){return t.Key===e})}function V(e,t,n){var a=null;return a=e?function(e,t,n){var a=L().calendarFolderEvents.get(e);if(a){var i=r.__read(N([t],n,a),1),o=i[0];return o||null}return null}(e,t,n):function(e,t){for(var n=L(),a=r.__spread(n.calendarFolderEvents.keys()),i=0;i<a.length;i++){var o=a[i],c=n.calendarFolderEvents.get(o),u=r.__read(c?N([e],t,c):[null],1),s=u[0];if(s)return s}return null}(t,n),m({lockId:n,updateMessage:"Got "+(a?"1":"no")+" item from the cache for given folder and key"}),a}function q(e){for(var t=L(),n=r.__spread(t.calendarFolderEvents.keys()),a=0;a<n.length;a++){var i=n[a],o=t.calendarFolderEvents.get(i),c=r.__read(o?o.events.filter(e):[null],1)[0];if(c)return c}return null}function z(e){var t=H(e);return t?r.__spread(t.locksInfo.entries()).reduce(l(),[]):[]}function H(e){return L().calendarFolderEvents.get(e)||null}function W(e){var t=H(e);return t?r.__spread(t.events):[]}function G(e){return!!H(e)}function J(e,t){var n=[],r=[];return e.forEach(function(e){var i={start:e.Start,end:e.End};t.some(function(e){return 0===Object(a.j)(e,i,!0)})?n.push(e):r.push(e)}),{eventsOverlapping:n,eventsNotOverlapping:r}}var Z=Object(x.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",function(e,t,n,r){return{lockId:e,folderId:t,eventKey:n,partialCalendarEvent:r}}),Q=Object(x.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",function(e,t,n){return{lockId:e,folderId:t,eventKey:n}}),Y=Object(x.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",function(e,t,n,r,a,i){return{lockId:e,folderId:t,eventKey:n,event:r,eventScope:a,forceOverrideAllPropertiesForEventIfAvailable:i}}),X=Object(x.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",function(e,t,n){return{folderId:e,eventKey:t,event:n}}),$=Object(x.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",function(e){return{partialCalendarEvent:e}}),ee=Object(x.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",function(e){return{partialCalendarEvent:e}}),te=Object(x.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",function(e,t){return{folderId:e,eventKey:t}}),ne=Object(x.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",function(e){return{folderId:e}}),re=Object(x.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",function(e,t,n){return void 0===n&&(n=!1),{folderId:e,calendarEvents:t,forceReplace:n}}),ae=Object(x.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",function(e,t){return{folderId:e,calendarEvents:t}}),ie=Object(x.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",function(e,t){return{folderId:e,instanceKey:t}}),oe=Object(x.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",function(e,t,n){return{folderId:e,instanceKey:t,onEventsRemoved:n}}),ce=Object(x.action)("REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",function(e,t){return{folderId:e,predicate:t}}),ue=Object(x.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",function(e,t,n){return{folderId:e,predicate:t,onEventsRemoved:n}}),se=Object(x.action)("CALENDAR_EVENTS_RELEASE_LOCK",function(e){return{lockId:e}}),de=Object(x.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",function(e,t,n){return void 0===n&&(n=!1),{folderId:e,eventsReloaded:t,forceReload:n}}),le=Object(x.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}}),fe=Object(x.action)("INTERNAL_DELETE_EVENTS_CACHE",function(e){return{folderId:e}}),ve=Object(x.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",function(e,t){return{lockId:e,eventKey:t}}),pe=Object(x.action)("UpdateItem",function(e,t){return{existingItem:e,updatedItem:t}}),_e=n(1455),be=n(1669),Ie=n(1676),me=n(4),ye=n(25),ge=Object(x.action)("calendarEventsRemoved",function(e){return{eventsRemoved:e}}),he=Object(x.action)("calendarEventsAdded",function(e){return{eventsAdded:e}}),Oe=Object(x.action)("calendarEventUpdated",function(e){return{eventUpdated:e}}),Ee=Object(x.action)("cacheReloaded",function(e,t){return{previousEvents:e,reloadedEvents:t}}),je=Object(x.action)("deleteEventsCache",function(e){return{folderId:e}}),Re=Object(x.action)("loadingCalendarEvents",function(e,t){return Object(ye.a)({name:"CalendarLoadState",customData:{loadingState:t},options:{isVerbose:!0}},{calendarId:e,loadingState:t})}),Te=Object(x.action)("instantCalendarEventCreate",function(e,t,n,r,a,i){return void 0===r&&(r=function(){}),void 0===a&&(a=void 0),void 0===i&&(i=Object(me.a)(be.a)),{eventToCreate:e,actionToExecute:t,onEventCreatedSuccess:n,onEventCreatedFailed:r,actionSource:a,errorMessage:i}}),Ce=Object(x.action)("instantCalendarEventUpdate",function(e,t,n,r,a,i,o,c,u){return void 0===i&&(i=function(){}),void 0===o&&(o=void 0),void 0===c&&(c=Object(me.a)(_e.a)),void 0===u&&(u=!1),{eventId:e,eventChanges:t,eventScope:n,actionToExecute:r,onEventUpdateSuccess:a,onEventUpdateFailed:i,actionSource:o,errorMessage:c,showNotification:u}}),Ae=Object(x.action)("instantCalendarEventDelete",function(e,t,n,r,a,i,o,c,u){return void 0===i&&(i=function(){}),void 0===o&&(o=void 0),void 0===c&&(c=Object(me.a)(Ie.a)),void 0===u&&(u=!1),{eventId:e,eventScope:t,dataPoint:n,actionToExecute:r,onEventDeleteSuccess:a,onEventDeleteFailed:i,actionSource:o,errorMessage:c,responseSent:u}}),Se=Object(x.action)("updatingCalendarEventFailed",function(e,t,n,r,a){return void 0===a&&(a=void 0),{eventBeforeUpdate:e,errorMessage:t,allowLocalUpdate:n,retryFunction:r,actionSource:a}});Object(x.orchestrator)(Ee,function(e){var t=e.previousEvents,n=e.reloadedEvents;n&&(t&&ge(t),he(n))}),Object(x.orchestrator)(ce,function(e){var t=e.folderId,n=e.predicate,r=null;ue(t,n,function(e){r=e}),r&&(r.forEach(function(e){return te(t,e.Key)}),ge(r))}),Object(x.orchestrator)(ie,function(e){var t=e.folderId,n=e.instanceKey,r=null;oe(t,n,function(e){r=e}),r&&(r.forEach(function(e){return te(t,e.Key)}),ge(r))}),Object(x.orchestrator)(ae,function(e){var t=e.folderId,n=J(e.calendarEvents,z(t)).eventsOverlapping;n.length>0&&(re(t,n),he(n))}),Object(x.orchestrator)(de,function(e){var t=e.folderId,n=e.eventsReloaded,r=e.forceReload,a=W(t);re(t,n,r),Ee(a,n)}),Object(x.orchestrator)(je,function(e){var t=e.folderId;ne(t),fe(t)});var Fe=n(1940),ke=n(1102);function Ne(e){if(0===e.length)return[];var t=[];return e.forEach(function(e){return function(e,t){for(var n=!1,r=0;r<t.length&&!n;r++){var i=t[r];0===Object(a.j)(i,e,!0)&&(t[r]=Object(a.f)(i,e),n=!0)}n||t.push(e)}(e,t)}),t}var De=n(197);function we(e,t){var n=function(e){return Object(ke.d)(e)?Pe:Object(ke.h)(e)?xe:Object(ke.e)(e)?Me:(Object(ke.i)(e),null)}(e.Recurrence);if(!n)return[r.__assign({},e)];var a=Ne(t),i=[],o=e.Recurrence.RecurrencePattern.Interval;a.forEach(function(t){var a=function(e,t){var n=Object(_.Qb)(e.Start),r=Object(Fe.a)(n.tz,e.Recurrence),a={start:n,end:r};return i=a,o=t,i.start=Object(_.p)(i.start,o.start)>0?i.start:o.start,i.end=null!=i.end&&Object(_.p)(i.end,o.end)<0?i.end:o.end,a;var i,o}(e,t),c=n(e,a,o);i.push.apply(i,r.__spread(c))});var c=Object(_.x)(e.Start,Object(_.Qb)(e.Start)),u=Object(_.x)(e.End,Object(_.Qb)(e.Start));return function(e,t,n,r){var a=[];return r.forEach(function(r){var i={};De(i,e),i.Start=Object(_.h)(r,t),i.End=Object(_.h)(r,n),i.CalendarItemType="Occurrence",a.push(i)}),a}(e,c,u,i)}function Pe(e,t,n){for(var r=[],a=Object(_.s)(t.end,t.start),i=0;i<=a;i+=n){var o=Object(_.e)(t.start,i);r.push(o)}return r}function xe(e,t,n){for(var r=[],i=e.Recurrence.RecurrencePattern,o=i.DaysOfWeek.split(" ").map(function(e){return Le(e)}),c=Math.max(Le(i.FirstDayOfWeek),0),u=t.start;Object(_.p)(u,t.end)<=0;){for(var s=u,d=Object(_.C)(s,c);Object(_.p)(s,d)<=0;)o.includes(Object(_.jb)(s))&&Object(a.q)(t,s)&&r.push(s),s=Object(_.e)(s,1);u=Object(_.Ub)(Object(_.e)(u,7*n),c)}return r}function Me(e,t,n){var r=[];if(Object(ke.b)(e.Recurrence))for(var i=(s=e.Recurrence.RecurrencePattern).DayOfMonth,o=t.start;Object(_.p)(o,t.end)<=0;){for(var c=o,u=Object(_.B)(c);Object(_.p)(c,u)<=0;)Object(_.hb)(c)==i&&Object(a.q)(t,c)&&r.push(c),c=Object(_.e)(c,1);o=Object(_.Tb)(Object(_.i)(o,n))}else{var s,d=Le((s=e.Recurrence.RecurrencePattern).DaysOfWeek),l=-1;switch(s.DayOfWeekIndex){case"First":l=1;break;case"Second":l=2;break;case"Third":l=3;break;case"Fourth":l=4}for(o=t.start;Object(_.p)(o,t.end)<=0;){var f=void 0;f=l>0?Ue(d,l,o):Ke(d,o),Object(a.q)(t,f)&&r.push(f),o=Object(_.Tb)(Object(_.i)(o,n))}}return r}function Le(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function Ue(e,t,n){var r=Object(_.Tb)(n),a=(e-Object(_.jb)(r)+7)%7+7*(t-1);return Object(_.e)(r,a)}function Ke(e,t){var n=Ue(e,5,t);return Object(_.sb)(n)==Object(_.sb)(t)?n:Ue(e,4,t)}var Be=n(140);function Ve(e,t,n){var r=function(e,t,n){var r=n&&n.locksInfo.get(t)?n.locksInfo.get(t).lockedDateRange:null;if(null!=r&&Object(a.c)(r,e,!0)){var i=F(e,n.events);if(Object(k.d)("debugEventsCache")){var o=i?i.length:"no";m({lockId:t,updateMessage:"Returning "+o+" items from cache for date range: "+e.start+" - "+e.end})}return i}return null}(n,e,H(t));return(r||[]).filter(function(e){return!Object(Be.G)(e.CalendarItemType)})}var qe=n(1941),ze=n.n(qe),He=n(1942),We=n.n(He),Ge=n(1943),Je=n.n(Ge),Ze=n(1944),Qe=n.n(Ze),Ye=n(1945),Xe=n.n(Ye),$e=n(1946),et=n.n($e),tt=n(27),nt=n(1291),rt=n(5),at=n(145);function it(e,t,n,a,i,o){return r.__awaiter(this,void 0,void 0,function(){var c,u,s;return r.__generator(this,function(r){switch(r.label){case 0:return c=Object(tt.getJsonRequestHeader)(),i&&(c.TimeZoneContext.TimeZoneDefinition.Id=i),s=null,o?[4,Object(at.b)(o)]:[3,2];case 1:s=r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,et()({request:{Header:c,Body:Qe()({MailboxDataArray:n.map(function(e){return Xe()({Email:We()({Address:e})})}),FreeBusyViewOptions:Je()({RequestedView:a,TimeWindow:ze()({StartTime:Object(_.mb)(e),EndTime:Object(_.mb)(t)})})})}},s)];case 3:return u=r.sent(),[3,5];case 4:return Object(rt.e)("cal-mf-diagnostics")&&nt.a.import().then(function(e){return e({action:"GetUserAvailabilityInternal",status:u?u.Body.ResponseCode:"Error",response:u&&u.Body})}),[7];case 5:return[2,u.Body]}})})}var ot=n(1473),ct=n(42),ut=n(389);function st(e,t,n,i){if(i=i||Object(ct.e)(),!n){var o=z(t);o&&o.length>0&&(n=o.sort(function(e,t){var n=Object(a.l)(e),r=Object(a.l)(t);return n>r?-1:n<r?1:0})[0])}var c=Object(ot.a)(),u=function(e,t){var n=Object(_.cc)(e),r=dt(n,Object(_.xb)(t.start));return Object(a.q)(t,r)?r:dt(n,Object(_.xb)(t.end))}(e.Birthday,n),s=r.__assign({},c,e,{Subject:e.Name,Start:u,End:Object(_.e)(u,1),IsAllDayEvent:!0,ParentFolderId:{Id:t,mailboxInfo:i},ItemId:{Id:e.Id.Id,mailboxInfo:i},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:e.EmailReminderSettings});return s||null}function dt(e,t){var n=Object(_.sb)(e),r=Object(_.hb)(e),a=Object(ut.a)(t,n),i=Math.min(r,a);return Object(_.cc)(t,n,i)}var lt=n(15),ft=n(1976),vt=n(1949),pt=n.n(vt),_t=n(1950),bt=n.n(_t);function It(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,i;return r.__generator(this,function(r){switch(r.label){case 0:return a=bt.a,i=[{Header:Object(tt.getJsonRequestHeader)(),Body:pt()({StartRange:Object(_.mb)(e),EndRange:Object(_.mb)(t)})}],[4,Object(at.b)(n.mailboxInfo)];case 1:return[4,a.apply(void 0,i.concat([r.sent()]))];case 2:return[2,r.sent().Body]}})})}var mt=n(483),yt=n(50);function gt(e,t,n,a){return void 0===a&&(a=0),r.__awaiter(this,void 0,void 0,function(){var i,o,c;return r.__generator(this,function(r){switch(r.label){case 0:return(i=Object(lt.q)())&&i.addCustomData({outOfCacheRange:!0}),o=Object(yt.x)(t),n(o,"Loading"),Object(yt.H)(t)?3!=(c=Object(yt.r)(t)).CalendarFolderType?[3,2]:[4,Et(e,o,t,n,a)]:[3,5];case 1:return[2,r.sent()];case 2:return[4,Ot(e,o,t,n,o.mailboxInfo.type==ct.a.GroupMailbox?o.mailboxInfo.primarySmtpAddress:null,a)];case 3:return[2,r.sent()];case 4:return[3,8];case 5:return c=Object(yt.o)({id:o}),Object(yt.J)(c)?[4,ht(Object(yt.s)({id:{id:c.ItemId.Id,mailboxInfo:o.mailboxInfo}}),c,e,o,n,a)]:[3,7];case 6:return[2,r.sent()];case 7:return n(o,"Failed"),[2,null];case 8:return[2]}})})}function ht(e,t,n,a,i,o){return void 0===o&&(o=0),r.__awaiter(this,void 0,void 0,function(){var c,u,s;return r.__generator(this,function(r){switch(r.label){case 0:if(!(!e&&null==t.SharedFolderId||t.hasOwnProperty("OwnerEmailAddress")&&!t.IsGroupMailboxCalendar&&e&&!e.EffectiveRights||e&&!e.EffectiveRights.Read&&t.IsGeneralScheduleCalendar))return[3,7];r.label=1;case 1:if(!(o>=0))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,it(n.start,n.end,[t.OwnerEmailAddress],"DetailedMerged",null,a.mailboxInfo)];case 3:return"NoError"==(c=r.sent()).ResponseCode?(i(a,"Loaded"),[2,c.Responses[0].CalendarView.Items.map(function(e){return Object(mt.a)(e,a.mailboxInfo)})]):(o--,[3,5]);case 4:return u=r.sent(),T.c.warn("[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: "+u),u.message&&(u.message.indexOf("ErrorApiQuarantined")>=0||u.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(i(a,"Throttled"),[2,null]):(o--,[3,5]);case 5:return[3,1];case 6:return i(a,"Failed"),[2,null];case 7:return s=e?e.FolderId.Id:t.SharedFolderId.Id,[4,Ot(n,a,s,i,t.OwnerEmailAddress,o)];case 8:return[2,r.sent()]}})})}function Ot(e,t,n,a,i,o){return void 0===o&&(o=0),r.__awaiter(this,void 0,void 0,function(){var c,u;return r.__generator(this,function(r){switch(r.label){case 0:if(!(o>=0))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(ft.a)(e.start,e.end,n,t,i,Object(rt.e)("cal-surface-declinedMeetings"))];case 2:return"NoError"==(c=r.sent()).ResponseCode?(a(t,"Loaded"),[2,c.Items.map(function(e){return Object(mt.a)(e,t.mailboxInfo)})]):(o--,[3,4]);case 3:return u=r.sent(),T.c.warn("[loadCalendarEventsInDateRange:getCalendarView: Exception occured: "+u),u.message&&(u.message.indexOf("ErrorApiQuarantined")>=0||u.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(a(t,"Throttled"),[2,null]):(o--,[3,4]);case 4:return[3,0];case 5:return a(t,"Failed"),[2,null]}})})}function Et(e,t,n,a,i){return void 0===i&&(i=0),r.__awaiter(this,void 0,void 0,function(){var o,c;return r.__generator(this,function(r){switch(r.label){case 0:if(!(i>=0))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,It(e.start,e.end,t)];case 2:return"NoError"==(o=r.sent()).ResponseCode?(a(t,"Loaded"),[2,o.BirthdayEvents.map(function(r){return st(r,n,e,t.mailboxInfo)})]):(i--,[3,4]);case 3:return c=r.sent(),T.c.warn("[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: "+c),c.message&&(c.message.indexOf("ErrorApiQuarantined")>=0||c.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(a(t,"Throttled"),[2,null]):(i--,[3,4]);case 4:return[3,0];case 5:return a(t,"Failed"),[2,null]}})})}var jt=3,Rt=1,Tt={};function Ct(e){Tt[e]||(Tt[e]=[])}function At(e,t){Ct(e);for(var n=Tt[e],r=0;r<n.length;r++)if(Object(a.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}function St(e,t,n){var i=function(e,t){var n=L().calendarFolderEvents.get(t);return n?n.locksInfo.get(e):null}(e,t);if(i&&i.lockedDateRange&&Object(a.c)(i.lockedDateRange,n,!0)){var o=Ve(e,t,n);return{fetchPromise:Promise.resolve(o),events:o}}var c=function(e,t,n){var i=z(t),o=H(t);return i.some(function(e){return Object(a.c)(e,n,!0)})&&o?F(n,o.events).map(function(e){return r.__assign({},e)}):null}(0,t,n);if(c)return{fetchPromise:Ft(e,t,n,Promise.resolve(c),"existing"),events:c};var u=At(t,n).info;if(u)return{fetchPromise:Ft(e,t,n,u.requestPromise.then(function(e){return e.filter(function(e){var t=e.Start,r=e.End;return 0==Object(a.j)(n,{start:t,end:r},!0)})}),"new"),events:null};var s=function(e,t){var n=this,a=r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),[4,gt(t,e,Re,Rt)];case 1:return[2,n.sent()];case 2:return function(e,t){var n=At(e,t).index;-1!==n&&Tt[e].splice(n,1)}(e,t),[7];case 3:return[2]}})});return function(e,t,n){Ct(e),Tt[e].push({dateRange:t,requestPromise:n})}(e,t,a),a}(t,n);return{fetchPromise:Ft(e,t,n,s,"new"),events:null}}function Ft(e,t,n,a,i){return r.__awaiter(this,void 0,void 0,function(){var o,c;return r.__generator(this,function(r){switch(r.label){case 0:return[4,a];case 1:return o=r.sent(),c=o?o.length:"no",m({lockId:e,updateMessage:"Fetched "+c+" "+i+" items for date range: "+n.start+" - "+n.end}),o&&le(e,t,n,o),[2,o]}})})}function kt(e,t){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,function(){var n,a,i;return r.__generator(this,function(o){switch(o.label){case 0:return n=function(e){var t=function(e){return Ct(e),Tt[e].map(function(e){return e.dateRange})}(e),n=z(e);return Ne(r.__spread(t,n))}(e),a=n.map(function(t){return gt(t,e,Re,Rt)}),[4,Promise.all(a)];case 1:return(i=o.sent())?(i.forEach(function(n){n&&(de(e,n,t),n.forEach(function(e){return $(e)}))}),[2,i.reduce(function(e,t){return t&&e.push.apply(e,r.__spread(t)),e},[])]):[2,null]}})})}function Nt(e,t,n,r){void 0===r&&(r=!1);var a=e.ParentFolderId.Id,i=!1,o=wt(a,e,t);o?o.IsRecurring&&!t?r?ge([o]):i=!0:ge([o]):T.c.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!o&&n||(i||Dt(a,[e]),r?$(e):ee(e))}function Dt(e,t){var n=J(t,z(e)).eventsOverlapping;re(e,n),he(n)}function wt(e,t,n){var a=null;if(n)a=K(t.ItemId.Id,e);else{a=r.__read(U(e,function(e){return e.InstanceKey==t.InstanceKey}),1)[0]}if(!a){var i=t.ClientSeriesId;if(i){a=r.__read(U(e,function(e){return e.ClientSeriesId==i}),1)[0]}}return a}function Pt(e,t){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return[4,kt(e,t)];case 1:return n.sent(),[2]}})})}var xt=n(1987),Mt=n(818),Lt=n(342),Ut=n(236),Kt=n.n(Ut),Bt=n(86);function Vt(e){var t=Object(Bt.a)();e.forEach(function(e){qt(e,t),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey?e.InstanceKey:t})}function qt(e,t,n){void 0===t&&(t=Object(Bt.a)()),void 0===n&&(n=Object(Bt.a)()),e.ItemId=r.__assign({},Kt()({Id:n}),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId||(e.ClientSeriesId=t),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}function zt(e,t,n,r,a){if(n){var i=e.ParentFolderId.Id;e.Recurrence?ce(i,function(t){return t.InstanceKey==e.InstanceKey}):ce(i,function(t){return t.ItemId.Id===e.ItemId.Id})}Lt.f.import().then(function(e){e("instantCalendarEventCreate",a,t,Object(me.a)(Mt.a),function(){return r()},"Error")})}Object(x.orchestrator)(Te,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i,o,c,u,s,d,l,f;return r.__generator(this,function(v){switch(v.label){case 0:t=e.eventToCreate,n=e.actionToExecute,a=e.actionSource,i=e.onEventCreatedFailed,o=e.onEventCreatedSuccess,c=e.errorMessage,u=G(t.ParentFolderId.Id),function(e,t,n){if(t){var a=e.ParentFolderId.Id;if(e.Recurrence){var i=z(a),o=we(e,i);Vt(o.concat(e));var c=o.map(function(e){return r.__assign({},e,{CalendarItemType:"Occurrence"})});return void ae(a,c)}u=e,void 0===s&&(s=Object(Bt.a)()),qt(u,s,s),ae(a,[e]),Lt.e.import().then(function(e){e("instantCalendarEventCreate",n,Object(me.a)(xt.a),{icon:"CheckMark"})})}var u,s}(t,u,a),s=function(){return Te(t,n,i,o,a,c)},d=null,v.label=1;case 1:return v.trys.push([1,3,,4]),[4,n(t)];case 2:return d=v.sent(),[3,4];case 3:throw l=v.sent(),zt(t,c,u,s,a),i(l),l;case 4:if(f=null,!d.isSuccessful)throw zt(t,c,u,s,a),i(c),c;return f=d.createdItem,function(e,t,n){t.ParentFolderId||(t.ParentFolderId=r.__assign({},e.ParentFolderId));if(n){if(t.Recurrence)return;var a=t.ParentFolderId.Id;ce(a,function(t){return t.ItemId.Id===e.ItemId.Id}),Nt(t,!0,!1)}}(t,f,u),o(f),[2]}})})});var Ht=n(197);function Wt(e,t){var n={Key:e,Start:t.Start,End:t.End};return Ht(t,n),t}function Gt(){return Yt.get()}function Jt(e){return Gt()[e]||null}function Zt(e,t){var n=L().fullItemsMruMap.get(e);return n&&r.__read(n.eventInfos.filter(function(e){return e.eventKey===t}),1)[0]||null}function Qt(e){var t=Jt(e);return t?t.loadState:null}var Yt=Object(w.computed)(function(){var e=L();return r.__spread(e.fullItemsMruMap.keys()).reduce(function(t,n){return e.fullItemsMruMap.get(n).eventInfos.forEach(function(e){return t[e.eventKey]=e}),t},{})});var Xt=n(197);function $t(e){if(e){var t=L();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,P())}}Object(x.mutator)(se,function(e){var t=e.lockId,n=L();r.__spread(n.calendarFolderEvents.keys()).forEach(function(e){n.calendarFolderEvents.get(e).locksInfo.get(t)&&function(e,t){p(f.All,e,t),t.locksInfo.delete(e)}(t,n.calendarFolderEvents.get(e))}),n.fullItemsMruMap.delete(t)}),Object(x.mutator)(X,function(e){var t=e.folderId,n=e.eventKey,r=e.event,a=B(n,t);a&&I(a,r,!0)}),Object(x.mutator)(ee,function(e){var t,n=e.partialCalendarEvent;if((t=n).Key&&void 0!==t.Start&&void 0!==t.End){n.Key;n=r.__rest(n,["Key"])}var a=B(Object(Be.G)(n.CalendarItemType)?n.InstanceKey:n.ItemId.Id,n.ParentFolderId.Id);a&&I(a,n)}),Object(x.mutator)(le,function(e){var t=e.lockId,n=e.folderId,r=e.dateRange,a=e.calendarEvents;$t(n);var i=H(n),o=Gt();C(r,a.filter(function(e){return!Object(Be.G)(e.CalendarItemType)}).map(function(e){return Wt(e.ItemId.Id,e)}).filter(function(e){return!o[e.Key]}),t,i);var c=i.locksInfo.get(t).lockedDateRange;Object(_.s)(c.end,c.start)>110&&A(function(e,t,n){var r=Object(_.s)(t.end,t.start);if(r===n)return t;if(r>n)return{start:t.start,end:Object(_.e)(t.start,n)};var a=n-r,i=Math.abs(Object(_.s)(t.end,e.end)),o=Math.abs(Object(_.s)(e.start,t.start)),c=t.start,u=t.end;if(i>0){var s=Math.min(a,i);u=Object(_.e)(u,s),a-=s}if(a>0&&o>0){var d=Math.min(a,o);c=Object(_.e)(c,-1*d)}return{start:c,end:u}}(c,r,110),t,i)}),Object(x.mutator)(oe,function(e){var t=e.folderId,n=e.instanceKey,r=e.onEventsRemoved;$t(t),r(S(function(e){return e.InstanceKey===n},H(t)))}),Object(x.mutator)(ue,function(e){var t=e.folderId,n=e.predicate,r=e.onEventsRemoved;$t(t),r(S(n,H(t)))}),Object(x.mutator)(fe,function(e){var t=e.folderId;L().calendarFolderEvents.delete(t)}),Object(x.mutator)(re,function(e){var t=e.folderId,n=e.calendarEvents,a=e.forceReplace;$t(t);var i,o,c,u,s=n.map(function(e){return Wt(e.ItemId.Id,e)}),d=H(t);a?(i=s,u=(o=d).events.length,(c=o.events).splice.apply(c,r.__spread([0,o.events.length],i)),m({lockId:"",updateMessage:"Replaced "+u+" items from cache with "+i.length+" items"})):O(s,d.events)}),Object(x.mutator)(pe,function(e){Xt(e.existingItem,e.updatedItem)});var en=Object(x.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",function(){return{}}),tn=5;function nn(e,t,n,a){an(t,n);var i=e.eventKey,o=n.get(t),c=o.eventInfos,u=r.__read(c.filter(function(e){return e.eventKey===i}),1)[0];u?on(o.eventInfos.indexOf(u),e,o):(c.push(e),function(e,t){!function(e,t,n){for(;e.eventInfos.length>t&&0<e.eventInfos.length;)cn(0,e,n)}(e,tn,t)}(o,a))}function rn(e,t,n,a){void 0===a&&(a=function(){}),an(t,n);var i=n.get(t),o=r.__read(i.eventInfos.filter(function(t){return t.eventKey===e}),1)[0],c=i.eventInfos.indexOf(o);return-1!==c&&cn(c,i,a),-1!==c}function an(e,t){t.get(e)||t.set(e,{eventInfos:[]})}function on(e,t,n){if(-1===e)throw new Error("Item with eventKey "+t.eventKey+" does not exist in the MRU");n.eventInfos.splice(e,1),n.eventInfos.push(t)}function cn(e,t,n){if(e<0||e>=t.eventInfos.length)throw new Error("Invalid index to remove "+e);var r=t.eventInfos[e];t.eventInfos.splice(e,1),n(r.eventKey)}function un(e){if(e){var t=L();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,P())}}function sn(e,t){return function(n){!function(e,t,n){if(0===e.length)return[];s(t,n);var a=n.locksInfo.get(t);e=e.filter(function(e){return a.lockedEvents[e]});var i=r.__spread(n.locksInfo.entries()).reduce(l(),[]),o=r.__spread(n.locksInfo.entries()).reduce(d(v(t)),{}),u=c(e,n.events,{dateRangesToRetain:i,eventsToRetain:o});e.forEach(function(e){delete a.lockedEvents[e]})}([n],e,L().calendarFolderEvents.get(t))}}Object(x.mutator)(Z,function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.partialCalendarEvent;un(n);var i=L();a&&R(Wt(t,a),r,i.calendarFolderEvents.get(n));nn({eventKey:t,folderId:n,loadState:0},r,i.fullItemsMruMap,sn(r,n))}),Object(x.mutator)(Q,function(e){var t=e.eventKey,n=e.folderId,r=e.lockId;un(n),nn({eventKey:t,folderId:n,loadState:2},r,L().fullItemsMruMap,sn(r,n))}),Object(x.mutator)(Y,function(e){var t=e.lockId,n=e.eventKey,r=e.folderId,a=e.event,i=e.eventScope,o=e.forceOverrideAllPropertiesForEventIfAvailable;un(r);var c=L(),u=3===i;R(Wt(n,a),t,c.calendarFolderEvents.get(r),u,o),nn({eventKey:n,folderId:r,loadState:1},t,c.fullItemsMruMap,sn(t,r))}),Object(x.mutator)(te,function(e){var t=e.folderId,n=e.eventKey,a=L();a.calendarFolderEvents.get(t)&&r.__spread(a.fullItemsMruMap.keys()).forEach(function(e){rn(n,e,a.fullItemsMruMap)})}),Object(x.mutator)(ne,function(e){var t=e.folderId,n=L(),a=n.calendarFolderEvents.get(t);if(a){var i=r.__spread(a.locksInfo.entries()).reduce(d(),{}),o=Object.keys(i);r.__spread(n.fullItemsMruMap.keys()).forEach(function(e){o.forEach(function(t){return rn(t,e,n.fullItemsMruMap)})})}}),Object(x.mutator)(en,function(){var e=L();r.__spread(e.fullItemsMruMap.keys()).forEach(function(t){!function(e,t){an(e,t),t.get(e).eventInfos=[]}(t,e.fullItemsMruMap)})}),Object(x.mutator)(ve,function(e){var t=L(),n=e.lockId;!function(e,t,n){an(t,n);var a=n.get(t),i=a.eventInfos,o=r.__read(i.filter(function(t){return t.eventKey===e}),1)[0];o&&on(a.eventInfos.indexOf(o),o,a)}(e.eventKey,n,t.fullItemsMruMap)});var dn=n(1305),ln=n.n(dn);function fn(e,t){var n;if(3==t){var r=K(e);n=r&&r.SeriesMasterItemId?Kt()({Id:r.SeriesMasterItemId.Id}):n=ln()({OccurrenceId:e})}else n=Kt()({Id:e});return n}var vn=n(1935),pn=n(1491);function _n(e,t,n){var r=Object(me.a)(pn.c);return e.IsMeeting&&t&&!e.IsCancelled&&(r=e.IsOrganizer?Object(me.a)(pn.a):Object(me.a)(pn.b)),new Promise(function(e,t){Lt.e.import().then(function(t){t("instantCalendarEventDelete",n,r,{icon:"Error"},{primaryActionText:Object(me.a)(vn.a),notificationCallback:function(t){t===Lt.a.PrimaryActionClicked?e(!0):e(!1)}})})})}function bn(e,t){t&&Pt(e.ParentFolderId.Id)}Object(x.orchestrator)(Ae,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i,o,c,u,s,d,l,f,v,p;return r.__generator(this,function(r){switch(r.label){case 0:t=e.eventId,n=e.eventScope,a=e.dataPoint,i=e.actionToExecute,o=e.onEventDeleteSuccess,c=e.onEventDeleteFailed,u=e.responseSent,s=e.actionSource,d=e.errorMessage,l=K(t.Id),f=(b=l)&&G(b.ParentFolderId.Id),function(e,t,n){if(n){var r=e.ParentFolderId.Id;if(3==t||2==t){var a=e.Start;ce(r,function(n){return n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(_.Bb)(n.Start,a))})}else ce(r,function(t){return t.ItemId.Id===e.ItemId.Id})}}(l,n,f),a&&a.markUserPerceivedTime(),v=fn(t.Id,n),null,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,_n(l,u,s)];case 2:return r.sent()?(bn(l,f),[2]):[4,i(v)];case 3:if(!r.sent().isSuccessful)throw c(d),d;return[3,5];case 4:throw p=r.sent(),function(e,t,n,r,a){bn(e,n),Lt.f.import().then(function(e){e("instantCalendarEventDeleteFailed",a,t,Object(me.a)(Mt.a),function(){return r()},"Delete")})}(l,d,f,function(){return Ae(t,n,null,i,o,c,s,d,u)},s),c(p),p;case 5:return o(),[2]}var b})})}),Object(x.orchestrator)(Se,function(e){var t=e.eventBeforeUpdate,n=e.errorMessage,r=e.allowLocalUpdate,a=e.retryFunction,i=e.actionSource;r&&Pt(t.ParentFolderId.Id),Lt.f.import().then(function(e){e("updateCalendarEventFailed",i,n,Object(me.a)(Mt.a),function(){return a()},"Error")})});var In=n(1898),mn=n.n(In),yn=n(1899),gn=n.n(yn),hn=n(861),On=n(1221);function En(e,t,n,a){return void 0===n&&(n=0),void 0===a&&(a=void 0),r.__awaiter(this,void 0,void 0,function(){var i,o,c,u,s,d,l,f;return r.__generator(this,function(r){switch(r.label){case 0:return i=e.Id,o=e.mailboxInfo,c=3==n||2==n,u=null,s=null,[4,Object(at.b)(o)];case 1:(d=r.sent()||{}).datapoint={customData:{itemId:i,fetchingMasterItem:c},jsonCustomData:function(e){var t=e.Body.ResponseMessages.Items[0];return{responseClass:t.ResponseClass,responseCode:t.ResponseCode}}},r.label=2;case 2:return r.trys.push([2,,4,5]),[4,gn()({Header:Object(tt.getJsonRequestHeader)(),Body:mn()({EventIds:[c?a?Kt()({Id:a.Id}):ln()({OccurrenceId:i}):Kt()({Id:i})],ItemShape:t,IncludeDeclinedMeetings:Object(rt.e)("cal-surface-declinedMeetings")})},d)];case 3:return u=r.sent(),null!=(l=u.Body.ResponseMessages.Items[0])&&"Success"==l.ResponseClass&&null!=(f=l.Items[0])&&(!function(e){e.Locations?e.Locations=e.Locations.filter(function(e){return e}):e.Locations=[],e.Resources&&e.Resources.map(function(t){Object(hn.c)(e.Locations,t.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter(function(e){return e.DisplayName!==t.Mailbox.Name||Object(On.s)(e.PostalAddress)}),e.Locations.push(Object(On.f)(t.Mailbox.Name,t.Mailbox.EmailAddress)))})}(f),s=Object(mt.a)(f,e.mailboxInfo)),[3,5];case 4:return Object(rt.e)("cal-mf-diagnostics")&&nt.a.import().then(function(e){return e({action:"GetCalendarEvent",status:"Error",response:u&&u.Body})}),[7];case 5:return[2,s]}})})}var jn=n(1951),Rn=n.n(jn),Tn=n(1952),Cn=n.n(Tn);var An=n(552);function Sn(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=void 0);var i=Object(yt.r)(t);return i&&3==i.CalendarFolderType?function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,i,o;return r.__generator(this,function(r){switch(r.label){case 0:return n=e.Id,a=e.mailboxInfo,[4,Object(at.b)(a)];case 1:return(r.sent()||{}).datapoint={customData:{itemId:n},jsonCustomData:function(e){return{responseClass:e&&e.Body&&e.Body.ResponseClass,responseCode:e&&e.Body&&e.Body.ResponseCode}}},[4,Cn()({Header:Object(tt.getJsonRequestHeader)(),Body:Rn()({CalendarItemId:Kt()({Id:n})})})];case 2:return null!=(i=r.sent()).Body&&"Success"==i.Body.ResponseClass&&null!=(o=i.Body.BirthdayEvent)?[2,st(o,t,void 0,e.mailboxInfo)]:[2,null]}})})}(e,t):En(e,{BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",InlineImageCustomDataTemplate:An.e,InlineImageUrlTemplate:An.g,AddBlankTargetToLinks:!0},n,a)}Object(x.orchestrator)($,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.partialCalendarEvent,n=Object(Be.G)(t.CalendarItemType)?t.InstanceKey:t.ItemId.Id,a=t.ParentFolderId.Id,null===Qt(t.ItemId.Id)?[3,2]:[4,Sn(t.ItemId,a)];case 1:(i=r.sent())&&X(a,n,i),r.label=2;case 2:return[2]}})})});var Fn=n(1719);Object(x.orchestrator)(Ce,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i,o,c,u,s,d,l,f,v,p,b,I;return r.__generator(this,function(m){switch(m.label){case 0:t=e.eventId,n=e.eventChanges,a=e.errorMessage,i=e.actionToExecute,o=e.onEventUpdateFailed,c=e.onEventUpdateSuccess,u=e.showNotification,s=e.actionSource,d=e.eventScope,l=K(t.Id),f=fn(t.Id,e.eventScope),l&&Object(Be.G)(l.CalendarItemType)&&(d=3),(v=function(e,t){if(!e)return!1;var n=e.ParentFolderId.Id;if(!G(n))return!1;var r=t.ParentFolderId;if(r&&r.Id!=n)return!1;return!0}(l,n))&&function(e,t,n,a,i){var o,c,u=e.ParentFolderId.Id,s=r.__assign({},e,t);if(3==n||2==n)if(t.Recurrence||t.Start||t.StartTimeZoneId||t.End||t.EndTimeZoneId||2==n){var d=e.Start;if(ce(u,function(t){return Object(Be.D)(t.CalendarItemType)&&t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(_.Bb)(t.Start,d))}),3==n){var l=z(u),f=we(s,l);Vt(f.concat(s));var v=f.map(function(e){return r.__assign({},e,{CalendarItemType:"Occurrence"})});ae(s.ParentFolderId.Id,v)}}else{var p=U(u,function(t){return t.InstanceKey==e.InstanceKey&&Object(Be.D)(t.CalendarItemType)});try{for(var b=r.__values(p),I=b.next();!I.done;I=b.next()){var m=I.value,y=m;pe(y,t),Oe(y)}}catch(e){o={error:e}}finally{try{I&&!I.done&&(c=b.return)&&c.call(b)}finally{if(o)throw o.error}}}if(!Object(Be.w)(e.CalendarItemType)||3!=n){var g=null==e.InstanceKey||Object(Be.D)(e.CalendarItemType)||Object(Be.w)(e.CalendarItemType);Nt(s,g,!0)}if(a){var h=s.IsMeeting||s.RequiredAttendees.length>0||s.OptionalAttendees.length>0,O=h?Object(me.a)(Fn.b):Object(me.a)(Fn.a),E={icon:h?"Send":"Save"};setTimeout(function(){Lt.e.import().then(function(e){e("instantCalendarEventUpdate",i,O,E)})},0)}}(l,n,d,u,s),p=function(){return Ce(t,n,d,i,c,o,s,a)},b=null,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,i(f)];case 2:return b=m.sent(),[3,4];case 3:throw I=m.sent(),Se(l,a,v,p),o(I),I;case 4:if(!b.isSuccessful)throw Se(l,a,v,p),o(a),a;return c(),[2]}})})});var kn=n(1953),Nn=n.n(kn),Dn=n(1954),wn=n.n(Dn);function Pn(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return n={Header:Object(tt.getJsonRequestHeader)(),Body:Nn()({EventId:Kt()({Id:e.Id}),WindowStart:Object(_.mb)(t.start),WindowEnd:Object(_.mb)(t.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object(rt.e)("cal-surface-declinedMeetings")})},a=wn.a,i=[n],[4,Object(at.b)(e.mailboxInfo)];case 1:return[4,a.apply(void 0,i.concat([r.sent()]))];case 2:return[2,r.sent().Body]}})})}var xn=n(375);var Mn,Ln={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},Un=2e3,Kn={},Bn={},Vn=[],qn=!0,zn={};function Hn(e){if(Kn[e])T.c.info("[CalendarNotifications] Already subscribed to notifications on folder: "+e);else{var t=function(e){if(Object(yt.H)(e))return{FolderId:e,MailboxId:void 0};if(Object(rt.e)("cal-groupNotifications")){var t=Object(yt.r)(e);if(t&&t.IsGroupMailboxCalendar)return{FolderId:void 0,MailboxId:t.OwnerEmailAddress}}return null}(e);t&&xn.b.import().then(function(n){var a=r.__assign({},t,{ChannelId:n(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:Object(rt.e)("cal-surface-declinedMeetings")}),i={subscriptionId:""+a.NotificationType+e+(Object(rt.e)("cal-surface-declinedMeetings")?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:a},o={folderId:e,subscription:i};T.c.info("[CalendarNotifications] Subscribing calendar item notifications. Folder: "+e),xn.f.importAndExecute(i,Gn),Kn[e]=o})}}function Wn(e){var t=Kn[e];t?(T.c.info("[CalendarNotifications] Unsubscribing calendar item notifications. Folder: "+e),xn.g.importAndExecute(t.subscription,Gn),delete Kn[e]):T.c.warn("[CalendarNotifications] Could not unsubscribe notifications on folder: '"+e+"', subscription data not found")}function Gn(e){Qn(e,!0),function(e){if(Yn(e.NotificationPayload))T.c.info("[CalendarNotifications]: A reload notification will be enqueued. All existing notifications will be discarded."),(Vn=[])[0]=e;else{for(var t=Vn.length-1;t>=0;t--){var n=Vn[t].NotificationPayload.Item,r=void 0,a=void 0,i=void 0;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,r=n.InstanceKey,i="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,r=n.ItemId.Id,i="ItemId"),a===r){T.c.info("[CalendarNotifications]: Found an existing notification in the queue for the same "+i+". Old notification will be removed."),Vn[t].InstanceKeyToDelete&&(e.InstanceKeyToDelete=Vn[t].InstanceKeyToDelete),Vn.splice(t,1);break}}var o=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==Ln.RowModified&&Object(Be.G)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&(Bn[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===Ln.RowAdded||e.NotificationPayload.EventType===Ln.RowModified){for(var t=Vn.length-1;t>=0;t--)if(Vn[t].NotificationPayload.EventType===Ln.RowDeleted&&Vn[t].OriginalUID==e.NotificationPayload.Item.UID){T.c.info('[CalendarNotifications]: "Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.'),e.InstanceKeyToDelete=Vn[t].NotificationPayload.Item.InstanceKey,Vn.splice(t,1);break}}else if(e.NotificationPayload.EventType===Ln.RowDeleted){var c=Bn[e.NotificationPayload.Item.InstanceKey];if(delete Bn[e.NotificationPayload.Item.InstanceKey],c){e.OriginalUID=c;for(var t=Vn.length-1;t>=0;t--){var u=Vn[t].NotificationPayload.Item.UID;if((Vn[t].NotificationPayload.EventType===Ln.RowAdded||Vn[t].NotificationPayload.EventType===Ln.RowModified)&&u==c){T.c.info('[CalendarNotifications]: "Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.'),Vn[t].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,o=!0;break}}}}o?T.c.info("[CalendarNotifications]: RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued."):(T.c.info("[CalendarNotifications]: Notification will be enqueued."),Vn.push(e))}T.c.info("[CalendarNotifications]: Notification queue length is: "+Vn.length)}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),qn?(Mn&&(T.c.info("[CalendarNotifications]: Notification processing timer was already started. It will be cancelled and restarted."),clearTimeout(Mn)),Mn=setTimeout(Zn,Un),T.c.info("[CalendarNotifications]: Timer to drain queue has started.")):T.c.info("[CalendarNotifications]: The notification was received while notification processing was suspended.")}function Jn(e){if(Qn(e.NotificationPayload,!1),Yn(e.NotificationPayload))Xn();else{var t=e.NotificationPayload.FolderId,n=G(t),r=z(t),i=Object(yt.r)(t),o=Object(yt.C)(t);i&&3==i.CalendarFolderType?Xn(t,!0):n&&r.length>0?e.NotificationPayload.EventType==Ln.RowDeleted?function(e,t){var n=t.Item.InstanceKey;zn[n]&&(T.c.info("[CalendarNotifications] Received delete notification for a recurring series we are currently expanding items for.\n            Ignoring expansion. Instance key: "+n),delete zn[n]);ie(e,n)}(t,e.NotificationPayload):Object(Be.G)(e.NotificationPayload.Item.CalendarItemType)?function(e,t,n){var r=Object(mt.a)(n.NotificationPayload.Item,t);if(r.UID){var i=z(e),o=Ne(i);o.forEach(function(i){var o=Pn(r.ItemId,i);zn[r.InstanceKey]=o,o.then(function(c){c&&"Success"==c.ResponseClass?function(e,t,n,r,i,o,c){if(er(e,t)){T.c.info("[CalendarNotifications] Action to expand series completed successfully. Retrieved "+(i?i.length:0)+" items.");var u=z(r),s=u.some(function(e){return Object(a.b)(n,e)});s?(tr(i,e.ItemId.Id,e.InstanceKey,c,r),$(o),Dt(r,i),i.forEach(function(e){$(e)})):Pt(r),delete zn[e.InstanceKey]}}(r,o,i,e,c.Occurrences.map(function(e){return Object(mt.a)(e,t)}),Object(mt.a)(c.RecurrenceMaster,t),n.InstanceKeyToDelete):$n(r,o,e,n.InstanceKeyToDelete,c)}).catch(function(t){$n(r,o,e,n.InstanceKeyToDelete,null,t.message)})})}}(t,o,e):function(e,t,n){var r=Object(mt.a)(n.Item,t),a=!1;switch(n.EventType){case Ln.RowAdded:a=!0;break;case Ln.RowModified:a=null==r.InstanceKey||Object(Be.D)(r.CalendarItemType)||Object(Be.w)(r.CalendarItemType),function(e,t,n,r){var a=Object(mt.a)(n.Item,t),i=wt(e,a,r);if(i){var o=0!=Object(_.p)(i.Start,a.Start),c=0!=Object(_.p)(i.End,a.End);Object(lt.o)("ProcessedSingleItemNotification",{NotificationType:n.EventType,ItemType:a.CalendarItemType,isStartTimeChanged:o,isEndTimeChanged:c},{isVerbose:!0})}}(e,t,n,a)}Nt(r,a,!1,!0)}(t,o,e.NotificationPayload):n?T.c.warn("[CalendarNotifications]: Events cache not yet loaded once for folder "+e.NotificationPayload.FolderId+"."):T.c.warn("[CalendarNotifications]: Events cache was empty for folder "+e.NotificationPayload.FolderId+".")}}function Zn(){var e=Vn.length;if(e>=8||Vn.some(function(e){return Yn(e.NotificationPayload)}))Xn();else for(var t=0;t<e;t++){Jn(Vn[t])}Vn=[],Bn={},clearTimeout(Mn)}function Qn(e,t){var n=e.Item&&e.Item.ItemId?e.Item.ItemId.Id:"<null>",r=e.Item&&e.Item.InstanceKey?e.Item.InstanceKey:"<null>",a=t?"Got calendar notification":"Now Processing calendar notification";if(T.c.info("[CalendarNotifications] '"+new Date(Date.now()).toString()+": "+a+"':\n        Type: '"+e.EventType+"',\n        FolderId: '"+e.FolderId+"',\n        ItemId: '"+n+"',\n        InstanceKey: '"+r+"'"),t){var i=e.Item?e.Item.CalendarItemType:"<null>";Object(lt.o)("IncomingNotification",{NotificationType:e.EventType,ItemType:i,ItemId:n},{isCosmosDatapoint:!0})}}function Yn(e){return e.EventType==Ln.Reload||e.Reload}function Xn(e,t){var n,a;void 0===t&&(t=!1);var i=e?[e]:Object.keys(Kn);try{for(var o=r.__values(i),c=o.next();!c.done;c=o.next()){Pt(c.value,t)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}}function $n(e,t,n,r,a,i){if(void 0===i&&(i=null),er(e,t)){if(a&&"ErrorItemNotFound"==a.ResponseCode)T.c.warn("[CalendarNotifications] Action to expand recurring series failed with item not found because item is not on the server. Removing series.\n                Item Instance Key: "+e.InstanceKey),tr(void 0,e.ItemId.Id,e.InstanceKey,r,n);else{var o=a?a.ResponseCode+": "+a.MessageText:i;T.c.warn("[CalendarNotifications] Action to expand recurring series failed for unknown reason, reloading cache.\n                Item Instance Key: "+e.InstanceKey+",\n                Message: '"+o+"'"),Pt(n)}delete zn[e.InstanceKey]}}function er(e,t){var n=zn[e.InstanceKey];return n&&n==t}function tr(e,t,n,r,a){var i=e?e.map(function(e){return e.UID}):void 0,o=function(e){return e.InstanceKey==n||r&&e.InstanceKey==r||e.InstanceKey==e.ClientSeriesId||e.SeriesMasterItemId.Id===t||i.includes(e.UID)};ce(a,function(e){return e.ClientSeriesId&&o(e)});var c=U(a,o);ge(c)}function nr(){qn&&(clearTimeout(Mn),T.c.info("[CalendarNotifications]: Processing of notifications will be suspended"),qn=!1)}function rr(){qn||(qn=!0,T.c.info("[CalendarNotifications]: Processing of notifications will be resumed"),Mn=setTimeout(Zn,Un))}function ar(e){var t=Object(yt.x)(e),n=t&&Object(yt.s)({id:t});return n?n.CharmId:null}function ir(e){return e&&e.CharmId||ar(e.ParentFolderId.Id)}function or(){var e;(e=L(),r.__spread(e.calendarFolderEvents.keys())).map(function(e){return kt(e)})}function cr(e,t){return t||Object(Be.G)(e.CalendarItemType)?e.InstanceKey:e.ItemId.Id}var ur=n(158),sr=n(213),dr=5e3,lr=function(e){var t={};return e.forEach(function(e){return t[e]={FreeBusyViewType:"None"}}),t};function fr(e,t,n,a,i,o){return void 0===i&&(i=!0),r.__awaiter(this,void 0,void 0,function(){var c,u,s,d,l,f,v;return r.__generator(this,function(r){switch(r.label){case 0:if(0===n.length)return[2];(c=new ur.a("FreeBusyAvailabilityRequested")).addCustomData({numAttendees:n.length}),r.label=1;case 1:return r.trys.push([1,3,,8]),[4,it(e,t,n,"DetailedMerged",e.tz,o)];case 2:return u=r.sent(),c.end(),s="Success"===u.ResponseClass&&n.length===u.Responses.length,d={},s?n.forEach(function(e,t){d[e]=u.Responses[t].CalendarView}):d=lr(n),i&&(l=s?Object.keys(d).filter(function(e){return"None"==d[e].FreeBusyViewType}):n).length>0&&fr(e,t,l,a,!1,o),a(d),[3,8];case 3:return f=r.sent(),c.endWithError("ServerError",f),T.c.warn('[getAvailabilityFunction] Received error calling getUserAvailabilityService, Error: "'+f.stack+'"'),i?f&&"GetUserAvailabilityInternal failed: Microsoft.Exchange.Services.Core.Types.ErrorApiQuarantinedException"==f.message?[4,Object(sr.a)(dr)]:[3,5]:[3,6];case 4:r.sent(),r.label=5;case 5:return fr(e,t,n,a,!1,o),[3,7];case 6:v=lr(n),a(v),r.label=7;case 7:return[3,8];case 8:return[2]}})})}var vr=n(91),pr={};function _r(e){return pr[e]||null}function br(e,t,n,a,i){void 0===n&&(n=null),void 0===a&&(a=function(){return null}),void 0===i&&(i=0);var o,c=3===i,u=function(e,t){return function(n){var r=K(n.Id,e);return r||t&&t(n)}}(n,a),s=Jt(t.Id);if(s)o=function(e,t,n,a,i){var o=i(t),c=3==a;if(o&&c)return Ir(e,o);if(!o&&c)return null;switch(n.loadState){case 1:return{event:o,fullEventPromise:Promise.resolve(o),promiseSource:2};case 0:return{event:o,fullEventPromise:_r(t.Id),promiseSource:0};case 2:var u=mr(o,t.Id,t,a,e);return r.__assign({event:o},u);default:return Object(vr.a)(n.loadState)}}(n=n||s.folderId,t,s,i,u);else{var d=u(t);if(d&&c)o=Ir(n=n||d.ParentFolderId.Id,d);else{if(!d&&c)return null;var l=mr(d,t.Id,t,i,n||(d?d.ParentFolderId.Id:null));o=r.__assign({event:d},l)}}if(o){var f=c||o.event&&Object(Be.G)(o.event.CalendarItemType)?o.event.InstanceKey:t.Id;n=n||(o.event?o.event.ParentFolderId.Id:null),o=r.__assign({},o,{fullEventPromise:yr(o.fullEventPromise,o.promiseSource,o.event,e,n,f,i)})}return o}function Ir(e,t){var n=t.InstanceKey,a=Jt(n);if(a&&1===a.loadState){var i=B(n,e);return{event:i,fullEventPromise:Promise.resolve(i),promiseSource:2}}return a&&0===a.loadState?{event:B(n,e)||t,fullEventPromise:_r(n),promiseSource:0}:{event:r.__assign({},t),fullEventPromise:gr(n,t.ItemId,3,t.ParentFolderId.Id,t.SeriesMasterItemId),promiseSource:0}}function mr(e,t,n,r,a){return!e||Object(Be.s)(e)?{fullEventPromise:gr(t,n,r,a,e&&e.SeriesMasterItemId),promiseSource:0}:{fullEventPromise:Promise.resolve(e),promiseSource:1}}function yr(e,t,n,a,i,o,c){return r.__awaiter(this,void 0,void 0,function(){var u,s,d,l,f;return r.__generator(this,function(r){switch(r.label){case 0:u=Zt(a,o),r.label=1;case 1:return r.trys.push([1,5,,6]),T.c.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+o+", Lock: "+a),!i||u&&1===u.loadState||(T.c.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+o+", Lock: "+a),Z(a,i,o,n)),2!=t?[3,2]:(s=n,[3,4]);case 2:return[4,e];case 3:s=r.sent(),r.label=4;case 4:if(!s)throw new Error("[fetchFullCalendarEvent] Unable to fetch full calendar event for event Key: "+o);return d=i||s.ParentFolderId.Id,f=u,u=Zt(a,o),!d||u&&1===u.loadState?(T.c.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+o+'", Lock: "'+a+'", FolderId: "'+d+'"'),ve(a,o)):(T.c.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+o+'", Lock: "'+a+'", FolderId: "'+d+'"'),Object(lt.o)("FullCalendarEventLoaded",{eventKey:o,lockId:a,prevFullItemLoadState:f?f.loadState:null,fullItemLoadState:u?u.loadState:null,isFullItem:void 0!==s.RequiredAttendees,isSameAsExistingEvent:n===s}),Y(a,d,o,s,c,0===t)),[2,B(o,i)];case 5:throw l=r.sent(),T.c.warn("[fetchFullCalendarEvent] Received error when fetching for "+o+" with error "+l),f=u,u=Zt(a,o),Object(lt.o)("FullCalendarEventLoaded",{eventKey:o,lockId:a,prevFullItemLoadState:f?f.loadState:null,fullItemLoadState:u?u.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1}),i&&Q(a,i,o),l;case 6:return[2]}})})}function gr(e,t,n,a,i){var o=this,c=r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,,2,3]),[4,hr(jt,t,n,a,i)];case 1:return[2,r.sent()];case 2:return function(e){delete pr[e]}(e),[7];case 3:return[2]}})});return function(e,t){pr[e]=t}(e,c),c}function hr(e,t,n,a,i){return r.__awaiter(this,void 0,void 0,function(){var o,c,u;return r.__generator(this,function(r){switch(r.label){case 0:o=0,r.label=1;case 1:if(!(o<e))return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Sn(t,a,n,i)];case 3:return c=r.sent(),o++,c||o>=e?[2,c]:[3,5];case 4:if(u=r.sent(),T.c.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+t.Id+'" with try '+o+": Error "+u.toString()),++o>=e)throw u;return[3,5];case 5:return[3,1];case 6:return[2,null]}})})}function Or(e){if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:function(t,n){return St(e,t,n)},fetchFullCalendarEvent:function(t,n,r,a){return br(e,t,n,r,a)},getLockId:function(){return e},release:function(){return se(e)}}}function Er(){return Or(function(){var e="events_cache_lock_"+D;return D++,e}())}function jr(e){return{getCalendarEventsForDateRange:function(t,n){return Ve(e,t,n)},getFullCalendarEvent:function(t,n){return V(t,n,e)}}}n.d(t,"k",function(){return Rr}),n.d(t,"c",function(){return ge}),n.d(t,"b",function(){return he}),n.d(t,"a",function(){return Oe}),n.d(t,"f",function(){return je}),n.d(t,"w",function(){return Re}),n.d(t,"t",function(){return Te}),n.d(t,"v",function(){return Ce}),n.d(t,"u",function(){return Ae}),n.d(t,"d",function(){return en}),n.d(t,"z",function(){return Hn}),n.d(t,"B",function(){return Wn}),n.d(t,"y",function(){return rr}),n.d(t,"A",function(){return nr}),n.d(t,"j",function(){return ar}),n.d(t,"m",function(){return ir}),n.d(t,"p",function(){return fn}),n.d(t,"l",function(){return J}),n.d(t,"o",function(){return Qt}),n.d(t,"x",function(){return or}),n.d(t,"n",function(){return cr}),n.d(t,"i",function(){return fr}),n.d(t,"s",function(){return it}),n.d(t,"g",function(){return Pn}),n.d(t,"e",function(){return Er}),n.d(t,"r",function(){return Or}),n.d(t,"q",function(){return jr}),n.d(t,"h",function(){return W});var Rr=K},1552:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(6),a=n(750);function i(e,t,n){if(e&&t&&n){var i=Object(r.x)(t,e),o=Object(a.a)(e.tz,n,e);return{start:o,end:Object(r.Kb)(t.tz,Object(r.h)(o,i))}}return null}},1561:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1067);function a(e,t,n){return e&&t&&n?Object(r.a)(e,t.tz,n,t):null}},1562:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1067);function a(e,t,n){return e&&t&&n?Object(r.a)(e,t.tz,t,n):null}},1563:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(6),a=n(750);function i(e,t,n,i){if(e&&t&&n){var o=Object(a.a)(e.tz,e,n),c=t;if(!Object(r.Bb)(o,t)||i){var u=Object(r.x)(t,e);c=Object(r.Kb)(t.tz,Object(r.h)(o,u))}return{start:o,end:c}}return null}},1570:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1057),a=n(6);function i(e,t){return e&&null!=t?Object(r.c)(Object(a.Qb)(e),t+1):null}},1604:function(e,t,n){"use strict";function r(e){var t=0,n=[];function r(){t-=1,n.length>0&&n.shift()()}return{add:function(a){return new Promise(function(i,o){var c=function(){t+=1,a().then(function(e){r(),i(e)},function(e){r(),o(e)})};t===e?n.push(c):c()})},getRunningCount:function(){return t},getQueueLength:function(){return n.length}}}n.d(t,"a",function(){return r})},1669:function(e){e.exports={a:"hfa"}},1676:function(e){e.exports={a:"qGa"}},1697:function(e,t,n){"use strict";var r;!function(e){e[e.Primary=0]="Primary",e[e.Secondary=1]="Secondary"}(r||(r={})),t.a=r},1719:function(e){e.exports={b:"sLb",a:"tLb"}},1861:function(e,t,n){"use strict";function r(e){var t=[];return e&&e.forEach(function(e){t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress})}),t}n.d(t,"a",function(){return r})},1889:function(e,t,n){"use strict";var r=n(287),a=n(575);var i=n(1467),o=n(1468);function c(e){return function(e){return!(e<=0||Object(a.a)(e,r.c)!=r.c&&Object(a.a)(e,r.e)!=r.e&&Object(a.a)(e,r.g)!=r.g&&Object(a.a)(e,r.f)!=r.f&&Object(a.a)(e,r.a)!=r.a&&Object(a.a)(e,r.b)!=r.b)}(e)||function(e){return Object(a.a)(e,r.i)==r.i||Object(a.a)(e,r.j)==r.j||Object(a.a)(e,r.k)==r.k}(e)||Object(i.a)(e)||Object(o.a)(e)}n.d(t,"a",function(){return c})},1891:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i});var r=2,a="",i=-1},1918:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.ForceDismissedFromCode=11]="ForceDismissedFromCode"}(r||(r={}))},1935:function(e){e.exports={a:"nca"}},1940:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(6);function a(e,t){if(t&&t.RecurrenceRange){var n=t.RecurrenceRange.EndDate;if(n)return Object(r.Kb)(e,n)}return null}},1965:function(e,t,n){"use strict";var r,a=n(609),i={TxpActivity:"TxpActivity",flightdeparture:a.a.FlightDeparture,hotelcheckin:a.a.HotelCheckin,hotelcheckout:a.a.HotelCheckout,invoicedue:a.a.InvoiceDue,invoicescheduled:a.a.InvoiceScheduled,parceldelivery:a.a.ParcelDelivery,rentalcarpickup:a.a.RentalCarPickup,rentalcardropoff:a.a.RentalCarDropOff,dining:a.a.Dining,miscevent:a.a.EventActivityType,serviceappointment:a.a.ServiceAppointment};!function(e){e[e.None=0]="None",e[e.Unexpected=1]="Unexpected",e[e.Configuration=2]="Configuration",e[e.Trust=3]="Trust",e[e.Error=4]="Error",e[e.ByDesign=5]="ByDesign",e[e.InThePast=6]="InThePast",e[e.SharedEvent=7]="SharedEvent"}(r||(r={}));var o=r,c={EventReservation:"miscevent",FlightReservation:"flightdeparture",FoodEstablishmentReservation:"dining",Invoice:"invoicedue",LodgingReservation:"hotelcheckin",ParcelDelivery:"parceldelivery",RentalCarReservation:"rentalcarpickup",ServiceReservation:"serviceappointment"},u=n(1697),s={primary:u.a.Primary,secondary:u.a.Secondary},d=n(1891);function l(e,t,n,r){return{activityId:t.toString(),type:n,entityId:e,calendarEventIdIndex:d.c,eventOmission:o.None,role:s.primary,activityName:r}}var f={none:o.None,unexpected:o.Unexpected,configuration:o.Configuration,trust:o.Trust,error:o.Error,bydesign:o.ByDesign,inthepast:o.InThePast,sharedevent:o.SharedEvent};function v(e,t){var n=e.type?e.type.toLowerCase():null,r=i[n];return r?function(e,t,n,r){var a=e.calendarEventOmission?e.calendarEventOmission.toLowerCase():null,i=e.role?e.role.toLowerCase():null,o=f[a],c=s[i];return{activityId:r.toString(),type:t,entityId:e.entityId,calendarEventIdIndex:e.calendarEventIdIndex,eventOmission:o,role:c,activityName:n}}(e,r,n,t):null}var p=n(277),_=n(1458),b="schema.org parser",I="schema",m="extraction";function y(e,t){if(e){var n=t?e["@EntityId"]:e["@id"];if(n){var r=_.a[e["additionalType/Txp"]],a=e["@source"],i=function(e,t){var n=null;return null!=e?n=_.a[e]:t&&(n=t.toLowerCase().indexOf(b)>-1?I:m),n}(r,a),o=e["originEmails/Txp"],c=e["@inferenceId"],u=e.immutableMessageIds,s=null,d=null,l=null;return o&&o.length&&(s=o[0].ewsId,d=o[0].receivedTime,l=o[0].internetMessageId),{id:n,source:a,trustScore:e["@entityExtractionTrustLevel"],txpAdditionalType:r,origin:i,originalEmailEwsId:s,originalEmailReceivedTime:d,originalEmailInternetMessageId:l,inferenceId:c,immutableMessageIds:u}}}return null}var g=n(0),h=n(456);function O(e,t){return e&&t?g.__assign({basicEntity:e},{name:t.name,phone:t.phone}):null}function E(e,t,n){if(e&&t){var r=void 0;if(t.reservationId)r=t.reservationId;else if(t.reservationNumber)r=t.reservationNumber;else if(!n)return null;var a=t.underName,i=g.__assign({},e,{reservationId:r,reservationStatus:t.reservationStatus,modifyReservationUrl:t.modifyReservationUrl,underName:O({},a)}),o=t.reservedTicket;if(o){var c=o.ticketSeat;i=g.__assign({},i,{reservedTicket:{ticketNumber:o.ticketNumber,seat:{row:c?c.seatRow:null,seatNumber:c?c.seatNumber:null,section:c?c.seatSection:null}}})}return i}return null}function j(e,t){return e&&t?g.__assign({},e,{streetAddress:t.streetAddress,addressLocality:t.addressLocality,addressRegion:t.addressRegion,addressCountry:t.addressCountry,postalCode:t.postalCode,postOfficeBoxNumber:t.postOfficeBoxNumber}):null}function R(e){var t=j({},e.reservationFor.address);return{name:e.reservationFor.name,address:t,telephone:e.reservationFor.telephone,city:e.reservationFor.city}}function T(e,t){if(e&&t){var n=g.__assign({},e,{name:t.name,telephone:t.telephone,city:t["address/commonCity"]});return t.address&&(n=g.__assign({},n,{address:g.__assign({},t.address)})),n}return null}var C="numSeats";function A(e){var t=0;return e[C]&&e[C]>0&&(t=parseInt(e[C],10)-1),t}function S(e,t){return e&&t?e=T(e=g.__assign({},e,{iataCode:t.iataCode}),t):null}function F(e,t,n){if(e&&t){var r=E(e,t,!1);if(function(e,t,n){if(e&&e.reservationFor&&e.reservationFor.provider){var r=e.reservationFor,a=e.reservationFor.provider,i=!n||n(r.arrivalTime,!1,t)&&n(r.arrivalTimeUTC,!0,t)&&n(r.departureTime,!1,t)&&n(r.departureTimeUTC,!0,t);if(a.iataCode&&a.name&&k(r.arrivalAirport)&&k(r.departureAirport)&&r.flightNumber&&r.arrivalTime&&r.departureTime&&i)return!0}return!1}(t,e,n)){var a=t.reservationFor,i=a.provider;return r=g.__assign({},r,{entityName:p.a.FlightReservation,entityType:h.a.FlightReservation,checkinUrl:t.checkinUrl?t.checkinUrl:t.potentialAction?t.potentialAction.target:null,departureTime:a.departureTime,departureTimeUTC:a["departureTime/utc"],departureTerminal:a.departureTerminal,departureGate:a.departureGate,departureTimeZone:a["departureTime/windowsTimeZoneName"],arrivalTime:a.arrivalTime,arrivalTimeUTC:a["arrivalTime/utc"],arrivalTerminal:a.arrivalTerminal,arrivalGate:a.arrivalGate,arrivalTimeZone:a["arrivalTime/windowsTimeZoneName"],flightNumber:a.flightNumber,airline:{name:i.name,iataCode:i.iataCode}}),r=g.__assign({},r,{departureAirport:S(r,a.departureAirport)}),r=g.__assign({},r,{arrivalAirport:S(r,a.arrivalAirport)})}}return null}function k(e){return!!(e&&e.iataCode&&(e["address/commonCity"]||e.address&&e.address.addressLocality))}function N(e,t){return e&&t?g.__assign({basicEntity:e},{name:t.name,telephone:t.telephone}):null}function D(e){if(e){if(!Array.isArray(e))return e;if(e.length>0)return e[0]}}function w(e,t){return e&&t?g.__assign({},e,{price:t.price,priceCurrency:t.priceCurrency}):null}function P(e,t,n){if(e&&t&&function(e,t,n){if(e){var r=!0,a=!0;n&&(r=n(e.expectedArrivalFrom,!1,t),a=n(e.expectedArrivalUntil,!1,t));var i=D(e.partOfOrder);if(i&&i.seller&&i.seller.name&&(e.expectedArrivalFrom&&r||e.expectedArrivalUntil&&a))return!0}return!1}(t,e,n)){var r=D(t.partOfOrder),a=r.seller,i=g.__assign({},e,{entityName:p.a.ParcelDelivery,entityType:h.a.ParcelDelivery,trackingUrl:t.trackingUrl,trackingNumber:t.trackingNumber,expectedArrivalFrom:t.expectedArrivalFrom,expectedArrivalUntil:t.expectedArrivalUntil,expectedArrivalUntilUtc:t["expectedArrivalUntil/utc"],deliveryAddress:{},partOfOrder:{orderNumber:r.orderNumber,orderStatus:r.orderStatus,seller:{name:a.name,telephone:a.telephone}}});i.provider=N({},t.provider),i.deliveryAddress=j({},t.deliveryAddress);var o=D(t.partOfOrder.orderedItem);return o&&(i.partOfOrder=g.__assign({},i.partOfOrder,{orderedItem:{url:o.url,name:o.name,sku:o.sku,description:o.description,brand:o.brand,color:o.color}})),i}return null}function x(e,t){if(t=D(t),e&&t){var n=g.__assign({},e,{name:t.name,description:t.addressLocality,model:t.model});return t.brand&&(n=g.__assign({},n,{brand:g.__assign({},t.brand)})),n}return null}function M(e,t,n,r,a){if(e){var i=y(e,r);if(i){switch(e["@type"]){case p.a.FlightReservation:i=F(i,e,a);break;case p.a.RentalCarReservation:i=function(e,t,n){if(e&&t&&function(e,t,n){var r=!n||n(e.pickupTime,!1,t)&&n(e.dropoffTime,!1,t);return!!(e.reservationFor&&e.dropoffLocation&&e.pickupLocation&&e.pickupTime&&e.dropoffTime&&r)}(t,e,n)){var r=E(e,t,!0);return r=g.__assign({},r,{entityName:p.a.RentalCarReservation,entityType:h.a.RentalCarReservation,pickupTime:t.pickupTime,pickupTimeUTC:t["pickupTime/utc"],dropoffTime:t.dropoffTime,dropoffTimeUTC:t["dropoffTime/utc"],car:x(r,t.reservationFor),dropoffLocation:T(r,t.dropoffLocation),pickupLocation:T(r,t.pickupLocation),provider:t.provider})}return null}(i,e,a);break;case p.a.ParcelDelivery:i=P(i,e,a);break;case p.a.LodgingReservation:i=function(e,t,n){if(e&&t&&function(e,t,n){if(e){var r=!n||n(e.checkinTime,!1,t)&&n(e.checkoutTime,!1,t);if(e.checkinTime&&e.checkoutTime&&e.reservationFor&&r)return!0}return!1}(t,e,n)){var r=E(e,t,!0),a=D((r=g.__assign({},r,{entityName:p.a.LodgingReservation,entityType:h.a.LodgingReservation,checkinTime:t.checkinTime,checkoutTime:t.checkoutTime,checkinTimeUTC:t["checkinTime/utc"],checkoutTimeUTC:t["checkoutTime/utc"],lodgingBusiness:{}})).lodgingBusiness);return a.address=j({},t.reservationFor.address),a.name=t.reservationFor.name,a.telephone=t.reservationFor.telephone,r}return null}(i,e,a);break;case p.a.FoodReservation:i=function(e,t,n){if(e&&t&&function(e,t,n){var r=!n||n(e.startTime,!1,t);return!!(e&&e.startTime&&e.underName&&e.underName.name&&e.reservationFor&&e.reservationFor.name&&r)}(t,e,n)){var r=E(e,t,!0);return r=g.__assign({},r,{entityName:p.a.FoodReservation,entityType:h.a.FoodReservation,startTime:t.startTime,startTimeUTC:t["startTime/utc"],partySize:Number(t["partySize/excludingOrganizer"]),restaurantInfo:R(t)})}return null}(i,e,a);break;case p.a.EventReservation:i=function(e,t){if(e&&t&&function(e){return!!(e&&e.reservationFor&&e.reservationFor.startDate&&e.underName&&e.underName.name)}(t)){var n=E(e,t,!0),r=t.reservationFor;if(r)return n=g.__assign({},n,{entityName:p.a.EventReservation,entityType:h.a.EventReservation,name:t.underName.name,startDate:r.startDate,startDateUtc:r["startDate/utc"],endDate:r.endDate,endDateUtc:r["endDate/utc"],numSeats:A(t),location:T(n,r.location),eventName:r.name})}return null}(i,e);break;case p.a.Invoice:i=t?function(e,t,n){var r,a,i;return e&&t&&function(e,t,n){var r=!n||n(e.scheduledPaymentDate,!1,t)||n(e.paymentDueDate,!1,t);return!!(e&&(e.accountId||e.accountIdEndsIn)&&e.provider&&e.provider.name&&(e.scheduledPaymentDate||e.paymentDueDate)&&r)}(t,e,n)?g.__assign({},e,{entityName:p.a.Invoice,entityType:h.a.Invoice,accountId:t.accountId,accountIdEndsIn:t["accountId/ending"],billingPeriod:t.billingPeriod,scheduledPaymentDate:t.scheduledPaymentDate,broker:N({},t.broker),category:t.category,customer:t.customer,provider:N({},t.provider),minimumPaymentDue:w({},t.minimumPaymentDue),totalPaymentDue:w({},t.totalPaymentDue),paymentDueDate:t.paymentDueDate,potentialAction:(r={},a=t.potentialAction,i=D(a),r&&i?g.__assign({},r,{url:i.url,description:i.description}):null),paymentStatus:t.paymentStatus}):null}(i,e,a):null;break;case p.a.ServiceReservation:i=n?function(e,t,n){if(e&&t&&function(e,t,n){if(e){var r=e.reservationFor,a=!n||n(r.startTimeFrom,!1,t);if(r&&r.name&&r.startTimeFrom&&a&&r.provider&&r.provider.name)return!0}return!1}(t,e,n)){var r=E(e,t,!0),a=t.reservationFor;return r=g.__assign({},r,{entityName:p.a.ServiceReservation,entityType:h.a.ServiceReservation,startTimeFrom:a.startTimeFrom,startTimeFromUtc:t.reservationFor["startTimeFrom/utc"],endTimeFrom:a.endTimeFrom,endTimeFromUtc:t.reservationFor["endTimeFrom/utc"],name:a.name,underName:O(r,t.underName),provider:O(r,a.provider),location:T({},a.location),confirmReservationUrl:t.confirmReservationUrl,modifyReservationUrl:t.modifyReservationUrl})}return null}(i,e,a):null;break;default:return null}return i}}return null}function L(e,t,n,r,a,o){if(e){var u=void 0,s=void 0;try{s=JSON.parse(e)}catch(e){s=null}if(s)if(u=function(e,t,n,r,a){var i={},o=[];return e&&e.forEach(function(e){var c=M(e,t,n,r,a);if(!c)return null;i[c.id]=c,o.push(c)}),0==Object.keys(i).length?null:{entitiesDictionary:i,entitiesArray:o}}(function(e){var t;if(e){var n=e.filter(function(e){return e.type!=i.TxpActivity}).map(function(e){return e.entities});t=[].concat.apply([],n)}return 0!=t.length?t:null}(s),t,n,a,o)){var d=void 0;if(r)d=function(e){var t;if(e){t=[];for(var n=0;n<e.length;n++){var r=e[n],a=c[r.entityName],o=i[a];o&&t.push(l(r.id,n,o,a))}}return t}(u.entitiesArray);else d=function(e,t){if(e){for(var n=[],r=0;r<e.length;r++){var a=e[r];if(a&&t&&t[a.entityId]){var i=v(a,r);if(!i)return null;n.push(i)}}return 0==n.length?null:n}return null}(((f=s)&&(p=f.filter(function(e){return e.type==i.TxpActivity}).map(function(e){return e.entities})),0!=p[0].length?p[0]:null),u.entitiesDictionary);if(d&&d.length>0)return{txpEntities:u.entitiesDictionary,txpActivities:d}}}var f,p;return null}n.d(t,"a",function(){return L})},1976:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(0),a=n(102),i=n.n(a),o=n(1947),c=n.n(o),u=n(1948),s=n.n(u),d=n(266),l=n.n(d),f=n(6),v=n(27),p=n(28),_=n(145),b=n(1604),I="X-OWA-ExplicitLogonUser",m="X-AnchorMailbox",y=6,g=null;function h(e,t,n,a,o,u){return void 0===n&&(n=Object(p.a)("calendar")),r.__awaiter(this,void 0,void 0,function(){var d,p;return r.__generator(this,function(r){switch(r.label){case 0:return d=null,o?(d={headers:(p={},p[I]=o,p[m]=o,p)},[3,3]):[3,1];case 1:return a?[4,Object(_.b)(a.mailboxInfo)]:[3,3];case 2:d=r.sent(),r.label=3;case 3:return g||(g=Object(b.a)(y)),[2,g.add(function(){return c()({Header:Object(v.getJsonRequestHeader)(),Body:s()({CalendarId:l()({BaseFolderId:i()({Id:n})}),RangeStart:Object(f.mb)(e),RangeEnd:Object(f.mb)(t),IncludeDeclinedMeetings:u})},d).then(function(e){return e.Body})})]}})})}},1987:function(e){e.exports={a:"xLb"}},277:function(e,t,n){"use strict";t.a={EventReservation:"EventReservation",FlightReservation:"FlightReservation",FoodReservation:"FoodEstablishmentReservation",Invoice:"Invoice",LodgingReservation:"LodgingReservation",ParcelDelivery:"ParcelDelivery",RentalCarReservation:"RentalCarReservation",ServiceReservation:"ServiceReservation",UnsuccessfulFlightReservation:"UnsuccessfulFlightReservation",UnsuccessfulLodgingReservation:"UnsuccessfulLodgingReservation",UnsuccessfulRentalCarReservation:"UnsuccessfulRentalCarReservation"}},287:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"f",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"d",function(){return s}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"j",function(){return f}),n.d(t,"k",function(){return v});var r=1,a=2,i=4,o=8,c=16,u=32,s=64,d=128,l=4294967296,f=8589934592,v=17179869184},342:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"f",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return s});var r=n(3),a=(n(1918),n(459));n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return a.b});var i=new r.c(function(){return n.e(151).then(n.bind(null,2976))}),o=new r.b(i,function(e){return e.showNotification}),c=new r.b(i,function(e){return e.showNotificationWithButtonCallback}),u=new r.b(i,function(e){return e.dismissNotification}),s=new r.b(i,function(e){return e.enableNotificationBar})},456:function(e,t,n){"use strict";var r;!function(e){e[e.EventReservation=0]="EventReservation",e[e.FlightReservation=1]="FlightReservation",e[e.FoodReservation=2]="FoodReservation",e[e.Invoice=3]="Invoice",e[e.LodgingReservation=4]="LodgingReservation",e[e.ParcelDelivery=5]="ParcelDelivery",e[e.RentalCarReservation=6]="RentalCarReservation",e[e.ServiceReservation=7]="ServiceReservation",e[e.UnsuccessfulFlightReservation=8]="UnsuccessfulFlightReservation",e[e.UnsuccessfulLodgingReservation=9]="UnsuccessfulLodgingReservation",e[e.UnsuccessfulRentalCarReservation=10]="UnsuccessfulRentalCarReservation"}(r||(r={})),t.a=r},483:function(e,t,n){"use strict";var r=n(0),a=n(42),i=n(6),o=n(80),c=n(5),u=n(63),s=n(1965),d=n(1467),l=n(1468);var f=n(1473);n.d(t,"a",function(){return p}),n.d(t,"b",function(){return b});var v=Object(f.a)();function p(e,t){return t=t||Object(a.e)(),r.__assign({},v,e,{ItemId:e.ItemId?r.__assign({},e.ItemId,{mailboxInfo:t}):e.ItemId,ParentFolderId:e.ParentFolderId?r.__assign({},e.ParentFolderId,{mailboxInfo:t}):e.ParentFolderId,Start:_(e.Start),End:_(e.End),StartTimeZoneId:Object(o.b)(e.StartTimeZoneId),EndTimeZoneId:Object(o.b)(e.EndTimeZoneId),LastModifiedTime:_(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:_(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",TxpObject:e.TailoredXpEntities?(n=e.TailoredXpEntities,i=e.EntityNamesMap,c=Object(d.a)(i),u=Object(l.a)(i),Object(s.a)(n,c,u)):void 0,SeriesMasterItemId:e.SeriesMasterItemId?r.__assign({},e.SeriesMasterItemId,{mailboxInfo:t}):null,Sensitivity:t.type==a.a.GroupMailbox&&"Private"==e.Sensitivity?"Normal":e.Sensitivity});var n,i,c,u}function _(e){if(e){if(Object(c.e)("cal-assumeTzOffsetFromCalendarItem")){var t=Object(u.getConfig)().timezone,n=!!t;return Object(i.Lb)(t,e,n)}return Object(i.lb)(e)}}function b(e){return r.__assign({__type:"CalendarItem:#Exchange"},e,{Start:e.Start&&Object(i.mb)(e.Start),End:e.End&&Object(i.mb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(i.mb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(i.mb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested})}},484:function(e,t,n){"use strict";n.d(t,"w",function(){return r}),n.d(t,"n",function(){return a}),n.d(t,"y",function(){return i}),n.d(t,"z",function(){return o}),n.d(t,"x",function(){return c}),n.d(t,"m",function(){return u}),n.d(t,"v",function(){return s}),n.d(t,"g",function(){return d}),n.d(t,"o",function(){return l}),n.d(t,"p",function(){return f}),n.d(t,"e",function(){return v}),n.d(t,"A",function(){return p}),n.d(t,"r",function(){return _}),n.d(t,"a",function(){return b}),n.d(t,"t",function(){return I}),n.d(t,"c",function(){return m}),n.d(t,"h",function(){return y}),n.d(t,"f",function(){return g}),n.d(t,"B",function(){return h}),n.d(t,"s",function(){return O}),n.d(t,"b",function(){return E}),n.d(t,"u",function(){return j}),n.d(t,"d",function(){return R}),n.d(t,"l",function(){return T}),n.d(t,"i",function(){return C}),n.d(t,"j",function(){return A}),n.d(t,"k",function(){return S}),n.d(t,"q",function(){return F});var r="Sunday",a="Monday",i="Tuesday",o="Wednesday",c="Thursday",u="Friday",s="Saturday",d=[r,a,i,o,c,u,s],l=["January","February","March","April","May","June","July","August","September","October","November","December"],f="None",v="DailyRecurrence",p="WeeklyRecurrence",_="RelativeMonthlyRecurrence",b="AbsoluteMonthlyRecurrence",I="RelativeYearlyRecurrence",m="AbsoluteYearlyRecurrence",y=["None","First","Second","Third","Fourth","Last"],g="DailyRecurrence:#Exchange",h="WeeklyRecurrence:#Exchange",O="RelativeMonthlyRecurrence:#Exchange",E="AbsoluteMonthlyRecurrence:#Exchange",j="RelativeYearlyRecurrence:#Exchange",R="AbsoluteYearlyRecurrence:#Exchange",T="EndDateRecurrence:#Exchange",C=3,A=25,S=1,F=[1,2,3,4,5,6,7,8,9,10]},575:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,a=t%n;return(((e-=r)/n&(t-=a)/n)>>>0)*n+((r&a)>>>0)}return(e&t)>>>0}n.d(t,"a",function(){return r})},609:function(e,t,n){"use strict";var r;!function(e){e[e.TxpActivity=0]="TxpActivity",e[e.Dining=1]="Dining",e[e.EventActivityType=2]="EventActivityType",e[e.FlightDeparture=3]="FlightDeparture",e[e.HotelCheckin=4]="HotelCheckin",e[e.HotelCheckout=5]="HotelCheckout",e[e.InvoiceDue=6]="InvoiceDue",e[e.ParcelDelivery=7]="ParcelDelivery",e[e.RentalCarPickup=8]="RentalCarPickup",e[e.RentalCarDropOff=9]="RentalCarDropOff",e[e.InvoiceScheduled=10]="InvoiceScheduled",e[e.ServiceAppointment=11]="ServiceAppointment"}(r||(r={})),t.a=r},64:function(e,t,n){"use strict";var r=n(93);function a(e){for(var t=[],n=0;n<r.a.DaysInOneWeek;n++)e&1<<n&&t.push(n);return t}n(1570),n(1561),n(1562),n(1552),n(1563);var i=n(1057),o=n(6);function c(e,t,n){return Object(o.Hb)(e,t,n)}n.d(t,"h",function(){return i.g}),n.d(t,"g",function(){return i.f}),n.d(t,"m",function(){return i.k}),n.d(t,"d",function(){return i.c}),n.d(t,"e",function(){return i.d}),n.d(t,"p",function(){return i.n}),n.d(t,"n",function(){return i.l}),n.d(t,"o",function(){return i.m}),n.d(t,"b",function(){return i.a}),n.d(t,"j",function(){return i.h}),n.d(t,"c",function(){return i.b}),n.d(t,"f",function(){return i.e}),n.d(t,"l",function(){return i.j}),n.d(t,"k",function(){return i.i}),n.d(t,"q",function(){return i.o}),n.d(t,"r",function(){return c}),n.d(t,"i",function(){return a}),n.d(t,"a",function(){return r.a})},725:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1432);function a(e){return Object(r.a)(e)&&"Resource"===e.LocationSource}},750:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(6);function a(e,t,n){return Object(r.Kb)(e,Object(r.xb)(t),Object(r.sb)(t),Object(r.hb)(t),Object(r.nb)(n),Object(r.rb)(n),Object(r.tb)(n),Object(r.qb)(n))}},818:function(e){e.exports={a:"Saa"}},861:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(725);function a(e,t){if(null==e&&null!=t||null!=e&&null==t)return!1;if(null==e&&null==t)return!0;if(0==e.length&&0==t.length)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;){if(!i(e[n],t[n]))return!1;n++}return!0}function i(e,t){return!(!e&&t||e&&!t)&&(e.Id===t.Id||Object(r.a)(e.PostalAddress)&&Object(r.a)(t.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.PostalAddress.LocationUri.toLowerCase())}function o(e,t){return e&&Object(r.a)(t.PostalAddress)?c(e,t.PostalAddress.LocationUri):u(e,t.Id)}function c(e,t){return e&&e.some(function(e){return Object(r.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.toLowerCase()})}function u(e,t){return e&&e.some(function(e){return e.Id===t})}},93:function(e,t,n){"use strict";var r=n(48),a={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.b.Sunday,r.b.Monday,r.b.Tuesday,r.b.Wednesday,r.b.Thursday,r.b.Friday,r.b.Saturday]};t.a=a}}]);
//# sourceMappingURL=owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2.js.map
self.scriptsLoaded['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2.js'] = (new Date()).getTime();