self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GetItemManager.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[231],{12772:function(e,t,r){"use strict";r.r(t);var n=r(6147);r.d(t,"getAdditionalPropertiesFromServer",function(){return n.b}),r.d(t,"getItemProperties",function(){return n.c}),r.d(t,"cleanUpByItemId",function(){return n.a})},13900:function(e,t,r){"use strict";r.r(t);var n=r(6147),i=r(7805),o=r(7804),a=r(7806),s=r(7807),u=r(8209);function c(){Object(n.d)([i.c,o.b,a.a,s.b,u.c])}r.d(t,"initializeGetItemManagerForRP",function(){return c})},6058:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(42);function i(e){return e&&e.MailboxInfo&&e.MailboxInfo.type==n.a.GroupMailbox}},6147:function(e,t,r){"use strict";var n=r(0);var i=r(1),o=r(29),a=Object(i.mutatorAction)("updateItemInStore",function(e,t){var r=o.H.items.get(e);r&&Object.keys(t).forEach(function(e){"ExtendedProperty"==e?r.ExtendedProperty=n.__spread(t.ExtendedProperty,r.ExtendedProperty):r[e]=t[e]})}),s=r(904),u=r(903),c=r(142),d=r(453),m=r.n(d);r.d(t,"d",function(){return p}),r.d(t,"b",function(){return g}),r.d(t,"c",function(){return I}),r.d(t,"a",function(){return P});var f={},l={};function p(e){e.forEach(function(e){l[e.featureId]=e})}function g(e,t){if(!f[e]||"Pending"!=f[e].requestStatus){var r=function(e,t){var r=[];if(Object.keys(l).forEach(function(i){var o=l[i],a=o.isPropertyExistedOnItem,s=o.shouldGetItemPropertiesFromServer,u=o.propertyPaths;!a(e)&&s(e,t)&&r.push.apply(r,n.__spread(u))}),r.length>0)return m()({BaseShape:"IdOnly",AdditionalProperties:r});return null}(e,t);if(r){var i={itemId:e,listViewType:t,requestStatus:"Pending",pendingPromise:null};f[e]=i;var o=c.a.items.get(e),d=o.MailboxInfo&&o.MailboxInfo.requestOptions;i.pendingPromise=Object(s.a)([e],r,null,null,d).then(function(t){if(t&&Object(u.a)(t[0])){i.requestStatus="Success";var r=t[0];return a(e,r.Items[0]),Promise.resolve(c.a.items.get(e))}var o=n.__read(function(e){return e&&"Success"!=e.ResponseClass?[e.ResponseCode,e.StackTrace]:[null,null]}(t[0]),2),s=o[0],d=o[1];return i.requestStatus="Error",Promise.reject(new Error("GetItem failed ErrorResponseCode="+s+", StackTrace="+d))}).catch(function(e){return i.requestStatus="Error",Promise.reject(e)})}}}function I(e,t){var r=l[t];if(!r)return Promise.reject("GetItemManager: The featureId is not registered in GetItemManager.");if(r.isPropertyExistedOnItem(e))return Promise.resolve(c.a.items.get(e));if(!f[e])return Promise.reject("GetItemManager: Please trigger getItem after the container finished loading.");var n=f[e];switch(n.requestStatus){case"Success":return Promise.resolve(c.a.items.get(e));case"Pending":case"Error":return n.pendingPromise;default:return Promise.reject("GetItemManager: The request status is unknown.")}}function P(e){delete f[e]}},7804:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"c",function(){return s});var n=r(5),i=r(142),o=r(223),a="EntityExtraction/ExtractLanguage1.0",s="InlineTranslationLocale",u=r.n(o)()({PropertyName:a,DistinguishedPropertySetId:"Common",PropertyType:"String"}),c={featureId:s,propertyPaths:[u],isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return t&&t.TranslationData&&null!=t.TranslationData.itemLocale},shouldGetItemPropertiesFromServer:function(e,t){return!(!Object(n.e)("rp-inlineTranslation")||0!=t||i.a.items.get(e).RightsManagementLicenseData)}};t.b=c},7805:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return u}),r.d(t,"d",function(){return c});var n=r(5),i=r(142),o=r(223),a=r.n(o),s="TranslationData",u="TranslationStatus",c="InlineTranslationDataAndStatus",d=[a()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),a()({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"})],m={featureId:c,propertyPaths:d,isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return t&&t.TranslationData&&null!=t.TranslationData.userLanguage},shouldGetItemPropertiesFromServer:function(e,t){return!(!Object(n.e)("rp-inlineTranslation")||!Object(n.e)("tra-cacheTranslation")||0!=t||i.a.items.get(e).RightsManagementLicenseData)}};t.c=m},7806:function(e,t,r){"use strict";r.d(t,"b",function(){return s});var n=r(6058),i=r(5),o=r(142),a=r(65),s="UserHighlight",u=r.n(a)()({FieldURI:"UserHighlightData"}),c={featureId:s,propertyPaths:[u],isPropertyExistedOnItem:function(e){var t=o.a.items.get(e);return t&&null!=t.userHighlightData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.e)("mc-userHighlighting"))return!1;var r=o.a.items.get(e);return r&&!Object(n.a)(r)}};t.a=c},7807:function(e,t,r){"use strict";r.d(t,"c",function(){return s}),r.d(t,"a",function(){return u});var n=r(6058),i=r(5),o=r(142),a=r(4582),s="UserNote",u="UserNoteData",c={featureId:s,propertyPaths:[a.g],isPropertyExistedOnItem:function(e){var t=o.a.items.get(e);return t&&null!=t.userNoteData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.e)("rp-userMarkup"))return!1;var r=o.a.items.get(e);return r&&!Object(n.a)(r)}};t.b=c},8209:function(e,t,r){"use strict";var n=r(142);var i=r(2562),o=r(223),a=r.n(o);r.d(t,"a",function(){return s}),r.d(t,"b",function(){return u}),r.d(t,"d",function(){return c});var s="EntityExtraction/Conversation",u="EntityExtraction/ConversationTest",c="YammerThread",d=[a()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),a()({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"})],m={featureId:c,propertyPaths:d,isPropertyExistedOnItem:function(e){var t=n.a.items.get(e);return t&&null!=t.YammerThreadId},shouldGetItemPropertiesFromServer:function(e,t){var r=n.a.items.get(e);return r&&Object(i.a)(r)&&(1==t||0==t&&function(e){var t=n.a.items.get(e);if(!t||!t.ConversationId||!t.ConversationId.Id)return!1;var r=t.ConversationId.Id,i=n.a.conversations.get(r);if(!i||!i.conversationNodeIds||0==i.conversationNodeIds.length)return!1;var o=i.conversationNodeIds,a=o["ChronologicalNewestOnBottom"==i.conversationSortOrder?0:o.length-1],s=n.a.conversationNodes.get(a);return s&&s.itemIds&&s.itemIds.length>0&&s.itemIds.includes(e)}(e))}};t.c=m}},0,[486,98,70,110,499,171]]);
//# sourceMappingURL=owa.GetItemManager.js.map
self.scriptsLoaded['owa.GetItemManager.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GetItemManager.js'] = (new Date()).getTime();