self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ActivityFeed.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[97],{10053:function(e,t,n){var r=n(10054),i=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},10054:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'.HCOSg_D2jVGvylMh5ecLq{font-size:16px;color:"[theme:neutralSecondary, default:#666666]"}._2bKgt8mWgc3UzQhqpi0cvz{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;font-size:8px;height:100%;color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={icon:"HCOSg_D2jVGvylMh5ecLq",unreadMarker:"_2bKgt8mWgc3UzQhqpi0cvz"}},10055:function(e){e.exports={a:"Zpb"}},10056:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'._1S_hVW7_Of9lp_Mue2xeYJ{-ms-overflow-style:-ms-autohiding-scrollbar;scrollbar-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]" transparent;scrollbar-width:thin;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow-y:auto}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar{height:18px;width:18px}._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar:disabled{display:none}._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button,._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-corner{cursor:pointer}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-corner{background:transparent}._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:decrement,._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:decrement:hover,._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:increment,._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:increment:hover,._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:decrement,._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:decrement:hover,._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:increment,._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:increment:hover{height:18px;width:18px}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:decrement,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:increment,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:decrement,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:increment,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-button:vertical:increment:hover{background-position:50%}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-track{background:transparent}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-thumb,html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-thumb:hover{border-radius:9px;border:solid 6px transparent;background-clip:content-box}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-thumb{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-thumb:hover{background-color:#98a3a6}._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-thumb:vertical{min-height:50px}._1S_hVW7_Of9lp_Mue2xeYJ::-webkit-scrollbar-thumb:horizontal{min-width:50px}._1l2ZyDqkKC2U_ok2_Ri4o-{display:-webkit-box;display:-ms-flexbox;display:flex}html[dir] ._1l2ZyDqkKC2U_ok2_Ri4o-{margin-bottom:12px}.ZSCJ5xq5YZB6pFIfWZgWo{font-size:14px}html[dir=ltr] .ZSCJ5xq5YZB6pFIfWZgWo{margin-left:auto}html[dir=rtl] .ZSCJ5xq5YZB6pFIfWZgWo{margin-right:auto}._31-1mIFPCikX2AZ4jcF5kx{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100% - 16px);-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column;flex-flow:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:relative}._31-1mIFPCikX2AZ4jcF5kx,._31-1mIFPCikX2AZ4jcF5kx ._18LHON7lWPXmY2jG0768RA{-ms-flex-item-align:center;align-self:center}._31-1mIFPCikX2AZ4jcF5kx ._18LHON7lWPXmY2jG0768RA{max-width:100%}._31-1mIFPCikX2AZ4jcF5kx ._2WrpNe4zCjEFOmfAbFiBt6{width:100%;color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._31-1mIFPCikX2AZ4jcF5kx ._2WrpNe4zCjEFOmfAbFiBt6{text-align:center}._31-1mIFPCikX2AZ4jcF5kx ._1OXotNuiO-Vdn5yv-77462{width:100%;font-size:18px;font-weight:600}html[dir] ._31-1mIFPCikX2AZ4jcF5kx ._1OXotNuiO-Vdn5yv-77462{text-align:center;margin-top:12px}._3TDCTCIEBZkWU0fb7ln2Nj{position:relative;cursor:pointer;max-width:288px}html[dir] ._3TDCTCIEBZkWU0fb7ln2Nj{border-radius:2px;margin-top:8px;-webkit-transition:-webkit-box-shadow .2s ease-in-out;transition:-webkit-box-shadow .2s ease-in-out;transition:box-shadow .2s ease-in-out;transition:box-shadow .2s ease-in-out,-webkit-box-shadow .2s ease-in-out}html[dir] ._3TDCTCIEBZkWU0fb7ln2Nj:first-of-type{margin-top:0}html[dir] ._3TDCTCIEBZkWU0fb7ln2Nj .ac-container.ac-selectable:hover{background:none!important}html[dir] ._2lNexCMsjMvfzLF39jpfi6{background-color:none}html[dir] ._2lNexCMsjMvfzLF39jpfi6:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._1AGlo4GMSKJxa4BNxoXvYD{background-color:"[theme:white, default:#ffffff]"}html[dir] ._1AGlo4GMSKJxa4BNxoXvYD,html[dir] ._1AGlo4GMSKJxa4BNxoXvYD:hover{-webkit-box-shadow:0 1px 2px -.4px "[theme:blackTranslucent10, default:rgba(0, 0, 0, .1)]";box-shadow:0 1px 2px -.4px "[theme:blackTranslucent10, default:rgba(0, 0, 0, .1)]"}html[dir] ._1AGlo4GMSKJxa4BNxoXvYD:hover{background-color:"[theme:neutralLighterAlt, default:#f8f8f8]"}._1kCL21sIe7YYufpKrohHvr{display:none;position:absolute;top:0;color:"[theme:neutralSecondary, default:#666666]"}html[dir=ltr] ._1kCL21sIe7YYufpKrohHvr{right:0}html[dir=rtl] ._1kCL21sIe7YYufpKrohHvr{left:0}._1kCL21sIe7YYufpKrohHvr:hover{color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._1kCL21sIe7YYufpKrohHvr:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1kCL21sIe7YYufpKrohHvr:active{color:"[theme:neutralDark, default:#212121]"}html[dir] ._1kCL21sIe7YYufpKrohHvr:active{background:"[theme:neutralLight, default:#eaeaea]"}._3TDCTCIEBZkWU0fb7ln2Nj:hover ._1kCL21sIe7YYufpKrohHvr{display:block}',""]),t.locals={feed:"_1S_hVW7_Of9lp_Mue2xeYJ",header:"_1l2ZyDqkKC2U_ok2_Ri4o-",clearAll:"ZSCJ5xq5YZB6pFIfWZgWo",emptyState:"_31-1mIFPCikX2AZ4jcF5kx",emptyIcon:"_18LHON7lWPXmY2jG0768RA",emptyText:"_2WrpNe4zCjEFOmfAbFiBt6",emptyBoldText:"_1OXotNuiO-Vdn5yv-77462",feedItem:"_3TDCTCIEBZkWU0fb7ln2Nj",feedItemSeen:"_2lNexCMsjMvfzLF39jpfi6",feedItemUnseen:"_1AGlo4GMSKJxa4BNxoXvYD",itemDismiss:"_1kCL21sIe7YYufpKrohHvr"}},10057:function(e){e.exports={a:"Vpb",d:"Wpb",c:"Xpb",b:"Ypb"}},10058:function(e,t,n){e.exports=n.p+"../resources/images/EmptyIllustration-c1bf49c43c40b275a1de765657894875.svg"},1783:function(e,t,n){"use strict";function r(e){if(!e)return e;var t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-")}function i(e){if(!e)return e;var t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/")}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})},2342:function(e,t,n){"use strict";n.r(t);var r,i=n(0),o=n(1),a=Object(o.action)("LOAD_ACTIVITY_FEED",function(){return{}}),l=n(4438);!function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention"}(r||(r={}));var s=Object(o.mutatorAction)("ACTIVITY_FEED_LOADED",function(e){var t=Object(l.a)();t.firstFetchComplete=!0,e&&(t.items.clear(),e.filter(c).forEach(function(e){t.items.set(e.id,{type:e.type,payload:JSON.parse(e.activityFeedItemPayload),id:e.id,version:e.version,expiry:e.expiry,isSeen:e.isSeen,isRead:e.isRead,isDismissed:e.isDismissed,priority:e.priority,timeOfAction:e.timeOfAction,aggregationKey:e.aggregationKey,timestamp:e.timestamp})}))});function c(e){if(null==e.type||null==e.type)return!1;switch(e.type){case r.Like:case r.AtMention:return!0;default:return!1}}var u=n(67),d=Object(o.action)("ACTIVITY_FEED_ITEMS_SEEN",function(e){return{itemIds:e}});Object(o.orchestrator)(a,function(){return i.__awaiter(void 0,void 0,void 0,function(){var e,t;return i.__generator(this,function(n){switch(n.label){case 0:return[4,Object(u.b)("ows/beta/ActivityFeed")];case 1:return e=n.sent(),s(e),!0===Object(l.a)().isActivityFeedOpen&&(t=i.__spread(Object(l.a)().items.values()),d(t.filter(function(e){return!e.isSeen}).map(function(e){return e.id}))),[2]}})})});var A=Object(o.action)("ACTIVITY_FEED_ITEM_ACTION",function(e){return{itemId:e}}),m="ows/beta/ActivityFeed/MarkItemsAsRead";Object(o.orchestrator)(A,function(e){!function(e){i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){return 0===e.length?[2]:(Object(u.e)(m,e),[2])})})}([e.itemId])}),Object(o.mutator)(A,function(e){var t=e.itemId,n=Object(l.a)().items;n.has(t)&&(n.get(t).isRead=!0)});var p="ows/beta/ActivityFeed/MarkItemsAsSeen";Object(o.mutator)(d,function(e){!function(e){i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){return 0===e.length?[2]:(Object(u.e)(p,e),[2])})})}(e.itemIds)});var b=n(5),h=Object(o.action)("APPLY_ACTIVITY_FEED_OPTIONS"),f=n(214);function _(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return[4,f.e.import()];case 1:return[4,t.sent()(f.a.MentionEventNotifications)];case 2:if(null===(e=t.sent()))throw new Error("Failed to load options.");return[2,e]}})})}function g(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return[4,f.e.import()];case 1:return[4,t.sent()(f.a.TxpEventNotifications)];case 2:if(null===(e=t.sent()))throw new Error("Failed to load options.");return[2,e]}})})}function v(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,f.d.importAndExecute(f.a.MentionEventNotifications,e).catch(function(e){return null})];case 1:return t.sent(),[2]}})})}function x(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,f.d.importAndExecute(f.a.TxpEventNotifications,e).catch(function(e){return null})];case 1:return t.sent(),[2]}})})}Object(o.orchestrator)(h,function(){!function(){i.__awaiter(this,void 0,void 0,function(){var e,t;return i.__generator(this,function(n){switch(n.label){case 0:return[4,_()];case 1:return e=n.sent(),(t=Object(b.e)("auth-activityFeedAtMentionsProcessor"))&&!e.enabled?(e.enabled=!0,v(e)):!t&&e.enabled&&(e.enabled=!1,v(e)),[2]}})})}(),function(){i.__awaiter(this,void 0,void 0,function(){var e,t;return i.__generator(this,function(n){switch(n.label){case 0:return[4,g()];case 1:return e=n.sent(),(t=Object(b.e)("auth-activityFeedTxpProcessor"))&&!e.enabled?(e.enabled=!0,x(e)):!t&&e.enabled&&(e.enabled=!1,x(e)),[2]}})})}()}),Object(o.mutator)(d,function(e){var t=e.itemIds,n=Object(l.a)();t.forEach(function(e){n.items.get(e).isSeen=!0})});var y=Object(o.action)("ACTIVITY_FEED_ITEM_DISMISS",function(e){return{itemId:e}}),k=Object(o.action)("ACTIVITY_FEED_DISMISS_ALL",function(){return{itemIds:i.__spread(Object(l.a)().items.values()).map(function(e){return e.id})}}),O="ows/beta/ActivityFeed/MarkItemsAsDismissed";function w(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){return 0===e.length?[2]:(Object(u.e)(O,e),[2])})})}Object(o.orchestrator)(y,function(e){w([e.itemId])}),Object(o.orchestrator)(k,function(e){w(e.itemIds)}),Object(o.mutator)(y,function(e){var t=e.itemId;Object(l.a)().items.delete(t)}),Object(o.mutator)(k,function(){Object(l.a)().items.clear()});var M=n(3442),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.getJsonTypeName=function(){return"Action.OpenMail"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId},t}(M.Action),C=n(2),E=n(1082),I=n(14),j=n(62),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"className",{get:function(){return""},enumerable:!0,configurable:!0}),t.prototype.internalRender=function(){return this.elementHost=document.createElement("div"),this.elementHost.className=this.className,j.render(this.renderComponent(),this.elementHost),this.elementHost},t.prototype.remove=function(){return this.elementHost&&(j.unmountComponentAtNode(this.elementHost),this.elementHost=null),e.prototype.remove.call(this)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.parseInternal(t)},t}(M.CardElement),Y=n(10053),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.renderComponent=function(){return C.createElement(E.a,{emailAddress:this.emailAddress,name:this.name,size:I.c.size28})},Object.defineProperty(t.prototype,"className",{get:function(){return Y.icon},enumerable:!0,configurable:!0}),t.prototype.getJsonTypeName=function(){return"ActivityPersona"},t.prototype.renderSpeech=function(){return""},t.prototype.parseInternal=function(e){this.emailAddress=e.emailAddress,this.name=e.name},t}(T),F=function(){Object(b.e)("auth-activityFeed")&&(M.AdaptiveCard.actionTypeRegistry.registerType("Action.OpenMail",function(){return new S}),M.AdaptiveCard.elementTypeRegistry.registerType("ActivityPersona",function(){return new B}),h(),a())},W=n(124),V=n(1560),N=n(4),J=n(10055),U=n(7084),D=n(115).bind(U),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.createCard=function(){var e=new M.AdaptiveCard,n=Object(W.d)(),r=t.props,i=r.itemId,o=r.json,a=r.onAction;return e.hostConfig=new M.HostConfig({fontFamily:"Segoe UI, Helvetica Neue, sans-serif",containerStyles:{default:{foregroundColors:{default:{default:n.black,subtle:n.neutralSecondary},accent:{default:n.themePrimary}}}},fontSizes:{small:12,default:14},fontWeights:{bolder:600}}),e.onExecuteAction=function(e){return a(i,e)},e.parse(o),e},t.onDismissItem=function(){y(t.props.itemId)},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.container&&this.container.appendChild(this.createCard().render())},t.prototype.render=function(){var e=this;return C.createElement("div",{className:D(U.feedItem,this.props.isSeen?U.feedItemSeen:U.feedItemUnseen)},C.createElement(V.a,{className:U.itemDismiss,iconProps:{iconName:"Clear"},onClick:this.onDismissItem,title:Object(N.a)(J.a),ariaLabel:Object(N.a)(J.a)}),C.createElement("div",{className:U.adaptiveContent,ref:function(t){return e.container=t}}))},t}(C.Component),G=n(10057),R=n(6),H=n(1783),z=function(e){switch(e.type){case r.Like:return K(e);case r.AtMention:return X(e);case r.GroupMention:case r.MeMention:case r.FileMention:case r.GroupAtAllMention:case r.Unknown:return P()}return function(){throw new Error}()},P=function(){return{}};function Z(e){return 1==e.payload.Actors.length?Object(N.b)(Object(N.a)(G.a),e.payload.Actors[0].EmailAddress.Name,e.payload.TargetSubject):2==e.payload.Actors.length?Object(N.b)(Object(N.a)(G.d),e.payload.Actors[0].EmailAddress.Name,e.payload.TargetSubject):e.payload.Actors.length>2?Object(N.b)(Object(N.a)(G.c),e.payload.Actors[0].EmailAddress.Name,e.payload.Actors.length-1,e.payload.TargetSubject):""}var Q=function(e){return{type:"AdaptiveCard",body:[{type:"Container",items:[{type:"ColumnSet",columns:[{type:"Column",items:[{type:"ActivityPersona",emailAddress:e.emailAddress,name:e.name}],width:"28px"},{type:"Column",items:[{type:"TextBlock",horizontalAlignment:"Left",text:e.bodyText,wrap:!0,maxLines:2}],width:"Auto"},{type:"Column",items:[],width:"16px"}]},{type:"ColumnSet",columns:[{type:"Column",items:[],width:"28px"},{type:"Column",items:[{type:"TextBlock",horizontalAlignment:"Left",text:""+Object(R.I)(Object(R.n)(e.timestamp)),wrap:!0,maxLines:2,isSubtle:!0,weight:"Bolder",size:"Small"}],width:"Auto"}]}]}],selectAction:e.selectAction,$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.0"}},K=function(e){return Q({emailAddress:e.payload.Actors[0].EmailAddress.EmailAddress,name:e.payload.Actors[0].EmailAddress.Name,bodyText:Z(e),timestamp:new Date(e.payload.LatestTimestamp),selectAction:{type:"Action.OpenMail",itemId:""+e.payload.TargetItemId}})},X=function(e){return Q({emailAddress:e.payload.Actor.EmailAddress.EmailAddress,name:e.payload.Actor.EmailAddress.Name,bodyText:Object(N.b)(Object(N.a)(G.b),e.payload.Actor.EmailAddress.Name,e.payload.Subject),timestamp:new Date(e.timestamp),selectAction:{type:"Action.OpenMail",itemId:Object(H.b)(e.payload.MessageId)}})},q=n(7085),$=n(10058),ee=n(7084);function te(){return C.createElement("div",{className:ee.emptyState},C.createElement("img",{className:ee.emptyIcon,src:$,role:"presentation"}),C.createElement("div",{className:ee.emptyBoldText},Object(N.a)(q.c)),C.createElement("div",{className:ee.emptyText},Object(N.a)(q.b)))}var ne=n(2869),re=n(7084);function ie(e){var t=0===e.cards.length,n=t?C.createElement(te,null):e.cards.map(function(t){return C.createElement(L,{key:t.id,isSeen:t.isSeen,itemId:t.id,json:z(t),onAction:e.onAction})});return C.createElement(C.Fragment,null,C.createElement("div",{className:re.header},C.createElement(ne.a,{className:re.clearAll,disabled:t,onClick:e.onDismissAll},Object(N.a)(q.a))),C.createElement("div",{className:re.feed},n))}var oe=n(1640),ae=n(211),le=n(18),se=n(15),ce=n(86),ue=Object(o.mutatorAction)("TOGGLE_ACTIVITY_FEED",function(e){Object(l.a)().isActivityFeedOpen=e}),de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAction=function(e,n){A(e);var r=Object(l.a)().items.get(e);switch(Object(se.o)("ActivityFeed_ActionClicked",{sessionId:t.sessionId,action:n.getJsonTypeName(),itemId:e,itemType:r.type,itemRead:r.isRead,itemSeen:r.isSeen}),n.getJsonTypeName()){case"Action.OpenMail":t.props.actions.openMail(n.itemId)}},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.sessionId=Object(ce.a)(),ue(!0);var e=i.__spread(Object(l.a)().items.values());Object(se.o)("ActivityFeed_Loaded",this.createSummary(e)),a()},t.prototype.componentWillUnmount=function(){ue(!1),Object(se.o)("ActivityFeed_Unloaded",{sessionId:this.sessionId})},t.prototype.createSummary=function(e){var t={sessionId:this.sessionId,unseen:0,total:e.length};return e.forEach(function(e){var n=e.type;n in t||(t[n]=0),t[n]+=1,t.unseen+=e.isSeen?0:1}),t},t.prototype.render=function(){var e=Object(l.a)(),t=e.firstFetchComplete,n=e.items;return t?C.createElement(ie,{cards:i.__spread(n.values()),onAction:this.handleAction,onDismissAll:k}):C.createElement(oe.a,{size:ae.a.large})},t=i.__decorate([le.observer,Object(se.l)("ActivityFeed")],t)}(C.Component);n.d(t,"initializeActivityFeed",function(){return F}),n.d(t,"ActivityFeed",function(){return de})},2869:function(e,t,n){"use strict";var r=n(1707),i=n(0),o=n(2),a=n(1392),l=n(352),s=n(873),c=Object(a.a)(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._link=o.createRef(),t._onClick=function(e){var n=t.props,r=n.onClick;n.disabled?e.preventDefault():r&&r(e)},t}return i.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.disabled,r=t.children,a=t.className,l=t.href,u=t.theme,d=t.styles,A=t.keytipProps,m=c(d,{className:a,isButton:!l,isDisabled:n,theme:u}),p=this._getRootType(this.props);return o.createElement(s.a,{keytipProps:A,ariaDescribedBy:this.props["aria-describedby"],disabled:n},function(t){return o.createElement(p,i.__assign({},t,e._adjustPropsForRootType(p,e.props),{className:m.root,onClick:e._onClick,ref:e._link,"aria-disabled":n}),r)})},t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()},t.prototype._adjustPropsForRootType=function(e,t){t.children,t.as;var n=t.disabled,r=t.target,o=t.href,a=(t.theme,t.getStyles,t.styles,t.componentRef,i.__rest(t,["children","as","disabled","target","href","theme","getStyles","styles","componentRef"]));return"string"==typeof e?"a"===e?i.__assign({target:r,href:n?void 0:o},a):"button"===e?i.__assign({type:"button",disabled:n},a):i.__assign({},a,{disabled:n}):i.__assign({target:r,href:o,disabled:n},a)},t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"},t}(l.a),d=n(17),A={root:"ms-Link"};n.d(t,"a",function(){return m});var m=Object(r.a)(u,function(e){var t,n,r,i=e.className,o=e.isButton,a=e.isDisabled,l=e.theme,s=l.semanticColors,c=s.link,u=s.linkHovered,m=s.disabledText,p=s.focusBorder,b=Object(d.getGlobalClassNames)(A,l);return{root:[b.root,l.fonts.medium,{color:c,outline:"none",fontSize:"inherit",fontWeight:"inherit",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+p+" inset",selectors:(n={},n[d.HighContrastSelector]={outline:"1px solid WindowText"},n)}},t[d.HighContrastSelector]={borderBottom:"none"},t)},o&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(r={},r[d.HighContrastSelectorBlack]={color:"#FFFF00"},r[d.HighContrastSelectorWhite]={color:"#00009F"},r)},!o&&{textDecoration:"none"},a&&["is-disabled",{color:m,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!a&&{selectors:{"&:active, &:hover, &:active:hover":{color:u,textDecoration:"underline"},"&:focus":{color:c}}},b.root,i]}},void 0,{scope:"Link"})},4438:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),i=n(7),o=Object(r.createStore)("activityFeedStore",{firstFetchComplete:!1,isActivityFeedOpen:!1,items:new i.ObservableMap})},7084:function(e,t,n){var r=n(10056),i=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},7085:function(e){e.exports={a:"Spb",c:"Tpb",b:"Upb"}}},0,[486,98,70,110]]);
//# sourceMappingURL=owa.ActivityFeed.js.map
self.scriptsLoaded['owa.ActivityFeed.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ActivityFeed.js'] = (new Date()).getTime();