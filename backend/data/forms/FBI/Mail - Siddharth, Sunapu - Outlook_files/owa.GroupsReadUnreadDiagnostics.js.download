self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GroupsReadUnreadDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[256],{12436:function(e,t,o){var n=o(12437),i=o(37);"string"==typeof n&&(n=[[e.i,n]]);for(var r=0;r<n.length;r++)i.loadStyles(n[r][1],!1);n.locals&&(e.exports=n.locals)},12437:function(e,t,o){(t=e.exports=o(36)(!1)).push([e.i,"._3n-f8Ap1Kc2GX9G5WkichB{font-weight:600;font-size:12px}html[dir=ltr] ._3n-f8Ap1Kc2GX9G5WkichB{padding:15px 0 10px 10px}html[dir=rtl] ._3n-f8Ap1Kc2GX9G5WkichB{padding:15px 10px 10px 0}html[dir=ltr] ._3FcKFiEljg6x-owcifZQA5{padding-left:15px}html[dir=rtl] ._3FcKFiEljg6x-owcifZQA5{padding-right:15px}",""]),t.locals={groupSectionHeader:"_3n-f8Ap1Kc2GX9G5WkichB",detailsList:"_3FcKFiEljg6x-owcifZQA5"}},1631:function(e,t,o){"use strict";o.d(t,"a",function(){return a});var n=o(17),i=o(362),r={root:"ms-Check",circle:"ms-Check-circle",check:"ms-Check-check"},a=function(e){var t,o,a,s,c=e.checkBoxHeight,l=void 0===c?"18px":c,u=e.checked,d=e.className,p=e.theme,h=p.palette,f=p.semanticColors,m=Object(i.a)(),g=Object(n.getGlobalClassNames)(r,p),b={fontSize:l,position:"absolute",left:0,top:0,width:l,height:l,textAlign:"center",verticalAlign:"middle"};return{root:[g.root,p.fonts.medium,{lineHeight:"1",width:l,height:l,verticalAlign:"top",position:"relative",userSelect:"none",selectors:{":before":{content:'""',position:"absolute",top:"1px",right:"1px",bottom:"1px",left:"1px",borderRadius:"50%",opacity:1,background:f.bodyBackground},"$checkHost:hover &, $checkHost:focus &, &:hover, &:focus":{opacity:1}}},u&&["is-checked",{selectors:{":before":{background:h.themePrimary,opacity:1,selectors:(t={},t[n.HighContrastSelector]={background:"Window"},t)}}}],d],circle:[g.circle,b,{color:h.neutralSecondary,selectors:(o={},o[n.HighContrastSelector]={color:"WindowText"},o)},u&&{color:h.white}],check:[g.check,b,{opacity:0,color:h.neutralSecondary,fontSize:"16px",left:m?"-0.5px":".5px",selectors:(a={":hover":{opacity:1}},a[n.HighContrastSelector]={MsHighContrastAdjust:"none"},a)},u&&{opacity:1,color:h.white,fontWeight:900,selectors:(s={},s[n.HighContrastSelector]={border:"none",color:"WindowText"},s)}],checkHost:[{}]}}},2457:function(e,t,o){"use strict";var n=o(1707),i=o(0),r=o(2),a=o(394),s=o(1392),c=Object(s.a)(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.checked,o=e.className,n=e.theme,i=e.styles,s=c(i,{theme:n,className:o,checked:t});return r.createElement("div",{className:s.root},r.createElement(a.a,{iconName:"CircleRing",className:s.circle}),r.createElement(a.a,{iconName:"StatusCircleCheckmark",className:s.check}))},t.defaultProps={checked:!1},t}(r.Component),u=o(1631);o.d(t,"a",function(){return d});var d=Object(n.a)(l,u.a,void 0,{scope:"Check"},!0)},2869:function(e,t,o){"use strict";var n=o(1707),i=o(0),r=o(2),a=o(1392),s=o(352),c=o(873),l=Object(a.a)(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._link=r.createRef(),t._onClick=function(e){var o=t.props,n=o.onClick;o.disabled?e.preventDefault():n&&n(e)},t}return i.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.disabled,n=t.children,a=t.className,s=t.href,u=t.theme,d=t.styles,p=t.keytipProps,h=l(d,{className:a,isButton:!s,isDisabled:o,theme:u}),f=this._getRootType(this.props);return r.createElement(c.a,{keytipProps:p,ariaDescribedBy:this.props["aria-describedby"],disabled:o},function(t){return r.createElement(f,i.__assign({},t,e._adjustPropsForRootType(f,e.props),{className:h.root,onClick:e._onClick,ref:e._link,"aria-disabled":o}),n)})},t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()},t.prototype._adjustPropsForRootType=function(e,t){t.children,t.as;var o=t.disabled,n=t.target,r=t.href,a=(t.theme,t.getStyles,t.styles,t.componentRef,i.__rest(t,["children","as","disabled","target","href","theme","getStyles","styles","componentRef"]));return"string"==typeof e?"a"===e?i.__assign({target:n,href:o?void 0:r},a):"button"===e?i.__assign({type:"button",disabled:o},a):i.__assign({},a,{disabled:o}):i.__assign({target:n,href:r,disabled:o},a)},t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"},t}(s.a),d=o(17),p={root:"ms-Link"};o.d(t,"a",function(){return h});var h=Object(n.a)(u,function(e){var t,o,n,i=e.className,r=e.isButton,a=e.isDisabled,s=e.theme,c=s.semanticColors,l=c.link,u=c.linkHovered,h=c.disabledText,f=c.focusBorder,m=Object(d.getGlobalClassNames)(p,s);return{root:[m.root,s.fonts.medium,{color:l,outline:"none",fontSize:"inherit",fontWeight:"inherit",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+f+" inset",selectors:(o={},o[d.HighContrastSelector]={outline:"1px solid WindowText"},o)}},t[d.HighContrastSelector]={borderBottom:"none"},t)},r&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(n={},n[d.HighContrastSelectorBlack]={color:"#FFFF00"},n[d.HighContrastSelectorWhite]={color:"#00009F"},n)},!r&&{textDecoration:"none"},a&&["is-disabled",{color:h,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!a&&{selectors:{"&:active, &:hover, &:active:hover":{color:u,textDecoration:"underline"},"&:focus":{color:l}}},m.root,i]}},void 0,{scope:"Link"})},8144:function(e,t,o){"use strict";o.r(t);var n=o(1),i=Object(n.action)("addDiagnosticsData",function(e,t,o){return{groupId:e,actionType:t,customData:o}}),r=o(7),a=Object(n.createStore)("groupsReadUnreadDiagnosticsStore",{diagnosticsMap:new r.ObservableMap})(),s=(Object(n.mutator)(i,function(e){var t=e.groupId,o=e.actionType,n=e.customData,i={group:t,actionType:o,timestamp:new Date(Date.now()).toLocaleTimeString(),customData:n};if(a.diagnosticsMap.has(t)){var r=a.diagnosticsMap.get(t);r.push(i),r.length>20&&r.splice(0,1)}else a.diagnosticsMap.set(t,[i])}),o(0)),c=Object(n.action)("addMarkAsReadDiagnostics",function(e,t,o,n,i){return{tableQuery:e,isActingOnAllItemsInTable:t,isReadValueToSet:o,actionSource:n,itemsToUpdate:i}}),l=Object(n.action)("addUnreadCountNotificationDiagnostics",function(e,t){return{groupId:e,notification:t}}),u=Object(n.action)("addUnreadCountSubscriptionDiagnostics",function(e,t,o){return{groupId:e,subscription:t,isUnsubscribe:o}}),d=o(46),p=o(2),h=o.n(p),f=o(2951),m=o(524),g=o(719),b=o(12436),v=[{key:"timestamp",minWidth:80,name:"Time",fieldName:"timestamp",isResizable:!0},{key:"actionType",minWidth:150,name:"Action",fieldName:"actionType",isResizable:!0},{key:"customData",minWidth:650,name:"Details",fieldName:"customData",isResizable:!0}],k=function(e,t,o){return p.createElement("span",null,e[o.key])},y=Object(d.a)(function(){if(0==a.diagnosticsMap.size)return null;var e=s.__spread(a.diagnosticsMap.keys()).sort(function(e,t){return e.localeCompare(t)}),t=[];return e.forEach(function(e){t.push(p.createElement("div",{className:b.groupSectionHeader},e)),t.push(p.createElement(f.a,{className:b.detailsList,items:a.diagnosticsMap.get(e),columns:v,layoutMode:m.e.fixedColumns,selectionMode:g.c.none,constrainMode:m.d.unconstrained,onRenderItemColumn:k}))}),p.createElement("div",{className:"allowTextSelection"},t)}),_=o(747),x=!1,C={name:"Groups read/unread",datapoints:[],type:"Custom"},w=function(){return h.a.createElement(y)};function S(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(e){switch(e.label){case 0:return x?[3,2]:(x=!0,[4,_.e.import().then(function(e){_.f.importAndExecute(C,e(),w)})]);case 1:e.sent(),e.label=2;case 2:return[2]}})})}var j=o(155),A=o(12);Object(n.orchestrator)(c,function(e){return s.__awaiter(void 0,void 0,void 0,function(){var t,o,n,r,a,c,l;return s.__generator(this,function(s){switch(s.label){case 0:return t=e.tableQuery,o=e.isActingOnAllItemsInTable,n=e.isReadValueToSet,r=e.actionSource,a=e.itemsToUpdate,Object(j.e)(t)?(c=function(e,t){return e?t?"MarkAllAsRead":"MarkAllAsUnread":t?"MarkAsRead":"MarkAsUnread"}(o,n),l="ListViewType: "+Object(A.y)(t.listViewType)+", ActionSource: "+r,a&&(l+=", Count: "+a.length),[4,S()]):[3,2];case 1:s.sent(),i(t.folderId,c,l),s.label=2;case 2:return[2]}})})});Object(n.orchestrator)(l,function(e){return s.__awaiter(void 0,void 0,void 0,function(){var t,o,n,r;return s.__generator(this,function(a){switch(a.label){case 0:return t=e.groupId,o=e.notification,n=o.EventType?o.EventType:"Unknown",r="UnreadCount: "+o.UnreadCount+", EventType: "+n+", NotificationId: "+o.NotificationId+", BrokerSubscriptionId: "+o.BrokerSubscriptionId,[4,S()];case 1:return a.sent(),i(t,"UnreadCountNotification",r),[2]}})})});Object(n.orchestrator)(u,function(e){return s.__awaiter(void 0,void 0,void 0,function(){var t,o,n,r,a;return s.__generator(this,function(s){switch(s.label){case 0:return t=e.groupId,o=e.subscription,n=e.isUnsubscribe,r=n?"Unsubscribe":"Subscribe",a="ChannelId: "+o.subscriptionParameters.ChannelId,[4,S()];case 1:return s.sent(),i(t,r,a),[2]}})})}),o.d(t,"addMarkAsReadDiagnostics",function(){return c}),o.d(t,"addUnreadCountNotificationDiagnostics",function(){return l}),o.d(t,"addUnreadCountSubscriptionDiagnostics",function(){return u})}},0,[1,0,2,6,188,486,98,70,110,499,171]]);
//# sourceMappingURL=owa.GroupsReadUnreadDiagnostics.js.map
self.scriptsLoaded['owa.GroupsReadUnreadDiagnostics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GroupsReadUnreadDiagnostics.js'] = (new Date()).getTime();