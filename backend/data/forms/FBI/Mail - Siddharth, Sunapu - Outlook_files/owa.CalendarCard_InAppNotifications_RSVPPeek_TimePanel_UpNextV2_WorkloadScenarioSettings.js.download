self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2~WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[19],{1486:function(e,n,r){"use strict";var a;function t(e){var n=e.getCalendarFolders;return a=n,e}function d(){var e=a;return a=void 0,e}r.d(n,"b",function(){return t}),r.d(n,"a",function(){return d})},50:function(e,n,r){"use strict";var a=r(1),t=r(7),d={calendarEntryMapping:new t.ObservableMap,calendarFolderMapping:new t.ObservableMap,calendarItemIdToChangeKey:new t.ObservableMap,folderIdToCalendarId:new t.ObservableMap,validEntryMapping:new t.ObservableMap,calendarGroupsMapping:new t.ObservableMap,defaultCalendars:new t.ObservableMap,calendarCacheInitializationState:{calendarCacheInitializationLoadState:new t.ObservableMap,calendarCacheInitializationLoadingScenarios:[]}},i=Object(a.createStore)("calendarsCacheStore",d),o=r(0),c=Object(a.action)("initializeCalendarsCacheInStore",function(e,n,r,a,t,d){return{defaultCalendarEntry:e,calendarEntries:n,calendarFolders:r,calendarGroups:a,folderIdMapping:t,calendarIdToChangeKeyMapping:d}}),l=Object(a.action)("calendarCacheInitializeFailed",function(e,n){return{calendarCacheScenarioId:e,primarySmtpAddress:n}}),u=Object(a.action)("initializeCalendarsCache",function(e,n){return void 0===n&&(n=!0),{calendarCacheScenarioId:e,isPrimaryAccount:n}}),s=Object(a.action)("calendarCacheInitialized",function(e,n,r){return{calendarCacheScenarioId:e,isPrimaryAccount:n,primarySmtpAddress:r}}),f=Object(a.action)("updateChangeKeyByCalendarItemId",function(e){return{itemId:e}}),I=Object(a.action)("addToCalendarsCache",function(e,n,r){return{calendarEntry:e,folder:n,mailboxInfo:r}}),p=Object(a.action)("addCalendarGroupToCalendarsCache",function(e){return{calendarGroup:e}}),m=Object(a.action)("updateCalendarEntry",function(e,n){return{itemId:e,calendarEntry:n}}),C=Object(a.action)("updateCalendarFolder",function(e,n){return{calendar:e,calendarFolder:n}}),g=Object(a.action)("removeCalendarFromCalendarsCache",function(e){return{calendar:e}}),b=Object(a.action)("markCalendarEntryAsValid",function(e){return{calendarEntry:e}}),h=Object(a.action)("calendarUpdated",function(e,n){return{calendarId:e,updates:n}}),v=Object(a.action)("groupAssociationChanged",function(e){return{payload:e}});Object(a.mutator)(f,function(e){var n=e.itemId,r=n.Id,a=n.ChangeKey;i().calendarItemIdToChangeKey.set(r,a)}),Object(a.mutator)(m,function(e){var n=e.itemId.Id,r=e.calendarEntry,a=i().calendarEntryMapping.get(n),t=(r.ItemId,o.__rest(r,["ItemId"]));a&&Object.keys(t).forEach(function(e){a[e]=t[e]})}),Object(a.mutator)(b,function(e){var n=e.calendarEntry;i().validEntryMapping.set(n.ItemId.Id,!0)});var y=Object(a.action)("calendarCacheInitializedInternal",function(e,n){return void 0===n&&(n=!0),{primarySmtpAddress:e,isPrimaryAccount:n}}),O=Object(a.action)("calendarCacheInitializeFailedInternal",function(e){return{primarySmtpAddress:e}}),S=Object(a.action)("clearCalendarCacheInitializationLoadingScenarios"),M=Object(a.action)("addCalendarCacheInitializationLoadingScenario",function(e){return{calendarCacheScenarioId:e}}),F=Object(a.action)("setCalendarCacheInitializationLoadState",function(e,n){return{calendarCacheInitializationLoadState:e,primarySmtpAddress:n}}),E=Object(a.action)("removeCalendarWithIDFromCalendarsCache",function(e){return{calendarId:e}});function j(e){if(void 0!==e.CalendarFolderId)return e.CalendarFolderId;var n=e;return n.IsGeneralScheduleCalendar?{Id:n.OwnerEmailAddress,ChangeKey:""}:n.SharedFolderId?{Id:n.SharedFolderId.Id,ChangeKey:null!=n.SharedFolderId.ChangeKey?n.SharedFolderId.ChangeKey:""}:null}var w=r(42);function A(e){return e||(e=Object(w.e)().primarySmtpAddress),i().defaultCalendars.get(e)}function _(){var e=i().calendarEntryMapping;return o.__spread(e.values())}function L(){return _().map(function(e){return G(e.id.id)}).filter(function(e){return e})}function x(){var e=i().calendarGroupsMapping;return o.__spread(e.values())}function T(e){return i().folderIdToCalendarId.get(e)}function z(e){return i().calendarEntryMapping.get(e)}function G(e){var n=z(e);return n?{id:{id:e,mailboxInfo:o.__assign({},n.id.mailboxInfo)},calculatedFolderId:q(e),displayName:n.CalendarName,colorScheme:null}:null}function K(e){return i().calendarFolderMapping.get(e.id.id)}function N(e){return z(e.id.id)}function D(e){var n=i().calendarFolderMapping,r=T(e);return r?n.get(r.id):void 0}function P(e){return i().calendarItemIdToChangeKey.get(e)}function R(e){return k(e.id.id)}function k(e){var n=i().calendarFolderMapping.get(e);return n&&(n.FolderId||n.DistinguishedFolderId)?n.FolderId?n.FolderId.Id:n.DistinguishedFolderId:q(e)}function q(e){var n=i().calendarEntryMapping.get(e);if(n){var r=j(n);return r?r.Id:null}return null}function U(e){var n=i(),r=n.folderIdToCalendarId,a=n.calendarEntryMapping,t=r.get(e);if(t){var d=a.get(t.id);return!d.IsGroupMailboxCalendar&&null!=d.CalendarFolderId}return!1}function H(e){if(U(e)){var n=function(e){var n=T(e);return n?z(n.id):void 0}(e);return n&&n.IsReadOnly}return!1}function B(e){var n=i().validEntryMapping;return e&&n.get(e.ItemId.Id)}function J(e){return!U(k(e))&&!B(z(e))}function W(e){var n,r=i(),a=r.folderIdToCalendarId,t=r.calendarEntryMapping,d=a.get(e);d?n=t.get(d.id):n=o.__spread(t.values()).filter(function(n){return n.OwnerEmailAddress&&n.OwnerEmailAddress.toLowerCase()==e.toLowerCase()})[0];return n}function $(e,n){return n+"_"+e}function V(e){return Object.keys(e).map(function(n){return[n,e[n]]})}function Q(e,n){var r=i();r.calendarItemIdToChangeKey.delete(e),r.calendarEntryMapping.delete(e),r.calendarFolderMapping.delete(e),n&&r.folderIdToCalendarId.delete(n)}Object(a.mutator)(c,function(e){var n=e.defaultCalendarEntry,r=e.calendarEntries,a=e.calendarFolders,d=e.folderIdMapping,c=e.calendarIdToChangeKeyMapping,l=e.calendarGroups,u=i();n&&u.defaultCalendars.set(n.id.mailboxInfo.primarySmtpAddress,n),u.calendarEntryMapping||(u.calendarEntryMapping=new t.ObservableMap),V(r).forEach(function(e){var n=o.__read(e,2),r=n[0],a=n[1];return u.calendarEntryMapping.set(r,a)}),u.calendarFolderMapping||(u.calendarFolderMapping=new t.ObservableMap),V(a).forEach(function(e){var n=o.__read(e,2),r=n[0],a=n[1];return u.calendarFolderMapping.set(r,a)}),u.folderIdToCalendarId||(u.folderIdToCalendarId=new t.ObservableMap),V(d).forEach(function(e){var n=o.__read(e,2),r=n[0],a=n[1];return u.folderIdToCalendarId.set(r,a)}),u.calendarItemIdToChangeKey||(u.calendarItemIdToChangeKey=new t.ObservableMap),V(c).forEach(function(e){var n=o.__read(e,2),r=n[0],a=n[1];return u.calendarItemIdToChangeKey.set(r,a)}),u.calendarGroupsMapping||(u.calendarGroupsMapping=new t.ObservableMap),V(l).forEach(function(e){var n=o.__read(e,2),r=n[0],a=n[1];return u.calendarGroupsMapping.set(r,a)}),u.validEntryMapping=new t.ObservableMap}),Object(a.mutator)(I,function(e){var n=e.calendarEntry,r=e.folder,a=e.mailboxInfo,t=i();t.calendarItemIdToChangeKey.set(n.ItemId.Id,n.ItemId.ChangeKey);var d=o.__assign({},n,{id:{id:n.ItemId.Id,mailboxInfo:a}});t.calendarEntryMapping.set(n.ItemId.Id,d),t.calendarFolderMapping.set(n.ItemId.Id,r),r.FolderId?t.folderIdToCalendarId.set(r.FolderId.Id,{id:n.ItemId.Id,mailboxInfo:a}):r.DistinguishedFolderId&&t.folderIdToCalendarId.set(r.DistinguishedFolderId,{id:n.ItemId.Id,mailboxInfo:a})}),Object(a.mutator)(p,function(e){var n=e.calendarGroup,r=i(),a=$(n.id.mailboxInfo.primarySmtpAddress,n.GroupId);r.calendarGroupsMapping.set(a,n)}),Object(a.mutator)(g,function(e){var n=e.calendar;Q(n.id.id,n.calculatedFolderId?n.calculatedFolderId:null)}),Object(a.mutator)(E,function(e){var n=e.calendarId;Q(n,k(n))}),Object(a.mutator)(C,function(e){var n=e.calendar,r=e.calendarFolder,a=K(n);Object.keys(r).forEach(function(e){a[e]=r[e]})}),Object(a.mutator)(M,function(e){i().calendarCacheInitializationState.calendarCacheInitializationLoadingScenarios.push(e.calendarCacheScenarioId)}),Object(a.mutator)(S,function(){i().calendarCacheInitializationState.calendarCacheInitializationLoadingScenarios=[]}),Object(a.mutator)(F,function(e){var n=e.primarySmtpAddress;n||(n=Object(w.e)().primarySmtpAddress);var r=i();r.calendarCacheInitializationState.calendarCacheInitializationLoadState||(r.calendarCacheInitializationState.calendarCacheInitializationLoadState=new t.ObservableMap),r.calendarCacheInitializationState.calendarCacheInitializationLoadState.set(n,e.calendarCacheInitializationLoadState)});var X=r(1917),Y=r.n(X),Z=r(27),ee=r(1486),ne=r(145);function re(e){return o.__awaiter(this,void 0,void 0,function(){var n,r;return o.__generator(this,function(a){switch(a.label){case 0:return n=null,e&&!Object(w.h)(e)||(n=Object(ee.a)()),n?[3,3]:[4,Object(ne.b)(Object(w.e)(e))];case 1:return r=a.sent(),[4,Y()({Header:Object(Z.getJsonRequestHeader)()},r)];case 2:n=a.sent(),a.label=3;case 3:return[2,n]}})})}var ae,te=r(9),de=r(730),ie=r(11);function oe(e,n,r){var a,t={},d={},i={},c={},l={},u=r?[r]:[Object(te.a)().SessionSettings.LogonEmailAddress],s=Object(w.e)(r);return e.forEach(function(e){l[e.ItemId.Id]=e.ItemId.ChangeKey;var r=o.__assign({},e,{id:{id:e.GroupId,mailboxInfo:s}}),d=$(s.primarySmtpAddress,e.GroupId);c[d]=r,e.Calendars.forEach(function(e){if(function(e,n){if(7==e.CalendarFolderType)return!1;if(Object(de.b)(e)){var r=e;if(r.IsOwnerEmailAddressInvalid)return ie.c.info("[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: "+r.OwnerEmailAddress),!1;var a=r.IsGeneralScheduleCalendar?r.OwnerEmailAddress:r.SharedFolderId?r.SharedFolderId.Id:null;if(!a)return ie.c.info("[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: "+e.ItemId.Id),!1;if(n.includes(a))return ie.c.info("[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: "+a),!1;if(n.push(a),r.OwnerEmailAddress=r.OwnerEmailAddress.toLowerCase(),r.IsGroupMailboxCalendar)return!1}return!0}(e,u)){var r=e.ItemId.Id,d=j(e).Id;if(1==e.CalendarFolderType){var c=n&&n.filter(function(e){return e.FolderId.Id===d})[0];a={id:{id:r,mailboxInfo:s},calculatedFolderId:d,displayName:c?c.DisplayName:e.CalendarName,colorScheme:null}}var f=o.__assign({},e,{id:{id:r,mailboxInfo:s}});!t[r]&&(t[r]=f),!i[d]&&(i[d]={id:e.ItemId.Id,mailboxInfo:s}),!l[r]&&(l[r]=e.ItemId.ChangeKey)}})}),n.forEach(function(e){var n=i[e.FolderId.Id];n&&(d[n.id]=e)}),{defaultCalendar:a,calendarEntryMapping:t,calendarFolderMapping:d,folderIdMapping:i,calendarGroupMapping:c,calendarIdToChangeKeyMapping:l}}function ce(e){e||(e=Object(w.e)().primarySmtpAddress);var n=i().calendarCacheInitializationState.calendarCacheInitializationLoadState.get(e);return null==n&&(n=ae.NotLoaded),n}function le(){return i().calendarCacheInitializationState.calendarCacheInitializationLoadingScenarios}!function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(ae||(ae={}));var ue=r(91),se=r(255);Object(a.orchestrator)(u,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var n,r,a,t,d,i,l,u,s,f;return o.__generator(this,function(I){switch(I.label){case 0:if(n=Object(w.e)().primarySmtpAddress,"CalendarModule"==e.calendarCacheScenarioId&&!e.isPrimaryAccount){n=null,r=Object(se.g)();try{for(a=o.__values(r),t=a.next();!t.done;t=a.next())if(ce((d=t.value).primarySmtpAddress)==ae.NotLoaded){n=d.primarySmtpAddress;break}}catch(e){s={error:e}}finally{try{t&&!t.done&&(f=a.return)&&f.call(a)}finally{if(s)throw s.error}}}if(!n)return[3,6];switch(M(e.calendarCacheScenarioId),i=ce(n),i){case ae.NotLoaded:return[3,1];case ae.Loaded:return[3,3];case ae.Loading:return[3,4]}return[3,5];case 1:return F(ae.Loading,n),[4,re(n)];case 2:return null!==(l=I.sent())&&l.WasSuccessful?(u=oe(l.CalendarGroups,l.CalendarFolders,n),c(u.defaultCalendar,u.calendarEntryMapping,u.calendarFolderMapping,u.calendarGroupMapping,u.folderIdMapping,u.calendarIdToChangeKeyMapping),y(n,e.isPrimaryAccount)):(O(),ie.c.error("[getCalendarFoldersFromServer] Failed to load calendars from server")),[3,6];case 3:return y(n,e.isPrimaryAccount),[3,6];case 4:return[3,6];case 5:return Object(ue.a)(i),[3,6];case 6:return[2]}})})});function fe(e){var n=T(e);return n?n.mailboxInfo:null}function Ie(e){var n=i(),r=n.folderIdToCalendarId,a=n.calendarEntryMapping,t=r.get(e);return t?a.get(t.id):null}Object(a.orchestrator)(y,function(e){F(ae.Loaded,e.primarySmtpAddress),le().forEach(function(n){return s(n,e.isPrimaryAccount,e.primarySmtpAddress)}),S()}),Object(a.orchestrator)(O,function(e){F(ae.NotLoaded,e.primarySmtpAddress),le().forEach(function(n){return l(n,e.primarySmtpAddress)}),S()});var pe=r(111),me=r.n(pe),Ce=r(1934),ge=r.n(Ce);function be(e,n){return o.__awaiter(this,void 0,void 0,function(){var r,a,t;return o.__generator(this,function(d){switch(d.label){case 0:return r={headers:Object(ne.e)(n)},a=Ie(e.Id),t=a&&(a.IsGeneralScheduleCalendar||a.IsGroupMailboxCalendar)?me()({Id:"calendar",Mailbox:{EmailAddress:n}}):5==a.CalendarFolderType?a.SharedFolderId:e,[4,ge()({request:{FolderId:t}},r)];case 1:return[2,d.sent()]}})})}var he=r(102),ve=r.n(he),ye=r(15);function Oe(e){return o.__awaiter(this,void 0,void 0,function(){var n,r,a,t,d,i,c;return o.__generator(this,function(o){switch(o.label){case 0:if(!(n=z(e)))throw new Error("Unable to get calendar entry for calendar "+e);r=k(e),a=q(e),t=T(r),d=t?t.mailboxInfo:Object(w.e)(),i=5==n.CalendarFolderType&&Object(te.a)().SessionSettings.DefaultPublicFolderMailbox?Object(te.a)().SessionSettings.DefaultPublicFolderMailbox:function(e,n){return e||(n?n.primarySmtpAddress:null)}(n.OwnerEmailAddress,d),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,be(ve()({Id:a}),i)];case 2:return c=o.sent(),[3,4];case 3:return o.sent(),Object(ye.o)("getCalendarFolderConfigurationServiceFailed"),b(n),[2];case 4:if(!c)throw new Error("Unable to get folder for calendar "+e);return b(n),5==n.CalendarFolderType?function(e,n,r){var a=e.CalendarFolder;if(a){n.CalendarFolderId||(n.CalendarFolderId=e.CalendarFolder.FolderId);var t=a.ReplicaList[0];I(n,a,{type:0,deprecatedMailboxId:t,primarySmtpAddress:t,routingKey:Object(w.c)()+t,requestOptions:Object(ne.a)(t,r),returnModernConversationItems:r.returnModernConversationItems})}}(c,n,d):function(e,n,r,a){var t=e.CalendarFolder;t&&t.EffectiveRights&&t.EffectiveRights.Read&&(e.MasterList&&(n.RemoteCategories=e.MasterList),(a==n.OwnerEmailAddress||n.ItemId&&a==n.ItemId.Id)&&(h(a,{id:{id:n.ItemId.Id,mailboxInfo:r},calculatedFolderId:t.FolderId.Id}),E(a),I(n,t,r)))}(c,n,d,e),[2]}})})}function Se(e){var n=K(e),r=N(e);return n&&r&&!r.IsReadOnly&&n.EffectiveRights&&n.EffectiveRights.CreateContents}function Me(e,n){var r=N(e);if(Object(de.b)(r)){var a=r;return!a.IsOwnerEmailAddressInvalid&&a.OwnerEmailAddress==n}return e.id&&e.id.mailboxInfo?n.indexOf(e.id.mailboxInfo.primarySmtpAddress)>=0:Object(te.a)().SessionSettings.UserEmailAddress==n}function Fe(e){return e?e.map(G).filter(function(e){return!!e}):null}r.d(n,"F",function(){return u}),r.d(n,"d",function(){return s}),r.d(n,"P",function(){return f}),r.d(n,"c",function(){return I}),r.d(n,"b",function(){return p}),r.d(n,"N",function(){return m}),r.d(n,"O",function(){return C}),r.d(n,"M",function(){return g}),r.d(n,"L",function(){return b}),r.d(n,"f",function(){return h}),r.d(n,"E",function(){return v}),r.d(n,"A",function(){return A}),r.d(n,"n",function(){return _}),r.d(n,"h",function(){return L}),r.d(n,"w",function(){return x}),r.d(n,"x",function(){return T}),r.d(n,"p",function(){return z}),r.d(n,"m",function(){return G}),r.d(n,"s",function(){return K}),r.d(n,"o",function(){return N}),r.d(n,"t",function(){return D}),r.d(n,"z",function(){return P}),r.d(n,"u",function(){return R}),r.d(n,"B",function(){return k}),r.d(n,"l",function(){return q}),r.d(n,"H",function(){return U}),r.d(n,"I",function(){return H}),r.d(n,"J",function(){return B}),r.d(n,"e",function(){return J}),r.d(n,"q",function(){return W}),r.d(n,"C",function(){return fe}),r.d(n,"r",function(){return Ie}),r.d(n,"j",function(){return ce}),r.d(n,"i",function(){return Oe}),r.d(n,"k",function(){return j}),r.d(n,"g",function(){return oe}),r.d(n,"v",function(){return $}),r.d(n,"K",function(){return Se}),r.d(n,"G",function(){return Me}),r.d(n,"D",function(){return Fe}),r.d(n,"y",function(){return re}),r.d(n,"a",function(){return ae})},730:function(e,n,r){"use strict";var a="LinkedCalendarEntry:#Exchange";function t(e){return e.__type==a}r.d(n,"b",function(){return t}),r.d(n,"a",function(){return a})}}]);
//# sourceMappingURL=owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2~WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2~WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CalendarCard~InAppNotifications~RSVPPeek~TimePanel~UpNextV2~WorkloadScenarioSettings.js'] = (new Date()).getTime();