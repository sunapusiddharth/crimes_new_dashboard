self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[204],{1081:function(e,t,n){"use strict";var a=n(363),o=n(316),r="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(o.a)(e)&&Object(a.a)(e)==r}},13769:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(7),r=n(12),i=n(142),s=n(3701),c=n(11);function d(e,t){var n=function(e){var t={},n=i.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){c.c.error("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(s.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(a.g)(n.parentInternetMessageId))break;n=i.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new o.ObservableMap({});return t.forEach(function(t){var a=i.a.conversationNodes.get(t),o=t===e?r.a.CheckMark:r.a.None;n.set(a.internetMessageId,o)}),n}(e,t);for(var d=new o.ObservableMap({}),u=!1,v=!1,f=0,l=0;l<t.length;l++){var b=i.a.conversationNodes.get(t[l]);n[b.internetMessageId]?(u?f+1===Object.keys(n).length?(d.set(b.internetMessageId,r.a.BusEnd),v=!0):d.set(b.internetMessageId,r.a.BusStop):(d.set(b.internetMessageId,r.a.BusStart),u=!0),f++):!u||v?d.set(b.internetMessageId,r.a.None):d.set(b.internetMessageId,r.a.NoStop)}return d}var u=n(265),v=n(72),f=n(6282),l=n(29),b=n(1);function p(){v.a.expandedConversationViewState.expandedRowKey=null,v.a.expandedConversationViewState.selectedNodeIds=[],v.a.expandedConversationViewState.shouldBeExpanded=!1,v.a.expandedConversationViewState.busStopStateMap=new o.ObservableMap({})}Object(b.mutator)(u.t,function(e){var t=e.nodeId,n=e.allNodeIds,a=v.a.expandedConversationViewState.selectedNodeIds;a.indexOf(t)>-1?(a.splice(a.indexOf(t),1),1===a.length&&(v.a.expandedConversationViewState.busStopStateMap=d(a[0],n))):a.push(t)}),Object(b.mutator)(u.h,function(e){v.a.expandedConversationViewState.busStopStateMap=new o.ObservableMap({})}),Object(b.mutator)(u.q,function(e){var t=e.rowKey,n=e.nodeIdToSelect,a=e.allNodeIds;v.a.expandedConversationViewState.expandedRowKey=t,v.a.expandedConversationViewState.selectedNodeIds=[n],v.a.expandedConversationViewState.busStopStateMap=d(n,a)}),Object(b.mutator)(u.u,function(e){var t=v.a.expandedConversationViewState;e.mailListItemSelectionSource==l.f.MailListItemCheckbox&&t.expandedRowKey!=e.rowKey&&p()}),Object(b.mutator)(u.p,function(e){var t=v.a.expandedConversationViewState;e.shouldSelect||t.expandedRowKey!=e.rowKey||p()}),Object(b.mutator)(u.i,function(e){p()}),Object(b.mutator)(u.k,function(e){p()}),Object(b.mutator)(u.r,function(e){var t=v.a.expandedConversationViewState;e.mailListItemSelectionSource==l.f.MailListItemTwisty&&t.expandedRowKey!=e.rowKey&&(t.expandedRowKey=e.rowKey,t.shouldBeExpanded=!0)}),Object(b.mutator)(u.o,function(e){v.a.expandedConversationViewState.shouldBeExpanded=e.shouldBeExpanded}),Object(b.mutator)(f.a,function(e){if(1===v.a.expandedConversationViewState.selectedNodeIds.length){var t=v.a.expandedConversationViewState.selectedNodeIds[0],n=l.H.conversations.get(e.conversationId).conversationNodeIds;v.a.expandedConversationViewState.busStopStateMap=d(t,n)}});var O=n(0),w=n(2056),I=n(684),j=n(256);Object(b.orchestrator)(u.b,function(e){S(e.itemId,e.tableView,e.nodeId,e.allNodeIds,l.f.MailListItemExpansion)});function S(e,t,n,a,o){Object(I.f)(t,!0,o),j.k.importAndExecute(e),u.q(r.O.expandedConversationViewState.expandedRowKey,n,a,t.id)}function g(e,t){var n,a,o=r.b.getConversationId(e,t),i=l.H.conversations.get(o);try{for(var c=O.__values(i.conversationNodeIds),d=c.next();!d.done;d=c.next()){var u=d.value,v=Object(s.b)(u);if(v){S(v.ItemId.Id,t,u,i.conversationNodeIds,l.f.RowRemoval);break}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}}function m(){u.i()}Object(b.orchestrator)(u.e,function(e){if(e.mailListItemSelectionSource==l.f.MailListItemTwisty){if(1==e.listViewType)throw new Error("Toggle expansion action cannot be called from message view");var t,n;Object(w.a)(e.rowKey)?m():(t=e.rowKey,n=e.tableView,u.o(!1),g(t,n))}}),Object(b.orchestrator)(u.c,function(e){Object(w.a)(e.rowKey)&&m()}),Object(b.orchestrator)(u.m,function(e){for(var t=r.b.getConversationId(e.rowKey,e.tableView),n=l.H.conversations.get(t),a=null,o=null,i=n.conversationNodeIds.indexOf(r.O.expandedConversationViewState.selectedNodeIds[0])+1;i<n.conversationNodeIds.length;i++){var c=n.conversationNodeIds[i],d=Object(s.b)(c);if(d){o=d.ItemId.Id,a=c;break}}a?S(o,e.tableView,a,n.conversationNodeIds,l.f.RowRemoval):g(e.rowKey,e.tableView)});var x=n(5715),y=n(5757),C=(Object(b.orchestrator)(y.a,function(e){Object(x.a)(),1===Object(r.E)().expandedConversationViewState.selectedNodeIds.length&&u.h()}),n(7088)),h=n(583);Object(b.orchestrator)(C.a,function(e){if(r.O.expandedConversationViewState.expandedRowKey){var t=l.H.conversations.get(e.conversationId);u.q(r.O.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(h.a)())}})},1626:function(e,t,n){"use strict";var a=n(1826);t.a=function(e){var t=Object(a.a)(e),n=t%1;return t==t?n?t-n:t:0}},1741:function(e,t,n){"use strict";var a=n(321),o=n(1822),r=n(801),i=n(1081),s=1/0,c=a.a?a.a.prototype:void 0,d=c?c.toString:void 0;t.a=function e(t){if("string"==typeof t)return t;if(Object(r.a)(t))return Object(o.a)(t,e)+"";if(Object(i.a)(t))return d?d.call(t):"";var n=t+"";return"0"==n&&1/t==-s?"-0":n}},1822:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,a=null==e?0:e.length,o=Array(a);++n<a;)o[n]=t(e[n],n,e);return o}},1826:function(e,t,n){"use strict";var a=n(902),o=1/0,r=1.7976931348623157e308;t.a=function(e){return e?(e=Object(a.a)(e))===o||e===-o?(e<0?-1:1)*r:e==e?e:0:0===e?e:0}},1898:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetCalendarEventRequest:#Exchange"},e)}},1899:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(55),o=n(2247);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),a.makeServiceRequest("GetCalendarEvent",e,t)}},2068:function(e,t,n){"use strict";var a=n(1741);t.a=function(e){return null==e?"":Object(a.a)(e)}},2071:function(e,t,n){"use strict";t.a=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}},2247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetCalendarEventJsonRequest:#Exchange"},e)}},2263:function(e,t,n){"use strict";var a=n(2071),o=n(1741),r=n(1626),i=n(2068);t.a=function(e,t,n){return e=Object(i.a)(e),n=null==n?0:Object(a.a)(Object(r.a)(n),0,e.length),t=Object(o.a)(t),e.slice(n,n+t.length)==t}},2422:function(e,t,n){"use strict";var a=n(2071),o=n(1741),r=n(1626),i=n(2068);t.a=function(e,t,n){e=Object(i.a)(e),t=Object(o.a)(t);var s=e.length,c=n=void 0===n?s:Object(a.a)(Object(r.a)(n),0,s);return(n-=t.length)>=0&&e.slice(n,c)==t}},5715:function(e,t,n){"use strict";var a=n(0),o=n(4202),r=n(2108),i=n(1382),s=n(183),c=n(1097),d=n(8),u=n(12);t.a=Object(d.select)({composeViewState:function(){return s.c.viewStates.get(s.c.primaryComposeId)},conversationItems:function(){return u.O.conversationItems}})(Object(d.action)("reloadReadingPane")(function(e){var t=Object(u.C)(),n=t?a.__spread(t.selectedRowKeys.keys()):[];if(1==n.length){var d=u.b.getRowClientItemId(n[0],t),v=Object(c.a)(n,t)[0];switch(t.tableQuery.listViewType){case 0:var f=e.conversationItems.get(d.Id);e.composeViewState&&e.composeViewState.isInlineCompose?s.C.importAndExecute(e.composeViewState).then(function(){Object(o.b)(d,v,f.subject)}):Object(o.b)(d,v,f.subject);break;case 1:e.composeViewState&&e.composeViewState.isInlineCompose?s.C.importAndExecute(e.composeViewState).then(function(){Object(r.a)(d,v,i.a)}):Object(r.a)(d,v,i.a)}}}))},5757:function(e,t,n){"use strict";var a=n(1),o=Object(a.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},6282:function(e,t,n){"use strict";var a=n(1);t.a=Object(a.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}})},7088:function(e,t,n){"use strict";var a=n(1);t.a=Object(a.action)("ON_ITEM_PART_SELECTED",function(e,t){return{conversationNodeId:e,conversationId:t}})},902:function(e,t,n){"use strict";var a=n(202),o=n(1081),r=NaN,i=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,d=/^0o[0-7]+$/i,u=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(o.a)(e))return r;if(Object(a.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(a.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=c.test(e);return n||d.test(e)?u(e.slice(2),n?2:8):s.test(e)?r:+e}}},0,[1,4,8,10,360,3,21,34,79,330,6,7,9,11,119,5,291,23,314,12,43,115,494,135,486,98,70,110,498,167,499,171,213,299,317,403,468,470]]);
//# sourceMappingURL=owa.ExpandedListSelectionActions.js.map
self.scriptsLoaded['owa.ExpandedListSelectionActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();