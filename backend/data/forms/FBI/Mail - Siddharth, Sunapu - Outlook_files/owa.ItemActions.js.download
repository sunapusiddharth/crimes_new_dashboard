self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ItemActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[275],{12671:function(e){e.exports={e:"hHb",d:"iHb",b:"jHb",a:"kHb",c:"lHb"}},12672:function(e){e.exports={a:"DGb"}},12673:function(e){e.exports={f:"WGb",d:"XGb",k:"YGb",j:"ZGb",i:"_Gb",e:"$Gb",h:"aHb",l:"bHb",b:"cHb",c:"dHb",g:"eHb",a:"fHb"}},12674:function(e,t,n){var r=n(12675),o=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},12675:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'._2ajHY-IcCEZ-jSZK-p7Umy div[class~=ms-Button-label]{display:block}html[dir] ._2ajHY-IcCEZ-jSZK-p7Umy div[class~=ms-Button-label]{margin:0 1px;padding:0}button.Isabp7l92KgYue--mXACT.ms-Button{width:auto}html[dir] button.bW0ipvHhaLslVzcuqolhK{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}.aX3RmEGx8HrdPL1yktLRm{width:230px}html[dir] .aX3RmEGx8HrdPL1yktLRm{background-color:"[theme:white, default:#ffffff]"}._3EVsmMkXoUVhUDeorDNq-T{max-height:400px;overflow-x:hidden}._2DozUcz4nbAM62BxTepAOh{-webkit-animation:none!important;animation:none!important}._3dfPy9ayr523z3j8V0vi53{overflow:hidden}._3nLjv484RsToOL5jRMWQLH{height:44px}html[dir=ltr] ._3nLjv484RsToOL5jRMWQLH{padding-left:12px}html[dir=rtl] ._3nLjv484RsToOL5jRMWQLH{padding-right:12px}html[dir] ._3nLjv484RsToOL5jRMWQLH:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}',""]),t.locals={likeCustomButton:"_2ajHY-IcCEZ-jSZK-p7Umy",likeIconButtonCustom:"Isabp7l92KgYue--mXACT",likeCustomButtonActive:"bW0ipvHhaLslVzcuqolhK",callout:"aX3RmEGx8HrdPL1yktLRm",scrollContainer:"_3EVsmMkXoUVhUDeorDNq-T",animationStop:"_2DozUcz4nbAM62BxTepAOh",personaCollection:"_3dfPy9ayr523z3j8V0vi53",persona:"_3nLjv484RsToOL5jRMWQLH"}},12676:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'html[dir=ltr] ._2opPWe6KuVFhEI52_XY6Tw{padding-right:2px}html[dir=rtl] ._2opPWe6KuVFhEI52_XY6Tw{padding-left:2px}._3tBxnKAWFWDe41Zarl9mN{width:100%;min-width:0;height:40px;display:inline-block;-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1;position:relative;top:1px}html[dir=ltr] ._3tBxnKAWFWDe41Zarl9mN{left:2px}html[dir=rtl] ._3tBxnKAWFWDe41Zarl9mN{right:2px}._20q0GP-4M43aJdIUNdbHS_{font-size:14px;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._20q0GP-4M43aJdIUNdbHS_{background:transparent}._3CHzUb8E75dSDcMFHT_8Qx{height:32px}html[dir] ._3CHzUb8E75dSDcMFHT_8Qx{background-color:transparent;padding:4px 0}.eeijf3m13i_oYyGsPmueH{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._3ODQEP4a8av7UYmYAIFIRW{height:100%;min-width:32px}html[dir] ._3ODQEP4a8av7UYmYAIFIRW{background-color:transparent;margin:0 2px}._2O1OZ_6q64cOi7BcKWHTR7.ms-ContextualMenu-icon._116RIYB_5dbJ9OMEhOhRmT,._2i4F3Q0eiaJ5u4aiXx5D3w:not(._20q0GP-4M43aJdIUNdbHS_),._3ODQEP4a8av7UYmYAIFIRW .ms-Button-label{display:none}._2-CHZF0Qg8MCaHcCu-HzJ2{position:relative;top:8px}html[dir=ltr] ._2-CHZF0Qg8MCaHcCu-HzJ2{float:right;padding-right:11px}html[dir=rtl] ._2-CHZF0Qg8MCaHcCu-HzJ2{float:left;padding-left:11px}._2fYaj1_Slq-gUPNzikpit{display:none}._1MncjFzxk89g--zyj1v5O5{width:32px;height:32px}html[dir] ._1MncjFzxk89g--zyj1v5O5{border-radius:2px;background:transparent}._1MncjFzxk89g--zyj1v5O5.ms-Button{width:32px;height:32px}html[dir] ._1MncjFzxk89g--zyj1v5O5:hover{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] ._1MncjFzxk89g--zyj1v5O5:active{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN{background-color:"[theme:themeLighter, default:#DEECF9]"}._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5._37fr-TjgFabRfitZmzNqlN.ms-Button .ms-Button-menuIcon,._1MncjFzxk89g--zyj1v5O5:active.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5:active.ms-Button .ms-Button-menuIcon,._1MncjFzxk89g--zyj1v5O5:hover.ms-Button .ms-Button-icon,._1MncjFzxk89g--zyj1v5O5:hover.ms-Button .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}.aZVJsA6Ilr8olDTFGKR6T{color:"[theme:themePrimary, default:#0078D4]"}._3DE4Hx2dldBiXVAxb2jkoh{color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._3of7CI7D6gm5OF90xXEWK0{background-color:transparent}',""]),t.locals={surfaceActionsCommandBarCharms:"_2opPWe6KuVFhEI52_XY6Tw",surfaceActionsCommandBarContainer:"_3tBxnKAWFWDe41Zarl9mN",surfaceActionsCommandBarOverflowIcon:"_20q0GP-4M43aJdIUNdbHS_",surfaceActionsCommandBar:"_3CHzUb8E75dSDcMFHT_8Qx",surfaceActionsCommandBarPrimarySet:"eeijf3m13i_oYyGsPmueH",surfaceActionsCommandBarButton:"_3ODQEP4a8av7UYmYAIFIRW",commandBarIcon:"_2O1OZ_6q64cOi7BcKWHTR7",hideMenuIcon:"_116RIYB_5dbJ9OMEhOhRmT",commandBarMenuIcon:"_2i4F3Q0eiaJ5u4aiXx5D3w",itemHeaderDropDownButtonCharms:"_2-CHZF0Qg8MCaHcCu-HzJ2",hideCharms:"_2fYaj1_Slq-gUPNzikpit",iconButton:"_1MncjFzxk89g--zyj1v5O5",isChecked:"_37fr-TjgFabRfitZmzNqlN",enabledIconButton:"aZVJsA6Ilr8olDTFGKR6T",disabledIconButton:"_3DE4Hx2dldBiXVAxb2jkoh",disabledReplyActionButton:"_3of7CI7D6gm5OF90xXEWK0"}},12677:function(e){e.exports={b:"BGb",a:"CGb"}},12678:function(e,t,n){var r=n(12679),o=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},12679:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'._1pVbbNWoU3A2KPJ5mTx9ss{width:750px!important;max-width:750px!important;height:550px;overflow:hidden}._2o7RMkbYm39CgXru8bzVk{width:690px;height:410px;overflow:auto;word-wrap:break-word;white-space:pre-line}._3c9eatHmfdZHfX00YKzcP4{color:"[theme:white, default:#ffffff]"!important}html[dir] ._3c9eatHmfdZHfX00YKzcP4{background-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._3c9eatHmfdZHfX00YKzcP4:hover{background-color:"[theme:themeDark, default:#0D62AA]"}html[dir] ._3c9eatHmfdZHfX00YKzcP4:active{background-color:"[theme:themeDarker, default:#004578]"}',""]),t.locals={container:"_1pVbbNWoU3A2KPJ5mTx9ss",content:"_2o7RMkbYm39CgXru8bzVk",button:"_3c9eatHmfdZHfX00YKzcP4"}},1341:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c});var r=n(1),o=Object(r.action)("ON_ARCHIVE_TAG_FOR_FOLDER_UPDATE_SUCCESS",function(e,t){return{folder:e,archiveTag:t}}),a=Object(r.action)("ON_DELETE_TAG_FOR_FOLDER_UPDATE_SUCCESS",function(e,t){return{folder:e,deleteTag:t}}),i=Object(r.action)("ON_RETENTION_TAG_FOR_ITEMS_UPDATE_SUCCESS",function(e,t,n){return{tag:e,isArchiveTag:t,itemIds:n}}),s=Object(r.action)("ON_RETENTION_TAG_FOR_ITEMS_CHANGED",function(e,t,n,r,o){return{isArchiveTag:e,tagValue:t,itemIds:n,actionSource:r,mailboxInfo:o}}),c=Object(r.action)("ON_RETENTION_TAG_FOR_CONVERSATIONS_CHANGED",function(e,t,n,r,o,a,i){return{isArchiveTag:e,tagValue:t,folderId:n,conversationActionContexts:r,itemIds:o,actionSource:a,mailboxInfo:i}})},13694:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(12671),a=n(2001),i=n(1692),s=n(7191),c=n(12672),u=n(6057),l=n(4054),d=n(4055),p=n(4056),m=n(4057),b=n(1653),h=n(3966),f=n(4),I=n(6146),g=n(18),v=n(1284),O=n(1763),k=n(60),y=n(14),j=n(1837),S=n(362),C=n(86),A=n(1082),x=n(79),M=n(2),P=n(12673),_=n(9),w=100;function R(e){try{if(e.LikeCount&&e.Likers){var t=Object(_.a)().SessionSettings.UserEmailAddress,n=!!e.Likers&&e.Likers.some(function(e){return e.EmailAddress===t});switch(e.LikeCount){case 1:return n?Object(f.a)(P.f):Object(f.b)(Object(f.a)(P.d),e.Likers[0].Name);case 2:return n?Object(f.b)(Object(f.a)(P.k),e.Likers.filter(function(e){return e.EmailAddress!==t})[0].Name):Object(f.b)(Object(f.a)(P.j),e.Likers[0].Name,e.Likers[1].Name);case 3:return n?Object(f.b)(Object(f.a)(P.i),e.Likers[0].Name,Object(f.a)(P.e)):Object(f.b)(Object(f.a)(P.h),e.Likers[0].Name,e.Likers[1].Name,Object(f.a)(P.e));default:return n?e.LikeCount>=w?Object(f.b)(Object(f.a)(P.l),w-1):Object(f.b)(Object(f.a)(P.b),e.Likers[0].Name,Object(f.b)(Object(f.a)(P.c),e.LikeCount-2)):e.LikeCount>=w?Object(f.b)(Object(f.a)(P.g),w-1):Object(f.b)(Object(f.a)(P.a),e.Likers[0].Name,e.Likers[1].Name,Object(f.b)(Object(f.a)(P.c),e.LikeCount-2))}}}catch(e){return null}return null}function T(e){return e.LikeCount?e.LikeCount<w?e.LikeCount.toString():w-1+"+":null}var B=n(3308),F=n(12674),L=n(8852),D=n(177),E=function(e){function t(t){var n=e.call(this,t)||this;return n.onLikeClicked=function(e,t){t.onClick(e,t),e.stopPropagation()},n.handleMouseOver=function(){n.state.isMouseOverButton||n.setState({isMouseOverButton:!0})},n.handleMouseLeave=function(){n.state.isMouseOverButton&&n.setState({isMouseOverButton:!1})},n.handleLikersListMouseOver=function(){n.state.isMouseOverLikersList||n.setState({isMouseOverLikersList:!0})},n.handleLikersListMouseLeave=function(){n.state.isMouseOverLikersList&&n.setState({isMouseOverLikersList:!1})},n.state={isMouseOverButton:!1,isMouseOverLikersList:!1},n}return r.__extends(t,e),t.prototype.IsLikersListShown=function(){return this.state.isMouseOverLikersList},t.prototype.render=function(){var e=this,t=this.props,n=t.surfaceActionItem,o=t.message,a=o.LikeCount&&o.Likers&&(this.state.isMouseOverButton||this.state.isMouseOverLikersList),i="likeButtonId"+Object(C.a)();return M.createElement(j.a,{content:n.name},M.createElement(v.a,{id:i,role:"button",ariaLabel:n.name,ariaDescription:R(o),iconProps:n.iconProps,styles:{root:D(L.surfaceActionsCommandBarButton,L.iconButton,o.LikeCount&&F.likeCustomButton,o.LikeCount&&F.likeIconButtonCustom,a&&F.likeCustomButtonActive),rootChecked:L.checkedCommandBarButton,rootDisabled:L.disabledReplyActionButton,icon:L.enabledIconButton,iconDisabled:L.disabledIconButton,menuIcon:L.commandBarMenuIcon},onClick:function(t){return e.onLikeClicked(t,n)},onMouseEnter:this.handleMouseOver,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,text:T(o)}),a&&M.createElement(O.a,{className:D(F.callout,{animationStop:Object(x.c)()}),onDismiss:function(){return e.setState(r.__assign({},e.state,{isMouseOverButton:!1,isMouseOverLikersList:!1}))},target:"#"+i,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(S.a)()?k.a.bottomLeftEdge:k.a.bottomRightEdge},M.createElement("div",{className:D(F.scrollContainer,"customScrollBar"),onMouseEnter:this.handleLikersListMouseOver,onMouseOver:this.handleLikersListMouseOver,onMouseLeave:this.handleLikersListMouseLeave},M.createElement("div",{className:F.personaCollection},o.Likers.map(function(e){return M.createElement(N,{key:e.EmailAddress,emailAddress:e.EmailAddress,name:e.Name,mailBoxType:e.MailboxType,disableHover:!0,clientScenario:"Liker"},M.createElement(A.a,{className:F.persona,key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:y.c.size32,showPersonaDetails:!0,mailboxType:e.MailboxType}))})))))},t=r.__decorate([g.observer],t)}(M.Component);function N(e){var t=Object(B.a)(e);return M.createElement(t,null,M.createElement("div",null,e.children))}var H=n(12677),G=n(3759),U=n(1189),z=n(2870),V=n(923),K=n(1824),J=n(904),W=n(903),Y=n(453),q=n.n(Y);function Z(e){return Object(J.a)([e.ItemId.Id],q()({BaseShape:"IdOnly"}),"MessageDetails","V2016_06_24",e.MailboxInfo&&e.MailboxInfo.requestOptions).then(function(e){return function(e){if(Object(W.a)(e[0])){var t=e[0].Items[0];if(null!=t.ExtendedProperty&&t.ExtendedProperty.length>=1)return t.ExtendedProperty[0].Value}return null}(e)})}function X(e){return Object(J.a)([e.ItemId.Id],q()({BaseShape:"IdOnly",IncludeMimeContent:!0}),null,"V2016_06_24",e.MailboxInfo&&e.MailboxInfo.requestOptions).then(function(e){return function(e){return Object(W.a)(e[0])?e[0].Items[0].MimeContent:null}(e)})}var $=n(41),Q=n(62),ee=n(177),te=n(12678),ne=function(e){function t(t){var n=e.call(this,t)||this;return n.onDismiss=function(){n.props.onClose()},n.state={content:""},n}return r.__extends(t,e),t.prototype.render=function(){return M.createElement(z.a,{hidden:!1,containerClassName:te.container,dialogContentProps:{showCloseButton:!1,title:Object($.a)()?Object(f.a)(H.b):Object(f.a)(H.a),type:V.a.normal},onDismiss:this.onDismiss},M.createElement("div",{className:ee(te.content,"allowTextSelection"),tabIndex:-1},this.state.content),M.createElement(K.a,null,M.createElement(U.a,{onClick:this.onDismiss,className:te.button},Object(f.a)(G.a))))},t.prototype.setContent=function(e){this.setState({content:e})},t=r.__decorate([g.observer],t)}(M.Component);var re=n(12);function oe(e){var t=Object(re.M)(e)?e:null;if(null==t)return null;var n=t.Sender&&t.Sender.Mailbox;if(n){var r=ae(n);if(r)return r}var o=t.From&&t.From.Mailbox;if(o){var a=ae(o);if(a)return a}return null}function ae(e){return"GroupMailbox"==e.MailboxType||Object(f.g)(e.EmailAddress)?null:Object(f.g)(e.Name)?e.EmailAddress:e.Name}var ie=n(7),se=n(46),ce=n(1678),ue=n(161),le=n(52),de=n(516),pe=n(8170),me=n(3292),be=n(15),he=n(42),fe=n(5),Ie=n(2629),ge=n(3986),ve=n(529),Oe=n(195),ke=n(2706),ye=n(6338),je=n(849),Se=n(8494),Ce=n(2641),Ae=n(8191),xe=n(7193),Me=n(4440),Pe=n(25),_e=Object(Pe.b)("toggleUndoDarkMode",{name:function(e){return e.undoDarkMode?"ToggleDarkModeOn":"ToggleDarkModeOff"},actionSource:"ReadingPane"})(function(e){e&&(e.undoDarkMode=!e.undoDarkMode)}),we=n(8),Re=Object(we.action)("toggleAmpPreference")(function(e){e.preferAmp=!e.preferAmp}),Te=n(7192),Be=n(1730),Fe=n(454),Le=n(2537),De=n(8487),Ee=n(2593),Ne=n(323),He=n(6340),Ge=n(2628),Ue=n(1699),ze=n(2002),Ve=n(1975),Ke=n(2554),Je=n(1633),We=n(340),Ye=n(1101),qe=n(1996),Ze=n(745),Xe=n(260),$e=n(2717),Qe=n(1384),et=n(183),tt=n(21),nt=n(200),rt=n(3875),ot=n(214),at=n(8852),it=n(115).bind(at),st="Dropdown",ct=5,ut=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.commandBarHiddenOverflowItems=[],t.commandBarDividerKey=0,t.likeButtonClickCount=0,t.likeUnlikeInProgress=!1,t.getHandler=function(e,n,r){return function(o,a){Object(rt.k)(!1,r,a,t.getActionSource(a)),n?(t.updateSelectItemPart(),e(o,a)):o.which==le.a.enter&&(o.preventDefault(),o.stopPropagation(),t.updateSelectItemPart(),e(o,a))}},t.updateSelectItemPart=function(){t.props.viewState.isConversationItemPart&&Object(Me.a)(t.props.viewState,!1)},t.ItemHeaderToolbarButton=Object(se.a)(function(e){return M.createElement(v.a,r.__assign({},e,{menuProps:e.menuProps&&r.__assign({},e.menuProps,{directionalHint:k.a.bottomAutoEdge}),onMenuClick:t.updateSelectItemPart,styles:r.__assign({},e.styles,{root:it(at.surfaceActionsCommandBarButton,at.iconButton),rootChecked:at.checkedCommandBarButton,rootDisabled:at.disabledReplyActionButton,icon:at.enabledIconButton,iconDisabled:at.disabledIconButton,menuIcon:at.commandBarMenuIcon}),role:"button"}))}),t.ItemHeaderToolbarOverflowButton=Object(se.a)(function(e){var n=t.ItemHeaderToolbarButton;return M.createElement(j.a,{content:Object(f.a)(u.a)},M.createElement(n,r.__assign({},e)))}),t.onCommandBarReduceData=function(e){var n=e.primaryItems,o=e.overflowItems,a=e.cacheKey,i=n[0];if(void 0!==i)return t.commandBarHiddenOverflowItems=r.__spread([i],t.commandBarHiddenOverflowItems),n=n.slice(1),a=t.computeCommandBarCacheKey(n),r.__assign({},e,{primaryItems:n,overflowItems:o,cacheKey:a})},t.onCommandBarGrowData=function(e){var n=e.primaryItems,o=e.overflowItems,a=e.cacheKey,i=t.commandBarHiddenOverflowItems[0];if(void 0!==i)return t.commandBarHiddenOverflowItems=t.commandBarHiddenOverflowItems.slice(1),n=r.__spread([i],n),a=t.computeCommandBarCacheKey(n),r.__assign({},e,{primaryItems:n,overflowItems:o,cacheKey:a})},t.onResize=function(){t.commandBar&&t.commandBar.remeasure()},t.onPopout=function(e,n){e.stopPropagation();var o=Object(Xe.e)(t.props.item.MailboxInfo,t.props.viewState.itemId);Object(Xe.c)("mail",o,function(){return r.__awaiter(t,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,ke.a.import()];case 1:return[2,e.sent()(Object(re.C)())]}})})})},t.replyByIm=function(e,n){t.replyByImInternal(!1)},t.replyAllByIm=function(e,n){t.replyByImInternal(!0)},t.onReply=function(e,n){t.onReplyReplyAllInternal(e,!1,n)},t.onReplyAll=function(e,n){t.onReplyReplyAllInternal(e,!0,n)},t.onReplyReplyAllInternal=function(e,n,o){e.stopPropagation();var a=t.getConversationId();et.y.importAndExecute({referenceItemId:r.__assign({},t.props.item.ItemId,{mailboxInfo:t.props.item.MailboxInfo}),isReplyAll:n,useFullCompose:!1,actionSource:st,instrumentationContexts:[t.props.instrumentationContext],conversationId:a,suppressServerMarkReadOnReplyOrForward:Object(re.R)(Object(re.C)())})},t.onForward=function(e,n){e.stopPropagation(),et.o.importAndExecute(r.__assign({},t.props.item.ItemId,{mailboxInfo:t.props.item.MailboxInfo}),st,[t.props.instrumentationContext],Object(re.R)(Object(re.C)()))},t.onReplyByMeeting=function(e,n){e.stopPropagation(),Object(Ae.a)(t.props.item.ItemId.Id,null,!1,st)},t.onLikeUnLike=function(){return function(e,n){e.stopPropagation(),!t.likeUnlikeInProgress&&n&&(t.likeUnlikeInProgress=!0,t.asyncLikeItem(n))}},t.asyncLikeItem=function(e){return r.__awaiter(t,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,nt.p.import()];case 1:return e=t.sent(),this.likeButtonClickCount++,e(r.__assign({},this.props.item.ItemId,{mailboxInfo:this.props.item.MailboxInfo}),this.props.item,Object(re.C)(),this.likeButtonClickCount>=ct,this.props.instrumentationContext),this.likeUnlikeInProgress=!1,[2]}})})},t.onDelete=function(e,n){e.stopPropagation();var r=t.getConversationId();if(r&&Object(fe.e)("rp-selectionUI")){var o=Object(Se.b)(r,t.props.viewState);nt.j.importAndExecute([t.props.item.ItemId.Id],Object(Ee.a)(t.props.item.ItemId.Id),[t.props.instrumentationContext],st,t.props.item.MailboxInfo,!0).then(function(){Object(xe.a)(o,r)})}else nt.j.importAndExecute([t.props.item.ItemId.Id],Object(Ee.a)(t.props.item.ItemId.Id),[t.props.instrumentationContext],st,t.props.item.MailboxInfo).then(function(){t.props.isDeeplink&&window.close()})},t.onToggleJunkNotjunk=function(){return function(e,n){e.stopPropagation(),nt.r.importAndExecute(t.props.item.ItemId.Id,Object(re.C)(),st,[t.props.instrumentationContext]),Object(Oe.a)()}},t.onPhishing=function(e,n){e.stopPropagation(),nt.q.importAndExecute(t.props.item.ItemId.Id,Object(re.C)(),st),Object(Oe.a)()},t.onReportAbuse=function(e,n){e.stopPropagation(),He.b.importAndExecute(t.props.item,Object(re.C)(),[t.props.instrumentationContext],st),Object(Oe.a)()},t.onBlock=function(e,n){e.stopPropagation(),nt.f.importAndExecute(t.props.item.ItemId.Id,[t.props.instrumentationContext],st),Object(Oe.a)()},t.onToggleReadMenuItem=function(e,n){e.stopPropagation();var r=t.props.item;je.c.importAndExecute(t.props.item.ItemId.Id,Object(re.C)(),!r.IsRead,[t.props.instrumentationContext],st)},t.onToggleFlagMenuItem=function(e,n){var r;e.stopPropagation(),r="Flagged"!=t.props.item.Flag.FlagStatus?"Flagged":"NotFlagged",nt.F.importAndExecute([t.props.item.ItemId.Id],[t.props.instrumentationContext],{FlagStatus:r},Object(re.C)().id,st)},t.onAddToSafeSenders=function(e,n){e.stopPropagation();var r=t.props.item;nt.c.import().then(function(e){e(r.Sender.Mailbox,r.ItemId.Id,t.getActionSource(n))})},t.onAssignPolicy=function(e,t){e.stopPropagation()},t.onCreateRule=function(e,n){e.stopPropagation();var r=t.props.item;ze.a.importAndExecute(r.From.Mailbox,t.getActionSource(n))},t.onPrint=function(e,n){e.stopPropagation(),Object(Ce.a)(r.__assign({},t.props.item.ItemId,{mailboxInfo:t.props.item.MailboxInfo}),st)},t.onTranslate=function(e,n){e.stopPropagation(),ye.e.importAndExecute(t.props.item.ItemId.Id,Object(De.a)(),!0)},t.onShowInImmersiveReader=function(e,n){e.stopPropagation(),Object(Ie.d)(r.__assign({},t.props.item.ItemId,{mailboxInfo:t.props.item.MailboxInfo}),st,t.getActionSource(n))},t.onViewMessageSource=function(e,n){e.stopPropagation(),Object(be.o)("ViewMessageSource",{subActionSource:t.getActionSource(n)},{actionSource:st}),function(e){r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){return(t=document.createElement("div")).id="ViewMessageSourceDialog",document.body.appendChild(t),n=Q.render(M.createElement(ne,{onClose:function(){Q.unmountComponentAtNode(t),document.body.removeChild(t)}}),t),Object($.a)()?e.MimeContent?n.setContent(atob(e.MimeContent.Value)):X(e).then(function(t){e.MimeContent=t,n.setContent(atob(e.MimeContent.Value))}):Z(e).then(function(e){n.setContent(e)}),[2]})})}(t.props.item)},t.onToggleAmp=function(e){e.stopPropagation(),Re(t.props.viewState.ampViewState)},t.onToggleUndoDarkMode=function(e,n){e.stopPropagation(),_e(t.props.viewState)},t.renderLikeCustomButtonMenuItem=function(e){return M.createElement(E,{ref:function(e){return t.customLikeButton=e},surfaceActionItem:e,message:t.props.item})},t.onToggleInteractiveContent=function(){var e=t.getReadingPaneViewState();Object(Te.a)(e,!e.showDownlevelContent)},t}return r.__extends(t,e),t.prototype.disableTranslate=function(e,t){return!e.CopyAllowed||!e.ForwardAllowed||!e.ReplyAllAllowed||!e.ReplyAllowed||!e.PrintAllowed||!t.TranslationData||!t.TranslationData.userLanguage||t.TranslationData.isShowingTranslation||t.TranslationData.isTranslating},t.prototype.shouldAddBlockSafeSenderMenuItemForFolder=function(e){return!Object(We.a)(e.ParentFolderId.Id,"drafts")&&e.Sender&&e.Sender.Mailbox&&!Object(Ve.a)(e.Sender.Mailbox.EmailAddress)&&null!=oe(e)},t.prototype.shouldAddAssignPolicyMenuItem=function(e){return!this.isGroupItem()&&(Object(tt.I)(e,tt.h)||Object(tt.I)(e,tt.c)||Object(tt.I)(e,"favorites"))},t.prototype.blockMenuItemName=function(e){return Object(f.b)(Object(f.a)(d.a),oe(e))},t.prototype.isCSAExperimentUser=function(){return Object(fe.e)("rp-csaExp")||Object(fe.e)("rp-csaExpWithMenuIcons")},t.prototype.createCommandBarItems=function(e,t){var n=this;this.commandBarHiddenOverflowItems=[];var o=[],a=[],i=Object(rt.i)(),s=this.props.customizedSubsetActionKeys&&this.props.customizedSubsetActionKeys.length>0?i.filter(function(e){return n.props.customizedSubsetActionKeys.indexOf(e.key)>-1}):i;this.props.viewState&&this.props.viewState.isYammerThread&&(this.addToggleInteractiveContentItem(a),this.tryAddDivider(a,{key:(this.commandBarDividerKey++).toString(),displayName:rt.a,itemType:ue.a.Divider,onClick:null}));var c=r.__read(Object($e.a)(this.props.item,this.props.viewState.isConversationItemPart),3),u=c[0],l=c[1],d=c[2];return s.forEach(function(i){var s=n.tryCreateStaticActionCommandBarItem(i,e,t,u,l,d);if(s){var c=i.key;if(n.props.hideSurfaceButton)n.addItemToCommandBarOverflow(c,a,s);else if(n.isCSAExperimentUser()){var p=s;(n.props.shouldIncludeFullInfo||Object(fe.e)("rp-selectionUI"))&&Object(rt.n)(c)&&(p=r.__assign({},s),n.addItemToCommandBarSurface(c,o,s)),n.addItemToCommandBarOverflow(c,a,p)}else Object(rt.n)(c)?n.addItemToCommandBarSurface(c,o,s):n.addItemToCommandBarOverflow(c,a,s)}}),this.tryCreateAddinsCommandBarItems(o,a),!this.isCSAExperimentUser()||this.props.shouldIncludeFullInfo||Object(fe.e)("rp-selectionUI")||o.push({key:"charms",onRender:function(){return M.createElement("div",{className:at.surfaceActionsCommandBarCharms},n.renderCharms())}}),{items:this.props.hideSurfaceButton?[]:o,overflowItems:this.props.isFloatingActionBar?[]:a}},t.prototype.addItemToCommandBarSurface=function(e,t,n){n.isPinned=!0,Object(rt.o)(e)?t.push(n):t.unshift(n)},t.prototype.addItemToCommandBarOverflow=function(e,t,n){n.renderedInOverflow=!0,n.onRender=null,"-"==e?this.tryAddDivider(t,n):t.push(n)},t.prototype.tryAddDivider=function(e,t){var n=e.length;n>0&&e[n-1].displayName!=rt.a&&e.push(t)},t.prototype.tryCreateStaticActionCommandBarItem=function(e,t,n,r,a,u){if(e.hideInGroup&&this.isGroupItem()||e.hideInSxS&&this.props.isItemAttachment)return null;var d,I=e.key,g=Object(rt.g)(I),v=Object(rt.h)(I).iconName,O=null,k=!1,y=null,j=e.key,S=this.props.item;switch(I){case"LikeUnlike":if(!Object($.a)()&&!Object(tt.I)(S.ParentFolderId.Id,tt.j)){var C=Object(_.a)().SessionSettings.UserEmailAddress,A=!!S.Likers&&S.Likers.some(function(e){return e.EmailAddress===C});d=this.onLikeUnLike(),A&&(v="LikeSolid",g=Object(f.a)(o.e)),Object(rt.n)(e.key)&&(y=this.renderLikeCustomButtonMenuItem)}break;case"ToggleAmp":var x=this.props.viewState.ampViewState,M=x.preferAmp,P=x.ampAvailability;Object(Qe.a)()&&P==Be.a.AmpValidated&&(g=M?Object(f.a)(s.a):Object(f.a)(c.a),j=M?"ViewAsOriginal":"ViewAsDynamic",d=this.onToggleAmp);break;case"Reply":d=this.onReply,k=r;break;case"ReplyAll":d=this.onReplyAll,k=a;break;case"Forward":d=this.onForward,k=u;break;case"ReplyByMeeting":d=this.onReplyByMeeting,k=n;break;case"Popout":this.props.isItemAttachment||this.props.isDeeplink||(d=this.onPopout);break;case"Delete":!this.props.isItemAttachment&&Object(ve.b)(8)&&(d=this.onDelete,k=!!this.isGroupItem()&&!S.CanDelete);break;case"MarkReadUnread":this.isGroupPopout()||(g=S.IsRead?Object(f.a)(b.a):Object(f.a)(i.a),j=S.IsRead?"MarkItemUnread":"MarkItemRead",d=this.onToggleReadMenuItem);break;case"FlagUnflag":if(Object(ve.b)(10)){var w=!S.Flag||"Flagged"!=S.Flag.FlagStatus;g=w?Object(f.a)(m.a):Object(f.a)(o.d),j=w?"FlagItem":"UnflagItem",d=this.onToggleFlagMenuItem}break;case"AssignPolicy":if(this.shouldAddAssignPolicyMenuItem(S.ParentFolderId.Id)){d=this.onAssignPolicy;var R=Object(re.C)();O=Object(Ge.c)(R?R.id:null,"RPCSAOverflow",this.props.item)}break;case"AddToSafeSenders":this.shouldAddBlockSafeSenderMenuItemForFolder(S)&&(d=this.onAddToSafeSenders);break;case"MarkJunkNotJunk":Object(ve.g)()&&Object(tt.K)(S.ParentFolderId.Id)&&(g=this.isInJunkFolder?Object(f.a)(o.b):Object(f.a)(p.a),j=this.isInJunkFolder?"MarkItemNotjunk":"MarkItemJunk",d=this.onToggleJunkNotjunk());break;case"MarkAsPhishing":d=this.onPhishing;break;case"Block":this.shouldAddBlockSafeSenderMenuItemForFolder(S)&&Object(tt.K)(S.ParentFolderId.Id)&&(g=this.blockMenuItemName(S),d=this.onBlock);break;case"ReportAbuse":Object(fe.e)("tri-reportAbuse")&&(g=Object(f.a)(h.a),d=this.onReportAbuse);break;case"CreateRule":Object(Ue.b)()&&this.itemHasSenderSMTP()&&Object(tt.K)(S.ParentFolderId.Id)&&(d=this.onCreateRule);break;case"Print":d=this.onPrint,k=!t.PrintAllowed;break;case"Translate":d=this.onTranslate,k=this.disableTranslate(t,this.props.item);break;case"ShowInImmersiveReader":d=this.onShowInImmersiveReader;break;case"ViewMessageSource":d=this.onViewMessageSource;break;case"ToggleDarkMode":var T=this.props.viewState.undoDarkMode;g=T?Object(f.a)(o.a):Object(f.a)(l.a),v=T?"ClearNight":"Sunny",j=T?"ToggleDarkModeOn":"ToggleDarkModeOff",d=this.onToggleUndoDarkMode;break;case"ReplyByIM":d=this.replyByIm,k=!Object(Ye.d)();break;case"ReplyAllByIM":d=this.replyAllByIm,k=!Object(Ye.d)();break;case"-":return{key:(this.commandBarDividerKey++).toString(),displayName:rt.a,itemType:ue.a.Divider,onClick:null}}return d?{key:I,name:g,iconProps:{iconName:v,className:it(at.commandBarIcon,{hideMenuIcon:!Object(fe.e)("rp-csaExpWithMenuIcons")})},onRender:y,disabled:k,onClick:this.getHandler(d,!0,j),onKeyDown:this.getHandler(d,!1,j),iconOnly:!0,ariaLabel:g,subMenuProps:O}:null},t.prototype.tryCreateAddinsCommandBarItems=function(e,t){var n=this;if(this.shouldAddinsPopulate()){var o,a=[],i=[],s=Object(ot.c)(ot.a.SurfaceActions);if(this.props.viewState.isConversationItemPart&&Object(fe.e)("rp-selectionUI")){var c=Object(Le.b)();o=c&&c.itemId}Object(pe.a)(me.a.MessageRead,this.props.item,o||this.props.item.ItemId.Id,s.readSurfaceAddins,a,i,!0,this.commandBarDividerKey,null,this.isCSAExperimentUser()),a.forEach(function(e){if(e.onClick){var t=e.onClick;e.onClick=n.getHandler(t,!0,"Addins"),e.onKeyDown=n.getHandler(t,!1,"Addins")}}),i.forEach(function(e){if(e.onClick){var t=e.onClick;e.onClick=n.getHandler(t,!0,"Addins"),e.onKeyDown=n.getHandler(t,!1,"Addins")}}),e.unshift.apply(e,r.__spread(a)),t.push.apply(t,r.__spread(i))}},t.prototype.componentDidMount=function(){Je.a.importAndExecute(this.onResize)},t.prototype.componentWillUnmount=function(){Je.c.importAndExecute(this.onResize)},t.prototype.componentDidUpdate=function(){this.shouldAddinsPopulate()&&Object(ge.h)(de.h.Single,Object(de.o)(this.props.item.ItemId.Id))},t.prototype.render=function(){var e=this.props.isParentComponentMounted,t=!this.props.item.ParentFolderId||!Object(We.a)(this.props.item.ParentFolderId.Id,"notes"),n=(null==e||e)&&t;return M.createElement("div",{className:at.surfaceActionsCommandBarContainer},n&&this.renderCommandBar())},t.prototype.renderCommandBar=function(){var e=this;if(!this.props.viewState)return null;var t=Object(Ke.a)(this.props.item),n=Object(Ze.a)(this.props.item),r=this.createCommandBarItems(t,n),i=it(at.itemHeaderDropDownButtonCharms,this.customLikeButton&&this.customLikeButton.IsLikersListShown()&&at.hideCharms);return M.createElement(M.Fragment,null,M.createElement(ce.a,{componentRef:function(t){return e.commandBar=t},items:r.items,overflowItems:r.overflowItems,overflowButtonProps:{menuIconProps:{iconName:"More",styles:{root:Object(f.g)(this.props.seeMoreStyles)?at.surfaceActionsCommandBarOverflowIcon:it(at.surfaceActionsCommandBarOverflowIcon,this.props.seeMoreStyles)}},ariaLabel:Object(f.a)(a.a)},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:rt.m,onDataGrown:rt.l,styles:{root:at.surfaceActionsCommandBar,primarySet:at.surfaceActionsCommandBarPrimarySet},ariaLabel:Object(f.a)(o.c),onReduceData:this.isCSAExperimentUser()?this.onCommandBarReduceData:void 0,onGrowData:this.isCSAExperimentUser()?this.onCommandBarGrowData:void 0}),!this.isCSAExperimentUser()&&!(this.props.shouldIncludeFullInfo||Object(fe.e)("rp-selectionUI"))&&M.createElement("div",{className:i},this.renderCharms()))},t.prototype.renderCharms=function(){var e=this.props.item;return M.createElement(I.b,{message:e,importance:e.Importance,hasAttachments:!1,flagStatus:e.Flag?e.Flag.FlagStatus:"NotFlagged",charmSize:I.a.size16,itemClass:e.ItemClass})},t.prototype.computeCommandBarCacheKey=function(e){return[e.reduce(function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)},""),"","overflow"].join(" ")},t.prototype.getConversationId=function(){var e=this.props.viewState.isConversationItemPart&&this.props.item.ConversationId?this.props.item.ConversationId.Id:null;return Object(Ne.a)()?null:e},t.prototype.isGroupPopout=function(){return this.props.isDeeplink&&this.isGroupItem()},t.prototype.isGroupItem=function(){return!!this.props.item.MailboxInfo&&this.props.item.MailboxInfo.type===he.a.GroupMailbox},Object.defineProperty(t.prototype,"isInJunkFolder",{get:function(){var e=this.props.item;return Object(We.a)(e.ParentFolderId.Id,"junkemail")},enumerable:!0,configurable:!0}),t.prototype.replyByImInternal=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o,a,i;return r.__generator(this,function(s){switch(s.label){case 0:return t=this.props.item,[4,et.q.import()];case 1:return[4,s.sent()(t,e)];case 2:return n=r.__read.apply(void 0,[s.sent(),2]),o=n[0],a=n[1],(i=r.__spread(o,a).map(function(e){return e.SipUri?e.SipUri:"sip:"+e.EmailAddress})).length>0&&Ye.f.import().then(function(n){return n(i,t.Subject,e?3:2)}),[2]}})})},t.prototype.itemHasSenderSMTP=function(){var e=Object(re.M)(this.props.item)?this.props.item:null;return!!(e&&e.From&&e.From.Mailbox)},t.prototype.addToggleInteractiveContentItem=function(e){var t=Object(f.a)(c.a),n="ToggleInteractiveContentOn",r=this.onToggleInteractiveContent,o={key:n,name:t,iconProps:{className:it(at.commandBarIcon,{hideMenuIcon:!Object(fe.e)("rp-csaExpWithMenuIcons")})},iconOnly:!0,disabled:!1,onClick:this.getHandler(r,!0,n),onKeyDown:this.getHandler(r,!1,n),ariaLabel:t};this.addItemToCommandBarOverflow("ToggleInteractiveContent",e,o)},t.prototype.shouldAddinsPopulate=function(){var e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&(this.props.shouldIncludeFullInfo||Object(fe.e)("rp-selectionUI"));return!(!Object(fe.e)("rp-addins")||!e||Object(et.d)(this.getConversationId())||this.props.isItemAttachment||!Object(de.O)(this.props.item)||this.isGroupItem()||Object(qe.a)(this.props.item))},t.prototype.getActionSource=function(e){var t="RPCSAPinned";return e&&e.renderedInOverflow&&(t=e.isPinned?"RPCSAOverflow":"RPCSANotPinned"),this.props.actionSource&&(t=this.props.actionSource),t},t.prototype.getReadingPaneViewState=function(){return this.props.viewState.isConversationItemPart?Fe.a.conversationReadingPaneViewState:Fe.a.itemReadingPaneViewState},r.__decorate([ie.computed],t.prototype,"isInJunkFolder",null),t=r.__decorate([g.observer],t)}(M.Component);n.d(t,"ItemActions",function(){return ut}),n.d(t,"Charms",function(){return I.b})},1653:function(e){e.exports={a:"jab"}},1692:function(e){e.exports={a:"Xwb"}},1888:function(e){e.exports={a:"vab"}},1895:function(e){e.exports={a:"oab"}},2002:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),o=new r.c(function(){return Promise.all([n.e(76),n.e(521),n.e(20),n.e(46),n.e(269)]).then(n.bind(null,3007))}),a=new r.a(o,function(e){return e.showInboxRuleDialog})},2093:function(e){e.exports={a:"lab"}},2094:function(e){e.exports={a:"tab"}},2105:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("SHOW_IN_IMMERSIVE_READER",function(e,t,n){return{itemId:e,actionSource:t,subActionSource:n}})},2129:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(15);function o(e){var t=e.isArchiveTag,n=e.actionSource,o=e.responseClass;Object(r.o)("TnS_RetentionPolicySelected",[t,n,o])}},2182:function(e){e.exports={a:"fGb",b:"gGb",c:"hGb"}},2316:function(e,t,n){var r=n(2986),o=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},2368:function(e){e.exports={b:"pGb",a:"qGb"}},2499:function(e){e.exports={a:"uab"}},2500:function(e){e.exports={a:"rab"}},2501:function(e){e.exports={a:"qab"}},2628:function(e,t,n){"use strict";var r=n(3),o=n(848),a=n(0),i=n(2093),s=n(4),c=n(21);var u=n(2709),l=n(161),d=n(2316);function p(e){var t=e.retentionId,n=e.displayName,r=e.isChecked,o=e.subMenuProps;return{key:t,text:n,data:t,onClick:e.onClickCallback,checked:r,itemProps:r?{styles:{label:d.checkedItem}}:null,iconProps:r?{iconName:"CheckMark",className:d.checkmark}:null,subMenuProps:o}}var m=n(2182);function b(e){var t=e.retentionId,n=e.retentionPolicyTags,r=e.folderType,o=e.isArchive,a=e.isChecked,i=e.onClickCallback,c=function(e,t){return 12==e?t?Object(s.a)(m.a):Object(s.a)(m.b):Object(s.a)(m.c)}(r,o);return p({retentionId:t,displayName:17!=r?function(e){var t=e.retentionPolicyTags,n=e.folderType,r=e.isArchive,o=e.defaultName;return t.reduce(function(e,t){return t.Type===n&&t.IsArchive==r?t.DisplayName:e},o)}({retentionPolicyTags:n,folderType:r,isArchive:o,defaultName:c}):c,isChecked:a,subMenuProps:null,onClickCallback:i})}var h=n(2316);function f(e,t,n,r,a){var i=!1;return(12==r?[]:e.map(function(e){var r=e.RetentionId===n;return r&&(i=!0),p({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&r,subMenuProps:null,onClickCallback:a})})).concat(b({retentionId:o.a,retentionPolicyTags:e,folderType:r,isArchive:!0,isChecked:t&&!i,onClickCallback:a}))}var I=n(2710);var g=n(2316);function v(e,t,n,r,a,i){var s=!1;return(17!=r||"archive"===a?[]:function(e){var t={},n=e.filter(function(e){return null==e.ParentLabelIdentity||e.ParentLabelIdentity.length<=0}).reduce(function(e,n){var r={parentPolicyTag:n,childrenPolicyTags:[]};return e.push(r),t[n.RetentionId]=r,e},[]);return e.filter(function(e){return null!=e.ParentLabelIdentity&&e.ParentLabelIdentity.length>0&&e.ParentLabelIdentity in t}).forEach(function(e){t[e.ParentLabelIdentity].childrenPolicyTags.push(e)}),n}(e).map(function(e){var r=function(e,t,n,r){var o=e.parentPolicyTag,a=e.childrenPolicyTags,i=o.RetentionId===n;if(null==a||0==a.length)return{item:p({retentionId:o.RetentionId,displayName:o.DisplayName,isChecked:t&&i,subMenuProps:null,onClickCallback:r}),policyFound:i};var s=!1,c=a.map(function(e){var o=e.RetentionId===n;return o&&(s=!0),p({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&o,subMenuProps:null,onClickCallback:r})});return{item:p({retentionId:o.RetentionId,displayName:o.DisplayName,isChecked:t&&i,subMenuProps:{items:c},onClickCallback:null}),policyFound:s}}(e,t,n,i);return r.policyFound&&(s=!0),r.item})).concat(b({retentionId:o.c,retentionPolicyTags:e,folderType:r,isArchive:!1,isChecked:t&&!s,onClickCallback:i}))}function O(e){var t=e.retentionPolicyTagList,n=e.showTagSelection,r=e.selectedArchiveTag,o=e.selectedDeleteTag,i=e.treeType,d=e.distinguishedFolderId,p=e.hasArchive,m=e.onArchivePolicyClickedCallback,b=e.onDeletePolicyClickedCallback,O=[],y=p&&i!=c.c,j=function(e){switch(e){case"msgfolderroot":case"archivemsgfolderroot":return 12;case"deleteditems":case"archivedeleteditems":return 3;case"recoverableitemsdeletions":case"archiverecoverableitemsdeletions":return 18;case"calendar":return 1;case"contacts":return 2;case"conversationhistory":return 16;case"drafts":return 4;case"inbox":return 5;case"junkemail":return 6;case"journal":return 7;case"notes":return 8;case"outbox":return 9;case"sentitems":return 10;case"syncissues":return 15;case"tasks":return 11;case"none":default:return 17}}(d),S=t.filter(function(e){return e.IsVisible&&e.IsArchive}).sort(k),C=t.filter(function(e){return e.IsVisible&&!e.IsArchive}).sort(k);return y&&O.push.apply(O,a.__spread(function(e,t,n,r,o){var a=n&&n.IsExplicit?n.Value:null;return[{key:"archiveSection",className:h.sectionHeader,itemType:l.a.Section,sectionProps:{bottomDivider:!0,title:Object(s.a)(u.a),items:f(e,t,a,r,o)}}]}(S,n,r,j,m))),O.push.apply(O,a.__spread(function(e,t,n,r,o,a){var i=n&&n.IsExplicit?n.Value:null;return[{key:"deleteSection",className:g.sectionHeader,itemType:l.a.Section,sectionProps:{title:Object(s.a)(I.a),items:v(e,t,i,r,o,a)}}]}(C,n,o,j,d,b))),{items:O}}function k(e,t){return e.RetentionPeriod&&t.RetentionPeriod?e.RetentionPeriod-t.RetentionPeriod:t.RetentionPeriod?1:-1}var y=n(9),j=n(41);function S(e){if(Object(j.a)())return null;var t=Object(y.a)(),n=e.treeType,r=t.RetentionPolicyTags;return r&&0!==r.length&&n!==c.j?{key:"AssignPolicy",name:Object(s.a)(i.a),disabled:!1,subMenuProps:O(a.__assign({},e,{showTagSelection:!0,retentionPolicyTagList:r,hasArchive:!!t.SessionSettings.HasArchive}))}:null}var C=n(155),A=n(12),x=n(219);var M=n(1341),P=n(224);function _(e,t,n){var r=A.O.tableViews.get(e);if(!r)return null;var o=function(e){if(e&&Object(C.e)(e.tableQuery)){var t=C.i.tryImportForRender();return t?t(e.tableQuery):[]}return Object(y.a)().RetentionPolicyTags}(r);if(!o||!o.length)return null;var i=function(e){var t,n;if(e&&Object(C.e)(e.tableQuery))t=null,n="groups";else{var r=Object(x.e)(e),o=r&&Object(c.y)().get(r);if(!o)return null;t=o.DistinguishedFolderId||o.FolderId.Id,n=o.treeType}return{folderId:t,treeType:n}}(r);if(!i)return null;var s,u,l,d=a.__spread(r.selectedRowKeys.keys());return n?(s=n.ArchiveTag,u=n.PolicyTag,l=!0):(s=1==d.length?A.b.getArchiveTag(d[0],r):null,u=1==d.length?A.b.getPolicyTag(d[0],r):null,l=1==d.length),O({retentionPolicyTagList:o,showTagSelection:l,selectedArchiveTag:s,selectedDeleteTag:u,treeType:i.treeType,distinguishedFolderId:"none",hasArchive:w(r),onArchivePolicyClickedCallback:R({isArchivePolicyClicked:!0,tableView:r,selectedTag:s,folderId:i.folderId,clientItem:n,actionSource:t}),onDeletePolicyClickedCallback:R({isArchivePolicyClicked:!1,tableView:r,selectedTag:u,folderId:i.folderId,clientItem:n,actionSource:t})})}function w(e){return(!e||!Object(C.e)(e.tableQuery))&&!!Object(y.a)().SessionSettings.HasArchive}function R(e){var t=e.isArchivePolicyClicked,n=e.tableView,r=e.selectedTag,i=e.folderId,s=e.clientItem,c=e.actionSource;return function(e,u){var l,d,p,m;if(l={retentionTag:r,retentionId:u.data,inheritSubMenuIdentifier:t?o.a:o.c},d=l.retentionTag,p=l.retentionId,m=l.inheritSubMenuIdentifier,!!d&&p!=d.Value||!d&&p!=m){var b="RPCSAOverflow"==c||1===n.tableQuery.listViewType,h=a.__spread(n.selectedRowKeys.keys()),f=Object(P.b)(n);if(b){var I="RPCSAOverflow"==c?[s.ItemId.Id]:h.map(function(e){return Object(A.G)(e,n.id).clientId.Id});Object(M.d)(t,u.data,I,c,f)}else{var g=h.map(function(e){return Object(A.h)(e,n.id)});I=h.reduce(function(e,t){var r=Object(A.F)(t,n.id);return r&&e.push.apply(e,a.__spread(r.itemIds)),e},[]);Object(M.c)(t,u.data,i,g,I,c,f)}}}}function T(e){var t=e.folder,n=e.retentionId,r=e.inheritSubMenuIdentifier,a=r===o.a?t.ArchiveTag:t.PolicyTag;return!!a&&n!=a.Value||!a&&n!=r}var B=n(1838),F=n.n(B),L=n(236),D=n.n(L),E=n(2449),N=n.n(E),H=n(2452),G=n.n(H),U=n(27),z=n(2436),V=n.n(z),K=n(65),J=n.n(K),W=n(1845),Y=n.n(W),q=n(1867),Z=n.n(q);function X(e,t,n,r){var o=function(e,t,n){var r,o=t?"ItemArchiveTag":"ItemPolicyTag",a=t?"ArchiveTag":"PolicyTag",i=[n?Y()({Path:J()({FieldURI:o}),Item:V()((r={},r[a]=n,r))}):Z()({Path:J()({FieldURI:o})})],s=[];return e.forEach(function(e){return s.push(F()({Updates:i,ItemId:D()({Id:e})}))}),G()({ItemChanges:s,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:!1,ClientSupportsIrm:!0,OutboundCharset:"AutoDetect",SendCalendarInvitationsOrCancellations:"SendToNone"})}(e,t,n);return N()({Header:Object(U.getJsonRequestHeader)(),Body:o},r).then(function(e){return e.Body.ResponseMessages.Items[0]})}var $=n(1),Q=n(11),ee=n(2129),te=(Object($.orchestrator)(M.d,function(e){return a.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i,s,c,u,l;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,r=e.itemIds,i=e.actionSource,s=e.mailboxInfo,c=n===o.a||n===o.c?null:{Value:n,IsExplicit:!0},[4,X(r,t,c,s.requestOptions)];case 1:return"Success"==(u=a.sent()).ResponseClass&&Object(M.e)(c,t,r),Object(ee.a)({isArchiveTag:t,actionSource:i,responseClass:u.ResponseClass}),[3,3];case 2:return l=a.sent(),Q.c.error("Error while updating item retention tag "+l),[3,3];case 3:return[2]}})})}),n(2490)),ne=n.n(te),re=n(2491),oe=n.n(re),ae=n(2492),ie=n.n(ae),se=n(266),ce=n.n(se),ue=n(1369),le=n(111),de=n.n(le),pe=n(102),me=n.n(pe),be=n(28);function he(e,t,n,r,o){var a=function(e,t,n,r){var o=e.map(function(e){return function(e,t,n,r){var o=ie()({Action:"SetRetentionPolicy",ConversationId:D()({Id:e.conversationId}),RetentionPolicyType:n});t&&(o.RetentionPolicyTagId=t);if(r){var a=ce()({BaseFolderId:(i=r,Object(be.a)(i)?de()({Id:i}):me()({Id:i}))});o.ContextFolderId=a}var i;return o}(e,t,n,r)});return oe()({ConversationActions:o,ReturnMovedItemIds:!1})}(e,t,n,r);return ne()({Header:Object(ue.getJsonRequestHeader)(),Body:a},o).then(function(e){return e.Body.ResponseMessages.Items[0]})}Object($.orchestrator)(M.c,function(e){return a.__awaiter(void 0,void 0,void 0,function(){var t,n,r,i,s,c,u,l,d,p,m,b;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,r=e.folderId,i=e.conversationActionContexts,s=e.itemIds,c=e.actionSource,u=e.mailboxInfo,l=t?1:0,d=n===o.a||n===o.c,[4,he(i,d?null:n,l,r,u.requestOptions)];case 1:return"Success"==(p=a.sent()).ResponseClass&&(m=d?null:{Value:n,IsExplicit:!0},Object(M.e)(m,t,s)),Object(ee.a)({isArchiveTag:t,actionSource:c,responseClass:p.ResponseClass}),[3,3];case 2:return b=a.sent(),Q.c.error("Error while updating conversation retention tag"+b),[3,3];case 3:return[2]}})})});var fe=n(29);Object($.mutator)(M.e,function(e){var t=e.itemIds,n=e.tag,r=e.isArchiveTag;t.forEach(function(e){var t=fe.H.items.get(e);t&&(r?t.ArchiveTag=n:t.PolicyTag=n)})}),n.d(t,"f",function(){return ge}),n.d(t,"g",function(){return ve}),n.d(t,"a",function(){return o.a}),n.d(t,"b",function(){return o.c}),n.d(t,"d",function(){return S}),n.d(t,"c",function(){return _}),n.d(t,"e",function(){return T});var Ie=new r.c(function(){return n.e(371).then(n.bind(null,13744))}),ge=new r.b(Ie,function(e){return e.onArchiveTagForFolderChanged}),ve=new r.b(Ie,function(e){return e.onDeleteTagForFolderChanged})},2629:function(e,t,n){"use strict";var r=n(0),o=n(2368),a=n(4),i=n(1),s=n(2105),c=function(e){return new Promise(function(t){return setTimeout(function(){t()},e)})},u=n(2637),l=n.n(u);function d(e,t,n,r){return l()({itemId:e,sessionId:t,version:n},r)}var p=n(15),m=n(246),b=n(236),h=n.n(b),f=(Object(i.orchestrator)(s.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,i,s,u,l,b,v,O,y,j,S,C;return r.__generator(this,function(r){switch(r.label){case 0:if(t=e.itemId,n=k(),!t||n.isLoading||0!==n.immersiveReaderFrameState)return[2];(i=new p.a("ShowInImmersiveReader")).addCustomData({sessionId:n.sessionId,subAction:e.subActionSource}),i.addActionSource(e.actionSource),f(!0),I(!0),s=(new Date).getUTCMilliseconds(),u=!0,l=null,b=null,r.label=1;case 1:return r.trys.push([1,7,8,9]),[4,d(h()({Id:t.Id}),n.sessionId,"2.0",t.mailboxInfo&&t.mailboxInfo.requestOptions)];case 2:if(v=r.sent(),i.addCheckmark("ImmersiveReaderProcessText_Done"),v&&v.ReaderModelJson?l=JSON.parse(v.ReaderModelJson):(u=!1,b="Response from service call was null or did not contain a ReaderModelJson"),!u)return[3,6];O=(new Date).getUTCMilliseconds(),y=(O-s).toString(),null,l.launchToPostMessageSentDurationInMs=y,g({messageType:"LinguisticModel",messageValue:l}),j=120,S=0,r.label=3;case 3:return S<j&&1===k().immersiveReaderFrameState?[4,c(500)]:[3,5];case 4:return r.sent(),S++,[3,3];case 5:1===k().immersiveReaderFrameState&&(u=!1,b="Frame never got to Ready state"),r.label=6;case 6:return[3,9];case 7:return C=r.sent(),u=!1,i.addCheckmark("CaughtException"),b=C.toString(),[3,9];case 8:return f(!1),[7];case 9:return u?i.end():(I(!1),i.endWithError("ServerError",new Error(b)),Object(m.b)(Object(a.a)(o.b),Object(a.a)(o.a),!1,{hideCancelButton:!0})),[2]}})})}),Object(i.mutatorAction)("toggleImmersiveReaderLoadingState",function(e){k().isLoading=e})),I=Object(i.mutatorAction)("toggleImmersiveReaderShowingState",function(e){k().immersiveReaderFrameState=e?1:0}),g=Object(i.mutatorAction)("setImmersiveReaderApiResponse",function(e){k().apiResponse=e}),v=n(86),O={sessionId:Object(v.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},k=Object(i.createStore)("immersivereader",O),y=k(),j=Object(i.mutatorAction)("setImmersiveReaderFrameReady",function(){k().immersiveReaderFrameState=2}),S=Object(i.mutatorAction)("closeImmersiveReader",function(){var e=k();e.immersiveReaderFrameState=0,e.apiResponse=null});n.d(t,"e",function(){return y}),n.d(t,"b",function(){return k}),n.d(t,"c",function(){return j}),n.d(t,"a",function(){return S}),n.d(t,"d",function(){return s.a})},2706:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),o=new r.c(function(){return n.e(227).then(n.bind(null,3249))}),a=new r.b(o,function(e){return e.preparePopoutDataForReadingPane})},2709:function(e){e.exports={a:"iGb"}},2710:function(e){e.exports={a:"eGb"}},2717:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(2642),o=n(5),a=n(2554),i=n(41),s=n(745);function c(e,t){var n=Object(a.a)(e),c=Object(s.a)(e)&&(t||!Object(i.a)()&&(!Object(o.e)("rp-smime")||!Object(o.e)("cmp-smime"))),u=Object(r.b)(e);return[!n.ReplyAllowed||u||c,!n.ReplyAllAllowed||u||c,!n.ForwardAllowed||c]}},2986:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,"._2Ij1xLT_HLp88M37zkVcqx{font-weight:600}html[dir] ._23f4dMU1_LGLt4GgPo3Lk9 .ms-ContextualMenu-header{padding:0 4px}._2XmjPcdNPHzJnErHgc7pg8{font-weight:700}",""]),t.locals={checkedItem:"_2Ij1xLT_HLp88M37zkVcqx",sectionHeader:"_23f4dMU1_LGLt4GgPo3Lk9",checkmark:"_2XmjPcdNPHzJnErHgc7pg8"}},3577:function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return f});var r=n(13),o=n(126),a=n(124),i="resources/images/surfaceActions",s=i+"/attach.svg",c=i+"/attachDark.svg",u=i+"/inlineimage.svg",l=i+"/inlineimageDark.svg",d=i+"/emoji.svg",p=i+"/showribbon.svg",m=i+"/showribbonDark.svg";function b(e){var t,n,i=!1;switch(e){case"AddAttachment":t=Object(o.resolve)(Object(r.r)(),Object(a.c)()?c:s),n=Object(o.resolve)(Object(r.r)(),s),i=!0;break;case"AddInlineImage":t=Object(o.resolve)(Object(r.r)(),Object(a.c)()?l:u),n=Object(o.resolve)(Object(r.r)(),u),i=!0;break;case"AddEmoji":t=Object(o.resolve)(Object(r.r)(),d),i=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"ToggleRibbon":t=Object(o.resolve)(Object(r.r)(),Object(a.c)()?m:p),n=Object(o.resolve)(Object(r.r)(),p),i=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":case"AccChecker":t="OutlookLogo";break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:i}}function h(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;case"ReplyByIM":case"ReplyAllByIM":t="ChatInviteFriend";break;case"ToggleAmp":t="LightningBolt";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function f(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},3578:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(9),o=n(41),a=n(5);function i(){return Object(o.a)()?Object(a.e)("cmp-encryption")&&Object(r.a)().SessionSettings.IsPremiumConsumerMailbox:Object(r.a)().SegmentationSettings.Irm}},3759:function(e){e.exports={a:"uub"}},3845:function(e){e.exports={a:"G$a"}},3875:function(e,t,n){"use strict";var r=n(3),o=n(4053);function a(e){return o.a.addinOptionSurfaceItems[e]}var i=n(1593),s=n(1888),c=n(2499),u=n(2094),l=n(1656),d=n(4054),p=n(2500),m=n(2501),b=n(3965),h=n(1895),f=n(4055),I=n(4056),g=n(2093),v=n(4057),O=n(1653),k=n(3884),y=n(3966),j=n(1885),S=n(1663),C=n(1664),A=n(3996),x=n(3997),M=n(3998),P=n(4058),_=n(4059),w=n(3999),R=n(4060),T=n(4061),B=n(4062),F=n(4120),L=n(4063),D=n(3845),E=n(4e3),N=n(4),H=n(41);function G(e){switch(e){case"AddAttachment":return Object(N.a)(L.a);case"AddInlineImage":return Object(N.a)(E.a);case"AddEmoji":return Object(N.a)(F.a);case"ToggleRibbon":return Object(N.a)(B.a);case"SaveDraft":return Object(N.a)(T.a);case"InsertSignature":return Object(N.a)(R.a);case"ShowFrom":return Object(N.a)(w.a);case"SetImportance":return Object(N.a)(_.a);case"ShowMessageOptions":return Object(N.a)(P.a);case"SwitchBodyType":return Object(N.a)(M.a);case"SensitivityMenu":return Object(N.a)(x.a);case"ProtectMessage":return Object(N.a)(A.a);case"AccChecker":return Object(N.a)(D.a);case"ToggleDarkCompose":return Object(N.a)(F.n);default:return""}}function U(e){switch(e){case"LikeUnlike":return Object(N.a)(F.d);case"Reply":return Object(N.a)(C.a);case"ReplyAll":return Object(N.a)(S.a);case"Forward":return Object(N.a)(j.a);case"ReplyByMeeting":return Object(N.a)(F.f);case"ReportAbuse":return Object(N.a)(y.a);case"Popout":return Object(N.a)(k.a);case"Delete":return Object(N.a)(F.c);case"MarkReadUnread":return Object(N.a)(O.a);case"FlagUnflag":return Object(N.a)(v.a);case"AssignPolicy":return Object(N.a)(g.a);case"AddToSafeSenders":return Object(N.a)(F.b);case"MarkJunkNotJunk":return Object(N.a)(I.a);case"MarkAsPhishing":return Object(N.a)(F.e);case"Block":return Object(N.b)(Object(N.a)(f.a),"");case"CreateRule":return Object(N.a)(h.a);case"Print":return Object(N.a)(b.a);case"Translate":return Object(N.a)(m.a);case"ShowInImmersiveReader":return Object(N.a)(p.a);case"ViewMessageSource":return Object(H.a)()?Object(N.a)(F.h):Object(N.a)(F.g);case"ToggleDarkMode":return Object(N.a)(d.a);case"ReplyByIM":return Object(N.a)(F.l);case"ReplyAllByIM":return Object(N.a)(F.k);case"ToggleAmp":return Object(N.a)(F.m);default:return""}}function z(e){switch(e){case"None":return Object(N.a)(F.i);case"Delete":return Object(N.a)(l.a);case"Archive":return Object(N.a)(u.a);case"PinUnpin":return Object(N.a)(c.a);case"ReadUnread":return Object(N.a)(F.j);case"FlagUnflag":return Object(N.a)(s.a);case"Move":return Object(N.a)(i.a);default:return""}}var V=n(3577),K=n(4064),J=n(3578),W=n(5),Y=n(214),q=n(9),Z=n(124);function X(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1}];return Object(W.e)("rp-replyByMeeting")&&e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(W.e)("fwk-skypeBusinessV2")&&e.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),Object(q.a)().SessionSettings.IsShadowMailbox||e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0},{key:"ReportAbuse",hideInGroup:!Object(H.a)(),hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(H.a)()||e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0},{key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(W.e)("rp-inlineTranslationManual")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(Z.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(W.e)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(H.a)()||e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object(W.e)("rp-amp")&&Object(H.a)()&&e.push({key:"ToggleAmp",hideInGroup:!1,hideInSxS:!0}),e}function $(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return e.push({key:"AddEmoji",hideInGroup:!1}),Object(W.e)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),Object(W.e)("cmp-clp")&&!Object(H.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(J.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(K.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e}function Q(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function ee(e){return-1!==Object(Y.c)(Y.a.SurfaceActions).readSurfaceActions.indexOf(e)}var te=n(15);function ne(e,t,n,r){var o;r?o=r:(o="Pinned",n&&n.renderedInOverflow&&(o=n.isPinned?"Overflow":"NotPinned")),Object(te.o)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,o])}function re(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0})}function oe(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!1})}n.d(t,"j",function(){return ie}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return G}),n.d(t,"g",function(){return U}),n.d(t,"f",function(){return z}),n.d(t,"a",function(){return"-"}),n.d(t,"d",function(){return V.a}),n.d(t,"h",function(){return V.c}),n.d(t,"e",function(){return $}),n.d(t,"i",function(){return X}),n.d(t,"o",function(){return Q}),n.d(t,"n",function(){return ee}),n.d(t,"k",function(){return ne}),n.d(t,"m",function(){return re}),n.d(t,"l",function(){return oe});var ae=new r.c(function(){return n.e(404).then(n.bind(null,13886))}),ie=new r.a(ae,function(e){return e.setAddinOptionSurfaceItems})},3884:function(e){e.exports={a:"iab"}},3966:function(e){e.exports={a:"hab"}},3996:function(e){e.exports={a:"cab",b:"dab"}},3997:function(e){e.exports={a:"bab"}},3998:function(e){e.exports={a:"aab"}},3999:function(e){e.exports={a:"Z$a"}},4000:function(e){e.exports={a:"F$a"}},4053:function(e,t,n){"use strict";var r=n(1),o=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=o},4054:function(e){e.exports={a:"sab"}},4055:function(e){e.exports={a:"nab"}},4056:function(e){e.exports={a:"mab"}},4057:function(e){e.exports={a:"kab"}},4058:function(e){e.exports={a:"$$a"}},4059:function(e){e.exports={a:"_$a"}},4060:function(e){e.exports={a:"Y$a"}},4061:function(e){e.exports={a:"X$a"}},4062:function(e){e.exports={a:"W$a"}},4063:function(e){e.exports={a:"H$a"}},4064:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(26);function o(){return!Object(r.o)()}},4120:function(e){e.exports={a:"I$a",d:"J$a",f:"K$a",c:"L$a",b:"M$a",e:"N$a",h:"O$a",g:"P$a",i:"Q$a",j:"R$a",l:"S$a",k:"T$a",m:"U$a",n:"V$a"}},6057:function(e){e.exports={a:"LCb"}},8170:function(e,t,n){"use strict";var r,o=n(1),a=Object(o.createStore)("AddinsSurfaceActionsStore",{isAddinObserverLoaded:!1})(),i=n(8),s=Object(i.action)("setAddinObserverLoaded ")(function(){a.isAddinObserverLoaded=!0}),c=n(516);c.r.import().then(function(e){r=e,s()});var u=n(0),l=n(161),d=n(3292),p=n(21),m=n(3875);function b(e,t,n,o,i,s,b,h,f,I,g){var v,O=function(e,t){return a.isAddinObserverLoaded&&r?r(e,t).get():null}(e,g=g||function(e){if(!e||!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(p.I)(t,p.j)}(t));v=O?O.sectionProps.items:[];var k=e==d.a.MessageRead?Object(c.o)(n):Object(c.m)(n),y=!0;v.forEach(function(e){Object(c.l)(k,e);var t=e;if(t.iconOnly=!0,f&&(t.className=f),o.indexOf(e.key)>=0){var n=t;I&&(n=u.__assign({},t)),null!=n.name&&null!=n.title&&n.name.trim()!=n.title.trim()&&(n.name=n.ariaLabel),n.title="",function(e,t,n){t.isPinned=!0,t.subMenuProps&&t.subMenuProps.items.forEach(function(e){e.isPinned=!0}),n?e.unshift(t):e.push(t)}(i,n,b)}(-1==o.indexOf(e.key)||I)&&(y&&(!function(e,t){var n=e.length;n>0&&e[n-1].displayName!=m.a&&e.push({key:"addinDivider_"+t,displayName:m.a,itemType:l.a.Divider,onClick:null})}(s,h++),y=!1),t.renderedInOverflow=!0,t.subMenuProps&&t.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0}),(t.itemType!==l.a.Divider||0!==s.length&&s[s.length-1].itemType!==l.a.Divider)&&s.push(t))})}n.d(t,"a",function(){return b})},848:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return i});var r="ArchivePolicyParentRow",o="DeletePolicyParentRow",a="FolderArchiveTag",i="FolderPolicyTag"},8852:function(e,t,n){var r=n(12676),o=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)}},0,[3,21,34,79,330,553,18,20,420,6,7,9,11,119,1,4,5,291,309,8,23,314,542,378,494,135,396,312,486,98,70,110,498,167,499,171,530,321,319,108,213,273,299,317,403,468,470]]);
//# sourceMappingURL=owa.ItemActions.js.map
self.scriptsLoaded['owa.ItemActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ItemActions.js'] = (new Date()).getTime();