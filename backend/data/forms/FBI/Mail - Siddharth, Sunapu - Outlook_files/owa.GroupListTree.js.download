self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GroupListTree.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[251],{10947:function(e){e.exports={a:"Eec"}},10948:function(e){e.exports={a:"_bc"}},10949:function(e,t,n){var o=n(10950),r=n(37);"string"==typeof o&&(o=[[e.i,o]]);for(var i=0;i<o.length;i++)r.loadStyles(o[i][1],!1);o.locals&&(e.exports=o.locals)},10950:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'.nSex22jJhxuH_NoJLuWL4{color:"[theme:themeDark, default:#0D62AA]";font-weight:600}html[dir=ltr] .nSex22jJhxuH_NoJLuWL4{padding-left:5px}html[dir=rtl] .nSex22jJhxuH_NoJLuWL4{padding-right:5px}',""]),t.locals={unreadCount:"nSex22jJhxuH_NoJLuWL4"}},10951:function(e){e.exports={a:"dcc"}},10952:function(e){e.exports={a:"Ybc"}},10953:function(e){e.exports={c:"gcc",b:"hcc",a:"icc"}},10954:function(e,t,n){var o=n(10955),r=n(37);"string"==typeof o&&(o=[[e.i,o]]);for(var i=0;i<o.length;i++)r.loadStyles(o[i][1],!1);o.locals&&(e.exports=o.locals)},10955:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'.-pJvQw8WCSS64u4yeesBP{color:#e81123}html[dir] .-pJvQw8WCSS64u4yeesBP{padding-top:8px}html[dir=ltr] .-pJvQw8WCSS64u4yeesBP{padding-left:5px}html[dir=rtl] .-pJvQw8WCSS64u4yeesBP{padding-right:5px}.-pJvQw8WCSS64u4yeesBP:hover{color:"[theme:redDark, default:#a80000]"}',""]),t.locals={errorIcon:"-pJvQw8WCSS64u4yeesBP"}},2610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.default=function(e){return o.__assign({__type:"SubscriptionParameters:#Exchange"},e)}},3256:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(1),i=Object(r.action)("openCreateGroup",function(){return{}}),s=Object(r.action)("openDiscoverGroups",function(){return{}}),u=n(5313),a=n(3),c=new a.c(function(){return Promise.all([n.e(1),n.e(5),n.e(28),n.e(52),n.e(237)]).then(n.bind(null,13622))}),p=new a.b(c,function(e){return e.createGroup}),d=n(3878),l=n(1152),f=n(517),h=n(187),b=n(9),m=n(41),g=n(5);function C(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return e?Object(d.b)().myOrgGroups.includes(e)?[3,2]:[4,l.a.import()]:[3,3];case 1:t.sent()(Object(f.j)()),t.label=2;case 2:Object(h.p)(e,"groups"),t.label=3;case 3:return[2]}})})}Object(r.orchestrator)(i,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var e,t;return o.__generator(this,function(n){switch(n.label){case 0:return!Object(g.e)("grp-shareable-crud")||Object(m.a)()?[3,2]:[4,p.import()];case 1:return t=n.sent(),e=Object(b.a)().SessionSettings,t(e.ExternalDirectoryUserGuid,e.UserLanguage,e.UserCulture,"OWA_LeftNav",C),[3,4];case 2:return[4,u.b.import()];case 3:(t=n.sent())(Object(m.a)()?u.a.Consumer:u.a.Enterprise,Object(b.a)().SessionSettings.UserCulture,"OWA",C),n.label=4;case 4:return[2]}})})});var v=n(9129),O=n(3302);function j(e){return o.__awaiter(this,void 0,void 0,function(){var t;return o.__generator(this,function(n){switch(n.label){case 0:return e?(t=e.smtpAddress.toLowerCase(),Object(d.b)().myOrgGroups.includes(t)?[3,2]:[4,l.a.import()]):[3,3];case 1:n.sent()(Object(f.j)()),n.label=2;case 2:Object(h.p)(t,"groups"),n.label=3;case 3:return[2]}})})}Object(r.orchestrator)(s,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var e,t;return o.__generator(this,function(n){switch(n.label){case 0:return[4,v.b.import()];case 1:return e=n.sent(),t=Object(b.a)(),Object(O.k)(t.SessionSettings.UserEmailAddress,t.SessionSettings.UserCulture),e(Object(m.a)()?v.a.Consumer:v.a.Enterprise,t.SessionSettings.UserCulture,"OWA",j),[2]}})})});var x=n(10947),M=n(6384),y=n(4),N=n(10948),G=n(2659),I=n(4585),E=n(4586),D=n(1662),R=n(1659),w=n(7),_=n(18),S=n(58),A=n(2666),L=n(1175),P=n(849),T=n(409),k=n(79),B=n(2),U=n(1366),H=n(60),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMarkAllAsRead=function(){var e=t.group.basicInformation.SmtpAddress,n=Object(L.a)(e,Object(L.b)()),o=Object(T.c)(n);P.b.importAndExecute("ContextMenu",o.virutalSelectAllExclusionList,!0,!0,[],o),t.props.onDismiss()},t.onToggleFavorite=function(){return o.__awaiter(t,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return[4,A.b.import()];case 1:return e.sent()(this.group.basicInformation.SmtpAddress),this.props.onDismiss(),[2]}})})},t.onCopyEmailAddress=function(){var e=document.createElement("input"),n=t.group.basicInformation.DisplayName+" <"+t.group.basicInformation.SmtpAddress+">";e.className="screenReaderOnly",document.body.appendChild(e);try{if(e.value=n,e.select(),!document.execCommand("copy"))throw new Error}catch(e){var o=Object(k.h)()?Object(y.a)(E.a):Object(y.a)(I.a);window.prompt(o,n)}finally{document.body.removeChild(e)}t.props.onDismiss()},t}return o.__extends(t,e),Object.defineProperty(t.prototype,"group",{get:function(){var e=this.props.groupId.toLowerCase();return Object(f.j)().groups.get(e)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.anchorPoint,n=e.onDismiss,o=this.createMenuItems();return this.props.commonContextMenuItems&&(o=o.concat(this.props.commonContextMenuItems)),B.createElement(U.a,{shouldFocusOnMount:!0,target:t,directionalHint:H.a.bottomLeftEdge,onDismiss:n,items:o})},t.prototype.getContextMenuItem=function(e,t,n,o){return{key:e,name:t,disabled:n,onClick:o}},t.prototype.createMenuItems=function(){var e=Object(S.isGroupInFavorites)(this.group.basicInformation.SmtpAddress),t=[this.getContextMenuItem("markAllAsRead",Object(y.a)(G.a),this.group.unreadMessageCount<=0,this.onMarkAllAsRead),this.getContextMenuItem("copyEmailAddress",Object(y.a)(N.a),!1,this.onCopyEmailAddress)];return Object(g.e)("tri-favorites-roaming")&&t.push(this.getContextMenuItem(e?"removeFromFavorites":"addToFavorites",e?Object(y.a)(R.a):Object(y.a)(D.a),!1,this.onToggleFavorite)),t},o.__decorate([w.computed],t.prototype,"group",null),t=o.__decorate([_.observer],t)}(B.Component),W=n(38),F=n(20),q=n(810),V=n(15),Q=n(741),K=n(2218);function X(){var e,t=Object(K.b)(),n=Object(Q.a)().groups,o=t.myOrgGroups.some(function(t){return(e=n.get(t)).groupDetails&&e.groupDetails.UserGroupRelationship?e.groupDetails.UserGroupRelationship.IsOwner:e.basicInformation&&e.basicInformation.AdditionalProperties&&e.basicInformation.AdditionalProperties.IsOwner})||0===t.myOrgGroups.length;Object(V.o)("ManageGroupClicked");var r=Object(F.a)().search,i=Object(W.j)(o)+r;i+=(r?"&":"?")+"source=ManageGroups",Object(q.b)("people")||window.open(i.toString(),"_blank")}var $=n(26),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCreateGroup=function(){i(),t.props.onDismiss()},t.onDiscoverGroups=function(){s(),t.props.onDismiss()},t.onManageGroups=function(){X()},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.anchorPoint,n=e.onDismiss,o=this.createMenuItems();return B.createElement(U.a,{shouldFocusOnMount:!0,target:t,directionalHint:H.a.bottomLeftEdge,onDismiss:n,items:o})},t.prototype.getContextMenuItem=function(e,t,n,o){return{key:e,name:t,disabled:n,onClick:o}},t.prototype.createMenuItems=function(){var e=Object(f.l)().groupCreationEnabled,t=!Object($.o)()&&Object(g.e)("grp-discovery-leftnav"),n=!Object($.o)()&&Object(g.e)("grp-manage-leftnav"),o=[];return e&&o.push(this.getContextMenuItem("newGroup",Object(y.a)(M.d),!1,this.onCreateGroup)),t&&o.push(this.getContextMenuItem("discoverGroups",Object(y.a)(M.a),!1,this.onDiscoverGroups)),n&&o.push(this.getContextMenuItem("manageGroups",Object(y.a)(M.b),!1,this.onManageGroups)),o},t=o.__decorate([_.observer],t)}(B.Component),Y=n(46),Z=n(4102),ee=n(1798),te=n(10949),ne=Object(Y.a)(function(e){var t=Object(f.j)().groups.get(e.groupId.toLowerCase()),n=t?t.unreadMessageCount:null;return n?B.createElement("span",{className:te.unreadCount},n,B.createElement("span",{className:"screenReaderOnly"},Object(y.a)(ee.a))):null}),oe=n(10951),re=n(1837),ie=n(1640),se=n(211),ue=Object(Y.a)(function(e){return B.createElement(re.a,{content:Object(y.a)(oe.a),calloutProps:{gapSpace:0}},B.createElement(ie.a,{size:se.a.small,title:""}))}),ae=Object(Y.a)(function(e){return Object(Z.a)(e.groupId).isDroppingMessage?B.createElement(ue,null):B.createElement(ne,{groupId:e.groupId})}),ce=Object(Y.a)(function(e){return Object(Z.a)(e.groupId).isDroppingMessage?B.createElement(ue,null):B.createElement(ne,{groupId:e.groupId})}),pe=n(10952),de=n(246),le=n(3927),fe=n(10953),he=Object(r.mutatorAction)("setGroupDragDropActionState",function(e,t){Object(K.b)().groupNodeViewStates.get(e).isDroppingMessage=t}),be=n(72),me=n(1231),ge=n(4997),Ce=n(1523),ve=n(4230),Oe=n(5340),je=n(266),xe=n.n(je);function Me(e,t,n,o){n.addCustomData({error:o}),n.endWithError("ServerError",new Error(o)),Object(de.b)(1==t?Object(y.a)(fe.c):Object(y.a)(M.c),1==t?Object(y.b)(Object(y.a)(fe.b),e):Object(y.b)(Object(y.a)(fe.a),e),!1,{hideCancelButton:!0}),he(e,!1)}function ye(e,t){e.rowKeys.length>le.b?Object(de.b)(Object(y.a)(M.c),Object(y.b)(Object(y.a)(pe.a),le.b),!1,{hideCancelButton:!0}):function(e,t){var n=new V.a("dragDropToGroup");he(t,!0);var o=e.rowKeys,r=e.tableViewId,i=be.a.tableViews.get(r),s=Object(L.a)(t,Object(L.b)()),u=0==i.tableQuery.listViewType?Object(ge.a)(o,r):Object(Ce.a)(o,r),a={headers:{"X-OWA-ExplicitLogonUser":s.folderId,"X-AnchorMailbox":s.folderId,"X-OWA-ActionName":"GroupMailbox"}};Object(Oe.a)(u,xe()({BaseFolderId:Object(me.a)(s)}),!0,a).then(function(e){var o=function(e){if(!e||!e.ResponseMessages||!e.ResponseMessages.Items)return null;for(var t={successfulItems:[],failedItemCount:0},n=0;n<e.ResponseMessages.Items.length;n++){var o=e.ResponseMessages.Items[n];o&&"Success"==o.ResponseClass?t.successfulItems.push(o.Items[0].ItemId.Id):(t.failedItemCount++,o&&(t.lastResponseCode=o.ResponseCode))}return t}(e);if(o&&o.failedItemCount<1){n.end();var r=u.map(function(e){return{Id:e}});Object(ve.a)(r,"HardDelete"),he(t,!1)}else Me(t,u.length,n,o.lastResponseCode?o.lastResponseCode:"UnknownError")}).catch(function(e){Me(t,u.length,n,JSON.stringify(e))})}(e,t)}var Ne=n(5487),Ge=n(1509),Ie=n(714),Ee=n(713),De=n(8),Re=Object(De.action)("showGroupContextMenu")(function(e,t,n,o,r){e.withContextMenuGroup={groupId:t,group:n,anchor:o,isRootNode:r}}),we=Object(De.action)("hideGroupContextMenu")(function(e){e.withContextMenuGroup=null}),_e=n(144),Se=n(394),Ae=n(10954),Le=Object(K.b)(),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonsToRender=function(){var e=Object(b.a)().UserOptions.IsGroupsTreeCollapsed;return[t.renderCreateGroupButtonAndModal(e),t.renderDiscoverGroupsButtonAndModal(e),t.renderManageGroupsButtonAndModal(e)]},t.renderGroupListItemContextMenu=function(e){return B.createElement(J,{anchorPoint:e.anchor,groupId:e.group.basicInformation.SmtpAddress,onDismiss:t.hideGroupContextMenuInternal})},t.renderGroupRootContextMenu=function(e){return B.createElement(z,{anchorPoint:e.anchor,onDismiss:t.hideGroupContextMenuInternal})},t.toggleGroupTreeExpansion=function(){l.f.importAndExecute()},t.subscribeToRemainingNotificationsIfNeeded=function(){Object(g.e)("grp-unreadCountTop5AndFavorites")&&Object(Ne.a)()},t.onContextMenuOpened=function(e,t){Re(Le,t.basicInformation.SmtpAddress,t,Object(Ie.a)(e),!1)},t.onRootContextMenuOpened=function(e){var t=Object(Ge.a)().groupCreationEnabled,n=!Object($.o)()&&Object(g.e)("grp-discovery-leftnav");if(!t&&!n)return null;Re(Le,null,null,Object(Ie.a)(e),!0)},t.noContextMenu=function(e){e.stopPropagation(),e.preventDefault()},t.launchCreateGroup=function(e){e.stopPropagation(),i()},t.launchDiscoverGroups=function(e){e.stopPropagation(),s()},t.onManageGroups=function(e){e.stopPropagation(),X()},t.onListNodeDrop=function(e,t){switch(e.itemType){case _e.a.MultiMailListMessageRows:case _e.a.MailListRow:ye(e,t)}},t.canDropOnListNode=function(e){switch(e.itemType){case _e.a.MultiMailListMessageRows:case _e.a.MailListRow:return"move";default:return"none"}},t}return o.__extends(t,e),t.prototype.render=function(){var e=Object(b.a)().UserOptions.IsGroupsTreeCollapsed;return B.createElement(d.a,{className:this.props.className,selectGroup:this.selectGroupInternal,isSelected:this.isGroupNodeSelectedInternal,isGroupsTreeCollapsed:e,toggleGroupTreeExpansion:this.toggleGroupTreeExpansion,renderGroupListCustomNodes:this.buttonsToRender,renderRightCharm:this.renderRightCharm,renderRightCharmHover:this.renderRightCharmHover,onChildNodeContextMenuOpened:this.onContextMenuOpened,renderChildNodeContextMenu:this.renderGroupListItemContextMenu,onRootNodeContextMenuOpened:this.onRootContextMenuOpened,renderRootNodeContextMenu:this.renderGroupRootContextMenu,renderRootNodeRightCharm:this.renderGroupRootNodeRightCharm,renderRootNodeRightCharmHover:this.renderGroupRootNodeRightCharm,onListNodeDrop:this.onListNodeDrop,canDropOnListNode:this.canDropOnListNode,onMouseEnterShowMoreButton:this.subscribeToRemainingNotificationsIfNeeded,onShowMoreEvent:this.subscribeToRemainingNotificationsIfNeeded})},t.prototype.renderGroupRootNodeRightCharm=function(){return Le.loadGroupsError?B.createElement(re.a,{content:Object(y.a)(x.a),directionalHint:H.a.bottomCenter},B.createElement(Se.a,{className:Ae.errorIcon,title:"",iconName:"Error",ariaLabel:Object(y.a)(x.a)})):null},t.prototype.hideGroupContextMenuInternal=function(){we(Le)},t.prototype.renderCreateGroupButtonAndModal=function(e){return Object(Ge.a)().groupCreationEnabled?B.createElement("div",null,!e&&this.renderCreateGroupButton()):null},t.prototype.renderDiscoverGroupsButtonAndModal=function(e){return!Object($.o)()&&Object(g.e)("grp-discovery-leftnav")?B.createElement("div",null,!e&&this.renderDiscoverGroupsButton()):null},t.prototype.renderManageGroupsButtonAndModal=function(e){return!Object($.o)()&&Object(g.e)("grp-manage-leftnav")?(Object(V.o)("ManageGroupsRendered"),B.createElement("div",null,!e&&this.renderManageGroupsButton())):null},t.prototype.renderRightCharm=function(e,t){return B.createElement(ae,{groupId:e})},t.prototype.renderRightCharmHover=function(e,t){return B.createElement(ce,{groupId:e})},t.prototype.selectGroupInternal=function(e,t){Object(h.p)(e,"groups")},t.prototype.isGroupNodeSelectedInternal=function(e,t){return Object(h.b)(e,"groups")},t.prototype.renderCreateGroupButton=function(){return B.createElement(Ee.a,{displayName:Object(y.a)(M.d),isCustomActionNode:!0,isRootNode:!1,key:"NewGroup",onClick:this.launchCreateGroup,onContextMenu:this.noContextMenu})},t.prototype.renderDiscoverGroupsButton=function(){return B.createElement(Ee.a,{displayName:Object(y.a)(M.a),isCustomActionNode:!0,isRootNode:!1,key:"DiscoverGroups",onClick:this.launchDiscoverGroups,onContextMenu:this.noContextMenu})},t.prototype.renderManageGroupsButton=function(){return B.createElement(Ee.a,{displayName:Object(y.a)(M.b),isCustomActionNode:!0,isRootNode:!1,key:"ManageGroups",onClick:this.onManageGroups,onContextMenu:this.noContextMenu})},t=o.__decorate([_.observer,Object(V.l)("GroupListTree")],t)}(B.Component);n.d(t,"GroupListTree",function(){return Pe}),n.d(t,"GroupRightCharm",function(){return ae}),n.d(t,"GroupRightCharmHover",function(){return ce}),n.d(t,"GroupDragDropSpinner",function(){return ue}),n.d(t,"GroupContextMenu",function(){return J}),n.d(t,"dropMailListRowsOnGroup",function(){return ye})},3302:function(e,t,n){"use strict";var o,r,i,s,u,a,c,p,d,l,f,h,b,m,g;var C;n(4);function v(e,t){t,C=e}function O(){return C}n.d(t,"o",function(){return o}),n.d(t,"n",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return u}),n.d(t,"g",function(){return a}),n.d(t,"d",function(){return c}),n.d(t,"f",function(){return p}),n.d(t,"l",function(){return d}),n.d(t,"m",function(){return l}),n.d(t,"q",function(){return f}),n.d(t,"r",function(){return h}),n.d(t,"h",function(){return b}),n.d(t,"j",function(){return m}),n.d(t,"e",function(){return g}),n.d(t,"p",function(){}),n.d(t,"k",function(){return v}),n.d(t,"i",function(){return O})},3327:function(e,t,n){"use strict";var o,r;n.d(t,"b",function(){return o}),n.d(t,"a",function(){return r}),function(e){e[e.Consumer=0]="Consumer",e[e.Enterprise=1]="Enterprise"}(o||(o={})),function(e){e[e.SmtpAddress=0]="SmtpAddress",e[e.ExternalDirectoryObjectId=1]="ExternalDirectoryObjectId"}(r||(r={}))},3878:function(e,t,n){"use strict";var o=n(2218),r=n(1),i=Object(r.mutatorAction)("toggleIsShowingAllGroups",function(){Object(o.b)().shouldShowAllGroups=!Object(o.b)().shouldShowAllGroups}),s=n(0),u=n(4152),a=n(4),c=n(2541),p=n(18),d=n(154),Droppable=n(678),l=n(517),f=n(2),h=n(144),b=n(4102),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onContextMenu=function(e,n){var o=t.props,r=o.onContextMenu,i=o.groupId;if(r){e.stopPropagation(),e.preventDefault();var s=i.toLowerCase(),u=Object(l.j)().groups;if(u.has(s))r(e,u.get(s))}},t.onDrop=function(e){t.props.onListNodeDrop&&t.props.onListNodeDrop(e,t.props.groupId)},t}return s.__extends(t,e),t.prototype.shouldComponentUpdate=function(e,t){return!Object(d.f)(this.props,e)},t.prototype.render=function(){var e=Object(b.a)(this.props.groupId);return f.createElement(Droppable.b,{dropViewState:e.drop,onDrop:this.onDrop,canDrop:this.props.canDropOnListNode},f.createElement(c.a,{selectGroup:this.props.selectGroup,isSelected:this.props.isSelected,renderRightCharm:this.props.renderRightCharm,renderRightCharmHover:this.props.renderRightCharmHover,chevronProps:null,customIcon:null,displayName:this.props.displayName,groupId:this.props.groupId,isDroppedOver:e.drop.isDragOver,onContextMenu:this.onContextMenu,renderCustomTreeNodeDisplay:null,customData:this.props.customData,showHoverStateOnDroppedOver:e.drop.draggableItemType==h.a.MailListRow||e.drop.draggableItemType==h.a.MultiMailListMessageRows}))},t=s.__decorate([p.observer],t)}(f.Component),g=n(3927),C=n(107),v=n(15),O=n(713),j=n(254),x=Object(l.j)(),M=Object(o.b)(),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isDragOverExpandCollapseNode=!1,t.onRootNodeChevronClicked=function(e){e.stopPropagation(),t.props.toggleGroupTreeExpansion()},t.onRootContextMenu=function(e){var n=t.props.onRootNodeContextMenuOpened;n&&(e.stopPropagation(),e.preventDefault(),n(e))},t.onDropOnCollapseExpandNode=function(){},t.canDropOnCollapseExpandNode=function(e){return!(M.shouldShowAllGroups||!t.props.canDropOnListNode)&&t.props.canDropOnListNode(e)},t.onDragOverCollapseExpandNode=function(e){t.isDragOverExpandCollapseNode=!0,setTimeout(function(){t.isDragOverExpandCollapseNode&&!Object(o.b)().shouldShowAllGroups&&t.toggleCollapseExpandNode()},1e3)},t.onDragLeaveCollapseExpandNode=function(){t.isDragOverExpandCollapseNode=!1},t.noContextMenu=function(e){e.stopPropagation(),e.preventDefault()},t.onCollapseExpandNodeClick=function(e){e.stopPropagation(),t.toggleCollapseExpandNode()},t.toggleCollapseExpandNode=function(){var e=M.myOrgGroups.length;Object(v.o)("GroupList_ToggleShouldShowAllGroups",{isShowMore:!M.shouldShowAllGroups,joinedGroupCount:e>=21?"21+":e}),t.props.onShowMoreEvent&&t.props.onShowMoreEvent(),i()},t}return s.__extends(t,e),t.prototype.render=function(){var e=M.myOrgGroups,t={role:C.a.tree},n=this.props.isGroupsTreeCollapsed;return f.createElement("div",s.__assign({style:this.props.style,className:this.props.className},Object(C.b)(t)),this.renderGroupRoot(n),this.renderChildren(e,n),M.withContextMenuGroup&&(M.withContextMenuGroup.isRootNode?this.props.renderRootNodeContextMenu&&this.props.renderRootNodeContextMenu(M.withContextMenuGroup):this.props.renderChildNodeContextMenu&&this.props.renderChildNodeContextMenu(M.withContextMenuGroup)),e.length>g.a&&this.renderCollapseExpandNode(n),this.props.renderGroupListCustomNodes&&this.props.renderGroupListCustomNodes())},t.prototype.renderNode=function(e){return f.createElement(m,{selectGroup:this.props.selectGroup,isSelected:this.props.isSelected,renderRightCharm:this.props.renderRightCharm,renderRightCharmHover:this.props.renderRightCharmHover,displayName:e.DisplayName,groupId:e.SmtpAddress,key:e.SmtpAddress,onContextMenu:this.props.onChildNodeContextMenuOpened,customData:this.props.customData,onListNodeDrop:this.props.onListNodeDrop,canDropOnListNode:this.props.canDropOnListNode})},t.prototype.renderGroupRoot=function(e){var t={isExpanded:!e,onClick:this.onRootNodeChevronClicked};return f.createElement(O.a,{chevronProps:t,depth:0,displayName:Object(a.a)(u.a),isRootNode:!0,key:"Groups_root",onClick:t.onClick,onContextMenu:this.onRootContextMenu,renderRightCharm:this.props.renderRootNodeRightCharm,renderRightCharmHover:this.props.renderRootNodeRightCharmHover})},t.prototype.renderChildren=function(e,t){var n=this,o=[];if(t)return o;if(M.shouldShowAllGroups){var r=[];e.forEach(function(e){var t=x.groups.get(e);r.push(t)}),r.sort(function(e,t){return e.basicInformation.DisplayName.localeCompare(t.basicInformation.DisplayName)}).forEach(function(e){o.push(n.renderNode(e.basicInformation))})}else e.slice(0,g.a).forEach(function(e){var t=x.groups.get(e);o.push(n.renderNode(t.basicInformation))});return o},t.prototype.renderCollapseExpandNode=function(e){if(e)return null;var t=M.shouldShowAllGroups?Object(a.a)(u.b):Object(a.a)(u.c),n=Object(j.a)();return f.createElement(Droppable.b,{dropViewState:n,onDrop:this.onDropOnCollapseExpandNode,canDrop:this.canDropOnCollapseExpandNode,onDragOver:this.onDragOverCollapseExpandNode,onDragLeave:this.onDragLeaveCollapseExpandNode},f.createElement(O.a,{displayName:t,isCustomActionNode:!0,isRootNode:!1,key:"groupsCollapseExpandNode",onClick:this.onCollapseExpandNodeClick,onContextMenu:this.noContextMenu,onMouseEnter:this.props.onMouseEnterShowMoreButton}))},t=s.__decorate([p.observer,Object(v.l)("GroupList")],t)}(f.Component);n.d(t,"c",function(){return o.a}),n.d(t,"b",function(){return o.b}),n.d(t,"a",function(){return y})},3926:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.default=function(e){return o.__assign({__type:"DeleteItemJsonRequest:#Exchange"},e)}},3927:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r});var o=5,r=100},3972:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.default=function(e){return o.__assign({__type:"DeleteItemRequest:#Exchange"},e)}},3973:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(55),r=n(3926);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),o.makeServiceRequest("DeleteItem",e,t)}},4102:function(e,t,n){"use strict";var o=n(2218),r=n(1099),i=n(254),s=n(1),u=Object(s.mutatorAction)("setGroupNodeViewStateMutator",function(e,t){Object(o.b)().groupNodeViewStates.set(e,t)});function a(e){return Object(o.b)().groupNodeViewStates.has(e)||u(e,{drag:Object(r.a)(),drop:Object(i.a)(),isDroppingMessage:!1}),Object(o.b)().groupNodeViewStates.get(e)}n.d(t,"a",function(){return a})},4152:function(e){e.exports={a:"vba",b:"wba",c:"xba"}},4230:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var o=n(3972),r=n.n(o),i=n(236),s=n.n(i),u=n(3973),a=n.n(u),c=n(27);function p(e,t){return r()({ItemIds:e.map(function(e){return t=e,s()({Id:t.Id,ChangeKey:t.ChangeKey});var t}),DeleteType:t,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function d(e,t,n){var o=p(e,t);return a()({Header:Object(c.getJsonRequestHeader)(),Body:o},n).then(function(e){return e.Body.ResponseMessages.Items})}},4585:function(e){e.exports={a:"wWa"}},4586:function(e){e.exports={a:"vWa"}},4977:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return u});var o=n(3),r=new o.c(function(){return Promise.all([n.e(6),n.e(7),n.e(11),n.e(256)]).then(n.bind(null,8144))}),i=new o.b(r,function(e){return e.addMarkAsReadDiagnostics}),s=new o.b(r,function(e){return e.addUnreadCountNotificationDiagnostics}),u=new o.b(r,function(e){return e.addUnreadCountSubscriptionDiagnostics})},4997:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(282);function r(e,t){var n={};return e.forEach(function(e){Object(o.a)(e,t).itemIds.forEach(function(e){n[e]||(n[e]=!0)})}),Object.keys(n)}},5313:function(e,t,n){"use strict";n.d(t,"b",function(){return s});var o=n(3327);n.d(t,"a",function(){return o.b});var r=n(3),i=new r.c(function(){return Promise.all([n.e(1),n.e(3),n.e(5),n.e(6),n.e(236)]).then(n.bind(null,8145))}),s=new r.b(i,function(e){return e.createGroup})},5340:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var o=n(5341),r=n(7117),i=n.n(r),s=n(7118),u=n.n(s),a=n(27);function c(e,t,n,r){var s=function(e,t,n){return i()({ToFolderId:t,ItemIds:Object(o.a)(e),ReturnNewItemIds:!0,RemoteExecute:n})}(e,t,n);return u()({Header:Object(a.getJsonRequestHeader)(),Body:s},r).then(function(e){return e.Body})}},5341:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n(236),r=n.n(o);function i(e){return e.map(function(e){return r()({Id:e})})}},5487:function(e,t,n){"use strict";var o=n(4977),r=n(2610),i=n.n(r),s=n(375),u=n(15),a=n(58),c=n(5),p=n(3878),d=n(3927),l=n(1),f=n(741),h=Object(l.mutatorAction)("UPDATE_GROUP_UNREAD_COUNT",function(e,t){var n=Object(f.a)().groups.get(e.toLowerCase());n&&(n.unreadMessageCount=t)});n.d(t,"b",function(){return g}),n.d(t,"a",function(){return C}),n.d(t,"c",function(){return O});var b={};function m(e){var t=e.id.replace("UnreadCountNotification_","");if(o.b.import().then(function(n){return n(t,e)}),"0"==e.EventType.toString()){var n=b[t];n&&(h(t.toLowerCase(),e.UnreadCount),n.firstNotificationReceived||(n.unreadCountDataPoint.end(),n.unreadCountDataPoint=null,n.firstNotificationReceived=!0))}}function g(){Object(c.e)("grp-unreadCountTop5AndFavorites")?p.c.myOrgGroups.filter(function(e,t){return t<d.a||Object(a.isGroupInFavorites)(e)}).forEach(function(e){v(e)}):C()}function C(){p.c.myOrgGroups.forEach(function(e){v(e)})}function v(e){(function(e){return!b[e]})(e=e.toLowerCase())&&s.b.import().then(function(t){var n=i()({NotificationType:"UnreadCountNotification",ChannelId:t(),MailboxId:e}),r={subscriptionId:j(e),requiresExplicitSubscribe:!0,subscriptionParameters:n};s.f.importAndExecute(r,m);var a={notificationSubscription:r,firstNotificationReceived:!1,unreadCountDataPoint:new u.a("UnreadCountNotification",{isQos:!0})};b[e]=a,o.c.import().then(function(t){return t(e,r,!1)})})}function O(e){e=e.toLowerCase();var t=b[e];if(t){var n=t.notificationSubscription;n&&(s.g.importAndExecute(n,m),delete b[e],o.c.import().then(function(t){return t(e,n,!0)}))}}function j(e){return"UnreadCountNotification_"+e}},6384:function(e){e.exports={c:"$bc",d:"acc",a:"bcc",b:"ccc"}},7117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.default=function(e){return o.__assign({__type:"CopyItemRequest:#Exchange"},e)}},7118:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(55),r=n(7119);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),o.makeServiceRequest("CopyItem",e,t)}},7119:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.default=function(e){return o.__assign({__type:"CopyItemJsonRequest:#Exchange"},e)}},9129:function(e,t,n){"use strict";var o,r;!function(e){e[e.Consumer=0]="Consumer",e[e.Enterprise=1]="Enterprise"}(o||(o={})),function(e){e[e.SmtpAddress=0]="SmtpAddress",e[e.ExternalDirectoryObjectId=1]="ExternalDirectoryObjectId"}(r||(r={}));var i=n(3);n.d(t,"b",function(){return u}),n.d(t,"a",function(){return o});var s=new i.c(function(){return Promise.all([n.e(3),n.e(7),n.e(8),n.e(53),n.e(255)]).then(n.bind(null,13603))}),u=new i.b(s,function(e){return e.discoverGroups})}},0,[1,4,8,10,360,78,18,20,46,294,3,21,34,79,330,6,7,9,11,119,5,309,310,23,314,542,378,544,383,12,43,115,312,486,98,70,110,498,167,499,171,530,321,319,213,228,299,308,468,470,606]]);
//# sourceMappingURL=owa.GroupListTree.js.map
self.scriptsLoaded['owa.GroupListTree.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GroupListTree.js'] = (new Date()).getTime();