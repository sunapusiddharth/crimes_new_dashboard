self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[117],{1086:function(e,n,t){"use strict";t.d(n,"b",function(){return u}),t.d(n,"a",function(){return p});var r,i=t(1747),o=t(1373),a=t(452),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(o.a)(e+"_16x16"),small:Object(o.a)(e+"_20x20"),medium:Object(o.a)(e+"_32x32"),large:Object(o.a)(e+"_64x64"),cdn:-1===f.indexOf(e)?Object(i.a)(e+"_16x16"):Object(i.a)("generic_16x16")},c[e])}var s="generic",d=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":s,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),l=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"}),f=["gdoc","gform","gsheet","gslide"];function p(e,n,t){if(void 0===n&&(n=!1),n)return r=r||{extraSmall:null,small:Object(o.a)("folder_20x20"),medium:Object(o.a)("folder_32x32"),large:Object(o.a)("folder_64x64"),cdn:Object(i.a)("folder_16x16")};var c,f=Object(a.a)(e);return f&&(c=d[f.toLowerCase()]),!c&&t&&t in l&&(c=l[t]),u(c||s)}},1237:function(e){e.exports={b:"GFa",d:"HFa",c:"IFa",a:"JFa"}},1373:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(2881),i="fileType-icon";function o(e){return r[function(e){return i+"-"+e}(e)]}},1747:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=1;function i(e){return"https://r"+(r++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1897:function(e,n,t){"use strict";t.d(n,"d",function(){return s}),t.d(n,"e",function(){return d}),t.d(n,"f",function(){return l}),t.d(n,"g",function(){return f});var r=t(2453);t.d(n,"h",function(){return r.a});var i=t(2444);t.d(n,"b",function(){return i.a});var o=t(2446);t.d(n,"c",function(){return o.a});var a=t(3),c=t(364);t.d(n,"a",function(){return c.c});var u=new a.c(function(){return Promise.all([t.e(10),t.e(12),t.e(13),t.e(116)]).then(t.bind(null,3231))}),s=new a.a(u,function(e){return e.previewAttachment}),d=new a.a(u,function(e){return e.previewAttachmentInSxS}),l=new a.a(u,function(e){return e.previewImageInSxS}),f=new a.a(u,function(e){return e.previewLinkInSxS})},1980:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(1),i=Object(r.action)("previewAttachment",function(e){return{context:e}})},2264:function(e,n,t){"use strict";t.d(n,"d",function(){return a}),t.d(n,"e",function(){return c}),t.d(n,"a",function(){return u}),t.d(n,"b",function(){return s}),t.d(n,"c",function(){return d});var r=t(3),i=t(2443);t.d(n,"f",function(){return i.a});var o=new r.c(function(){return t.e(389).then(t.bind(null,3232))}),a=new r.b(o,function(e){return e.tryProcessSharePointLink}),c=new r.b(o,function(e){return e.tryUndoProcessSharePointLink}),u=new r.b(o,function(e){return e.docLinkHadPreviewInfo}),s=new r.b(o,function(e){return e.forceGetWacInfoOperation}),d=new r.b(o,function(e){return e.getValidDocLinkPreviewInfo})},2429:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r,i=t(1086),o=t(1747);function a(e,n,t,a,c){if(t)return r=r||{extraSmall:Object(i.b)("generic").extraSmall,small:Object(i.b)("generic").small,medium:Object(i.b)("blockedfile").medium,large:Object(i.b)("generic").large,cdn:Object(o.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":return Object(i.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(i.b)("calendar")}return a?Object(i.b)("sharedfolder"):Object(i.a)(e,!1,n)||Object(i.b)("generic")}},2443:function(e,n,t){"use strict";t.d(n,"b",function(){return i}),t.d(n,"c",function(){return o}),t.d(n,"a",function(){return a});var r=t(1),i=Object(r.action)("tryProcessSharePointLink",function(e,n){return{element:e,itemId:n}}),o=Object(r.action)("tryUndoProcessSharePointLink",function(e){return{elements:e}}),a=Object(r.action)("previewLinkInSxS",function(e,n){return{wacUrlGetter:e,itemId:n}})},2444:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.NoOp=0]="NoOp",e[e.AlwaysHidden=1]="AlwaysHidden",e[e.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",e[e.LoadConversationReadingPane=3]="LoadConversationReadingPane",e[e.LoadItemReadingPane=4]="LoadItemReadingPane"}(r||(r={}))},2446:function(e,n,t){"use strict";var r=null,i={register:function(e){r=e},available:function(){return!!r},run:function(){r&&r()}};n.a=i},2453:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(1),i=Object(r.action)("loadItemAttachment",function(e,n){return{itemAttachmentId:e,perfDatapoint:n}})},2564:function(e){e.exports={a:"Q1a"}},2686:function(e,n,t){"use strict";t.r(n);var r=t(1897),i=t(7342),o=t(1);Object(o.orchestrator)(r.h,function(e){var n=e.itemAttachmentId,t=e.perfDatapoint;i.a.importAndExecute(n,t)});var a=t(1980);Object(o.orchestrator)(a.a,function(e){var n=e.context;r.d.importAndExecute(n)});var c=t(4806),u=t(364);Object(o.orchestrator)(c.j,function(e){var n=e.wacUrlGetter,t=e.linkId,i=e.readOnly;r.g.importAndExecute(n,null,r.a.ComposeDocLink,{method:r.b.CopyMailReadingPaneContainer},null,t,i)}),Object(o.orchestrator)(u.C,function(e){var n=e.selectedLinkId,t=e.isSelectedLinkReadOnly;Object(c.i)(n,t)});var s=t(2264);Object(o.orchestrator)(s.f,function(e){var n=e.wacUrlGetter,t=e.itemId;r.g.importAndExecute(n,t,r.a.ReadingPaneDocLink,{method:r.b.CopyMailReadingPaneContainer},null,null,null)});var d=t(3),l=new d.c(function(){return Promise.all([t.e(10),t.e(547),t.e(12),t.e(18),t.e(408)]).then(t.bind(null,13643))}),f=new d.a(l,function(e){return e.insertSxSV2IntoDomIfNeeded});r.c.register(f.importAndExecute)},3307:function(e,n,t){"use strict";t.d(n,"g",function(){return i}),t.d(n,"e",function(){return o}),t.d(n,"f",function(){return a}),t.d(n,"c",function(){return c}),t.d(n,"b",function(){return u}),t.d(n,"a",function(){return s}),t.d(n,"d",function(){return d});var r=t(1),i=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",function(e,n){return{linkId:e,sharingDialogResponse:n}}),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",function(e,n){return{linkId:e,newPermission:n}}),a=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",function(e,n,t,r){return{linkId:e,newLinkUrl:n,oldLinkUrl:t,expirationDate:r}}),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",function(e,n){return{linkId:e,actionStatus:n}}),u=Object(r.action)("CREATE_SHARING_LINK",function(e,n,t,r){return{linkId:e,currentUrl:n,canonicalUrl:t,newPermissionLevel:r}}),s=Object(r.action)("ADD_SHARING_LINK",function(e,n){return{linkId:e,linkModel:n}}),d=Object(r.action)("TOKEN_UNAVAILABLE",function(e){return{linkId:e}})},3342:function(e,n,t){"use strict";var r=t(3540);function i(){return Object(r.a)().sharingLinks.size}var o=t(3367);function a(e){var n=Object(o.a)(e);return n?{id:n.linkId,name:n.fileName,supportsDownsell:!1,currentPermissionLevel:n.permissionLevel,sharingInfo:n.sharingInfo,sharingTipsIgnored:n.sharingTipsIgnored,sharingRecipientsInfo:n.sharingRecipientsInfo}:null}var c=t(3515),u=t(3),s=t(3345),d=t(3307),l=t(3541);t.d(n,"i",function(){return p}),t.d(n,"m",function(){return h}),t.d(n,"q",function(){return m}),t.d(n,"o",function(){return b}),t.d(n,"n",function(){return g}),t.d(n,"k",function(){return v}),t.d(n,"p",function(){return x}),t.d(n,"j",function(){return O}),t.d(n,"l",function(){return k}),t.d(n,"b",function(){return s.a}),t.d(n,"c",function(){return s.b}),t.d(n,"e",function(){return s.c}),t.d(n,"t",function(){return s.d}),t.d(n,"w",function(){return d.g}),t.d(n,"u",function(){return d.e}),t.d(n,"v",function(){return d.f}),t.d(n,"s",function(){return d.c}),t.d(n,"d",function(){return d.b}),t.d(n,"a",function(){return c.a}),t.d(n,"r",function(){return l.b}),t.d(n,"f",function(){return i}),t.d(n,"g",function(){return a}),t.d(n,"h",function(){return o.a});var f=new u.c(function(){return Promise.all([t.e(12),t.e(283)]).then(t.bind(null,13619))}),p=new u.b(f,function(e){return e.addRecipientsIntoLink}),h=new u.b(f,function(e){return e.removeRecipientsFromLink}),m=new u.b(f,function(e){return e.updateRecipientPermissionInfos}),b=new u.b(f,function(e){return e.setGetPermissionInfoFailure}),g=new u.b(f,function(e){return e.resetSharingRecipientsInfo}),v=new u.b(f,function(e){return e.ignoreSharingTip}),x=new u.b(f,function(e){return e.setLinkActionStatus}),O=new u.b(f,function(e){return e.getSharingTipRecipientInfo}),k=new u.b(f,function(e){return e.linkBootStrap})},3345:function(e,n,t){"use strict";t.d(n,"a",function(){return i}),t.d(n,"d",function(){return o}),t.d(n,"c",function(){return a}),t.d(n,"b",function(){return c});var r=t(1),i=Object(r.action)("ADD_SHAREPOINT_LINK",function(e,n,t,r){return{linkId:e,url:n,sharingLinkIds:t,response:r}}),o=Object(r.action)("SHARING_LINK_REMOVED",function(e,n){return{linkId:e,sharingLinkIds:n}}),a=Object(r.action)("DELETE_LINK",function(e){return{linkId:e}}),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",function(e,n,t){return{linkId:e,providerId:n,isTryAgain:t}})},3367:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(3540);function i(e){return Object(r.a)().sharingLinks.get(e)}},3385:function(e,n,t){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}t.d(n,"a",function(){return r}),t.d(n,"b",function(){return i}),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},3386:function(e,n,t){"use strict";var r=t(1),i=t(7),o=t(3478),a={providers:new i.ObservableMap,loadState:o.a.NotLoaded,removalPending:new i.ObservableMap},c=Object(r.createStore)("fileProviderStoreV2",a);n.a=c},3390:function(e,n,t){"use strict";t.d(n,"b",function(){return o}),t.d(n,"a",function(){return i}),t.d(n,"c",function(){return a});var r=t(1),i=Object(r.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),o=Object(r.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),a=Object(r.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},3409:function(e,n,t){"use strict";t.d(n,"g",function(){return r}),t.d(n,"e",function(){return i}),t.d(n,"m",function(){return o}),t.d(n,"l",function(){return a}),t.d(n,"c",function(){return c}),t.d(n,"o",function(){return u}),t.d(n,"f",function(){return s}),t.d(n,"b",function(){return d}),t.d(n,"i",function(){return l}),t.d(n,"j",function(){return f}),t.d(n,"a",function(){return p}),t.d(n,"d",function(){return h}),t.d(n,"n",function(){return m}),t.d(n,"k",function(){return b}),t.d(n,"p",function(){return g}),t.d(n,"h",function(){return v});var r=100,i=1,o="PublicDL",a="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",d="ExternalMailbox",l="Mailbox",f="OneOff",p="Contact",h="ImplicitContact",m="PublicFolder",b="Other",g="Room",v="LinkedIn"},3414:function(e,n,t){"use strict";var r=t(0),i=t(3910),o=t.n(i),a=t(3631),c=t.n(a);function u(e){var n=c()({ProviderType:e});return o()(n)}var s=t(3911),d=t.n(s),l=t(3632),f=t.n(l);function p(e){var n=f()({ProviderType:e});return d()(n)}var h=t(3879),m=t(5);t.d(n,"a",function(){return j}),t.d(n,"b",function(){return S});var b="code",g="token",v=3e3,x=3;function O(e){return{state:e}}function k(e){return e.state}function w(e){return e.code}function j(e,n,t,i,o){var a={providerType:e,getAuthUrlInfo:null,getCSRFToken:k,getOAuthCode:w};return function e(n,t,i,o,a,c,s){return r.__awaiter(this,void 0,void 0,function(){var d,l;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),d=void 0,7!==n&&9!==n&&8!==n?[3,2]:[4,p(n)];case 1:return l=r.sent(),d=l.AttachmentDataProviderCreator.ProviderAppKey,i=l.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(n)];case 3:l=r.sent(),d=l.ProviderAppKey,r.label=4;case 4:return t.getAuthUrlInfo=Object(h.d)(n,i,o,d,a,c),[3,6];case 5:return r.sent(),s>0&&setTimeout(function(){return e(n,t,i,o,a,c,--s)},v),[3,6];case 6:return[2]}})})}(e,a,n,t,i,o,x),a}var _=null;function I(){if(!_){(_={})[3]=j(3,"https://app.box.com/api/oauth2/authorize",Object(h.c)(3),b,O),_[2]=j(2,"https://www.dropbox.com/oauth2/authorize",Object(h.b)(2),b,O);var e=j(6,"https://www.facebook.com/dialog/oauth",Object(h.b)(6),g,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=k,e.getOAuthCode=function(e){return e.access_token},_[6]=e;var n=j(5,"https://accounts.google.com/o/oauth2/auth",h.a+"/ADPRedirect.aspx",b,function(e){var n={state:e,provider:5..toString(),url:Object(h.b)()};return{state:JSON.stringify(n),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});n.getCSRFToken=function(e){return JSON.parse(e.state).state},_[5]=n,_[1]=j(1,"https://login.live.com/oauth20_authorize.srf",Object(h.c)(1),b,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(m.e)("doc-fileProvider-wopiClient")&&(_[7]=j(7,"",Object(h.c)(7),b,O),_[8]=j(8,"",Object(h.c)(8),b,O),_[9]=j(9,"",Object(h.c)(9),b,O))}return _}function S(e){var n=I();return e in n?n[e]:null}},3430:function(e,n,t){"use strict";t.d(n,"h",function(){return s}),t.d(n,"i",function(){return d}),t.d(n,"f",function(){return l}),t.d(n,"k",function(){return f}),t.d(n,"m",function(){return p}),t.d(n,"e",function(){return h}),t.d(n,"g",function(){return m}),t.d(n,"j",function(){return b}),t.d(n,"l",function(){return g});var r=t(3385);t.d(n,"c",function(){return r.a}),t.d(n,"d",function(){return r.b});var i=t(3542);t.d(n,"b",function(){return i.a});var o=t(3),a=t(3543);t.d(n,"n",function(){return a.a});t(3409);var c=t(3508);t.d(n,"a",function(){return c.a});var u=new o.c(function(){return t.e(392).then(t.bind(null,4479))}),s=new o.b(u,function(e){return e.getSharingInformation}),d=new o.b(u,function(e){return e.getSharingIssuesForSharingData}),l=new o.b(u,function(e){return e.getInfoBarCreator}),f=new o.b(u,function(e){return e.hasLargeDLRecipient}),p=new o.b(u,function(e){return e.hasRecipientExpansionFailure}),h=new o.b(u,function(e){return e.getGroupsAndSmallDLs}),m=new o.b(u,function(e){return e.getInvididualRecipients}),b=new o.b(u,function(e){return e.hasGetRecipientPermissionFailed}),g=new o.b(u,function(e){return e.logSharingTipChangesForLinkRemoval})},3436:function(e,n,t){"use strict";t.d(n,"b",function(){return o}),t.d(n,"a",function(){return a});var r=t(0),i=t(3386),o=function(){return r.__spread(Object(i.a)().providers.values())},a=function(e){return Object(i.a)().providers.get(e)||null}},3444:function(e,n,t){"use strict";var r=t(3581),i=t(3544),o=(t(3386),t(3390)),a=t(3449),c=(t(3855),t(3815),t(3436));var u=t(3516),s=t(3),d=t(3478),l=t(3414);t.d(n,"k",function(){return p}),t.d(n,"m",function(){return h}),t.d(n,"j",function(){return m}),t.d(n,"l",function(){return b}),t.d(n,"a",function(){return a.b}),t.d(n,"b",function(){return r.a}),t.d(n,"f",function(){return l.b}),t.d(n,"c",function(){return d.a}),t.d(n,"d",function(){return o.a}),t.d(n,"e",function(){return o.b}),t.d(n,"h",function(){return i.a}),t.d(n,"i",function(){return u.a}),t.d(n,"g",function(){return c.b}),t.d(n,"n",function(){return o.c});var f=new s.c(function(){return Promise.all([t.e(6),t.e(7),t.e(11),t.e(16),t.e(218)]).then(t.bind(null,13682))}),p=new s.b(f,function(e){return e.loadProviders}),h=new s.b(f,function(e){return e.removeFileProvider}),m=new s.b(f,function(e){return e.addFileProvider}),b=new s.b(f,function(e){return e.removeAndAddFileProvider})},3449:function(e,n,t){"use strict";t.d(n,"b",function(){return r}),t.d(n,"a",function(){return o}),t.d(n,"c",function(){return a});var r,i=t(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var o=Object.freeze([1,3,2,6,5,7,8,9]),a=Object.freeze(i.__spread(o,[0,4,10]))},3478:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},3487:function(e,n,t){"use strict";var r=t(1),i=t(214),o={expressionPickerViewState:null,selectedSkinTone:Object(i.c)(i.a.DiverseEmojis).diverseEmojisSelectedSkinTone,useFlexPane:null},a=Object(r.createStore)("expression",o)();n.a=a},3508:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},3515:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},3516:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(3386);function i(){return Object(r.a)().loadState}},3540:function(e,n,t){"use strict";var r=t(7),i=t(1),o={sharingLinks:new r.ObservableMap({})},a=Object(i.createStore)("sharingLinkStore",o);n.a=a},3541:function(e,n,t){"use strict";function r(e){return void 0!==e.recipients}function i(e){return void 0!==e.length}t.d(n,"b",function(){return r}),t.d(n,"a",function(){return i})},3542:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},3543:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(1),i=Object(r.action)("REFRESH_EXPIRATION_DATE",function(e){return{id:e}})},3544:function(e,n,t){"use strict";t.d(n,"a",function(){return u});var r=t(3909),i=t(3814),o=t(3889),a=t(4),c=t(91);function u(e,n){if(void 0===n&&(n=!1),n)return"";switch(e){case 0:case 1:return Object(a.a)(o.a);case 2:case 9:return Object(a.a)(r.b);case 3:case 7:return Object(a.a)(r.a);case 5:return Object(a.a)(r.e);case 6:return Object(a.a)(r.d);case 4:return Object(a.a)(r.f);case 10:return Object(a.a)(i.b);case 8:return Object(a.a)(r.c);default:return Object(c.a)(e)}}},3561:function(e,n,t){"use strict";var r=t(0),i=t(3912),o=t(3633),a=t(3890),c=t(3971),u=t(3487),s=t(3891),d=t(125),l=t(79),f=27,p=75,h=Object(l.h)()?function(e){return e.metaKey}:function(e){return e.ctrlKey},m=function(){function e(e,n){var t=this;this.ribbonViewState=e,this.getSelectedImageCallback=n,this.workaroundFocusIssueForFirefox=Object(d.f)()?function(){if(t.editor){var e=t.editor.getCustomData("WORKAROUND_TEXTBOX_FOR_FIREFOX",function(){var e=t.editor.getDocument().createElement("input");return e.type="textbox",e.style.width="0",e.style.height="0",t.editor.insertNode(e,{position:3,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),e},function(e){return e.parentNode&&e.parentNode.removeChild(e)});e.style.display="",e.focus(),e.style.display="none"}}:function(){},this.insertNodeFromExpressionPicker=function(e){if(t.editor&&!t.editor.isDisposed()){t.editor.focus();var n=u.a.expressionPickerViewState.wordToReplace;t.editor.performAutoComplete(function(){n?t.pluginUtils.replaceWithNode(t.editor,n,e,!0):t.editor.insertNode(e,{position:2,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1}),Object(c.a)(u.a.expressionPickerViewState,"")},"Ribbon")}},this.insertLinkFeature={keys:[p],allowFunctionKeys:!0,shouldHandleEvent:function(e){var n=e.rawEvent;return!n.altKey&&!n.shiftKey&&h(n)},handleEvent:function(e){var n=e.rawEvent;n.preventDefault(),n.stopPropagation(),t.workaroundFocusIssueForFirefox(),o.g.import().then(function(e){return e(t)})}},this.closeContextualFormatBarFeature={keys:[f],shouldHandleEvent:function(){return t.ribbonViewState.isContextualFormatBarShown},handleEvent:function(e){var n=e.rawEvent;n.preventDefault(),n.stopPropagation(),Object(i.a)(t.ribbonViewState,!1)}}}return e.prototype.getName=function(){return"Ribbon"},e.prototype.initialize=function(e){var n=this;this.editor=e,this.editor.addContentEditFeature(this.insertLinkFeature),this.editor.addContentEditFeature(this.closeContextualFormatBarFeature),o.h.import().then(function(e){return n.updateRibbonState=e})},e.prototype.onPluginEvent=function(e){var n=this;if(this.updateRibbonState&&(2==e.eventType&&e.rawEvent.keyCode!=f||5==e.eventType||6==e.eventType)){var t=6!=e.eventType;this.updateRibbonState(this,this.ribbonViewState,t,!0)}this.ribbonViewState.formatViewState.formatPainterFormat&&5==e.eventType&&o.e.import().then(function(e){return e(n)})},e.prototype.dispose=function(){this.editor=null,a.a.importAndExecute()},e.prototype.getEditor=function(){return this.editor},e.prototype.getFormatState=function(){return this.ribbonViewState.formatViewState},e.prototype.getImageSelectedByPlugin=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(n){switch(n.label){case 0:return this.getSelectedImageCallback?[4,this.getSelectedImageCallback]:[3,2];case 1:return e=n.sent()(),[3,3];case 2:e=null,n.label=3;case 3:return[2,e]}})})},e.prototype.setPluginUtils=function(e){this.pluginUtils=e},e.prototype.toggleExpressionPicker=function(e,n){e?s.b.importAndExecute(this.insertNodeFromExpressionPicker,n,"","ribbon"):a.a.importAndExecute()},e}();n.a=m},3580:function(e,n,t){"use strict";t.d(n,"d",function(){return i}),t.d(n,"b",function(){return o}),t.d(n,"e",function(){return a}),t.d(n,"a",function(){return c}),t.d(n,"c",function(){return u});var r=t(1),i=Object(r.action)("TRY_CHECK_PERM_FOR_LINKS",function(e,n,t){return{linkIds:e,recipientInfos:n,composeId:t}}),o=Object(r.action)("EXPAND_GROUPS_AND_SMALL_DLS",function(e,n,t){return{linkIds:e,recipientInfos:n,composeId:t}}),a=Object(r.action)("TRY_CHECK_PERM_FOR_ONE_LINK",function(e,n,t,r){return{linkId:e,recipientContainers:n,fromAddress:t,composeId:r}}),c=Object(r.action)("COMPOSE_GET_HAS_SHARING_ISSUES",function(e){return{composeId:e}}),u=Object(r.action)("ON_LINK_PERMISSION_CHANGED",function(e,n,t,r){return{linkId:e,newPermissionLevel:n,recipientInfos:t,composeId:r}})},3581:function(e,n,t){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),n.a=r},3631:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);n.default=function(e){return r.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},3632:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);n.default=function(e){return r.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},3633:function(e,n,t){"use strict";t.d(n,"b",function(){return a}),t.d(n,"a",function(){return c}),t.d(n,"i",function(){return u}),t.d(n,"h",function(){return s}),t.d(n,"e",function(){return d}),t.d(n,"g",function(){return l}),t.d(n,"d",function(){return f}),t.d(n,"f",function(){return p});var r=t(3561);t.d(n,"c",function(){return r.a});var i=t(3),o=new i.c(function(){return Promise.all([t.e(4),t.e(9),t.e(23),t.e(21),t.e(262)]).then(t.bind(null,4816))}),a=Object(i.d)(o,function(e){return e.Ribbon}),c=Object(i.d)(o,function(e){return e.ContextualFormatBar}),u=new i.a(o,function(e){return e.updateRibbonWidth}),s=new i.b(o,function(e){return e.updateRibbonState}),d=new i.b(o,function(e){return e.formatPainterFinish}),l=new i.b(o,function(e){return e.showInsertLinkDialog}),f=new i.b(o,function(e){return e.displayInsertLinkDialog}),p=new i.b(o,function(e){return e.showImageAltTextDialog})},3739:function(e,n,t){"use strict";function r(e){if(null===e)return null;var n=[];return e.CanShareInternally&&(n.push(2),n.push(1)),e.CanCreateOrganizationEditLink&&n.push(6),e.CanCreateOrganizationViewLink&&n.push(5),e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:null}function i(e){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;default:return 0}}function o(e,n,t){var r=i(e);if(0===r)switch(n){case 2:return t?4:3;case 1:return t?6:5;case 5:return t?2:1;default:return 0}return r}var a=t(4143),c=t(4),u="OneDrivePro",s=t(91),d=t(5),l=t(9);function f(e,n){switch(e){case 3:return Object(c.a)(a.b);case 4:return Object(c.a)(a.a);case 6:return Object(c.a)(a.d);case 5:return Object(c.a)(a.e);case 1:return n===u?Object(c.a)(a.g):Object(c.a)(a.b);case 2:return n===u?Object(c.a)(a.f):Object(c.a)(a.a);case 0:return Object(c.a)(a.c);default:return Object(s.a)(e)}}function p(e,n){return n===u&&Object(d.e)("doc-attachment-contextualSharingTips")?function(e){var n=Object(l.a)().SessionSettings.CompanyName;switch(e){case 3:return Object(c.a)(a.i);case 4:return Object(c.a)(a.h);case 6:return Object(c.b)(Object(c.a)(a.j),n);case 5:return Object(c.b)(Object(c.a)(a.k),n);case 1:return Object(c.a)(a.g);case 2:return Object(c.a)(a.f);case 0:return Object(c.a)(a.c);default:return Object(s.a)(e)}}(e):f(e,n)}function h(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}t.d(n,"b",function(){return r}),t.d(n,"c",function(){return i}),t.d(n,"d",function(){return o}),t.d(n,"e",function(){return f}),t.d(n,"f",function(){return p}),t.d(n,"a",function(){return u}),t.d(n,"g",function(){return h})},3814:function(e){e.exports={a:"CSa",b:"DSa"}},3815:function(e,n,t){"use strict";t.d(n,"a",function(){return c});var r=t(9),i=t(41),o=t(91),a=t(5);function c(e){var n=Object(r.a)();switch(e){case 5:return n.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&n.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.e)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return n.AttachmentPolicy.BoxAttachmentsEnabled&&n.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.e)("doc-fileProvider-box");case 2:return n.AttachmentPolicy.DropboxAttachmentsEnabled&&n.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.e)("doc-fileProvider-dropbox");case 6:return n.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.e)("doc-fileProvider-facebook");case 1:return!!Object(i.a)()||Object(a.e)("doc-filePicker-oneDriveConsumerForO365")&&n.AttachmentPolicy.OnedriveAttachmentsEnabled&&n.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(a.e)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return n.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.e)("doc-fileProvider-wopiClient");default:return Object(o.a)(e)}}},3853:function(e,n,t){"use strict";t.d(n,"d",function(){return a}),t.d(n,"e",function(){return c}),t.d(n,"b",function(){return u}),t.d(n,"c",function(){return s});var r=t(3),i=t(3580);t.d(n,"a",function(){return i.a});var o=new r.c(function(){return Promise.all([t.e(12),t.e(363)]).then(t.bind(null,5455))}),a=new r.a(o,function(e){return e.tryCheckPermForLinks}),c=new r.a(o,function(e){return e.tryCheckPermForOneLink}),u=new r.a(o,function(e){return e.expandGroupsAndSmallDLs}),s=new r.a(o,function(e){return e.onLinkHasChanged})},3855:function(e,n,t){"use strict";t.d(n,"a",function(){return i}),t.d(n,"b",function(){return o});var r=t(3449),i="file provider is not addable";function o(e){return r.a.indexOf(e)>-1}},3879:function(e,n,t){"use strict";var r=t(38),i=t(13);function o(e,n,t){if(!e||!n||!t)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+n+"="+t:e+"?"+n+"="+t}t.d(n,"a",function(){return a}),t.d(n,"b",function(){return c}),t.d(n,"c",function(){return u}),t.d(n,"d",function(){return s});var a=Object(i.B)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var n=e?encodeURIComponent("?provider="+e):"",t=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.n)()+"/mail/"+t+n}function u(e){var n=Object(r.n)()+"/mail/AddFileProvider.html",t=encodeURIComponent("provider="+e+"&url="+n);return a+"/ADPRedirect.aspx?"+t}function s(e,n,t,r,i,a){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),n=e.length-1,t=[],r=0;r<16;r++)t.push(e[Math.round(Math.random()*n)]);return"owa_csrf_token_"+t.join("")}(),c=o(n,"client_id",r);if(c=o(c,"redirect_uri",t),c=o(c,"response_type",i),a){var u=a(e);c=Object.keys(u).reduce(function(e,n){return o(e,n,u[n])},c)}return{authUrl:c,redirectUrl:t,csrfToken:e}}}},3889:function(e){e.exports={a:"NSa"}},3890:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(3),i=new r.c(function(){return Promise.all([t.e(44),t.e(207)]).then(t.bind(null,4823))}),o=new r.a(i,function(e){return e.closeExpressionPane})},3891:function(e,n,t){"use strict";t.d(n,"b",function(){return o}),t.d(n,"a",function(){return a});var r=t(3),i=new r.c(function(){return Promise.all([t.e(509),t.e(44),t.e(206)]).then(t.bind(null,4812))}),o=new r.a(i,function(e){return e.showExpressionPane}),a=Object(r.d)(i,function(e){return e.ExpressionPane})},3909:function(e){e.exports={b:"HSa",a:"ISa",e:"JSa",d:"KSa",f:"LSa",c:"MSa"}},3910:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(55),i=t(3631);n.default=function(e,n){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,n)}},3911:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(55),i=t(3632);n.default=function(e,n){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAttachmentDataProviderCreator",e,n)}},3912:function(e,n,t){"use strict";var r=t(8);n.a=Object(r.action)("setIsContextualFormatBarShown")(function(e,n,t,r){void 0===t&&(t=0),void 0===r&&(r=0),e.isContextualFormatBarShown=n,e.contextualFormatBarLeft=t,e.contextualFormatBarTop=r})},3971:function(e,n,t){"use strict";var r=t(1);n.a=Object(r.mutatorAction)("setWordToReplace",function(e,n){e.wordToReplace=n})},4143:function(e){e.exports={b:"mHa",a:"nHa",d:"oHa",e:"pHa",g:"qHa",f:"rHa",c:"sHa",i:"tHa",h:"uHa",j:"vHa",k:"wHa"}},452:function(e,n,t){"use strict";function r(e){if(!e)return null;var n=e.lastIndexOf(".");return n>0?e.substr(n).toLowerCase():null}function i(e){var n=r(e);return n?n.replace(".",""):null}var o=t(1237),a=t(4);function c(e){var n;return e>=1073741824?(e/=1073741824,n=Object(a.a)(o.b)):e>=1048576?(e/=1048576,n=Object(a.a)(o.d)):e>=1024?(e/=1024,n=Object(a.a)(o.c)):n=Object(a.a)(o.a),Object(a.b)(n,Math.round(e))}function u(e){return e&&(n=e,(t=d.exec(n))&&t.length>1&&s[t[1].toLowerCase()]);var n,t}var s={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},d=/^\s*([^;\s]*)(?:;|\s|$)/;var l=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"];function f(e,n){var t=r(e)||u(n);return!!t&&l.indexOf(t.toLowerCase())>=0}var p=t(5),h=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function m(e){if(!Object(p.e)("doc-attachment-documentThumbnail"))return!1;var n=r(e);return!!n&&h.indexOf(n.toLowerCase())>=0}t.d(n,"a",function(){return r}),t.d(n,"b",function(){return i}),t.d(n,"e",function(){return c}),t.d(n,"c",function(){return f}),t.d(n,"d",function(){return m})},4585:function(e){e.exports={a:"wWa"}},4586:function(e){e.exports={a:"vWa"}},4658:function(e,n,t){"use strict";var r=t(2564),i=t(4);function o(e,n){return{name:Object(i.a)(r.a),key:"OpenInNewTab",onClick:function(){window.open(e,"_blank"),n&&n()}}}t.d(n,"a",function(){return"owa-attachment-remove-on-send-end"}),t.d(n,"b",function(){return"owa-attachment-remove-on-send-start"}),t.d(n,"c",function(){return o})},476:function(e,n,t){"use strict";var r,i,o;t.d(n,"c",function(){return r}),t.d(n,"b",function(){return i}),t.d(n,"a",function(){return o}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},4806:function(e,n,t){"use strict";var r,i=t(0),o=t(1),a=Object(o.action)("SET_IS_CONTEXT_MENU_OPEN",function(e,n){return{linkId:e,value:n}}),c=Object(o.action)("RESET_IS_CONTEXT_MENU_OPEN_FOR_LINKS",function(){return{}}),u=Object(o.action)("UPDATE_COMPOSE_LINK_VIEW_STATE",function(e,n,t){return{linkId:e,displayName:n,isLinkBeautified:t}}),s=Object(o.action)("REMOVE_COMPOSE_LINK_VIEW_STATE",function(e){return{linkId:e}}),d={composeLinks:new(t(7).ObservableMap)({}),selectedLinkId:null,isSelectedLinkReadOnly:null},l=Object(o.createStore)("composeLinkViewStore",d);function f(e){return l().composeLinks.get(e)}!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected"}(r||(r={}));var p,h=r,m="LinkContextMenu",b=t(5922),g=t(4);!function(e){e.contextMenu="contextMenu",e.sharingTip="sharingTip"}(p||(p={}));var v=t(5),x=t(9);function O(e){var n=Object(x.a)().AttachmentPolicy.ClassicAttachmentsEnabled;if(!Object(v.e)("doc-attachment-contextualSharingTips")||!n||e.sharingInfo.blocksDownload)return!1;var t=e.mimeType;return(!t||"application/onenote"!==t&&"text/directory"!==t)&&(!e.sharingInfo||!e.sharingInfo.blocksDownload)}var k=t(3444),w=t(3342),j=t(66),_=t(11);function I(e){var n=function(e){for(var n=0;n<e.length;n++)if(0===e[n].type)return e[n].model.Id;return _.c.warn("createAttachmentFromLink: Could not get OneDrive Pro provider ID. File will not upload."),""}(Object(k.g)());Object(j.b)(n)||Object(w.c)(e,n,!1)}var S=t(15);var y=t(3739),E=t(3853),L=t(5923);function A(e,n,t){var r=[];return e.supportedPermissionLevels&&e.supportedPermissionLevels.forEach(function(i){if(1!==i&&2!==i){var o=Object(y.f)(i,y.a);r.push({text:o,key:o,title:o,onClick:function(){Object(S.o)("AttachmentLinkViewChangePermission"),function(e,n,t,r){if(e===n.permissionLevel)return;var i=function(e,n){switch(e){case 6:return n.sharingUrls.organizationEditLink;case 5:return n.sharingUrls.organizationViewLink;case 2:case 1:case 0:return n.sharingInfo.canonicalUrl;default:return null}}(e,n);Object(w.u)(n.linkId,e),i?Object(w.v)(n.linkId,i,n.url,null):Object(w.d)(n.linkId,n.url,n.sharingInfo.canonicalUrl,e);E.c.importAndExecute(n.linkId,e,r,t)}(i,e,n,t),Me()},isChecked:i===e.permissionLevel,canCheck:!0})}}),r.length>0?{items:r,className:L.fixWidthContextMenu,directionalHintFixed:!0}:null}var C=t(5775);function P(e,n,t){return i.__awaiter(this,void 0,void 0,function(){var r,o,a;return i.__generator(this,function(i){switch(i.label){case 0:return Me(),[4,C.a.import()];case 1:return r=i.sent(),o=e.sharingInfo.canonicalUrl,a=e.sharingInfo.siteUrl,r(a,o,e.sharingInfo.shareId,e.permissionLevel).then(function(r){var i=r.shareId!==e.sharingInfo.shareId;Object(w.w)(e.linkId,r),i&&E.c.importAndExecute(e.linkId,r.permissionLevel,t,n)}).catch(function(){}),[2]}})})}var T=t(394),N=t(2),R=t(5924),F=t(177);var M=t(5925),D=t(4585),W=t(4586),U=t(79);function V(e){return Object(g.g)(e.href)?null:{name:Object(g.a)(M.a),key:"CopyLink",onClick:function(){var n,t;n=e.href,t=Object(U.h)()?Object(g.a)(W.a):Object(g.a)(D.a),window.prompt(t,n),Object(S.o)("AttachmentLinkViewCopyLink")}}}var z=t(161);function B(e){return{key:e,itemType:z.a.Divider}}var G=t(7345);function H(e){for(var n=0;n<e.childNodes.length;n++){var t=e.childNodes[n];if("#text"===t.nodeName)return t.textContent}return null}var Y=t(246),J=t(3633);function q(e,n){return J.d.import(),{name:Object(g.a)(G.a),key:"EditLink",onClick:function(){Object(S.o)("AttachmentLinkViewEditLink"),function(e,n){i.__awaiter(this,void 0,void 0,function(){var t,r;return i.__generator(this,function(i){switch(i.label){case 0:return t=H(e),r={LinkUrl:e.href,DisplayText:t,HasChanged:!1},[4,J.d.import()];case 1:return[4,i.sent()(r)];case 2:if(i.sent()===Y.a.ok&&r.HasChanged){if(r.LinkUrl===e.href&&Object(j.b)(r.DisplayText))return[2];n(r.LinkUrl,r.DisplayText.length>0?r.DisplayText:null)}return[2]}})})}(e,n)}}}var K=t(5926),X=Object(o.action)("ADD_COMPOSE_LINK_VIEW_STATE",function(e){return{linkId:e}}),Q=Object(o.action)("REMOVE_ALL_COMPOSE_LINK_VIEW_STATES"),Z=Object(o.action)("PREVIEW_SP_DOC_LINK_IN_SXS",function(e,n,t){return{wacUrlGetter:e,linkId:n,readOnly:t}}),$=Object(o.action)("onLinkSelectionChange",function(e,n){return{selectedLinkId:e,isSelectedLinkReadOnly:n}}),ee=t(2264);function ne(e,n,t){return t?null:{name:Object(g.a)(K.a),key:"Preview",onClick:function(){!function(e,n){i.__awaiter(this,void 0,void 0,function(){var t,r;return i.__generator(this,function(i){switch(i.label){case 0:return Object(S.o)("PreviewLinkInSxS"),[4,ee.c.import()];case 1:return t=i.sent(),(r=t(e))?[3,4]:[4,ee.b.import()];case 2:return[4,i.sent()(e,!0)];case 3:r=i.sent(),i.label=4;case 4:return Z(function(){return Promise.resolve(r.wacUrlInfo)},n,r.wacUrlInfo.readOnly),[2]}})})}(e,n),Me()}}}var te=t(7346);var re=t(5927),ie=t(5928),oe=t(5121),ae=t(7347),ce=t(7348),ue=t(3430);function se(e){return e===ue.c.linkHasExpired||e===ue.c.linkWillExpire}var de=t(46),le=t(1640),fe=t(211),pe=t(7349),he=t(177),me=Object(de.a)(function(e){var n=e.sharingLinkInfo.linkActionStatus;return N.useEffect(function(){var n=function(n){Object(w.s)(e.sharingLinkInfo.linkId,w.a.none)};return window.addEventListener("transitionend",n),function(){return window.removeEventListener("transitionend",n)}},[]),se(e.sharingIssue.id)&&n!==w.a.none&&n!==w.a.refreshFailed?n===w.a.refreshing?N.createElement("div",{className:pe.overlay},N.createElement(le.a,{className:pe.spinner,size:fe.a.medium}),Object(g.a)(ce.b)):n===w.a.refreshSucceeded?N.createElement("div",{className:he(pe.overlay,pe.fadeOut)},N.createElement(T.a,{iconName:"CheckMark",className:pe.check}),Object(g.a)(ce.a)):null:null}),be=t(18),ge=t(476),ve=t(7351),xe=t(91),Oe=t(6);function ke(e,n,t,r){switch(e){case ue.c.externalRecipientCSL:case ue.c.getSharingInfoFailed:case ue.c.noPermissionSet:case ue.c.noPermissionToShare:case ue.c.noPermissionToShareExternally:case ue.c.sharingWithLargeDL:return n;case ue.c.linkHasExpired:case ue.c.linkWillExpire:return function(e,n,t){if(n===w.a.refreshFailed)return Object(g.a)(ve.e);if(e===ue.c.linkHasExpired)return Object(g.a)(ve.a);var r=Object(Oe.O)(t);return Object(g.b)(Object(g.a)(ve.c),r)}(e,t,r);default:return Object(xe.a)(e)}}var we=t(5924),je=t(7352),_e=t(115).bind(je),Ie=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.getSharingTipMessageAndActions=function(e,t){var r=-1!==t.sharingTipActions.indexOf(ue.b.ignore),i=-1!==t.sharingTipActions.indexOf(ue.b.refreshExpiration)&&e.sharingInfo.canRefresh,o=e.linkActionStatus===w.a.refreshFailed?Object(g.a)(ae.b):Object(g.a)(oe.a),a=e.sharingInfo.canShareExternally||e.sharingInfo.canShareInternally,c=-1!==t.sharingTipActions.indexOf(ue.b.changePermission)&&Object(v.e)("doc-attachment-contextualSharingTips")&&a,u=-1!==t.sharingTipActions.indexOf(ue.b.attachAsACopy)&&!c&&O(e),s=ke(t.id,t.sharingTipString,e.linkActionStatus,e.sharingInfo.expirationDate);return N.createElement("div",{className:we.text},N.createElement("span",{className:je.paddingRight},s),i&&N.createElement(N.Fragment,null,N.createElement("button",{className:je.actionButton,onClick:n.refreshLink},o),N.createElement("span",{className:je.divider}," "," | "," ")),c&&N.createElement(N.Fragment,null,N.createElement("button",{className:je.actionButton,onClick:n.changePermission},Object(g.a)(ie.a)),N.createElement("span",{className:je.divider}," "," | "," ")),u&&N.createElement(N.Fragment,null,N.createElement("button",{className:je.actionButton,onClick:n.attachACopy},Object(g.a)(ae.a)),N.createElement("span",{className:je.divider}," "," | "," ")),r&&N.createElement("button",{className:je.actionButton,onClick:n.ignoreTip},Object(g.a)(re.a)))},n.refreshLink=function(e){var t;Object(ue.n)(n.props.sharingLinkInfo.linkId),t=n.props.sharingIssue.id,Object(S.o)("AttachmentLinkRefreshedSharingTip",[t]),e.stopPropagation()},n.changePermission=function(e){var t;P(n.props.sharingLinkInfo,n.props.composeId,n.props.recipientInfos),t=n.props.sharingIssue.id,Object(S.o)("AttachmentLinkViewChangePermissionSharingDialog",[p.sharingTip,t]),e.stopPropagation()},n.attachACopy=function(e){var t;I(n.props.sharingLinkInfo.linkId),t=n.props.sharingIssue.id,Object(S.o)("AttachmentLinkAttachAsACopy",[p.sharingTip,t]),Me(),e.stopPropagation()},n.ignoreTip=function(e){var t;w.k.import().then(function(e){return e(n.props.sharingLinkInfo.linkId,n.props.sharingIssue.id)}),t=n.props.sharingIssue.id,Object(S.o)("AttachmentLinkSharingTipIgnored",[t]),e.stopPropagation()},n}return i.__extends(n,e),n.prototype.render=function(){var e,n,t=this.props,r=t.sharingIssue,i=t.sharingLinkInfo,o={error:r.messageRank===ge.b.Error},a=(e=r.id,n=i.linkActionStatus,se(e)?n===w.a.refreshFailed?Object(g.a)(ve.f):e===ue.c.linkWillExpire?Object(g.a)(ve.d):e===ue.c.linkHasExpired?Object(g.a)(ve.b):null:null);return N.createElement("div",{className:we.menuItemContainer,"aria-label":r.sharingTipString,"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:null,tabIndex:0},N.createElement(me,{sharingLinkInfo:i,sharingIssue:r}),N.createElement("div",{className:we.iconContainer},N.createElement(T.a,{iconName:"Info",className:_e(je.sharingTipIcon,o),title:a})),this.getSharingTipMessageAndActions(i,r))},n=i.__decorate([be.observer],n)}(N.Component);function Se(e){var n=l();return e===n.selectedLinkId?!1===n.isSelectedLinkReadOnly?h.Edit:h.Selected:h.None}var ye,Ee=t(4658),Le=t(62);!function(e){e[e.SharingTip=0]="SharingTip",e[e.ChangePermission=1]="ChangePermission",e[e.Preview=2]="Preview",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.AttachACopy=4]="AttachACopy",e[e.RevertToFullUrl=5]="RevertToFullUrl",e[e.EditLink=6]="EditLink",e[e.CopyLinkToClipboard=7]="CopyLinkToClipboard"}(ye||(ye={}));var Ae=t(1366),Ce=t(60),Pe=t(5923),Te=t(115).bind(Pe),Ne=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.onDismissContextMenu=function(e){Me()},n}return i.__extends(n,e),n.prototype.render=function(){var e=Object(w.h)(this.props.composeLinkViewState.linkId);if(!e||e.linkActionStatus===w.a.attachingAsACopy||e.linkActionStatus===w.a.pendingAttachAsACopy)return null;var n,t,r,o,a,c,u,s,d,l,f,x=i.__read((n=this.props.composeLinkViewState,t=this.props.anchorElement,r=this.props.editor,o=this.props.composeId,a=this.props.recipientInfo,c=this.props.isCalendar,u=!1,s=!1,d=[],l=Object.keys(ye).filter(function(e){return!isNaN(Number(ye[e]))}).map(function(e){return ye[e]}),f=function(e,n){r.isDisposed()||r.addUndoSnapshot(function(){return function(e,n,t,r){Le.unmountComponentAtNode(n);var i=document.createElement("a");i.href=t,i.innerText=r,e.replaceNode(n,i),e.select(i,-3),e.triggerContentChangedEvent(m)}(r,t,e,n)})},l.forEach(function(e){switch(e){case ye.SharingTip:var r=function(e,n,t){if(!Object(v.e)("doc-attachment-contextualSharingTips"))return null;var r=ue.i.tryImportForRender();if(!r)return null;var i=r(Object(w.g)(e.linkId),n);if(i.length>0){i.length>1&&Object(S.o)("AttachmentLinkMultipleSharingTipsShown");var o=[];return i.map(function(r){var i=Object(w.h)(e.linkId);o.push({key:"contextualSharingTip",onRender:function(e,o){return N.createElement(Ie,{sharingIssue:r,sharingLinkInfo:i,composeId:t,recipientInfos:n})}})}),o}return null}(n,a,o);r&&r.length>0&&(u=!0,r.forEach(function(e,n){d.push(e),d.push(B("divider_sharing "+n))}));break;case ye.OpenInNewTab:var i=Object(Ee.c)(Object(w.h)(n.linkId).url,function(){Me(),Object(S.o)("OpenInNewTab",{entryPoint:"BeautifulLinkContextMenu"})});i&&d.push(i);break;case ye.AttachACopy:var l=(M=n.linkId,O(Object(w.h)(M))?{name:Object(g.a)(b.a),key:"AttachACopy",onClick:function(){Object(S.o)("AttachmentLinkAttachAsACopy",[p.contextMenu]),Me(),I(M)}}:null);l&&d.push(l);break;case ye.ChangePermission:var m=function(e,n,t){var r=Object(w.h)(e);if(!Object(v.e)("doc-attachment-contextualSharingTips")||!r.accessTokenAvailable)return null;var i=function(){Object(S.o)("AttachmentLinkViewChangePermissionSharingDialog",[p.contextMenu]),P(r,n,t)};return{key:"ChangePermissionsSharingDialog",onRender:function(e,n){return N.createElement("button",{className:F(R.menuItemContainer,R.buttonStyles),"aria-label":Object(y.f)(r.permissionLevel,y.a),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:i,tabIndex:0},N.createElement("div",{className:R.iconContainer},N.createElement("img",{src:(t=r.permissionLevel,function(e){var n="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing";switch(e){case 2:case 3:return n+"/companyonly.svg";case 4:case 5:return n+"/anyone.svg";case 6:return n+"/directrecipients.svg";default:return n+"/existingaccess.svg?v2"}}(function(e){switch(e){case 4:return 5;case 3:return 4;case 6:return 3;case 5:return 2;case 2:case 1:return 6;default:return 1}}(t))),className:R.permissionIcon})),N.createElement("div",{className:F(R.text,R.paddingForChevron)},Object(y.f)(r.permissionLevel,y.a)),N.createElement(T.a,{iconName:"ChevronRight",className:F(R.chevronRight,"flipForRtl")}));var t}}}(n.linkId,o,a);if(m)d.push(m),d.push(B("divider_perms")),s=!0;else{var x=function(e,n,t){var r=Object(w.h)(e.linkId);return{text:Object(y.f)(r.permissionLevel,y.a),key:"changePermission",className:L.smallFontContextMenu,subMenuProps:A(r,n,t)}}(n,o,a);x&&(d.push(x),d.push(B("divider_perms")))}break;case ye.EditLink:if(n.isLinkBeautified){var k=q(t,f);k&&d.push(k)}break;case ye.RevertToFullUrl:n.isLinkBeautified&&d.push(function(e,n,t,r){return{name:Object(g.a)(te.a),key:"RevertToFullUrl",onClick:function(){Object(S.o)("AttachmentLinkViewRevertToFullUrl"),Me(),t(n.href,n.href)}}}(n.linkId,t,f));break;case ye.Preview:if(Object(v.e)("doc-SxS-jsApi-ODB-Core")){var j=ee.a.tryImportForRender(),_=Object(w.h)(n.linkId).url;if(j&&j(_)&&Se(n.linkId)===h.None){var E=ne(_,n.linkId,c);E&&d.push(E)}}break;case ye.CopyLinkToClipboard:var C=V(t);C&&d.push(C);break;default:Object(xe.a)(e)}var M}),[d,u||s]),2),k=x[0],j={conditionalPadding:x[1]},_=Object(v.e)("doc-attachment-contextualSharingTips");return N.createElement(Ae.a,{className:Te(j),target:this.props.anchorElement,shouldFocusOnMount:_,onDismiss:this.onDismissContextMenu,items:k,directionalHint:Ce.a.bottomLeftEdge,gapSpace:2})},n=i.__decorate([be.observer],n)}(N.Component),Re=null;function Fe(e,n,t,r,o){return i.__awaiter(this,void 0,void 0,function(){var c,u,s,d,l,p;return i.__generator(this,function(i){switch(i.label){case 0:return Me(),c=w.j.tryImportForRender(),u=[],c&&(u=c(r,o)),s=!r.some(function(e){return Object(w.r)(e)}),(Re=document.createElement("span")).id="sharingLinkContextMenu",e.appendChild(Re),Le.render(N.createElement(Ne,{composeLinkViewState:f(e.id),anchorElement:e,editor:n,composeId:t,recipientInfo:u,isCalendar:s}),Re),a(e.id,!0),[4,ue.i.import()];case 1:return d=i.sent(),l=Object(w.g)(e.id),p=d(l,u).length>0,Object(S.o)("LinkContextMenuOpened",{hasSharingIssue:p}),[2]}})})}function Me(){Re&&(Le.unmountComponentAtNode(Re),Re.parentNode&&Re.parentNode.removeChild(Re),Re=null),c()}var De,We=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(n,e),n.prototype.componentDidMount=function(){var e=Le.findDOMNode(this);Le.unmountComponentAtNode(e),e.outerHTML=this.createComment()},n.prototype.createComment=function(){return"\x3c!--"+this.props.text+"--\x3e"},n.prototype.render=function(){return N.createElement("div",null)},n}(N.Component),Ue=t(13),Ve=t(927),ze="text/directory",Be=t(7354),Ge=t(115).bind(Be);!function(e){e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(De||(De={}));var He=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.onContextMenu=function(e){Fe(n.link,n.props.editor,n.props.composeId,n.props.getRecipientWells(),n.props.fromAddress),e.preventDefault()},n.onClick=function(e){Fe(n.link,n.props.editor,n.props.composeId,n.props.getRecipientWells(),n.props.fromAddress),e.preventDefault()},n.getAnchorStyle=function(){return n.props.viewState.isLinkBeautified?{padding:"0 1px",backgroundColor:"rgb(244,244,244)",borderRadius:"2px",userSelect:"all"}:null},n.getFileIconStyle=function(){return{width:"16px",height:"16px",verticalAlign:"middle",padding:"1px 2px 2px 0"}},n.getErrorIconStyle=function(){return{width:"12px",height:"12px",verticalAlign:"top"}},n.getAnchorTextColor=function(e){if(e===De.Error)return Be.linkWithSharingIssue},n.getErrorIcon=function(e){return e===De.Error?Object(g.b)("{0}{1}",Object(Ue.r)(),"resources/images/redinfo_24.png"):e===De.Warning?Object(g.b)("{0}{1}",Object(Ue.r)(),"resources/images/greyinfo_24.png"):""},n.onMouseOver=function(){n.link&&n.props.viewState.isLinkBeautified&&(n.link.style.backgroundColor="rgb(237,235,233)")},n.onMouseLeave=function(){n.link&&n.props.viewState.isLinkBeautified&&(n.link.style.backgroundColor="rgb(243,242,241)")},n}return i.__extends(n,e),n.prototype.render=function(){var e=this,n=this.props.viewState?function(e,n,t,r){var i=t(),o=Object(w.g)(e);if(null===o||!n||!Object(v.e)("doc-attachment-contextualSharingTips"))return De.None;var a=w.j.tryImportForRender(),c=ue.i.tryImportForRender(),u=[];if(a&&c){u=a(i,r);var s=c(o,u);if(s&&s.length>0)return s.some(function(e){return e.messageRank===ge.b.Error})?De.Error:De.Warning}return De.None}(this.props.viewState.linkId,this.props.viewState.isLinkBeautified,this.props.getRecipientWells,this.props.fromAddress):De.None;Object(v.e)("doc-link-editingVisualFeature")?this.linkPreviewMode=Se(this.props.sharingLink.linkId):this.linkPreviewMode=h.None;var t={attachingAsACopy:this.props.sharingLink.linkActionStatus===w.a.attachingAsACopy||this.props.sharingLink.linkActionStatus===w.a.pendingAttachAsACopy,link:this.props.viewState.isLinkBeautified};return t[this.getComposeLinkStyle(this.linkPreviewMode)]=!0,N.createElement("a",{ref:function(n){return e.link=n},href:this.props.sharingLink.url,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,style:this.getAnchorStyle(),id:this.props.sharingLink.linkId,className:Ge("OWAAutoLink",this.getAnchorTextColor(n),t)},N.createElement(We,{text:Ee.b}),Object(v.e)("doc-link-editingVisualFeature")&&N.createElement(T.a,{className:this.linkPreviewMode===h.Edit?Be.editLinkIcon:Be.hidden,iconName:"Edit"}),N.createElement(We,{text:Ee.a}),this.props.viewState.isLinkBeautified&&this.props.hasValidFileName&&N.createElement("img",{src:this.props.fileIcon,style:this.getFileIconStyle(),alt:"",role:"presentation"}),this.props.viewState.displayName,N.createElement(We,{text:Ee.b}),N.createElement("img",{alt:"",role:"presentation",src:this.getErrorIcon(n),hidden:n===De.None,style:this.getErrorIconStyle()}),N.createElement(We,{text:Ee.a}))},n.prototype.componentDidMount=function(){this.copyStyleFromOriginalAnchor(),this.props.viewState.isLinkBeautified&&this.link.setAttribute("contenteditable","false"),this.link.addEventListener("click",this.onClick),this.link.addEventListener("contextmenu",this.onContextMenu),this.props.editor.replaceNode(this.props.originalAnchor,this.link);var e=this.props.editor.getSelectionRange();e&&(e.startContainer!==e.endContainer||e.startContainer!==this.link.parentNode&&e.startContainer.previousSibling!==this.link||this.props.editor.select(this.link,-3))},n.prototype.componentWillUnmount=function(){this.link&&(this.link.removeEventListener("click",this.onClick),this.link.removeEventListener("contextmenu",this.onContextMenu))},n.prototype.copyStyleFromOriginalAnchor=function(){var e=this.props.originalAnchor.getAttribute("style");(e&&e.length>0&&e.lastIndexOf(";")!==e.length-1&&(e+=";"),e+=this.link.getAttribute("style"),this.props.isLinkPreviouslyBeautified)&&(this.props.originalAnchor.querySelector("SPAN")&&(e+=this.props.originalAnchor.children[1].getAttribute("style")));this.link.setAttribute("style",e)},n.prototype.getComposeLinkStyle=function(e){switch(e){case h.Edit:return"edit";case h.Selected:return"selected";case h.None:return"none";default:return Object(xe.a)(e)}},n=i.__decorate([be.observer],n)}(N.Component);function Ye(e,n,t,r,i,o,a,c,s,d){_.c.info("createSharingLinkView");var l=s||d,p=a||d,h=function(e,n,t){if(e&&n){var r=Object(Ve.e)(e,t===ze,t);return r.cdn||""}return""}(d?H(i):o.fileName,l,c),m=document.createElement("span"),b=function(e,n,t,r,i){if(i)return H(e);if(t&&r)return n.fileName;return e.text}(i,o,p,s,d);u(i.id,b,l),Le.render(N.createElement(He,{viewState:f(i.id),getRecipientWells:n,fromAddress:t,sharingLink:o,fileIcon:h,hasValidFileName:p,editor:e,originalAnchor:i,composeId:r,isLinkPreviouslyBeautified:d}),m)}var Je=t(7356);function qe(e){return N.createElement(le.a,{className:Je.linkSpinner,size:fe.a.xSmall})}function Ke(e){Le.render(N.createElement(qe,null),e)}function Xe(e){var n=f(e);return!!n&&n.isContextMenuOpen}Object(o.mutator)(X,function(e){var n=l(),t={linkId:e.linkId,isContextMenuOpen:!1,isLinkBeautified:!1,displayName:null};n.composeLinks.set(e.linkId,t)}),Object(o.mutator)(s,function(e){l().composeLinks.delete(e.linkId)}),Object(o.mutator)(Q,function(e){l().composeLinks.clear()}),Object(o.mutator)(u,function(e){f(e.linkId).displayName=e.displayName}),Object(o.mutator)(w.v,function(e){var n=f(e.linkId);n.isLinkBeautified||n.displayName!==e.oldLinkUrl||(n.displayName=e.newLinkUrl)}),Object(o.mutator)(a,function(e){f(e.linkId).isContextMenuOpen=e.value}),Object(o.mutator)(c,function(e){l().composeLinks.forEach(function(e){return e.isContextMenuOpen=!1})}),Object(o.mutator)(u,function(e){f(e.linkId).isLinkBeautified=e.isLinkBeautified}),Object(o.mutator)($,function(e){var n=l(),t=e.selectedLinkId,r=e.isSelectedLinkReadOnly;n.selectedLinkId=t,n.isSelectedLinkReadOnly=r}),Object(o.orchestrator)(w.e,function(e){var n=document.getElementById(e.linkId);n&&(Le.unmountComponentAtNode(n),n.remove(),s(e.linkId))}),t.d(n,"a",function(){return m}),t.d(n,"b",function(){return"OWAAutoLink"}),t.d(n,"c",function(){return X}),t.d(n,"k",function(){return Q}),t.d(n,"i",function(){return $}),t.d(n,"j",function(){return Z}),t.d(n,"g",function(){return f}),t.d(n,"e",function(){return Ye}),t.d(n,"h",function(){return Xe}),t.d(n,"l",function(){return Fe}),t.d(n,"d",function(){return Me}),t.d(n,"f",function(){return Ke})},5121:function(e){e.exports={a:"lHa"}},5232:function(e,n,t){"use strict";var r=t(0),i=t(4),o=t(1),a=t(13),c=t(126);var u={am:"am-et","be-by":"be",cy:"cy-gb",en:"en-us",fil:"fil-ph","gd-gb":"gd","lo-la":"lo","mn-mn":"mn",no:"nn-no",or:"or-in","pa-in":"pa",prs:"prs-af",pt:"pt-br",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs","ug-cn":"ug",uz:"uz-latn-uz","zh-hant":"zh-cn","zh-hans":"zh-tw"};function s(){return r.__awaiter(this,void 0,void 0,function(){var e,n,t;return r.__generator(this,function(l){switch(l.label){case 0:return f=Object(i.e)(Object(i.d)().currentLocale).locale.toLocaleLowerCase(),e=u[f]||f,n=["items-view","items-view-addon-sp","items-view-utilities","odsp-datasources","odsp-list-utilities","odsp-shared-sharing","odsp-utilities","utilities-custom-formatter","utilities-date-time","utilities-office-apps"],[4,Promise.all(n.map(function(n){return function(e,n){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(c.resolve)(Object(a.r)(),"resources/"+e+"/locale/"+n+".json"),[4,fetch(t)];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}})})}(n,e)}))];case 1:return t=l.sent(),window.ItemsViewStrings=t.reduce(function(e,n){return r.__assign({},e,n)},{}),d||(Object(o.orchestrator)(i.h,s),d=!0),[2]}var f})})}var d=!1;t.d(n,"a",function(){return s})},5775:function(e,n,t){"use strict";t.d(n,"a",function(){return u}),t.d(n,"b",function(){return c});var r=t(0),i=t(3220),o=t(3),a=t(5232),c=new o.c(function(){return r.__awaiter(void 0,void 0,void 0,function(){var e;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Object(a.a)()];case 1:return n.sent(),[4,Promise.all([t.e(41),t.e(29),t.e(81),t.e(545),t.e(393)]).then(t.bind(null,8140))];case 2:return e=n.sent(),Object(i.initializeIcons)(),[2,e]}})})}),u=new o.b(c,function(e){return e.sharingDialog})},5922:function(e){e.exports={a:"h2a"}},5923:function(e,n,t){var r=t(7343),i=t(37);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},5924:function(e,n,t){var r=t(7344),i=t(37);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},5925:function(e){e.exports={a:"g2a"}},5926:function(e){e.exports={a:"S1a"}},5927:function(e){e.exports={a:"kHa"}},5928:function(e){e.exports={a:"a2a"}},7342:function(e,n,t){"use strict";t.d(n,"a",function(){return o}),t.d(n,"b",function(){return a});t(15);var r=t(3),i=new r.c(function(){return t.e(276).then(t.bind(null,9106))}),o=new r.a(i,function(e){return e.loadItemAttachment}),a=new r.b(i,function(e){return e.loadItemAttachmentFromServer})},7343:function(e,n,t){(n=e.exports=t(36)(!1)).push([e.i,"._17WyMAb7kE3GVOOwb-TpZ2{width:380px}.iji84L-TYfQ1OzoQCLarU{font-size:12px;font-weight:400}html[dir=ltr] .kYi6jPW-Twz-7yNjFuas7 .ms-ContextualMenu-link{padding-left:40px}html[dir=rtl] .kYi6jPW-Twz-7yNjFuas7 .ms-ContextualMenu-link{padding-right:40px}",""]),n.locals={fixWidthContextMenu:"_17WyMAb7kE3GVOOwb-TpZ2",smallFontContextMenu:"iji84L-TYfQ1OzoQCLarU",conditionalPadding:"kYi6jPW-Twz-7yNjFuas7"}},7344:function(e,n,t){(n=e.exports=t(36)(!1)).push([e.i,'._1FXMYQgOMl3amdWxRszOtq{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;max-width:340px;width:100%}html[dir] ._1FXMYQgOMl3amdWxRszOtq{background:transparent;padding:4px 0;margin:1px}html[dir=ltr] ._1FXMYQgOMl3amdWxRszOtq{text-align:left}html[dir=rtl] ._1FXMYQgOMl3amdWxRszOtq{text-align:right}._1FXMYQgOMl3amdWxRszOtq:focus{outline:dotted 1px}._2J6rsM7M0QVkdfFCwf00JE{cursor:pointer}html[dir] ._2J6rsM7M0QVkdfFCwf00JE:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}._3C9hg6ajHb65GB2Yn3bZfl{word-wrap:break-word;max-width:286px}html[dir=ltr] ._3C9hg6ajHb65GB2Yn3bZfl{padding:8px 16px 8px 0}html[dir=rtl] ._3C9hg6ajHb65GB2Yn3bZfl{padding:8px 0 8px 16px}._T68wDSYHk9rU_lDLi9YG{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;min-width:44px}._T68wDSYHk9rU_lDLi9YG,._3ocYJJXdgtwVydxjhLdwEm{display:-webkit-box;display:-ms-flexbox;display:flex}._3ocYJJXdgtwVydxjhLdwEm{width:24px}html[dir=ltr] ._3ocYJJXdgtwVydxjhLdwEm{left:10px}html[dir=rtl] ._3ocYJJXdgtwVydxjhLdwEm{right:10px}._1aMX_W4LfwQ1uTeRkbETcG{display:inline-block;height:32px;line-height:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;font-size:12px}html[dir] ._1aMX_W4LfwQ1uTeRkbETcG{text-align:center}html[dir=ltr] ._1aMX_W4LfwQ1uTeRkbETcG{right:8px}html[dir=rtl] ._1aMX_W4LfwQ1uTeRkbETcG{left:8px}._1aMX_W4LfwQ1uTeRkbETcG,._3ocYJJXdgtwVydxjhLdwEm,._2RFcp9Zl9UWOAAPCKGSCKd{position:absolute;top:50%}html[dir] ._1aMX_W4LfwQ1uTeRkbETcG,html[dir] ._3ocYJJXdgtwVydxjhLdwEm,html[dir] ._2RFcp9Zl9UWOAAPCKGSCKd{-webkit-transform:translateY(-50%);transform:translateY(-50%)}html[dir=ltr] .G28wWLVhUsHo2YnnrMEFD{padding-right:28px}html[dir=rtl] .G28wWLVhUsHo2YnnrMEFD{padding-left:28px}',""]),n.locals={menuItemContainer:"_1FXMYQgOMl3amdWxRszOtq",buttonStyles:"_2J6rsM7M0QVkdfFCwf00JE",text:"_3C9hg6ajHb65GB2Yn3bZfl",iconContainer:"_T68wDSYHk9rU_lDLi9YG",permissionIcon:"_3ocYJJXdgtwVydxjhLdwEm",chevronRight:"_1aMX_W4LfwQ1uTeRkbETcG",verticalCenter:"_2RFcp9Zl9UWOAAPCKGSCKd",paddingForChevron:"G28wWLVhUsHo2YnnrMEFD"}},7345:function(e){e.exports={a:"T1a"}},7346:function(e){e.exports={a:"R1a"}},7347:function(e){e.exports={b:"_1a",a:"$1a"}},7348:function(e){e.exports={b:"e2a",a:"f2a"}},7349:function(e,n,t){var r=t(7350),i=t(37);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},7350:function(e,n,t){(n=e.exports=t(36)(!1)).push([e.i,'._15uyY13ASl7ioBzQ_C4EWc{position:absolute;z-index:2;width:100%;height:calc(100% - 10px);opacity:.9;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;color:"[theme:themePrimary, default:#0078D4]";font-size:14px}html[dir] ._15uyY13ASl7ioBzQ_C4EWc{background-color:"[theme:white, default:#ffffff]"}._3d_DdC8WbZ8lVAv_uGMON8{color:#107c10}html[dir=ltr] ._3d_DdC8WbZ8lVAv_uGMON8{padding-right:4px}html[dir=rtl] ._3d_DdC8WbZ8lVAv_uGMON8{padding-left:4px}html[dir=ltr] ._2Atp1TsvFekBpdmnwjlUMU{padding-right:8px}html[dir=rtl] ._2Atp1TsvFekBpdmnwjlUMU{padding-left:8px}._3FqcARyIY48vWIbTdVE2SJ{opacity:0}html[dir] ._3FqcARyIY48vWIbTdVE2SJ{-webkit-transition:opacity 4s cubic-bezier(.95,.05,.5,.12);transition:opacity 4s cubic-bezier(.95,.05,.5,.12)}',""]),n.locals={overlay:"_15uyY13ASl7ioBzQ_C4EWc",check:"_3d_DdC8WbZ8lVAv_uGMON8",spinner:"_2Atp1TsvFekBpdmnwjlUMU",fadeOut:"_3FqcARyIY48vWIbTdVE2SJ"}},7351:function(e){e.exports={e:"U1a",a:"V1a",c:"W1a",f:"X1a",d:"Y1a",b:"Z1a"}},7352:function(e,n,t){var r=t(7353),i=t(37);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},7353:function(e,n,t){(n=e.exports=t(36)(!1)).push([e.i,'._1j7cMKJzK3hDG-6d1x8z6x{font-size:14px;color:"[theme:neutralSecondary, default:#666666]"}._1j7cMKJzK3hDG-6d1x8z6x.NCCd4mtRtnDhwXkQV3Z_P{color:#c50e2e}._1XTgRlvIFVAMWCwk3N1Mrd{font-size:12px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";cursor:pointer}html[dir] ._1XTgRlvIFVAMWCwk3N1Mrd{background:transparent}html[dir=ltr] ._1lAZM-j0_dTiprJU8qtsOC{padding-right:5px}html[dir=rtl] ._1lAZM-j0_dTiprJU8qtsOC{padding-left:5px}._2A5MU0_Ldq3YiUz9_7eSp0{position:relative;top:-1px}',""]),n.locals={sharingTipIcon:"_1j7cMKJzK3hDG-6d1x8z6x",error:"NCCd4mtRtnDhwXkQV3Z_P",actionButton:"_1XTgRlvIFVAMWCwk3N1Mrd",paddingRight:"_1lAZM-j0_dTiprJU8qtsOC",divider:"_2A5MU0_Ldq3YiUz9_7eSp0"}},7354:function(e,n,t){var r=t(7355),i=t(37);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},7355:function(e,n,t){(n=e.exports=t(36)(!1)).push([e.i,'._3Yr2UU45BKqj8cd21wO--0{color:#c50e2e}._3iLgzr8un7L5GebClucrpV{display:inline-block}._3BQT8e_ffVCDX0mocATk3h{opacity:.3}html[dir] ._1qJHlPfY83WgqLBJTIZPj{border-radius:2px}html[dir] ._1qJHlPfY83WgqLBJTIZPj:focus,html[dir] ._1qJHlPfY83WgqLBJTIZPj:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1Bl3Epd8DW0Ci3uZDqSnP5,._12rPxFFSJYfi0v4-eMstQ7,._2m59mwUb8f5uts16JkmmuW{color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._1Bl3Epd8DW0Ci3uZDqSnP5,html[dir] ._12rPxFFSJYfi0v4-eMstQ7,html[dir] ._2m59mwUb8f5uts16JkmmuW{border-width:1px;background-color:"[theme:themeLight, default:#C7E0F4]"!important;border-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._1Bl3Epd8DW0Ci3uZDqSnP5{border-style:dashed;background-color:"[theme:themeLighterAlt, default:#EFF6FC]"!important}html[dir] ._12rPxFFSJYfi0v4-eMstQ7{border-style:solid}._28V6s2qWpjnFBjP3O5_ZUO{font-size:14px;font-weight:400;position:relative;top:-1px;color:"[theme:themePrimary, default:#0078D4]";vertical-align:middle;text-decoration:underline;-webkit-text-decoration-color:"[theme:themeLighterAlt, default:#EFF6FC]";text-decoration-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir=ltr] ._28V6s2qWpjnFBjP3O5_ZUO{padding-right:4px;padding-left:3px}html[dir=rtl] ._28V6s2qWpjnFBjP3O5_ZUO{padding-left:4px;padding-right:3px}.qfTvShXNrHnAq_ovV3Leq{display:none}',""]),n.locals={linkWithSharingIssue:"_3Yr2UU45BKqj8cd21wO--0",link:"_3iLgzr8un7L5GebClucrpV",attachingAsACopy:"_3BQT8e_ffVCDX0mocATk3h",none:"_1qJHlPfY83WgqLBJTIZPj",edit:"_1Bl3Epd8DW0Ci3uZDqSnP5",selected:"_12rPxFFSJYfi0v4-eMstQ7",withBorder:"_2m59mwUb8f5uts16JkmmuW",editLinkIcon:"_28V6s2qWpjnFBjP3O5_ZUO",hidden:"qfTvShXNrHnAq_ovV3Leq"}},7356:function(e,n,t){var r=t(7357),i=t(37);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},7357:function(e,n,t){(n=e.exports=t(36)(!1)).push([e.i,".zlTOIqgXrUeoE4QgaYR88{vertical-align:middle;width:14px;height:14px;display:inline-block}",""]),n.locals={linkSpinner:"zlTOIqgXrUeoE4QgaYR88"}},927:function(e,n,t){"use strict";t.d(n,"a",function(){return u});var r=t(1373);t.d(n,"c",function(){return r.a});var i=t(2429);t.d(n,"d",function(){return i.a});var o=t(1086);t.d(n,"e",function(){return o.a}),t.d(n,"b",function(){return o.b});var a=t(3),c=new a.c(function(){return t.e(215).then(t.bind(null,3219))}),u=Object(a.d)(c,function(e){return e.CloudIconWithOverlay})}},0,[6,7,11,16,218,4,9,23,21,262,41,29,81,545,393,12,43,115,283,44,207,486,98,70,110,499,171,215,392]]);
//# sourceMappingURL=owa.AttachmentPreviewSxSInitialize.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxSInitialize.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();