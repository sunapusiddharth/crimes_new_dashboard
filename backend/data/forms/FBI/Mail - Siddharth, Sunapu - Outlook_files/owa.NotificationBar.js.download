self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.NotificationBar.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[322],{2107:function(t,e,a){"use strict";a.r(e);var i=a(1),o=a(7),n={notificationsMap:new o.ObservableMap,notificationStack:[],notificationBarViewState:{isHovered:!1,autoDismissTimerCompleted:!1,isFocused:!1}},r=Object(i.createStore)("NotificationBarStore",n)(),c=a(11),l=Object(i.mutatorAction)("removeNotification",function(t){var e=r.notificationStack.indexOf(t);if(e<0)return c.c.error("notification id cannot be found in removeNotification"),void r.notificationsMap.delete(t);r.notificationStack.splice(e,1),r.notificationsMap.delete(t)}),s={};function d(t){return s[t]}var u=Object(i.action)("notificationAutoDismissTimerCompleted"),f=Object(i.action)("notificationMouseEnter"),h=Object(i.action)("notificationMouseLeave",function(t){return{notificationId:t}}),m=Object(i.action)("resetNotificationViewState"),p=Object(i.action)("setNotificationIsHovered",function(t){return{isHovered:t}}),b=Object(i.action)("setFocusOnNotificationBar"),k=a(1015),x=1e3,v=null;function g(t){clearTimeout(v),function(t){delete s[t]}(t),l(t),m()}Object(i.orchestrator)(h,function(t){if(r.notificationBarViewState.autoDismissTimerCompleted){var e=d(t.notificationId);g(t.notificationId),e&&e(k.a.MouseLeaveAfterTimerCompleted)}p(!1)}),Object(i.mutator)(u,function(t){r.notificationBarViewState.autoDismissTimerCompleted=!0}),Object(i.mutator)(f,function(t){r.notificationBarViewState.isHovered=!0}),Object(i.mutator)(p,function(t){r.notificationBarViewState.isHovered=t.isHovered}),Object(i.mutator)(m,function(t){r.notificationBarViewState.isHovered=!1,r.notificationBarViewState.autoDismissTimerCompleted=!1,0===r.notificationStack.length&&(r.notificationBarViewState.isFocused=!1)}),Object(i.mutator)(b,function(t){r.notificationBarViewState.isFocused=!0});var B=a(0),y=Object(i.action)("CLEAR_NOTIFICATION_BAR",function(t){return{hostId:t}});Object(i.orchestrator)(y,function(t){var e,a;try{for(var i=B.__values(r.notificationStack),o=i.next();!o.done;o=i.next()){var n=o.value,c=r.notificationsMap.get(n);c.hostId===t.hostId&&c.allowClear&&g(n)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(e)throw e.error}}});var S=a(9324),w=a(4),T=a(2),C=a(95),A=a(6703),O={root:{backgroundColor:Object(C.g)().neutralSecondary,marginRight:"8px",borderStyle:"solid",borderWidth:"1px",borderColor:Object(C.g)().white},rootHovered:{backgroundColor:Object(C.g)().neutralPrimaryAlt},rootPressed:{backgroundColor:Object(C.g)().neutralDark},textContainer:{overflow:"hidden"},label:A.actionButtonText},E={root:{marginRight:"8px",color:Object(C.g)().white},rootHovered:{color:Object(C.g)().white,backgroundColor:"transparent"},rootPressed:{color:Object(C.g)().neutralDark,backgroundColor:"transparent"}},N=a(17),D=a(4209),I=a(2219),j=a(1189),_=a(1560),F=a(394),H=a(18),L=a(1640),V=a(211),M=a(6703),W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderSpinnerOrIcon=function(){if(e.props.notification.shouldShowSpinner)return T.createElement(L.a,{className:M.spinner,type:V.b.normal});if(e.props.notification.icon){var t={root:M.iconRoot};return T.createElement(F.a,{styles:t,iconName:e.props.notification.icon})}return T.createElement("div",{className:M.iconSpace})},e.onBeforeUnload=function(t){e.closeAndExecuteCallback(k.a.NotificationBarUnmounted)},e.onPrimaryButtonClick=function(t){e.closeAndExecuteCallback(k.a.PrimaryActionClicked)},e.onSecondaryButtonClick=function(t){e.closeAndExecuteCallback(k.a.SecondaryActionClicked)},e.onDismissClick=function(t){e.closeAndExecuteCallback(k.a.DismissClicked)},e.onMouseEnter=function(t){f()},e.onMouseLeave=function(t){h(e.props.notification.id)},e.setPrimaryButtonRef=function(t){e.focusButtonRef=t},e.setDismissButtonRef=function(t){e.props.notification.primaryActionText||(e.focusButtonRef=t)},e.onButtonFocused=function(){b()},e}return B.__extends(e,t),Object.defineProperty(e.prototype,"shouldFocus",{get:function(){return r.notificationBarViewState.isFocused&&null!==this.focusButtonRef},enumerable:!0,configurable:!0}),e.prototype.componentDidMount=function(){window.addEventListener("beforeunload",this.onBeforeUnload)},e.prototype.componentDidUpdate=function(){this.shouldFocus&&this.focusButtonRef.focus()},e.prototype.componentWillUnmount=function(){d(this.props.notification.id)&&this.closeAndExecuteCallback(k.a.NotificationBarUnmounted),window.removeEventListener("beforeunload",this.onBeforeUnload)},e.prototype.render=function(){var t=this.props,e=t.notification,a=B.__rest(t,["notification"]);return T.createElement(D.CSSTransition,B.__assign({},a,{timeout:167,classNames:{enter:N.AnimationClassNames.slideUpIn20,exit:N.AnimationClassNames.slideDownOut20}}),T.createElement("div",{className:M.positioningContainer},T.createElement("div",{className:M.notificationBarContainer,style:{minWidth:e.minWidth+"px",maxWidth:e.maxWidth+"px"},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},T.createElement("div",{className:M.leftItems},this.renderSpinnerOrIcon(),T.createElement("span",{className:M.contentText},e.contentText)),T.createElement("div",{className:M.rightItems},e.primaryActionText&&T.createElement(I.a,{componentRef:this.setPrimaryButtonRef,onClick:this.onPrimaryButtonClick,text:e.primaryActionText,title:e.primaryActionText,ariaLabel:e.primaryActionText,styles:O,onFocus:this.onButtonFocused}),e.primaryActionText&&e.secondaryActionText&&T.createElement(j.a,{onClick:this.onSecondaryButtonClick,text:e.secondaryActionText,title:e.secondaryActionText,ariaLabel:e.secondaryActionText,styles:O}),T.createElement(_.a,{componentRef:this.setDismissButtonRef,onClick:this.onDismissClick,styles:E,iconProps:{iconName:"Cancel"},onFocus:this.onButtonFocused})))))},e.prototype.closeAndExecuteCallback=function(t){var e=d(this.props.notification.id);g(this.props.notification.id),!r.notificationBarViewState.isFocused&&this.props.onNotificationBlur&&this.props.onNotificationBlur(),e&&e(t)},B.__decorate([o.computed],e.prototype,"shouldFocus",null),e=B.__decorate([H.observer],e)}(T.Component),R=a(125),P=a(6703),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B.__extends(e,t),e.prototype.render=function(){if(!this.props.hostId)return null;var t;if(r.notificationStack.length>0){var e=r.notificationStack[r.notificationStack.length-1],a=r.notificationsMap.get(e);if(this.props.hostId===a.hostId){t=a;var i=R.k?Object(w.a)(S.c):Object(w.a)(S.b);this.ariaNotifString=null!==t.primaryActionText?Object(w.b)(Object(w.a)(S.a),t.contentText,i,t.primaryActionText):t.contentText}}return T.createElement(T.Fragment,null,T.createElement(D.TransitionGroup,{className:P.notificationBarHostContainer},t&&T.createElement(W,{notification:Object(o.toJS)(t),key:t.id,onNotificationBlur:this.props.onNotificationBlur})),T.createElement("div",{className:"screenReaderOnly",role:"alert","aria-relevant":"additions",id:"notificationBarText"}))},e.prototype.componentDidUpdate=function(){r.notificationStack.length>0&&this.addAccessibilityNotifBarDiv()},e.prototype.addAccessibilityNotifBarDiv=function(){var t=document.getElementById("notificationBarText");t.firstChild&&t.removeChild(t.firstChild);var e=document.createElement("div");e.innerText=this.ariaNotifString,document.getElementById("notificationBarText").appendChild(e)},e=B.__decorate([H.observer],e)}(T.Component),X=Object(i.mutatorAction)("pushNotification",function(t,e){r.notificationsMap.has(t)?c.c.error("cannot add notification with the same id.  Please dismiss the notification before adding it again."):(r.notificationsMap.set(t,e),r.notificationStack.push(t))}),Q=a(8),U=a(5515),G=Object(Q.select)({store:function(){return r}})(function(t,e,a,i,o){var n=void 0===i?{}:i,l=n.icon,f=n.primaryActionText,h=n.secondaryActionText,m=n.minWidth,p=void 0===m?400:m,b=n.maxWidth,B=void 0===b?400:b,y=n.shouldShowSpinner,S=void 0!==y&&y,w=n.allowAutoDismiss,T=void 0===w||w,C=n.autoDismissInSeconds,A=void 0===C?7:C,O=n.allowClear,E=void 0!==O&&O,N=(n.isHovered,n.notificationCallback);if(a="function"==typeof a?a():a)if(!f&&!h||N){var D={id:t,contentText:a,hostId:e,icon:l,primaryActionText:f,secondaryActionText:h,minWidth:p,maxWidth:B,shouldShowSpinner:S,allowAutoDismiss:T,autoDismissInSeconds:A,allowClear:E};if(o.store.notificationStack.length>0){var I=o.store.notificationStack[o.store.notificationStack.length-1];o.store.notificationsMap.get(I).allowAutoDismiss&&g(I)}!function(t,e){if(void 0!==s[t])throw new Error("Cannot over write an existing notification callback.");s[t]=e}(t,N),X(t,D),T&&!Object(U.a)(2)&&function(t,e){v=setTimeout(function(){if(u(),!r.notificationBarViewState.isHovered&&!r.notificationBarViewState.isFocused){var e=d(t);g(t),e&&e(k.a.AutoDismissed)}},e*x)}(t,A)}else c.c.error("notification callback must be defined with a primary or secondary action");else c.c.error("contentText is required to show the notification")});a.d(e,"NotificationBarHost",function(){return q}),a.d(e,"showNotification",function(){return G}),a.d(e,"dismissNotification",function(){return g}),a.d(e,"clearNotificationBar",function(){return y})},5515:function(t,e,a){"use strict";a.d(e,"a",function(){return o});var i=a(9);function o(t){return!!(t&Object(i.a)().ViewStateConfiguration.AccessibilityBitFlags)}},6703:function(t,e,a){var i=a(9325),o=a(37);"string"==typeof i&&(i=[[t.i,i]]);for(var n=0;n<i.length;n++)o.loadStyles(i[n][1],!1);i.locals&&(t.exports=i.locals)},9324:function(t){t.exports={c:"vca",b:"wca",a:"xca"}},9325:function(t,e,a){(e=t.exports=a(36)(!1)).push([t.i,'._3xqEuTlsJbTQdiBbqhDlEy{pointer-events:none;position:absolute;bottom:0;z-index:4}html[dir] ._3xqEuTlsJbTQdiBbqhDlEy{background-color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._3xqEuTlsJbTQdiBbqhDlEy,html[dir=rtl] ._3xqEuTlsJbTQdiBbqhDlEy{left:0;right:0}._394rO9_XIBrDE0VaIH3AWj{width:100%;position:absolute;bottom:0;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}._24raGxVN-NYNI6ltdpiov2,._394rO9_XIBrDE0VaIH3AWj{display:-webkit-box;display:-ms-flexbox;display:flex}._24raGxVN-NYNI6ltdpiov2{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:48px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;pointer-events:auto}html[dir] ._24raGxVN-NYNI6ltdpiov2{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white);-webkit-box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";background-color:"[theme:neutralSecondary, default:#666666]";border-radius:4px 4px 0 0}html[dir=ltr] .HFhW96xMp5v9DXf1mD-gE{margin-left:24px;margin-right:14px}html[dir=rtl] .HFhW96xMp5v9DXf1mD-gE{margin-right:24px;margin-left:14px}._2gL8VTsxpsj9xOhfHX0ARq{color:"[theme:white, default:#ffffff]";font-size:15px}html[dir=ltr] ._2gL8VTsxpsj9xOhfHX0ARq{margin-left:24px;margin-right:16px}html[dir=rtl] ._2gL8VTsxpsj9xOhfHX0ARq{margin-right:24px;margin-left:16px}html[dir=ltr] ._21g8jkqFMZX18DGFuOEVYw{margin-left:48px}html[dir=rtl] ._21g8jkqFMZX18DGFuOEVYw{margin-right:48px}._1HFU5ZOFiIWaCX1sxSRyO1{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}html[dir=ltr] ._1HFU5ZOFiIWaCX1sxSRyO1{margin-right:8px}html[dir=rtl] ._1HFU5ZOFiIWaCX1sxSRyO1{margin-left:8px}._3Zb1dKENKlm20nLBci9L3G{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;max-width:66%}.e8QWIPW0726cSzB7kykNB{font-size:14px;font-weight:400}.chQAugHvoCEfpy0BOor02,.e8QWIPW0726cSzB7kykNB{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"[theme:white, default:#ffffff]"}.chQAugHvoCEfpy0BOor02{height:32px;line-height:32px}',""]),e.locals={notificationBarHostContainer:"_3xqEuTlsJbTQdiBbqhDlEy",positioningContainer:"_394rO9_XIBrDE0VaIH3AWj",notificationBarContainer:"_24raGxVN-NYNI6ltdpiov2",spinner:"HFhW96xMp5v9DXf1mD-gE",iconRoot:"_2gL8VTsxpsj9xOhfHX0ARq",iconSpace:"_21g8jkqFMZX18DGFuOEVYw",leftItems:"_1HFU5ZOFiIWaCX1sxSRyO1",rightItems:"_3Zb1dKENKlm20nLBci9L3G",contentText:"e8QWIPW0726cSzB7kykNB",actionButtonText:"chQAugHvoCEfpy0BOor02"}}}]);
//# sourceMappingURL=owa.NotificationBar.js.map
self.scriptsLoaded['owa.NotificationBar.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.NotificationBar.js'] = (new Date()).getTime();