self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.InlineTranslation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[273],{12680:function(t){t.exports={h:"rGb",i:"sGb",g:"tGb",f:"uGb",e:"vGb",d:"wGb",c:"xGb",a:"yGb",b:"zGb"}},12681:function(t,n,a){var e=a(12682),r=a(37);"string"==typeof e&&(e=[[t.i,e]]);for(var o=0;o<e.length;o++)r.loadStyles(e[o][1],!1);e.locals&&(t.exports=e.locals)},12682:function(t,n,a){(n=t.exports=a(36)(!1)).push([t.i,"html[dir] ._1eN94FfatbCko5uUefAU47{padding-top:10px}html[dir=ltr] ._1eN94FfatbCko5uUefAU47{margin-left:52px}html[dir=rtl] ._1eN94FfatbCko5uUefAU47{margin-right:52px}",""]),n.locals={translationFeedback:"_1eN94FfatbCko5uUefAU47"}},1286:function(t,n,a){"use strict";a.d(n,"a",function(){return o}),a.d(n,"b",function(){return i}),a.d(n,"c",function(){return s});var e=a(3),r=new e.c(function(){return Promise.all([a.e(1),a.e(3),a.e(5),a.e(75),a.e(214)]).then(a.bind(null,2276))}),o=Object(e.d)(r,function(t){return t.FeedbackForm}),i=Object(e.d)(r,function(t){return t.FeedbackRibbon}),s=Object(e.d)(r,function(t){return t.NewConsumerRecruitmentForm})},13290:function(t,n,a){"use strict";a.r(n);var e=a(0);var r=a(7804),o=a(5),i=a(4762),s=a(4085),l=a(11),u=40,c="Language",d="Locale",T="BestGuessLanguage";function f(t){return e.__awaiter(this,void 0,void 0,function(){var n,a,f,g,b;return e.__generator(this,function(e){switch(e.label){case 0:n=null,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,i.c.import()];case 2:return[4,e.sent()(t.ItemId.Id,r.c)];case 3:return n=e.sent(),[3,5];case 4:return e.sent(),l.c.info("getLocalePropertyForItem: Unable to get item property from GetItemManager."),[3,5];case 5:if(n)if(a=Object(s.b)(n,null,r.a)){if(f=JSON.parse(a.Value)[0],g=f[c])return b="",!function(t){return t.Preview.length<u}(t)?b=g.hasOwnProperty(T)?g[T]:g[d]:Object(o.e)("tra-EnableShortMessage")&&g.hasOwnProperty(T)&&(b=g[T]),[2,b||""]}else l.c.info("getDetectedLanguageForEmailProperty: No language property found for item.");return[2,""]}})})}var g={name:"InlineTranslationMessageTranslated",cosmosOnlyData:function(t,n){return t}},b={name:"InlineTranslationMessageUntranslated",cosmosOnlyData:function(t){return t}},m={name:"InlineTranslationStoreData",cosmosOnlyData:function(t,n){return t}},D={name:"InlineTranslationStoreStatus",cosmosOnlyData:function(t,n){return t}},h={name:"InlineTranslationLoadDataAndStatus",cosmosOnlyData:function(t){return t.ItemId.Id}},p=a(15),w=a(25),v=a(7805),O=Object(w.b)("storeTranslationData",h)(function(t){return e.__awaiter(this,void 0,void 0,function(){var n,a,r,o;return e.__generator(this,function(e){switch(e.label){case 0:n=null,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,i.c.import()];case 2:return[4,e.sent()(t.ItemId.Id,v.d)];case 3:return n=e.sent(),[3,5];case 4:return a=e.sent(),Object(p.q)().endWithError("ServerError",new Error(a.responseMessage)),[3,5];case 5:return n?(r=Object(s.b)(n,null,v.a),o=Object(s.b)(n,null,v.b),[2,[r?r.Value:null,o?o.Value:null]]):[2,[null,null]]}})})}),j=a(8488),I=a(8486),y=a(4988),x=a(223),S=a.n(x),C=a(1433),L=a.n(C),F=a(1838),_=a.n(F),E=a(236),P=a.n(E),M=a(2452),N=a.n(M);function k(t,n,a){var e=S()({PropertyName:n,DistinguishedPropertySetId:"Common",PropertyType:"String"}),r=L()({ExtendedFieldURI:e,Value:a}),o=Object(y.a)(r),i=_()({Updates:[o],ItemId:P()({Id:t})});return N()({ItemChanges:[i],ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}var U=a(2449),G=a.n(U),R=a(29),H=a(27),q=Object(w.b)("storeTranslationData",m)(function(t,n){return e.__awaiter(this,void 0,void 0,function(){var a,r;return e.__generator(this,function(e){return a=k(t,"TranslationData",JSON.stringify(n)),r=Object(p.q)(),[2,G()({Header:Object(H.getJsonRequestHeader)(),Body:a}).then(function(t){var n=Object(R.g)(t.Body.ResponseMessages.Items[0]);return n||r.endWithError("ServerError"),n}).catch(function(t){return r.endWithError("ServerError"),!1})]})})}),A=Object(w.b)("storeTranslationData",D)(function(t,n){return e.__awaiter(this,void 0,void 0,function(){var a,r;return e.__generator(this,function(e){return a=k(t,"TranslationStatus",""+n),r=Object(p.q)(),[2,G()({Header:Object(H.getJsonRequestHeader)(),Body:a}).then(function(t){var n=Object(R.g)(t.Body.ResponseMessages.Items[0]);return n||r.endWithError("ServerError"),n}).catch(function(t){return r.endWithError("ServerError"),!1})]})})}),B=a(86),W=a(5175),J=a(2442),V=Object(w.b)("translateItem",g)(function(t,n,a){return void 0===a&&(a=!1),e.__awaiter(this,void 0,void 0,function(){var r,i,s,l,u,c,d,T,f,g,b,m,D,h,w,v,O,j,y;return e.__generator(this,function(e){switch(e.label){case 0:if(r=7e3,i=Object(p.q)(),s=R.H.items.get(t),l=Object(B.a)(),u=!1,c=R.H.conversations.get(s.ConversationId.Id),s.TranslationData.isTranslating=!0,s.TranslationData.translationFailed=!1,d=!1,T=!1,f=!1,g=[],n&&null==c.subjectTranslationData.translationText&&(g.push(n),d=!0),(null==s.TranslationData.translationText&&s.TranslationData.isTranslatable&&!Object(I.a)(s.TranslationData.itemOgmaLocale)||a)&&(g.push(s.UniqueBody.Value),T=!0),Object(o.e)("rp-inlineTranslationForwardContent")&&(b=function(t){var n=t.ConversationId.Id,a=R.H.conversations.get(n);if(a&&a.conversationNodeIds){var e=t,r=R.H.conversationNodes.get(e.InternetMessageId);if(r&&r.quotedTextList)return r.quotedTextList}return}(s))&&(null===s.TranslationData.forwardContentTranslationText&&s.TranslationData.isForwardContentTranslatable&&!Object(I.a)(s.TranslationData.forwardContentLocale)||a)&&(b.forEach(function(t){g.push(t)}),f=!0),!(d||T||f))return[3,6];m=void 0,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,W.k.import()];case 2:return[4,e.sent()(g,l)];case 3:return m=e.sent(),u=!0,[3,5];case 4:return D=e.sent(),function(t,n,a,e){if(t.TranslationData.isTranslating=!1,t.TranslationData.translationFailed=!0,a){var r=new Error("[InlineTranslation] TranslateText failed. Error:"+n+" | cid:"+e);a.endWithError("ServerError",r)}}(s,D,i,l),[2];case 5:s.TranslationData.shouldGetFeedback=!0,d&&(h=m.shift(),c.subjectTranslationData.translationText=h),T&&(w=m.shift(),s.TranslationData.translationText=w),f&&(s.TranslationData.forwardContentTranslationText=m),e.label=6;case 6:return s.TranslationData.isTranslating=!1,v=!1,null===s.TranslationData.translationText&&null===s.TranslationData.forwardContentTranslationText||null===c.subjectTranslationData.translationText&&n||(!Object(o.e)("tra-cacheTranslation")||s.TranslationData.isShowingTranslation||s.TranslationData.isShowingForwardContentTranslation||(v=!0),null!==s.TranslationData.translationText&&(s.TranslationData.isShowingTranslation=!0),null!==s.TranslationData.forwardContentTranslationText&&(s.TranslationData.isShowingForwardContentTranslation=!0),null!==n&&(c.subjectTranslationData.isShowingTranslation=!0),(s.TranslationData.manuallyTranslated||a&&!function(t){return t.TranslationData.isTranslatable&&!Object(I.a)(t.TranslationData.itemOgmaLocale)||t.TranslationData.isForwardContentTranslatable&&!Object(I.a)(t.TranslationData.forwardContentLocale)}(s))&&(i&&i.addCustomData({manual:!0}),s.TranslationData.manuallyTranslated=!0)),Object(o.e)("rp-inlineTranslation-floodgateSurvey")&&setTimeout(function(){J.a.import().then(function(t){t("TranslationCompleted")})},r),Object(o.e)("tra-cacheTranslation")&&u?[4,W.h.import()]:[3,9];case 7:return O=e.sent(),j=O(),y={language:j,subject:c.subjectTranslationData.translationText,body:s.TranslationData.translationText,forward:s.TranslationData.forwardContentTranslationText,dateTime:Date.now()},[4,q(s.ItemId.Id,y)];case 8:e.sent(),e.label=9;case 9:return v?[4,A(s.ItemId.Id,!0)]:[3,11];case 10:e.sent(),e.label=11;case 11:return[2]}})})});var $=a(8),z=Object($.action)("setItemLocale")(function(t,n){return e.__awaiter(this,void 0,void 0,function(){var a,r,i,s,l,u,c,d,T,g,b,m,D,h,p,w,v,I,y,x,S,C,L,F,_,E;return e.__generator(this,function(e){switch(e.label){case 0:return[4,W.j.import()];case 1:return a=e.sent(),[4,W.d.import()];case 2:return r=e.sent(),[4,W.e.import()];case 3:return i=e.sent(),[4,W.f.import()];case 4:return s=e.sent(),[4,W.g.import()];case 5:return l=e.sent(),[4,W.h.import()];case 6:return u=e.sent(),[4,W.c.import()];case 7:return c=e.sent(),[4,W.a.import()];case 8:return d=e.sent(),T=!t.TranslationData.userLanguage,null!=(g=t.TranslationData.itemLocale)?[3,10]:[4,f(t)];case 9:g=e.sent(),e.label=10;case 10:return b=i(g),[4,a()];case 11:return m=e.sent(),D=!T&&(m||l()!=t.TranslationData.userLanguage),T||D?(h=R.H.conversations.get(t.ConversationId.Id),c()?(t.TranslationData.userLanguage=l(),t.TranslationData.itemOgmaLocale=b,t.TranslationData.itemLocaleName=s(b),Object(o.e)("rp-inlineTranslationForwardContent")?(p=function(t){var n=t.ConversationId.Id,a=R.H.conversations.get(n);if(a&&a.conversationNodeIds){var e=t,r=R.H.conversationNodes.get(e.InternetMessageId);if(r&&r.hasQuotedText&&r.quotedTextList){var o=[];return r.quotedTextList.forEach(function(t){o.push(function(t){try{var n=(new DOMParser).parseFromString(t,"text/html");n.querySelector('[id$="divRplyFwdMsg"]').remove();var a=n.querySelectorAll("style");if(a&&a.length>0)for(var e=0;e<a.length;e++)a[e]&&(a[e].innerHTML="");return n.body.textContent||""}catch(t){return""}}(t))}),o}}return}(t),w=null,p?[4,W.b.import()]:[3,17]):[3,18]):(t.TranslationData.isTranslatable=!1,t.TranslationData.isShowingTranslation=!1,t.TranslationData.translationText=null,t.TranslationData.isForwardContentTranslatable=!1,t.TranslationData.isShowingForwardContentTranslation=!1,t.TranslationData.forwardContentTranslationText=null,h.subjectTranslationData.isShowingTranslation=!1,h.subjectTranslationData.translationText=null,[2])):[3,24];case 12:return v=e.sent(),0===t.Preview.length?[3,14]:[4,v(p)];case 13:return(w=e.sent())?(t.TranslationData.forwardContentLocale=w,t.TranslationData.forwardContentLocaleName=s(w),t.TranslationData.isForwardContentTranslatable=d(r(),w)):(t.TranslationData.isForwardContentTranslatable=!1,t.TranslationData.forwardContentTranslationText=null),[3,17];case 14:return b?[3,16]:[4,v(p)];case 15:w=e.sent(),t.TranslationData.itemOgmaLocale=w,t.TranslationData.itemLocaleName=s(w),e.label=16;case 16:t.TranslationData.forwardContentLocale=t.TranslationData.itemOgmaLocale,t.TranslationData.forwardContentLocaleName=t.TranslationData.itemLocaleName,t.TranslationData.isForwardContentTranslatable=d(r(),t.TranslationData.forwardContentLocale),e.label=17;case 17:return[3,19];case 18:t.TranslationData.isForwardContentTranslatable=!1,e.label=19;case 19:return null==t.TranslationData.itemLocale&&(t.TranslationData.itemLocale=g),I=d(r(),g),y=!0,T?Object(o.e)("tra-cacheTranslation")?[4,O(t)]:[3,21]:[3,23];case 20:return S=e.sent(),[3,22];case 21:S=[null,null],e.label=22;case 22:C="true"===(x=S)[1],null!==x[1]&&(y=!1),L=JSON.parse(x[0]),F=u(),L&&L.language==F?(h.subjectTranslationData.translationText||(h.subjectTranslationData.translationText=L.subject),t.TranslationData.translationText=L.body,L.forward&&L.forward.length>0?t.TranslationData.forwardContentTranslationText=L.forward:t.TranslationData.forwardContentTranslationText=null):(C&&(y=!0,C=!1),t.TranslationData.translationText=null,t.TranslationData.forwardContentTranslationText=null),C&&(t.TranslationData.translationText&&(t.TranslationData.isShowingTranslation=!0),h.subjectTranslationData.translationText&&(h.subjectTranslationData.isShowingTranslation=!0),Object(o.e)("rp-inlineTranslationForwardContent")&&t.TranslationData.forwardContentTranslationText&&(t.TranslationData.isShowingForwardContentTranslation=!0),I||t.TranslationData.isForwardContentTranslatable||(t.TranslationData.manuallyTranslated=!0)),e.label=23;case 23:t.TranslationData.isTranslatable=I,D&&(t.TranslationData.isShowingTranslation=!1,t.TranslationData.translationText=null,t.TranslationData.isShowingForwardContentTranslation=!1,t.TranslationData.forwardContentTranslationText=null,h.subjectTranslationData.isShowingTranslation=!1,h.subjectTranslationData.translationText=null),Object(o.e)("rp-inlineTranslationAutomatic")&&y&&(_=t.TranslationData.isTranslatable&&Object(j.a)(t.TranslationData.itemOgmaLocale),E=!1,Object(o.e)("rp-inlineTranslationForwardContent")&&(E=t.TranslationData.isForwardContentTranslatable&&Object(j.a)(t.TranslationData.forwardContentLocale)),(_||E)&&V(t.ItemId.Id,n)),e.label=24;case 24:return[2]}})})});var Q=Object(w.b)("untranslateItem",b)(function(t){return e.__awaiter(this,void 0,void 0,function(){var n,a;return e.__generator(this,function(e){switch(e.label){case 0:return n=R.H.items.get(t),a=n.ConversationId.Id,R.H.conversations.get(a).subjectTranslationData.isShowingTranslation=!1,n.TranslationData.isShowingTranslation=!1,n.TranslationData.isShowingForwardContentTranslation=!1,Object(o.e)("tra-cacheTranslation")?[4,A(n.ItemId.Id,!1)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}),Y=a(5008),K=a(1),X=Object(K.mutatorAction)("addExcludedLanguage",function(t){var n=Object(Y.a)(),a={feature:n.feature,translationMode:n.translationMode,excludedLanguages:e.__spread(n.excludedLanguages)};n.excludedLanguages.push(t),W.l.import().then(function(t){t(a,n)})}),Z=Object(K.mutatorAction)("setTranslationMode",function(t){var n=Object(Y.a)(),a={feature:n.feature,translationMode:n.translationMode,excludedLanguages:e.__spread(n.excludedLanguages)};n.translationMode=t,W.l.import().then(function(t){t(a,n)})}),tt=a(2),nt=a(1286),at=a(12680),et=a(4),rt=a(12681);function ot(){}function it(){}function st(t){var n=[{logString:"Readability",uiString:Object(et.a)(at.c)},{logString:"Formatting",uiString:Object(et.a)(at.a)},{logString:"Other",uiString:Object(et.a)(at.b)}],a={title:Object(et.a)(at.f),subTitle:Object(et.a)(at.e),ghostText:Object(et.a)(at.d),categories:n};return tt.createElement("div",{className:rt.translationFeedback},tt.createElement(nt.b,{ribbonMessage:Object(et.a)(at.h),feature:"inlineTranslation",thankYouMessage:Object(et.a)(at.i),moreFeedbackRibbonMessage:Object(et.a)(at.g),noFeedbackDialogParams:a,yesCallBack:ot,noCallBack:it}))}a.d(n,"setItemLocale",function(){return z}),a.d(n,"translateItem",function(){return V}),a.d(n,"untranslateItem",function(){return Q}),a.d(n,"addExcludedLanguage",function(){return X}),a.d(n,"setTranslationMode",function(){return Z}),a.d(n,"TranslationFeedbackRibbon",function(){return st})},1433:function(t,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=a(0);n.default=function(t){return e.__assign({__type:"ExtendedPropertyType:#Exchange"},t)}},2442:function(t,n,a){"use strict";a.d(n,"a",function(){return o});var e=a(3),r=(a(44),new e.c(function(){return a.e(225).then(a.bind(null,3223))})),o=new e.b(r,function(t){return t.logFloodgateActivity})},4988:function(t,n,a){"use strict";a.d(n,"a",function(){return d});var e=a(1433),r=a.n(e),o=a(223),i=a.n(o),s=a(2436),l=a.n(s),u=a(1845),c=a.n(u);function d(t){return c()({Path:i()(t.ExtendedFieldURI),Item:l()({ExtendedProperty:[r()(t)]})})}},5175:function(t,n,a){"use strict";a.d(n,"a",function(){return o}),a.d(n,"j",function(){return i}),a.d(n,"i",function(){return s}),a.d(n,"d",function(){return l}),a.d(n,"e",function(){return u}),a.d(n,"b",function(){return c}),a.d(n,"f",function(){return d}),a.d(n,"g",function(){return T}),a.d(n,"h",function(){return f}),a.d(n,"c",function(){return g}),a.d(n,"k",function(){return b}),a.d(n,"l",function(){return m});var e=a(3),r=new e.c(function(){return a.e(419).then(a.bind(null,9082))}),o=new e.b(r,function(t){return t.checkCanTranslate}),i=new e.b(r,function(t){return t.initSupportedLanguages}),s=new e.b(r,function(t){return t.initAndGetSupportedLanguageMap}),l=new e.b(r,function(t){return t.getLocaleOfSupportedLanguageMap}),u=new e.b(r,function(t){return t.getOgmaSupportedLanguageTag}),c=new e.b(r,function(t){return t.getDetectedLanguage}),d=new e.b(r,function(t){return t.getSupportedLanguageMap}),T=new e.b(r,function(t){return t.getUserLanguageName}),f=new e.b(r,function(t){return t.getUserLanguageTag}),g=new e.b(r,function(t){return t.getIsUserLocaleSupported}),b=new e.b(r,function(t){return t.translateText}),m=new e.b(r,function(t){return t.updateTranslationOptions})},7804:function(t,n,a){"use strict";a.d(n,"a",function(){return i}),a.d(n,"c",function(){return s});var e=a(5),r=a(142),o=a(223),i="EntityExtraction/ExtractLanguage1.0",s="InlineTranslationLocale",l=a.n(o)()({PropertyName:i,DistinguishedPropertySetId:"Common",PropertyType:"String"}),u={featureId:s,propertyPaths:[l],isPropertyExistedOnItem:function(t){var n=r.a.items.get(t);return n&&n.TranslationData&&null!=n.TranslationData.itemLocale},shouldGetItemPropertiesFromServer:function(t,n){return!(!Object(e.e)("rp-inlineTranslation")||0!=n||r.a.items.get(t).RightsManagementLicenseData)}};n.b=u},7805:function(t,n,a){"use strict";a.d(n,"a",function(){return s}),a.d(n,"b",function(){return l}),a.d(n,"d",function(){return u});var e=a(5),r=a(142),o=a(223),i=a.n(o),s="TranslationData",l="TranslationStatus",u="InlineTranslationDataAndStatus",c=[i()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),i()({PropertyName:l,DistinguishedPropertySetId:"Common",PropertyType:"String"})],d={featureId:u,propertyPaths:c,isPropertyExistedOnItem:function(t){var n=r.a.items.get(t);return n&&n.TranslationData&&null!=n.TranslationData.userLanguage},shouldGetItemPropertiesFromServer:function(t,n){return!(!Object(e.e)("rp-inlineTranslation")||!Object(e.e)("tra-cacheTranslation")||0!=n||r.a.items.get(t).RightsManagementLicenseData)}};n.c=d}},0,[1,3,5,75,214,4,8,9,542,378,486,98,70,110,499,171,225,231,419]]);
//# sourceMappingURL=owa.InlineTranslation.js.map
self.scriptsLoaded['owa.InlineTranslation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.InlineTranslation.js'] = (new Date()).getTime();