/*! Version: 1.0.0; Third Party Notices: https://lpcres.delve.office.com/lpc/versionless/tpn-0f9b4258b013de50755b14b166a0f165ae3efa86d6af835bdf9902e118bad796ed37868b399b5e259ced5c1690ac785b20617fba8c92ad87f1c8fb0bb16bcb59.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[16],{1101:function(e,t,n){"use strict";var r=n(4),o=n(186),a=n(34),i=n(88),s=n(152),c=n(451),l=n(452),d=n(72),u=n(555),p=n(837);var m=/(.*?)<<<(.*?)>>>/g,h=function(e,t){if(void 0===t)return e;try{return Object(u.getPluralizedString)(e,t)}catch(t){return e}},f=Object(d.memoizeFunction)(function(e,t){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];var d=c.a.apply(void 0,[function(e){return"<<<".concat(e,">>>")}].concat(a)),u=h(e(d),t),f=Object(l.a)(u,m);if(!f.length)return function(){return[u].filter(Boolean)};var g=f[f.length-1],b=u.substr(g.index+g[0].length),y=Object(p.a)(f.map(function(e,t){var n=Object(o.a)(e,3),a=(n[0],n[1]),i=n[2];return[function(){return a||null},function(e){var n=e[i];return n?"string"==typeof n?n:r.cloneElement(n,{key:t}):null}]})).concat(function(){return b||null});return function(e){return Object(i.filterOutNull)(y.map(function(t){return t(e)}))}});function g(e){var t,n,o,i=(t=e.text,n=e.placeholders,o=e.count,f.apply(void 0,[t,o].concat(Object(a.a)(Object(s.keys)(n).sort())))(n));return r.createElement(r.Fragment,null,i)}n.d(t,"a",function(){return g})},1533:function(e,t,n){"use strict";n.r(t);n(569),n(1229),n(1230),n(1231);var r=n(302),o=n(6),a=n(72),i=n(395),s=n(284),c=n(440),l=n(364),d=n(1087),u=n(1207),p=n(917),m=n(1138),h=n(1204),f=n(1199),g=n(780),b=n(1104),y=n(4),P=n(229),S=n(1),x="ContactEditor";function v(e,t,n){return Object(S.a)(x+"."+e,{featureName:x,getLogProperties:function(){return t?{}:null},exportOptions:n})}var E=v("StartEditingContact",!0),A=v("StartCreateContact",!0),C=v("LoadCompleted",!0),N=v("LoadFailed",!0),O=v("AddedChangeSetFromPersona",!0),w=v("NameAdded",!0),k=v("NameUpdated",!1),V=v("PhoneAdded",!0),j=v("PhoneUpdated",!0),D=v("AddressEditStarted",!0),L=v("AddressAdded",!0),T=v("AddressUpdated",!0),U=v("OtherContactPropAdded",!0),B=v("OtherContactPropUpdated",!0),W=v("OtherContactDatePropRemoved",!0),M=v("ImAdded",!0),R=v("ImUpdated",!0),F=v("EmailAdded",!0),I=v("EmailBlurred",!0),H=v("EmailUpdated",!0),Y=v("PersonalNotesAdded",!0),G=v("PersonalNotesUpdated",!0),_=v("WorkDetailAdded",!0),z=v("WorkDetailUpdated",!0),K=v("SaveButtonClicked",!0,{exportType:"UserInteraction",exportName:"EditedContact"}),X=v("SaveButtonClickedWithErrors",!0),J=v("CancelButtonClicked",!0),Z=v("NotSaveButtonInDialogClicked",!0),$=v("RetryButtonInDialogClicked",!0),q=v("CancelButtonInDialogClicked",!0),Q=(v("ScrolledToTop",!0),v("SaveConfirmationTriggered",!0)),ee=v("ExternalCancelTriggered",!0),te=v("SaveCompleted",!0),ne=v("CancelCompleted",!0),re=v("SaveFailed",!0),oe=v("FavoriteStarClicked",!0),ae=v("ProfilePhotoUpdated",!0),ie=v("ResetErrorState",!0),se=n(88),ce=n(152),le=n(1253),de=n(374),ue=n(435),pe=n(172),me=n(1530),he=n(208),fe=n(343),ge=["DisplayNamePrefix","GivenName","MiddleName","Surname","Generation","Nickname","YomiFirstName","YomiLastName"],be=["GivenName","Surname","Nickname","MiddleName","DisplayNamePrefix","Generation","YomiFirstName","YomiLastName"],ye=["PersonaPersonalHomePages","PersonaSpouseNames","PersonaManagers","PersonaAssistantNames","PersonaBusinessHomePages","PersonaBirthdays","PersonaWeddingAnniversaries"],Pe=["PersonaPersonalHomePages","PersonaSpouseNames","PersonaManagers","PersonaAssistantNames","PersonaBusinessHomePages","PersonaSchools","PersonaLocations","PersonaHobbies","PersonaBirthdays","PersonaWeddingAnniversaries"],Se=Object(fe.stringLiteralArray)("PersonaDisplayNamePrefixes","PersonaGivenNames","PersonaMiddleNames","PersonaSurnames","PersonaGenerations","PersonaNicknames","PersonaYomiFirstNames","PersonaYomiLastNames"),xe=Object(fe.stringLiteralArray)("PersonaHomePhones","PersonaHomePhones2","PersonaMobilePhones","PersonaCarPhones","PersonaBusinessPhoneNumbers","PersonaBusinessPhoneNumbers2"),ve=Object(fe.stringLiteralArray)("PersonaOrganizationMainPhones","PersonaPagers","PersonaOtherTelephones","PersonaOtherPhones2","PersonaHomeFaxes","PersonaWorkFaxes","PersonaOtherFaxes","PersonaAssistantPhoneNumbers","PersonaCallbackPhones","PersonaRadioPhones","PersonaTelexNumbers","PersonaTTYTDDPhoneNumbers"),Ee=xe.concat(ve),Ae=Object(fe.stringLiteralArray)("PersonaEmails1","PersonaEmails2","PersonaEmails3"),Ce=Object(fe.stringLiteralArray)("PersonaImAddresses"),Ne=Object(fe.stringLiteralArray)("PersonaCompanyNames","PersonaTitles"),Oe=Object(fe.stringLiteralArray)("PersonaDepartments","PersonaOfficeLocations"),we=Object(fe.stringLiteralArray)("PersonaYomiCompanyNames"),ke=Ne.concat(Oe,we),Ve=Object(fe.stringLiteralArray)("PersonaHomeAddresses","PersonaBusinessAddresses","PersonaOtherAddresses"),je=(Object(fe.stringLiteralArray)("PersonaPersonalHomePages","PersonaSpouseNames"),Object(fe.stringLiteralArray)("PersonaManagers","PersonaAssistantNames","PersonaBusinessHomePages","PersonaSchools","PersonaLocations","PersonaHobbies"),Object(fe.stringLiteralArray)("PersonaBirthdays","PersonaWeddingAnniversaries"),Object(fe.stringLiteralArray)("PersonaBirthdaysLocal","PersonaWeddingAnniversariesLocal"),Object(fe.stringLiteralArray)("PersonaBodies"));function De(e){return Fe(e.propertyUri)}var Le=Se.concat(Ae,Ce,Ee,ke,Ve,Pe,je);function Te(e){return-1!==Se.indexOf(e)}function Ue(e){return-1!==Ae.indexOf(e)}function Be(e){return-1!==Ce.indexOf(e)}function We(e){return-1!==xe.indexOf(e)}function Me(e){return-1!==ve.indexOf(e)}function Re(e){return-1!==ke.indexOf(e)}function Fe(e){return-1!==Ve.indexOf(e)}function Ie(e){return-1!==Pe.indexOf(e)}function He(e){return-1!==je.indexOf(e)}function Ye(e){return-1!==Le.indexOf(e)}function Ge(e){switch(e){case"PersonaWeddingAnniversariesLocal":case"PersonaBirthdaysLocal":case"PersonaWeddingAnniversaries":case"PersonaBirthdays":return!0;default:return!1}}var _e=n(0),ze=((_e.declareString)("contactEditorStrings.attributionForGAL")),Ke=((_e.declareStringWithPlaceholders)("contactEditorStrings.attributionForContactFolder"));function Xe(e,t){return e&&t?Object(de.a)(Object(se.filterOutNull)(e.map(function(e){var n=Object(pe.default)(t,function(t){return t.Id===e});return!n||n.IsHidden?null:"GAL"===n.DisplayName?ze():"Outlook"===n.DisplayName&&n.FolderName?Ke({folder:n.FolderName}):n.FolderName?n.DisplayName+" - "+n.FolderName:n.DisplayName}))):[]}var Je=function(){return(Je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ze={AddNameSubmenu:((_e.declareString)("contactEditorStrings.labelAddNameSubmenu")),AddPhoneSubmenu:((_e.declareString)("contactEditorStrings.labelAddPhoneSubmenu")),AddPhoneOtherSubmenu:((_e.declareString)("contactEditorStrings.labelAddPhoneOtherSubmenu")),AddAddressSubmenu:((_e.declareString)("contactEditorStrings.labelAddAddressSubmenu")),AddWorkSubmenu:((_e.declareString)("contactEditorStrings.labelAddWorkSubmenu")),AddOtherSubmenu:((_e.declareString)("contactEditorStrings.labelAddOtherSubmenu")),GivenName:((_e.declareString)("contactEditorStrings.labelGivenName")),MiddleName:((_e.declareString)("contactEditorStrings.labelMiddleName")),Surname:((_e.declareString)("contactEditorStrings.labelSurname")),DisplayNamePrefix:((_e.declareString)("contactEditorStrings.labelDisplayNamePrefix")),Generation:((_e.declareString)("contactEditorStrings.labelGeneration")),Nickname:((_e.declareString)("contactEditorStrings.labelNickname")),YomiName:((_e.declareString)("contactEditorStrings.labelYomiName")),YomiFirstName:((_e.declareString)("contactEditorStrings.labelYomiFirstName")),YomiLastName:((_e.declareString)("contactEditorStrings.labelYomiLastName")),PersonaBodies:((_e.declareString)("contactEditorStrings.labelPersonaBodies")),PersonaCompanyNames:((_e.declareString)("contactEditorStrings.labelCompanyName")),PersonaDepartments:((_e.declareString)("contactEditorStrings.labelDepartment")),PersonaOfficeLocations:((_e.declareString)("contactEditorStrings.labelLocation")),PersonaTitles:((_e.declareString)("contactEditorStrings.labelTitle")),PersonaYomiCompanyNames:((_e.declareString)("contactEditorStrings.labelYomiCompanyName")),Email:((_e.declareString)("contactEditorStrings.labelEmail")),PersonaAssistantPhoneNumbers:((_e.declareString)("contactEditorStrings.labelAssistant")),BusinessPhone:((_e.declareString)("contactEditorStrings.labelBusiness")),AddBusiness:((_e.declareString)("contactEditorStrings.labelAddBusiness")),PersonaWorkFaxes:((_e.declareString)("contactEditorStrings.labelBusinessFax")),PersonaCallbackPhones:((_e.declareString)("contactEditorStrings.labelCallback")),HomePhone:((_e.declareString)("contactEditorStrings.labelHome")),AddHome:((_e.declareString)("contactEditorStrings.labelAddHome")),PersonaHomeFaxes:((_e.declareString)("contactEditorStrings.labelHomeFax")),Mobile:((_e.declareString)("contactEditorStrings.labelMobile")),AddMobile:((_e.declareString)("contactEditorStrings.labelAddMobile")),PersonaOrganizationMainPhones:((_e.declareString)("contactEditorStrings.labelOrganizationMain")),Other:((_e.declareString)("contactEditorStrings.labelOther")),IM:((_e.declareString)("contactEditorStrings.labelIM")),PersonaOtherFaxes:((_e.declareString)("contactEditorStrings.labelOtherFax")),PersonaPagers:((_e.declareString)("contactEditorStrings.labelPager")),PersonaPhoneNumber:((_e.declareString)("contactEditorStrings.labelPrimary")),PersonaRadioPhones:((_e.declareString)("contactEditorStrings.labelRadio")),PersonaTelexNumbers:((_e.declareString)("contactEditorStrings.labelTelex")),PersonaTTYTDDPhoneNumbers:((_e.declareString)("contactEditorStrings.labelTTYTDD")),PersonaManagers:((_e.declareString)("contactEditorStrings.labelPersonaManagers")),PersonaBusinessHomePages:((_e.declareString)("contactEditorStrings.labelPersonaBusinessHomePages")),PersonaAssistantNames:((_e.declareString)("contactEditorStrings.labelPersonaAssistantNames")),PersonaLocations:((_e.declareString)("contactEditorStrings.labelPersonaLocations")),PersonaHobbies:((_e.declareString)("contactEditorStrings.labelPersonaHobbies")),PersonaSchools:((_e.declareString)("contactEditorStrings.labelPersonaSchools")),PersonaHomeAddresses:((_e.declareString)("contactEditorStrings.labelPersonaHomeAddresses")),AddPersonaHomeAddresses:((_e.declareString)("contactEditorStrings.labelAddPersonaHomeAddresses")),PersonaBusinessAddresses:((_e.declareString)("contactEditorStrings.labelPersonaBusinessAddresses")),AddPersonaBusinessAddresses:((_e.declareString)("contactEditorStrings.labelAddPersonaBusinessAddresses")),PersonaOtherAddresses:((_e.declareString)("contactEditorStrings.labelPersonaOtherAddresses")),AddPersonaOtherAddresses:((_e.declareString)("contactEditorStrings.labelAddPersonaOtherAddresses")),Street:((_e.declareString)("contactEditorStrings.labelStreet")),City:((_e.declareString)("contactEditorStrings.labelCity")),State:((_e.declareString)("contactEditorStrings.labelStateProvince")),PostalCode:((_e.declareString)("contactEditorStrings.labelZipPostalCode")),Country:((_e.declareString)("contactEditorStrings.labelCountryRegion")),PersonaPersonalHomePages:((_e.declareString)("contactEditorStrings.labelPersonaPersonalHomePages")),PersonaSpouseNames:((_e.declareString)("contactEditorStrings.labelPersonaSpouseNames")),PersonaWeddingAnniversaries:((_e.declareString)("contactEditorStrings.labelPersonaWeddingAnniversaries")),PersonaBirthdays:((_e.declareString)("contactEditorStrings.labelPersonaBirthdays")),GoToToday:((_e.declareString)("contactEditorStrings.labelGoToToday")),GoToPreviousMonth:((_e.declareString)("contactEditorStrings.labelGoToPreviousMonth")),GoToNextMonth:((_e.declareString)("contactEditorStrings.labelGoToNextMonth")),GoToPrevYear:((_e.declareString)("contactEditorStrings.labelGoToPrevYear")),GoToNextYear:((_e.declareString)("contactEditorStrings.labelGoToNextYear")),SelectDay:((_e.declareString)("contactEditorStrings.labelSelectDay")),Day:((_e.declareString)("contactEditorStrings.labelDay")),Month:((_e.declareString)("contactEditorStrings.labelMonth")),Year:((_e.declareString)("contactEditorStrings.labelYear"))},$e=Je({},Ze,{PersonaWeddingAnniversariesLocal:Ze.PersonaWeddingAnniversaries,PersonaBirthdaysLocal:Ze.PersonaBirthdays});function qe(e){return $e[e]()}function Qe(e){switch(e){case"PersonaHomePhones":case"PersonaHomePhones2":return qe("HomePhone");case"PersonaBusinessPhoneNumbers":case"PersonaBusinessPhoneNumbers2":return qe("BusinessPhone");case"PersonaMobilePhones":case"PersonaCarPhones":return qe("Mobile");case"PersonaOtherTelephones":case"PersonaOtherPhones2":return qe("Other");default:return qe(e)}}function et(e){switch(e){case"PersonaHomePhones":case"PersonaHomePhones2":return qe("AddHome");case"PersonaBusinessPhoneNumbers":case"PersonaBusinessPhoneNumbers2":return qe("AddBusiness");case"PersonaMobilePhones":case"PersonaCarPhones":return qe("AddMobile");case"PersonaOtherTelephones":case"PersonaOtherPhones2":return qe("Other");default:return qe(e)}}function tt(e){switch(e){case"PersonaHomeAddresses":return qe("AddPersonaHomeAddresses");case"PersonaBusinessAddresses":return qe("AddPersonaBusinessAddresses");case"PersonaOtherAddresses":return qe("AddPersonaOtherAddresses");default:return Object(o.g)(e)}}var nt=function(){return(nt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},rt=255,ot={updatedNames:{},updatedPhones:[],updatedWorkDetails:[],updatedIms:[],updatedPostalAddresses:[],updatedEmails:[],updatedOtherContactProps:[],updatedPersonalNotes:[],updatedProfilePhoto:null,validationErrors:!1},at={index:0,oldValue:null,newValue:"",attributions:[],isWritable:!0},it=nt({},at,{propertyUri:"PersonaCompanyNames"}),st={updatedNames:{PersonaGivenNames:{oldValue:null,newValue:""},PersonaSurnames:{oldValue:null,newValue:""}},updatedPhones:[nt({},at,{propertyUri:"PersonaMobilePhones"})],updatedWorkDetails:[it],updatedIms:[],updatedPostalAddresses:[],updatedEmails:[nt({},at,{propertyUri:"PersonaEmails1",oldDisplayNameValue:null,oldOriginalDisplayNameValue:null})],updatedOtherContactProps:[],updatedPersonalNotes:[],updatedProfilePhoto:null,validationErrors:!1};function ct(e,t,n){return 0===$t(e,t).length&&(null===e.updatedProfilePhoto||"NewContact"===n)}function lt(e){switch(e){case"DisplayNamePrefix":return"PersonaDisplayNamePrefixes";case"Generation":return"PersonaGenerations";case"GivenName":return"PersonaGivenNames";case"MiddleName":return"PersonaMiddleNames";case"Nickname":return"PersonaNicknames";case"Surname":return"PersonaSurnames";case"YomiFirstName":return"PersonaYomiFirstNames";case"YomiLastName":return"PersonaYomiLastNames";case"YomiName":return"PersonaYomiFirstNames";default:return Object(o.g)(e)}}function dt(e,t,n){var r=Object(l.a)(e,function(e){return n(e,t)});if(-1===r)return e.concat(t);var o=e.slice();return o.splice(r,1,t),o}function ut(e,t){return e.propertyUri===t.propertyUri&&e.index===t.index}function pt(e,t){return e.propertyUri===t.propertyUri&&(e.index===t.index||""===e.newValue)}function mt(e,t){return nt({},at,{propertyUri:e,newValue:t,index:-1})}function ht(e,t){for(var n=e,r=0,o=t;r<o.length;r++){n=dt(n,o[r],ut)}return n}function ft(e){switch(e){case"YomiFirstName":case"YomiLastName":return"YomiName";default:return e}}function gt(e,t,n,r){var a,i=lt(t);return i?Object(o.k)(e,{updatedNames:Object(o.k)(e.updatedNames,(a={},a[i]={oldValue:n,newValue:r},a))}):e}var bt=function(e){return function(t,n){return Ut((t||[]).map(function(t,r){if(t.Value&&t.Value.Type){var a=fn(e,t.Attributions);return{propertyUri:n,index:r,oldValue:Object(o.j)(t.Value&&t.Value.Number),newValue:t.Value&&t.Value.Number||"",isWritable:a,attributions:Xe(t.Attributions,e)}}return console.error("Got phone entry without type ("+n+")"),null}))}};function yt(e){var t=bt(e.AttributionsArray);return t(e.AssistantPhoneNumbersArray,"PersonaAssistantPhoneNumbers").concat(t(e.BusinessPhoneNumbersArray,"PersonaBusinessPhoneNumbers")).concat(t(e.BusinessPhoneNumbers2Array,"PersonaBusinessPhoneNumbers2")).concat(t(e.CallbackPhonesArray,"PersonaCallbackPhones")).concat(t(e.CarPhonesArray,"PersonaCarPhones")).concat(t(e.HomeFaxesArray,"PersonaHomeFaxes")).concat(t(e.HomePhonesArray,"PersonaHomePhones")).concat(t(e.HomePhones2Array,"PersonaHomePhones2")).concat(t(e.MobilePhonesArray,"PersonaMobilePhones")).concat(t(e.OrganizationMainPhonesArray,"PersonaOrganizationMainPhones")).concat(t(e.OtherFaxesArray,"PersonaOtherFaxes")).concat(t(e.OtherTelephonesArray,"PersonaOtherTelephones")).concat(t(e.OtherPhones2Array,"PersonaOtherPhones2")).concat(t(e.PagersArray,"PersonaPagers")).concat(t(e.RadioPhonesArray,"PersonaRadioPhones")).concat(t(e.TelexNumbersArray,"PersonaTelexNumbers")).concat(t(e.TTYTDDPhoneNumbersArray,"PersonaTTYTDDPhoneNumbers")).concat(t(e.WorkFaxesArray,"PersonaWorkFaxes"))}function Pt(e,t){return ht(yt(e),t.updatedPhones)}function St(e,t,n,r,o){var a=n(e,t).filter(function(e){return!0===e.isWritable}),i=r.filter(function(e){return!a.some(function(t){return t.propertyUri===e})});return o?i:i.filter(function(e){return!function(e){switch(e){case"PersonaOfficeLocations":case"PersonaDepartments":case"PersonaManagers":case"PersonaAssistantNames":case"PersonaBusinessHomePages":case"PersonaSchools":case"PersonaLocations":case"PersonaHobbies":return!0;default:return!1}}(e)})}function xt(e,t,n){var r=mt(t,n||""),a=dt(e.updatedPhones,r,pt);return Object(o.k)(e,{updatedPhones:a})}function vt(e,t){var n=dt(e.updatedPhones,t,ut);return Object(o.k)(e,{updatedPhones:n})}function Et(e,t){return ht(wt(e),t.updatedIms)}function At(e,t){var n=mt("PersonaImAddresses",t||""),r=dt(e.updatedIms,n,pt);return Object(o.k)(e,{updatedIms:r})}function Ct(e,t){var n=dt(e.updatedIms,t,ut);return Object(o.k)(e,{updatedIms:n})}function Nt(e,t,n){var r=dt(e.updatedPostalAddresses,mt(t,n||{Street:"",City:"",Country:"",PostalCode:"",State:""}),pt);return Object(o.k)(e,{updatedPostalAddresses:r})}function Ot(e,t){var n=dt(e.updatedPostalAddresses,t,ut);return Object(o.k)(e,{updatedPostalAddresses:n})}function wt(e){return function(e,t){var n=e.AttributionsArray;return Ut((e.ImAddressesArray||[]).map(function(e,r){var a=fn(n,e.Attributions),i=e.Value?e.Value.replace(/^sip:/,""):e.Value;return{propertyUri:t,attributions:Xe(e.Attributions,n),index:r,oldValue:Object(o.j)(i),newValue:i||"",isWritable:a}}))}(e,"PersonaImAddresses")}function kt(e){return Bt(e.Emails1Array,e.AttributionsArray,"PersonaEmails1").concat(Bt(e.Emails2Array,e.AttributionsArray,"PersonaEmails2")).concat(Bt(e.Emails3Array,e.AttributionsArray,"PersonaEmails3"))}function Vt(e){var t,n=kt(e);return t=n,Object(he.a)(t,function(e,t){var n;return e.newValue===t.newValue&&e.isWritable===t.isWritable&&!!(n=t.attributions).push.apply(n,Object(me.a)(e.attributions,t.attributions))})}function jt(e,t){return ht(kt(e),t.updatedEmails)}function Dt(e,t,n){var r=nt({},mt(t,n||""),{oldDisplayNameValue:null,oldOriginalDisplayNameValue:null}),a=dt(e.updatedEmails,r,pt);return Object(o.k)(e,{updatedEmails:a})}function Lt(e,t){var n=t;t.newValue&&le.validate(t.newValue.trim())&&(n=nt({},t,{showErrorMessage:!1}));var r=dt(e.updatedEmails,n,ut);return Object(o.k)(e,{updatedEmails:r})}function Tt(e){return"RecipientCache"!==e}function Ut(e){return Object(se.filterOutNull)(e).reduce(function(e,t){var n=t&&t.attributions.filter(Tt);return(t&&!t.attributions.length||n&&n.length>0)&&e.push(Object(o.k)(t,{attributions:n})),e},[])}function Bt(e,t,n){return Ut((e||[]).map(function(e,r){if(!e.Value)return null;var a="EX"!==e.Value.RoutingType&&e.Value.EmailAddress?e.Value.EmailAddress:e.Value.OriginalDisplayName;if(!a)return null;var i=fn(t||[],e.Attributions);return{propertyUri:n,index:r,oldValue:Object(o.j)(e.Value.EmailAddress),newValue:a,oldDisplayNameValue:Object(o.j)(e.Value.Name),oldOriginalDisplayNameValue:Object(o.j)(e.Value.OriginalDisplayName),attributions:Xe(e.Attributions,t),isWritable:i}}))}function Wt(e,t){return ht(Zt(e),t.updatedPostalAddresses)}function Mt(e,t,n){return Ut((e||[]).map(function(e,r){if(e.Value&&e.Value.Type){var o=fn(t||[],e.Attributions);return{propertyUri:n,index:r,oldValue:e.Value,newValue:e.Value,editing:!1,attributions:Xe(e.Attributions,t),isWritable:o}}return null}))}function Rt(e,t,n){return Ut((e||[]).map(function(e,r){if(e.Value){var o="string"==typeof e.Value?new Date(e.Value):e.Value,a=fn(t||[],e.Attributions);return{propertyUri:n,index:r,oldValue:o,newValue:o,attributions:Xe(e.Attributions,t),isWritable:a,isRemoved:!1}}return null}))}function Ft(e,t,n){return Ut((e||[]).map(function(e,r){return e.Value&&"string"==typeof e.Value?{propertyUri:n,index:r,oldValue:e.Value,newValue:e.Value,attributions:Xe(e.Attributions,t),isWritable:fn(t||[],e.Attributions)}:null}))}function It(e,t,n,r){var o=Rt(t,n,r).concat(Rt(e,n,r)).pop();return o?[o]:[]}function Ht(e){return It(e.WeddingAnniversariesLocalArray,e.WeddingAnniversariesArray,e.AttributionsArray,"PersonaWeddingAnniversaries").concat(It(e.BirthdaysLocalArray,e.BirthdaysArray,e.AttributionsArray,"PersonaBirthdays")).concat(Ft(e.PersonalHomePagesArray,e.AttributionsArray,"PersonaPersonalHomePages")).concat(Ft(e.SpouseNamesArray,e.AttributionsArray,"PersonaSpouseNames")).concat(Ft(e.ManagersArray,e.AttributionsArray,"PersonaManagers")).concat(Ft(e.AssistantNamesArray,e.AttributionsArray,"PersonaAssistantNames")).concat(Ft(e.BusinessHomePagesArray,e.AttributionsArray,"PersonaBusinessHomePages")).concat(Ft(e.SchoolsArray,e.AttributionsArray,"PersonaSchools")).concat(Ft(e.LocationsArray,e.AttributionsArray,"PersonaLocations")).concat(Ft(e.HobbiesArray,e.AttributionsArray,"PersonaHobbies"))}function Yt(e,t){return ht(Ht(e),t.updatedOtherContactProps).filter(function(e){return xn(e)&&!e.isRemoved||!xn(e)})}function Gt(e,t,n){var r=e.updatedOtherContactProps,a=e.updatedOtherContactProps.filter(xn),i=Object(pe.default)(a,function(e){return!!e.isRemoved&&e.propertyUri===t});i&&-1!==i.index?r=e.updatedOtherContactProps.filter(function(e){return e!==i}):r=function(e,t,n){var r=Object(l.a)(e,function(e){return n(e,t)});if(-1===r)return e.concat(t);var o=e.slice();return o.splice(r,1),o.concat(t)}(r,Ge(t)?nt({},mt(t,n?new Date(n):null),{isRemoved:!1}):mt(t,n||""),pt);return Object(o.k)(e,{updatedOtherContactProps:r})}function _t(e,t){var n=dt(e.updatedOtherContactProps,t,ut);return Object(o.k)(e,{updatedOtherContactProps:n})}function zt(e,t){var n=mt("PersonaBodies",t||""),r=dt(e.updatedPersonalNotes,n,pt);return Object(o.k)(e,{updatedPersonalNotes:r})}function Kt(e,t){var n=dt(e.updatedPersonalNotes,t,ut);return Object(o.k)(e,{updatedPersonalNotes:n})}function Xt(e){return e.BodiesArray?Object(se.filterOutNull)(e.BodiesArray).map(function(t,n){return{propertyUri:"PersonaBodies",index:n,oldValue:Object(o.j)(t.Value&&t.Value.Value),newValue:t.Value&&t.Value.Value||"",attributions:Xe(t.Attributions,e.AttributionsArray),isWritable:fn(e.AttributionsArray,t.Attributions)}}):[{propertyUri:"PersonaBodies",index:0,oldValue:"",newValue:"",attributions:[],isWritable:!0}]}function Jt(e,t){return ht(Xt(e),t.updatedPersonalNotes)}function Zt(e){return Mt(e.BusinessAddressesArray,e.AttributionsArray,"PersonaBusinessAddresses").concat(Mt(e.HomeAddressesArray,e.AttributionsArray,"PersonaHomeAddresses")).concat(Mt(e.OtherAddressesArray,e.AttributionsArray,"PersonaOtherAddresses"))}function $t(e,t){var n=t?nt({},e,{updatedEmails:Sn(e.updatedEmails,t)}):e,r=function(e,t){if(!t)return Object(ce.keys)(e.updatedNames).map(function(t){var n=e.updatedNames[t];return{propertyUri:t,oldValue:"",newValue:n&&n.newValue||""}});if(0===Object(ce.keys)(e.updatedNames).length)return[];for(var n=(t.AttributionsArray||[]).filter(function(e){return e.IsWritable}).map(function(e){return e.Id}),r=[],o=0,a=ge;o<a.length;o++){for(var i=a[o],s=lt(i),c=bn(t,s),l=c.filter(function(e){return!e.Attributions||e.Attributions.some(function(e){return!!e&&n.indexOf(e)>=0})}),d=e.updatedNames[s],u=d?d.newValue||"":t[i]||"",p=[],m=0,h=l;m<h.length;m++){var f=h[m];r.push({propertyUri:s,oldValue:f.Value||"",newValue:u}),p.push.apply(p,f.Attributions||[])}for(var g=Object(me.a)(n,p).length,b=0;b<g;b++)r.push({propertyUri:s,oldValue:"",newValue:u})}return r.filter(function(e){return e.newValue!==e.oldValue})}(n,t),o=function(e){return e.updatedPostalAddresses.map(function(e){var t=[e.oldValue&&e.oldValue.Street||"",e.oldValue&&e.oldValue.City||"",e.oldValue&&e.oldValue.State||"",e.oldValue&&e.oldValue.PostalCode||"",e.oldValue&&e.oldValue.Country||""].join(qt),n=[e&&e.newValue&&e.newValue.Street||"",e&&e.newValue&&e.newValue.City||"",e&&e.newValue&&e.newValue.State||"",e&&e.newValue&&e.newValue.PostalCode||"",e&&e.newValue&&e.newValue.Country||""].join(qt);return{propertyUri:e.propertyUri,oldValue:t,newValue:n}}).filter(function(e){return e.oldValue!==e.newValue})}(n),a=function(e,t){return en(e,t&&t.BirthdaysArray||[],"PersonaBirthdays",t&&t.BirthdaysLocalArray||[],"PersonaBirthdaysLocal").concat(en(e,t&&t.WeddingAnniversariesArray||[],"PersonaWeddingAnniversaries",t&&t.WeddingAnniversariesLocalArray||[],"PersonaWeddingAnniversariesLocal")).concat(e.updatedOtherContactProps.filter(function(e){return!xn(e)}).map(function(e){var t="string"==typeof e.oldValue?e.oldValue:"",n="string"==typeof e.newValue?e.newValue:"";return{propertyUri:e.propertyUri,oldValue:t,newValue:n}}))}(n,t),i=function(e){return e.updatedPersonalNotes.map(function(e){return{propertyUri:e.propertyUri,oldValue:e.oldValue?e.oldValue:"",newValue:e.newValue||""}})}(n),s=function(e,t){return tn(e,t||null,nn,on,sn)}(n,t),c=function(e,t){return tn(e,t||null,rn,an,cn)}(n,t);return r.concat(n.updatedEmails,s,c,n.updatedIms,n.updatedPhones,n.updatedWorkDetails,o,a,i).map(function(e){return{propertyUri:e.propertyUri,oldValue:e.oldValue||"",newValue:e.newValue&&e.newValue.trim()||""}}).filter(function(e){return""!==e.oldValue||""!==e.newValue}).filter(function(e){return e.oldValue!==e.newValue})}var qt="$#$";function Qt(e,t,n){return 0===e.length?[{propertyUri:t,oldValue:"",newValue:n}]:e.map(function(e){return{propertyUri:t,oldValue:e.Value||"",newValue:n}})}function en(e,t,n,r,o){var a=e.updatedOtherContactProps.filter(function(e){return e.propertyUri===n||e.propertyUri===o})[0];if(!a)return[];var i=a.newValue?"string"==typeof a.newValue?a.newValue:a.newValue.toISOString():"";return Qt(t,n,i).concat(Qt(r,o,i))}function tn(e,t,n,r,a){return e.updatedEmails.map(function(e){var i=e.newValue||"",s=n(e);if(-1===e.index&&t)switch(e.propertyUri){case"PersonaEmails1":s=r(t.Emails1Array||[]);break;case"PersonaEmails2":s=r(t.Emails2Array||[]);break;case"PersonaEmails3":s=r(t.Emails3Array||[]);break;default:return Object(o.g)(e.propertyUri)}return{propertyUri:a(e.propertyUri),oldValue:s,newValue:i}})}function nn(e){return e.oldDisplayNameValue||""}function rn(e){return e.oldOriginalDisplayNameValue||""}function on(e){var t=Object(pe.default)(e,function(e){return!!e.Value&&!!e.Value.Name});return t&&t.Value&&t.Value.Name?t.Value.Name:""}function an(e){var t=Object(pe.default)(e,function(e){return!!e.Value&&!!e.Value.OriginalDisplayName});return t&&t.Value&&t.Value.OriginalDisplayName?t.Value.OriginalDisplayName:""}function sn(e){switch(e){case"PersonaEmails1":return"PersonaEmails1DisplayNames";case"PersonaEmails2":return"PersonaEmails2DisplayNames";case"PersonaEmails3":return"PersonaEmails3DisplayNames";default:return Object(o.g)(e)}}function cn(e){switch(e){case"PersonaEmails1":return"PersonaEmails1OriginalDisplayNames";case"PersonaEmails2":return"PersonaEmails2OriginalDisplayNames";case"PersonaEmails3":return"PersonaEmails3OriginalDisplayNames";default:return Object(o.g)(e)}}function ln(e,t,n){var r=mt(t,n||""),a=dt(e.updatedWorkDetails,r,pt);return Object(o.k)(e,{updatedWorkDetails:a})}function dn(e,t){var n=dt(e.updatedWorkDetails,t,ut);return Object(o.k)(e,{updatedWorkDetails:n})}function un(e,t){return ht(pn(e),t.updatedWorkDetails)}function pn(e){return mn(e.CompanyNamesArray,e.AttributionsArray,"PersonaCompanyNames").concat(mn(e.TitlesArray,e.AttributionsArray,"PersonaTitles")).concat(mn(e.DepartmentsArray,e.AttributionsArray,"PersonaDepartments")).concat(mn(e.OfficeLocationsArray,e.AttributionsArray,"PersonaOfficeLocations")).concat(mn(e.YomiCompanyNamesArray,e.AttributionsArray,"PersonaYomiCompanyNames"))}function mn(e,t,n){return Ut((e||[]).map(function(e,r){return{propertyUri:n,index:r,oldValue:Object(o.j)(e.Value),newValue:e.Value||"",attributions:Xe(e.Attributions,t),isWritable:fn(t||[],e.Attributions)}}))}function hn(e,t){var n={},r=["GivenName","Surname"];return(e.YomiFirstName||e.YomiLastName)&&r.push("YomiFirstName","YomiLastName"),ge.forEach(function(o){var a,i,s,c=lt(o),l=e[o],d=t.updatedNames[c],u=d&&d.newValue,p=Xe(function(e,t){return e.filter(function(e){return e.Value===t}).reduce(function(e,t){return e.concat(t.Attributions||[])},[])}(bn(e,o),l),e.AttributionsArray).filter(Tt);void 0!==u?n=nt({},n,((a={})[o]={propertyUri:c,oldValue:l,newValue:u,attributions:p,isWritable:!0},a)):l?n=nt({},n,((i={})[o]={propertyUri:c,oldValue:l,newValue:l,attributions:p,isWritable:!0},i)):-1!==r.indexOf(o)&&(n=nt({},n,((s={})[o]={propertyUri:c,oldValue:null,newValue:"",isWritable:!0,attributions:p},s)))}),n}function fn(e,t){return!(!e||!t)&&t.some(function(t){return e.some(function(e){return e.Id===t&&!0===e.IsWritable})})}function gn(e){return e?[{Value:e,Attributions:null}]:[]}function bn(e,t){switch(t){case"DisplayNamePrefix":case"PersonaDisplayNamePrefixes":return e.DisplayNamePrefixesArray||gn(e.DisplayNamePrefix);case"GivenName":case"PersonaGivenNames":return e.GivenNamesArray||gn(e.GivenName);case"MiddleName":case"PersonaMiddleNames":return e.MiddleNamesArray||gn(e.MiddleName);case"Surname":case"PersonaSurnames":return e.SurnamesArray||gn(e.Surname);case"Generation":case"PersonaGenerations":return e.GenerationsArray||gn(e.Generation);case"Nickname":case"PersonaNicknames":return e.NicknamesArray||gn(e.Nickname);case"YomiFirstName":case"PersonaYomiFirstNames":return e.YomiFirstNamesArray||gn(e.YomiFirstName);case"YomiLastName":case"PersonaYomiLastNames":return e.YomiLastNamesArray||gn(e.YomiLastName);default:return Object(o.g)(t)}}function yn(e){for(var t=0,n=ge;t<n.length;t++){var r=n[t],o=e.updatedNames[lt(r)];if(o&&o.newValue.length>rt)return lt(r)}var a=function(e){return e.newValue.length>rt},i=Object(pe.default)(e.updatedEmails,function(e){return a(e)||!!e.showErrorMessage})||Object(pe.default)(e.updatedIms,a)||Object(pe.default)(e.updatedPhones,a)||Object(pe.default)(e.updatedWorkDetails,a)||Object(pe.default)(e.updatedPostalAddresses,function(e){return e.newValue.Street&&e.newValue.Street.length>rt||e.newValue.City&&e.newValue.City.length>rt||e.newValue.Country&&e.newValue.Country.length>rt||e.newValue.PostalCode&&e.newValue.PostalCode.length>rt||e.newValue.State&&e.newValue.State.length>rt||!1})||Object(pe.default)(e.updatedOtherContactProps,function(e){return!xn(e)&&a(e)});return i?i.propertyUri:""}function Pn(e){return e.some(function(e){return!e.isWritable})}function Sn(e,t){var n=kt(t),r=[];return n.map(function(t){return n.map(function(n){t!==n&&t.newValue===n.newValue&&t.isWritable===n.isWritable&&e.map(function(e){return e.propertyUri===n.propertyUri&&e.index===n.index&&r.push(nt({},t,{newValue:e.newValue}))})})}),r.push.apply(r,e),r}function xn(e){return Ge(e.propertyUri)}var vn=n(42),En=n(550),An=n(39),Cn=n(115),Nn=n(48),On=function(){return(On=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},wn={editorState:"idle",originalContact:null,changeSet:ot,mostRecentPropertyUri:"",errorState:null},kn={idle:[{action:E,nextState:"loading"},{action:A,nextState:"editing"}],loading:[{action:C,nextState:"editing"},{action:N,nextState:"loadErrorDialogOpen"}],editing:[{action:K,nextState:"saving"},{action:X,nextState:"editing"},{action:Q,nextState:"discardDialogOpen"},{action:ne,nextState:"idle"}],saving:[{action:te,nextState:"idle"},{action:re,nextState:"failed"}],discardDialogOpen:[{action:Z,nextState:"idle"},{action:q,nextState:"editing"},{action:ne,nextState:"idle"}],loadErrorDialogOpen:[{action:$,nextState:"loading"},{action:q,nextState:"idle"}],failed:[{action:K,nextState:"idle"},{action:ne,nextState:"idle"}]},Vn=Object(vn.a)().handleAction(A,function(e,t){var n=t.payload.initialValues.slice(),r=t.payload.focusPropertyUri;r&&Ye(r)&&-1===t.payload.initialValues.map(function(e){return e.propertyUri}).indexOf(r)&&(n=Fe(r)?n.concat([{propertyUri:r,value:{Street:"",City:"",Country:"",PostalCode:"",State:""}}]):n.concat([{propertyUri:r,value:""}]));return t.payload.initialValues.reduce(Bn,st)}).handleAction(O,function(e,t){var n=wn.changeSet,r=t.payload.originalContact,o=hn(r,n),a=!1;Object(ce.keys)(o).forEach(function(e){var t=o&&o[e],r=t&&t.newValue||"";Object(Cn.e)(r)||(a=!0),n=gt(n,e,"",r)}),!1===a&&(n=gt(n,"GivenName","",r.DisplayName||""));0===(n=Mn(Vt,Lt,r,n)).updatedEmails.length&&r.EmailAddress&&r.EmailAddress.EmailAddress&&(n=Mn(Wn,Lt,r,n));return n=Mn(yt,vt,r,n),n=Mn(pn,dn,r,n),n=Mn(Zt,Ot,r,n),n=Mn(Ht,_t,r,n),n=Mn(Xt,Kt,r,n),n=Mn(wt,Ct,r,n)}).handleAction(C,function(e,t){var n=t.payload,r=n.focusPropertyUri,o=n.originalContact;if(!r||!Ye(r)||!o)return e;if(Te(r)||(Ue(r)?kt(o).some(function(e){return e.isWritable}):Be(r)?wt(o).some(function(e){return e.isWritable}):We(r)||Me(r)?yt(o).some(function(e){return e.isWritable&&e.propertyUri===r}):Ie(r)?Ht(o).some(function(e){return e.isWritable&&e.propertyUri===r}):He(r)?Xt(o).some(function(e){return e.isWritable}):Re(r)?pn(o).some(function(e){return e.isWritable&&e.propertyUri===r}):Fe(r)?Zt(o).some(function(e){return e.isWritable&&e.propertyUri===r}):void 0))return e;var a=Fe(r)?{propertyUri:r,value:{Street:"",City:"",Country:"",PostalCode:"",State:""}}:{propertyUri:r,value:""};return Bn(e,a)}).handleAction(w,function(e,t){return function(e,t){for(var n,r=0,a="YomiName"===t?["YomiFirstName","YomiLastName"]:[t];r<a.length;r++){var i=lt(a[r]),s=e.updatedNames[i];if(s&&(s.oldValue||s.newValue));else{var c=Object(o.k)(e.updatedNames,((n={})[i]={oldValue:null,newValue:""},n));e=Object(o.k)(e,{updatedNames:c})}}return e}(e,t.payload.availableName)}).handleAction(k,function(e,t){var n=t.payload;return gt(e,n.fieldType,n.oldValue,n.newValue)}).handleAction(V,function(e,t){return xt(e,t.payload.availablePhone)}).handleAction(j,function(e,t){return vt(e,t.payload.phone)}).handleAction(L,function(e,t){return Nt(e,t.payload.availablePostalAddress)}).handleAction(T,function(e,t){return Ot(e,t.payload.postalAddress)}).handleAction(U,function(e,t){return Gt(e,t.payload.availableOtherContactProp)}).handleAction(B,function(e,t){return _t(e,t.payload.otherContactProp)}).handleAction(W,function(e,t){return function(e,t){var n=nt({},t,{isRemoved:!0,newValue:null}),r=dt(e.updatedOtherContactProps,n,ut);return Object(o.k)(e,{updatedOtherContactProps:r})}(e,t.payload.otherContactDateProp)}).handleAction(M,function(e){return At(e)}).handleAction(R,function(e,t){return Ct(e,t.payload.im)}).handleAction(F,function(e,t){return Dt(e,t.payload.availableEmail)}).handleAction(I,function(e,t){return function(e,t){var n=nt({},t,{showErrorMessage:!(!t.newValue||le.validate(t.newValue.trim()))}),r=dt(e.updatedEmails,n,ut);return Object(o.k)(e,{updatedEmails:r})}(e,t.payload.email)}).handleAction(H,function(e,t){return Lt(e,t.payload.email)}).handleAction(_,function(e,t){return ln(e,t.payload.availableWorkDetail)}).handleAction(z,function(e,t){return dn(e,t.payload.workDetail)}).handleAction(Y,function(e){return zt(e)}).handleAction(G,function(e,t){return Kt(e,t.payload.note)}).handleAction(ae,function(e,t){return function(e,t){return Object(o.k)(e,{updatedProfilePhoto:t})}(e,t.payload.dataUri)}).handleAction(te,function(){return wn.changeSet}).handleAction(ne,function(){return wn.changeSet}).handleAction(K,function(e){return On({},e,{validationErrors:!1})}).handleAction(X,function(e){return On({},e,{validationErrors:!0})}).done(ot),jn=Object(vn.a)().handleAction(A,function(e,t){return t.payload.focusPropertyUri||"PersonaGivenNames"}).handleAction(E,function(e,t){return t.payload.focusPropertyUri||"PersonaGivenNames"}).handleAction(w,function(e,t){return lt(t.payload.availableName)}).handleAction(V,function(e,t){return t.payload.availablePhone}).handleAction(L,function(e,t){return t.payload.availablePostalAddress}).handleAction(D,function(e,t){return t.payload.postalAddress.propertyUri}).handleAction(U,function(e,t){return t.payload.availableOtherContactProp}).handleAction(F,function(e,t){return t.payload.availableEmail}).handleAction(M,function(e,t){return t.payload.availableIm}).handleAction(_,function(e,t){return t.payload.availableWorkDetail}).handleAction(Y,function(){return"PersonaBodies"}).handleAction(te,function(){return wn.mostRecentPropertyUri}).handleAction(ne,function(){return wn.mostRecentPropertyUri}).done(wn.mostRecentPropertyUri),Dn=Object(vn.a)().handleAction(A,function(){return wn.originalContact}).handleAction(C,function(e,t){return t.payload.originalContact}).handleAction(te,function(){return wn.originalContact}).handleAction(ne,function(){return wn.originalContact}).done(wn.originalContact),Ln=Object(vn.a)().handleAction(ie,function(e,t){return null}).handleAction(K,function(){return wn.errorState}).handleAction(X,function(e,t){return t.payload}).handleAction(re,function(e,t){return{message:t.payload.error,propertyUri:""}}).handleAction(te,function(){return wn.errorState}).handleAction(ne,function(){return wn.errorState}).done(wn.errorState),Tn=Object(Nn.combineReducers)({editorState:Object(En.a)(kn,wn.editorState),originalContact:Dn,changeSet:Vn,mostRecentPropertyUri:jn,errorState:Ln}),Un=Object(An.a)("ContactEditorStore",Tn,function(e){return{editorState:e.editorState,originalContact:e.originalContact,changeSet:e.changeSet,errorState:e.errorState,mostRecentPropertyUri:e.mostRecentPropertyUri,phones:Pt(e.originalContact||{},e.changeSet),updatedValues:$t(e.changeSet,e.originalContact||void 0)}}),Bn=function(e,t){var n;if(function(e){return!De(e)}(t)){if(Te(t.propertyUri))return Object(o.k)(e,{updatedNames:Object(o.k)(e.updatedNames,(n={},n[t.propertyUri]={oldValue:null,newValue:t.value},n))});if(Ue(t.propertyUri))return Dt(e,t.propertyUri,t.value);if(Be(t.propertyUri))return At(e,t.value);if(We(t.propertyUri)||Me(t.propertyUri))return xt(e,t.propertyUri,t.value);if(Ie(t.propertyUri))return Gt(e,t.propertyUri,t.value);if(He(t.propertyUri))return zt(e,t.value);if(Re(t.propertyUri))return ln(e,t.propertyUri,t.value)}else if(De(t))return Nt(e,t.propertyUri,t.value);return e};function Wn(e){return[{propertyUri:"PersonaEmails1",index:-1,oldValue:null,newValue:e.EmailAddress&&e.EmailAddress.EmailAddress||"",oldDisplayNameValue:null,oldOriginalDisplayNameValue:null,attributions:[],isWritable:!0}]}function Mn(e,t,n,r){return e(n).map(function(e){return r=t(r,Object(o.k)(e,{oldValue:"",isWritable:!0}))}),r}var Rn=n(26),Fn=n(680),In=function(){return(In=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Hn(e,t){return e?t:void 0}var Yn=Object(Fn.b)(function(e,t,n){return Object(Rn.W)({row:[{display:"flex",flexDirection:"row",flexShrink:"0",selectors:{"& > div + div":{marginLeft:n},"& > div":In({},Hn(e,{marginLeft:n,marginTop:n}),Hn(t,{flex:1}))}},e&&{flexWrap:"wrap",marginTop:"-"+n,marginLeft:"-"+n}]})}),Gn="24px";function _n(e){var t=Yn(e.wrap,e.equalWidthChildren,Gn).row;return y.createElement("div",{className:t+" "+(e.className||"")},e.children)}var zn=Object(Fn.b)(function(e){return Object(Rn.W)({column:{display:"flex",flexDirection:"column"}})});function Kn(e){var t=zn(Gn).column;return y.createElement("div",{className:t+" "+(e.className||"")},e.children)}var Xn=Object(Fn.b)(function(e){var t=e.palette.neutralLighter;return Object(Rn.W)({persona:{minWidth:"100px",height:"100px",borderRadius:"50%",backgroundColor:t},nameblock:{marginTop:"4px"},section:{backgroundColor:t,height:"19px",minWidth:"133px",marginBottom:"17px",marginTop:"16px"},label:{backgroundColor:t,height:"12px",minWidth:"100px",marginBottom:"4px"},namefield:{backgroundColor:t,height:"19px",minWidth:"156px",marginBottom:"17px"},textfield:{backgroundColor:t,height:"19px",minWidth:"194px",marginBottom:"17px"},notes:{height:"56px",minWidth:"404px",borderWidth:"1px",borderColor:t,borderStyle:"solid",marginBottom:"56px"}})});function Jn(e){var t=Xn(e.theme);return y.createElement("div",{className:e.styling},y.createElement(_n,null,y.createElement(Kn,null,y.createElement("div",{className:t.persona})),y.createElement(Kn,null,y.createElement("div",{className:t.nameblock},y.createElement(_n,null,y.createElement("div",{className:t.label})),y.createElement(_n,null,y.createElement("div",{className:t.namefield})),y.createElement(_n,null,y.createElement("div",{className:t.label})),y.createElement(_n,null,y.createElement("div",{className:t.namefield}))))),y.createElement(_n,null,y.createElement("div",{className:t.section})),y.createElement(_n,null,y.createElement("div",{className:t.label})),y.createElement(_n,null,y.createElement("div",{className:t.textfield})),y.createElement(_n,null,y.createElement("div",{className:t.label})),y.createElement(_n,null,y.createElement("div",{className:t.textfield})),y.createElement(_n,null,y.createElement("div",{className:t.label})),y.createElement(_n,null,y.createElement("div",{className:t.textfield})),y.createElement(_n,null,y.createElement("div",{className:t.label})),y.createElement(_n,null,y.createElement("div",{className:t.textfield})),y.createElement(_n,null,y.createElement("div",{className:t.section})),y.createElement(_n,null,y.createElement("div",{className:t.notes})))}var Zn=Object(Fn.b)(function(){var e={sectionTitle:Object(Rn.R)().fonts.large};return Object(Rn.W)(e,{sectionBlock:{border:0,padding:0,marginTop:"24px"},sectionTitle:{fontWeight:600,padding:0}})});function $n(e){var t=Zn();return y.createElement("fieldset",{className:t.sectionBlock},y.createElement("legend",{role:"heading","aria-level":2,className:t.sectionTitle},e.header),e.children)}var qn,Qn=n(1073),er=n(715),tr=((_e.declareString)("contactEditorStrings.attributionsAriaLabel")),nr=((_e.declareString)("contactEditorStrings.attributionsCaption")),rr=Object(Fn.b)(function(e){return Object(Rn.W)({attributionInfoIcon:{selectors:{".ms-Button":{verticalAlign:"middle",width:"16px",height:"16px",boxSizing:"content-box"},".ms-Button-icon":{fontSize:"13px",color:e.palette.themePrimary}}},attributionHover:{visibility:"hidden",selectors:{"*:hover > * > * > &":{visibility:"visible"},"*:focus":{visibility:"visible"},".ms-Fabric.is-focusVisible &":{visibility:"visible"}}},attributionCallout:{selectors:{".ms-Callout-main":{padding:"14px",overflow:"visible !important"}}},calloutContent:{margin:"-24px",padding:"24px",fontSize:"12px"},attributionTitle:{fontWeight:"bold"}})}),or=(qn=function(e,t){return(qn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}qn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ar=function(e){function t(t){var n=e.call(this,t)||this;return n.iconButtonElement=null,n.onClickIcon=function(e){e&&n.props.showAlways&&e.preventDefault(),n.state.isCalloutVisible&&e&&0===e.screenX&&0===e.screenY?n.onHide():n.onShow()},n.onShow=function(){n.setState(function(e){return Object(o.k)(e,{isCalloutVisible:!0})})},n.onHide=function(){n.setState(function(e){return Object(o.k)(e,{isCalloutVisible:!1})})},n.state={isCalloutVisible:!1},n}return or(t,e),t.prototype.render=function(){var e=this,t=this.props.attributions.length>0,n=this.state.isCalloutVisible,r=rr(this.props.theme),o=[r.attributionInfoIcon];return this.props.showAlways||this.state.isCalloutVisible||o.push(r.attributionHover),y.createElement("span",{className:o.join(" "),ref:function(t){return e.iconButtonElement=t}},t&&y.createElement(d.a,{iconProps:{iconName:"Info"},onMouseEnter:this.onShow,onMouseLeave:this.onHide,onMouseDown:this.onClickIcon,onClick:this.onClickIcon,tabIndex:-1,ariaLabel:tr()}),n?this.iconButtonElement&&y.createElement(Qn.a,{className:r.attributionCallout,target:this.iconButtonElement,onDismiss:this.onHide,gapSpace:8,directionalHint:er.a.rightTopEdge,isBeakVisible:!1},y.createElement("div",{className:r.calloutContent,onMouseEnter:this.onShow,onMouseLeave:this.onHide,role:"alert"},y.createElement("span",null,y.createElement("div",{className:r.attributionTitle},nr())),this.props.attributions.map(function(e,t){return y.createElement("div",{key:t},e)}),this.props.children?y.createElement("p",null,this.props.children):null)):null)},t}(y.Component),ir=Object(c.a)(ar),sr=n(1088),cr=function(){return(cr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},lr=Object(Fn.b)(function(e,t){void 0===t&&(t="inactive");var n=e.palette,r=n.neutralLighterAlt;return Object(Rn.W)({container:{position:"relative",display:"block",paddingTop:"13px",marginTop:"6px",marginBottom:"0px",width:"100%",backgroundColor:"disabled"===t?r:"inherit"},textField:{selectors:{"& .ms-TextField-fieldGroup, &.is-disabled .ms-TextField-fieldGroup":{backgroundColor:"transparent",zIndex:2},"input:disabled":cr({backgroundColor:"transparent"},{"-webkit-text-fill-color":n.neutralTertiaryAlt,"-webkit-opacity":1}),"& .ms-TextField-field":{paddingLeft:0}}},label:{display:"flex",alignItems:"center",position:"absolute",zIndex:"inactive"===t?1:3,transition:"top 200ms ease-out, color 200ms, font-size 200ms ease-out",fontSize:"inactive"===t?"17px":"12px",top:"inactive"===t?"0px":"-10px",height:"inactive"===t?"32px":"16px",color:"inactive"===t?n.neutralSecondaryAlt:n.neutralSecondary}})}),dr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ur=function(){return(ur=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},pr=function(e){function t(t){var n=e.call(this,t)||this;return n.textField=null,n.onFocus=function(){n.setState(function(e){return Object(o.k)(e,{isActive:!0})})},n.onBlur=function(){n.props.onBlur&&n.props.onBlur(),n.setState(function(e){return Object(o.k)(e,{isActive:!1})})},n.onRenderLabel=function(e){if(!e)return null;var t=n.getCSS();return y.createElement("div",{className:t.label},y.createElement("label",{htmlFor:e.id},e.label),n.props.onGetLabelAddon&&n.props.onGetLabelAddon(n.state.isActive))},n.getCSS=function(){var e=n.props.disabled||!n.props.isWritable?"disabled":n.props.value||n.state.isActive?"active":"inactive";return lr(n.props.theme,e)},n.state={isActive:!1},n}return dr(t,e),t.prototype.render=function(){var e=this,t=this.getCSS();return y.createElement("div",{className:Object(b.a)(t.container,this.props.className)},y.createElement(sr.a,ur({},this.props,{"data-log-name":this.props.dataLogName,componentRef:function(t){e.props.componentRef&&e.props.componentRef(t),e.textField=t},onRenderLabel:this.onRenderLabel,onFocus:this.onFocus,onBlur:this.onBlur,onKeyPress:function(t){return e.onKeyPress(t)},className:t.textField,underlined:!0,disabled:this.props.disabled||!this.props.isWritable,multiline:this.props.multiline||!1,autoAdjustHeight:this.props.multiline||!1})))},t.prototype.onKeyPress=function(e){this.textField&&13===e.charCode&&this.props.onReturnPressed&&!this.props.multiline&&this.props.onReturnPressed(this.textField)},t}(y.Component),mr=Object(c.a)(pr),hr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fr=function(){return(fr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},gr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onGetLabelAddon=function(e){return t.props.value||e?y.createElement(ir,{attributions:t.props.attributions,showAlways:e}):null},t}return hr(t,e),t.prototype.render=function(){return y.createElement(mr,fr({},this.props,{onGetLabelAddon:this.onGetLabelAddon}))},t}(y.Component);function br(e){var t=0===e.emails.length?null:e.emails.map(function(t,n){var r=t.propertyUri+"-"+t.index;return y.createElement(gr,{componentRef:function(r){return e.textFieldRef(t.propertyUri,r,e.focusIndex+n/e.emails.length)},id:r,key:r,dataLogName:r,label:qe("Email"),value:t.newValue||"",isWritable:t.isWritable,onChanged:Object(o.b)(function(n){return e.onUpdateEmail(Object(o.k)(t,{newValue:n}))}),onReturnPressed:e.onReturnPressed,attributions:t.attributions,errorMessage:(t.showErrorMessage?e.strings.emailErrorMessage:"")||(t.newValue.length>rt?e.strings.inputLengthErrorMessage:""),onBlur:function(){return e.onBlurEmail(t)}})});return y.createElement(Kn,null,t)}function yr(e){var t=0===e.ims.length?null:e.ims.map(function(t,n){var r=t.propertyUri+"-"+t.index;return y.createElement(gr,{componentRef:function(r){return e.textFieldRef(t.propertyUri,r,e.focusIndex+n/e.ims.length)},id:r,key:r,dataLogName:r,label:qe("IM"),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>rt?e.strings.inputLengthErrorMessage:"",onChanged:Object(o.b)(function(n){return e.onUpdateIM(Object(o.k)(t,{newValue:n}))}),onReturnPressed:e.onReturnPressed,attributions:t.attributions})});return y.createElement(Kn,null,t)}var Pr=Object(Fn.b)(function(){return Object(Rn.W)({container:{flexGrow:1,marginTop:"-4px",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"},nameFieldContainer:{flex:"1 1 200px"},nameFieldLeftSmallContainer:{flex:"0 0 60px",marginRight:"20px"},nameFieldRightSmallContainer:{flex:"0 0 60px",marginLeft:"20px"}})});function Sr(e){var t=Pr();return y.createElement(Kn,{className:t.container},ge.map(function(n,r){if(n in e.names){var a=e.names[n];if(!a||null===a.oldValue&&null===a.newValue)return null;var i=function(e,t){switch(e){case"DisplayNamePrefix":return t.nameFieldLeftSmallContainer;case"Generation":return t.nameFieldRightSmallContainer;default:return t.nameFieldContainer}}(n,t),s=a.oldValue;return y.createElement(gr,{componentRef:function(t){return e.textFieldRef(a.propertyUri,t,e.focusIndex+r/ge.length)},key:n,dataLogName:n,id:n,className:i,label:qe(n),value:a.newValue||"",isWritable:a.isWritable,errorMessage:a.newValue.length>rt?e.strings.inputLengthErrorMessage:"",onChanged:Object(o.b)(function(t){return e.onUpdateName(n,s,t)}),onReturnPressed:e.onReturnPressed,attributions:a.attributions})}return null}))}var xr=n(1074),vr=Object(Fn.b)(function(e){var t=e.palette;return Object(Rn.W)({deletableDatePicker:{border:"0px",margin:"8px 0px 8px 0px",padding:"0px"},container:{display:"flex",flexDirection:"row",alignItems:"flex-end",selectors:{"& .ms-Dropdown-container":{width:"100%"},"& .ms-Dropdown-label":{fontSize:"12px"},"& > div":{paddingRight:"12px"}}},monthPicker:{width:"160px"},datePicker:{width:"80px"},yearPicker:{width:"100px"},deleteButton:{selectors:{"&:hover":{backgroundColor:t.neutralLight},"&:hover .ms-Button-icon":{color:t.neutralPrimary}}},label:{display:"flex",fontSize:"12px",marginBottom:"4px",color:t.neutralSecondary,padding:0}})}),Er=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ar=1604,Cr=function(e){function t(t){var n=e.call(this,t)||this;n.changeDayState=function(e){e&&n.props.otherContactProp.isWritable&&(n.setState(function(t){return Object(o.k)(t,{selectedDayItem:e})}),n.updateStore(n.getSelectedYear(),n.getSelectedMonth(),kr(e.text)))},n.changeMonthState=function(e){e&&n.props.otherContactProp.isWritable&&(n.setState(function(t){return Object(o.k)(t,{selectedMonthItem:e})}),n.updateStore(n.getSelectedYear(),kr(e.key.toString()),n.getSelectedDay()))},n.changeYearState=function(e){e&&n.props.otherContactProp.isWritable&&(n.setState(function(t){return Object(o.k)(t,{selectedYearItem:e})}),n.updateStore(kr(e.text)||Ar,n.getSelectedMonth(),n.getSelectedDay()))};var r=t.otherContactProp.newValue?t.otherContactProp.newValue:t.otherContactProp.oldValue?t.otherContactProp.oldValue:Or(new Date(Ar,0,1));return n.state={selectedDayItem:{key:r.getUTCDate().toString(),text:""},selectedMonthItem:{key:r.getUTCMonth().toString(),text:""},selectedYearItem:{key:r.getUTCFullYear().toString(),text:""}},n}return Er(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.selectedMonthItem,r=t.selectedDayItem,o=t.selectedYearItem,a=!this.props.otherContactProp.isWritable,i=vr(this.props.theme),s={optionsContainerWrapper:{maxHeight:"280px",overflowY:"scroll",overflowX:"hidden"},optionsContainer:{marginRight:"16px"}};return y.createElement("fieldset",{className:i.deletableDatePicker},y.createElement("legend",{className:i.label},this.props.label," ",y.createElement(ir,{attributions:this.props.attributions,showAlways:!1})),y.createElement("div",{className:i.container},y.createElement("div",{className:i.monthPicker},y.createElement(xr.a,{allowFreeform:!0,componentRef:function(t){!a&&e.props.componentRef(t,e.props.focusIndex)},disabled:a,ariaLabel:qe("Month"),selectedKey:n&&n.key,onChanged:this.changeMonthState,options:this.getMonthOptions(),styles:s})),y.createElement("div",{className:i.datePicker},y.createElement(xr.a,{allowFreeform:!0,componentRef:function(t){!a&&e.props.componentRef(t,e.props.focusIndex,!0)},disabled:a,ariaLabel:qe("Day"),selectedKey:r&&r.key,onChanged:this.changeDayState,options:this.getDayOptions(),styles:s})),y.createElement("div",{className:i.yearPicker},y.createElement(xr.a,{allowFreeform:!0,componentRef:function(t){!a&&e.props.componentRef(t,e.props.focusIndex,!0)},disabled:a,ariaLabel:qe("Year"),selectedKey:o&&o.key,onChanged:this.changeYearState,options:this.getYearOptions(),styles:s})),this.props.onDeleted?y.createElement(d.a,{className:i.deleteButton,onClick:this.props.onDeleted,iconProps:{iconName:"Delete"},title:this.props.strings.removeDate,ariaLabel:this.props.strings.removeDate}):null))},t.prototype.updateStore=function(e,t,n){this.props.onUpdate(Object(o.k)(this.props.otherContactProp,{newValue:Or(new Date(e,t,n,11,59))}))},t.prototype.getSelectedYear=function(){return kr(this.state.selectedYearItem.key.toString())||Ar},t.prototype.getSelectedMonth=function(){return kr(this.state.selectedMonthItem.key.toString())},t.prototype.getSelectedDay=function(){return kr(this.state.selectedDayItem.key.toString())},t.prototype.getDayOptions=function(){return(e=this.getSelectedMonth(),t=this.getSelectedYear(),wr(1,function(e,t){return void 0===t&&(t=Ar),new Date(t,e+1,0).getDate()}(e,t))).map(function(e){return{key:e,text:e}});var e,t},t.prototype.getMonthOptions=function(){return(e=this.props.strings.monthNames,[e.january,e.february,e.march,e.april,e.may,e.june,e.july,e.august,e.september,e.october,e.november,e.december]).map(function(e,t){return{key:t.toString(),text:e}});var e},t.prototype.getYearOptions=function(){return[{key:Ar.toString(),text:qe("Year")}].concat(wr(1900,(new Date).getUTCFullYear()).reverse().map(function(e){return{key:e,text:e}}))},t}(y.Component),Nr=Object(c.a)(Cr);function Or(e){var t=6e4*e.getTimezoneOffset();return new Date(e.getTime()-t)}function wr(e,t){return Array.apply(null,new Array(t-e+1)).map(function(t,n){return(n+e).toString()})}function kr(e){return parseInt(e,10)}function Vr(e){if(0===e.otherContactProps.length)return null;var t=Pe.map(function(t,n){return e.otherContactProps.filter(function(e){return e.propertyUri===t}).map(function(t){var r=t.propertyUri+"-"+t.index;return xn(t)?y.createElement(Nr,{componentRef:function(n,r,o){return e.focusTargetRef(o?void 0:t.propertyUri,n,r)},focusIndex:e.focusIndex+n/Pe.length,onUpdate:e.onUpdateOtherContactProp,onDeleted:t.isWritable?function(){e.onRemoveOtherContactDateProp(t)}:void 0,strings:e.strings,otherContactProp:t,key:r,label:qe(t.propertyUri),attributions:t.attributions}):y.createElement(gr,{componentRef:function(r){return e.focusTargetRef(t.propertyUri,r,e.focusIndex+n/Pe.length)},id:r,key:r,dataLogName:r,label:qe(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>rt?e.strings.inputLengthErrorMessage:"",onChanged:Object(o.b)(function(n){e.onUpdateOtherContactProp(Object(o.k)(t,{newValue:n}))}),attributions:t.attributions,onReturnPressed:e.onReturnPressed})})});return y.createElement($n,{header:e.strings.otherPropertiesHeader},y.createElement(Kn,null,t))}var jr=Object(Fn.b)(function(){return Object(Rn.W)({notesEditor:{width:"100%",marginTop:"12px",marginBottom:"40px"}})});function Dr(e){var t=e.textFieldRef,n=e.strings,r=e.notes,a=e.onUpdatePersonalNote,i=e.focusIndex;return y.createElement($n,{header:n.privateNotes},r.map(function(e){return y.createElement(sr.a,{disabled:!e.isWritable,className:jr().notesEditor,ariaLabel:Lr(n.privateNotes,n.privateNotesSection,e),label:r.length>1?Lr(n.privateNotes,n.privateNotesSection,e):void 0,componentRef:function(e){return t("PersonaBodies",e,i)},multiline:!0,autoAdjustHeight:!0,rows:4,value:e.newValue||"",resizable:!1,placeholder:n.privateNotesPlaceholder,key:e.index,"data-log-name":"PersonaBodies-"+e.index,onChanged:Object(o.b)(function(t){e.isWritable&&a(Object(o.k)(e,{newValue:t}))})})}))}function Lr(e,t,n){return 0===n.attributions.length?e:t({p0:n.attributions.join(" - ")})}function Tr(e){var t=0===e.phones.length?null:e.phones.map(function(t,n){var r=t.propertyUri+"-"+t.index;return y.createElement(gr,{componentRef:function(r){return e.textFieldRef(t.propertyUri,r,e.focusIndex+n/e.phones.length)},id:r,key:r,dataLogName:r,label:Qe(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>rt?e.strings.inputLengthErrorMessage:"",onChanged:Object(o.b)(function(n){return e.onUpdatePhone(Object(o.k)(t,{newValue:n}))}),onReturnPressed:e.onReturnPressed,attributions:t.attributions})});return y.createElement(Kn,null,t)}var Ur=function(){return(Ur=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Br=Object(Fn.b)(function(e){return Object(Rn.W)({headerRow:Ur({justifyContent:"space-between",lineHeight:"14px;",marginTop:"6px"},Rn.e.small,!e&&{backgroundColor:Rn.f.neutralLighterAlt}),header:{color:Rn.f.neutralSecondary},addressFieldsContainer:{flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",display:"flex"},fullLineField:{flex:"0 0 100%"},halfLineField:{flex:"0 0 192px"}})}),Wr=function(){return(Wr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Mr(e){var t=["Street","City","State","PostalCode","Country"],n=Br(e.postalAddress.isWritable);return y.createElement("div",{className:n.addressFieldsContainer},t.map(function(r,a){var i=e.postalAddress.propertyUri+"-"+e.postalAddress.index+"-"+r;return y.createElement(mr,{componentRef:function(n){return e.textFieldRef(0===a?e.postalAddress.propertyUri:void 0,n,e.focusIndex+a/(100*t.length))},id:i,key:i,dataLogName:i,label:qe(r),className:0===a?n.fullLineField:n.halfLineField,value:e.postalAddress.newValue&&e.postalAddress.newValue[r]||"",errorMessage:(e.postalAddress.newValue&&e.postalAddress.newValue[r]||"").length>rt?e.strings.inputLengthErrorMessage:"",isWritable:e.postalAddress.isWritable,multiline:"Street"===r,onChanged:Object(o.b)(function(t){var n;e.postalAddress.newValue&&e.onUpdatePostalAddress(Object(o.k)(e.postalAddress,{newValue:Object(o.k)(e.postalAddress.newValue,(n={},n[r]=t,n))}))}),onReturnPressed:e.onReturnPressed})}))}function Rr(e){var t=e.postalAddresses.map(function(t,n){return y.createElement($n,{key:n,header:(r=qe(t.propertyUri),o=t.attributions,y.createElement(_n,null,r," ",y.createElement(ir,{attributions:o,showAlways:!1})))},y.createElement(Mr,Wr({postalAddress:t,focusIndex:e.focusIndex+n/e.postalAddresses.length},e)));var r,o});return y.createElement(Kn,null,t)}var Fr=n(766),Ir=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hr=y.lazy(function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,1536)).then(function(e){return{default:e.StandaloneProfilePhotoPicker}})}),Yr=function(e){function t(t){var n=e.call(this,t)||this;return n.showPhotoPicker=function(){n.setState(function(e){return Object(o.k)(e,{isPhotoPickerVisible:!0})})},n.hidePhotoPicker=function(){n.setState(function(e){return Object(o.k)(e,{isPhotoPickerVisible:!1})})},n.state={isPhotoPickerVisible:!1},n}return Ir(t,e),t.prototype.render=function(){var e=this;return y.createElement(Fr.a,{onClick:this.showPhotoPicker,title:this.props.title},y.createElement(y.Suspense,{fallback:y.createElement("div",null)},this.state.isPhotoPickerVisible&&y.createElement(Hr,{personDisplayName:this.props.personDisplayName,personImageUrl:this.props.personImageUrl,strings:this.props.strings,onUpload:function(t,n,r){return e.onPhotoUploaded(t,n,r)},onDismiss:this.hidePhotoPicker})))},t.prototype.onPhotoUploaded=function(e,t,n){t(),this.hidePhotoPicker(),this.props.onUpload&&this.props.onUpload(e)},t}(y.Component),Gr=n(985),_r=n(903),zr=n(1093),Kr=n(916),Xr=n(1203),Jr=n(1136),Zr=n(1202),$r=n(915),qr=n(1539),Qr=n(914),eo=Object(Fn.b)(function(e){return Object(Rn.W)({button:{margin:"10px 14px 0px 0px",padding:"0px",minWidth:"120px",maxWidth:"160px",color:e.palette.themePrimary,selectors:{"& .ms-Button-menuIcon, & .ms-Button-icon":{color:e.palette.themePrimary}}}})}),to=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var no=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return to(t,e),t.prototype.render=function(){var e,t,n,r=this.props,o=function(e,t){var n=hn(e,t),r=be.filter(function(e){return!n[e]});return Object(de.a)(r.map(ft))}(r.originalContact,r.changeSet),a=(e=r.originalContact,t=r.changeSet,n=r.isEnterprise,St(e,t,jt,Ae,n)),i=function(e,t,n){var r=St(e,t,Pt,Ee,n);return Object(ue.a)(r,function(e){return et(e)})}(r.originalContact,r.changeSet,r.isEnterprise),s=function(e,t,n){return St(e,t,un,ke,n)}(r.originalContact,r.changeSet,r.isEnterprise),c=function(e,t,n){return St(e,t,Wt,Ve,n)}(r.originalContact,r.changeSet,r.isEnterprise),l=function(e,t,n){return St(e,t,Yt,ye,n)}(r.originalContact,r.changeSet,r.isEnterprise),d=function(e,t,n){return St(e,t,Et,Ce,n)}(r.originalContact,r.changeSet,r.isEnterprise),u=function(e,t,n){return St(e,t,Jt,je,n)}(r.originalContact,r.changeSet,r.isEnterprise),p=eo(r.theme),m=a.slice(0,1),h=Object(qr.a)(Ee,i.filter(We)),f=Object(qr.a)(Ee,i.filter(Me));0===h.length&&(h=f,f=[]);var g=function(e){return{key:e,name:et(e),onClick:function(){r.onAddPhone(e)}}},b=r.disabled||a.length+d.length+o.length+h.length+f.length+s.length+l.length+c.length===0;return y.createElement(Qr.a,{"data-log-name":"ContactEditorAdd",className:p.button,disabled:b,menuProps:{items:m.map(function(e){return{key:e,name:qe("Email"),onClick:function(){r.onAddEmail(e)}}}).concat(d.map(function(e){return{key:e,name:qe("IM"),onClick:function(){r.onAddIm(e)}}})).concat(ro(qe("AddNameSubmenu"),o.map(function(e){return{key:e,name:qe(e),onClick:function(){window.setTimeout(function(){return r.onAddName(e)},0)}}})),ro(qe("AddPhoneSubmenu"),h.map(g).concat(ro(qe("AddPhoneOtherSubmenu"),f.map(g),qe("AddPhoneSubmenu").concat(qe("AddPhoneOtherSubmenu"))))),ro(qe("AddWorkSubmenu"),s.map(function(e){return{key:e,name:qe(e),onClick:function(){r.onAddWorkDetail(e)}}})),ro(qe("AddAddressSubmenu"),c.map(function(e){return{key:e,name:tt(e),onClick:function(){r.onAddPostalAddress(e)}}})),ro(qe("AddOtherSubmenu"),l.map(function(e){return{key:e,name:qe(e),onClick:function(){r.onAddOtherContactProp(e)}}}))).concat(u.map(function(e){return{key:e,name:qe("PersonaBodies"),onClick:function(){r.onAddPersonalNotes(e)}}}))},iconProps:{iconName:"Add"}},r.caption)},t}(y.Component);function ro(e,t,n){return n=n||e,0===t.length?[]:{key:n,name:e,subMenuProps:{items:t}}}var oo=Object(c.a)(Object(P.b)(function(e,t){return{originalContact:Un.getSelectors(e).originalContact||{},changeSet:Un.getSelectors(e).changeSet}},function(e,t){return{onAddEmail:function(t){return e(F({availableEmail:t}))},onAddIm:function(t){return e(M({availableIm:t}))},onAddName:function(t){return e(w({availableName:t}))},onAddOtherContactProp:function(t){return e(U({availableOtherContactProp:t}))},onAddPhone:function(t){return e(V({availablePhone:t}))},onAddPostalAddress:function(t){return e(L({availablePostalAddress:t}))},onAddWorkDetail:function(t){return e(_({availableWorkDetail:t}))},onAddPersonalNotes:function(t){return e(Y({availableNotes:t}))}}})(no)),ao=Object(Fn.b)(function(e){var t=e.palette,n=t.neutralLighter;return Object(Rn.W)({button:{margin:"14px 14px 0px 0px",padding:"0px",minWidth:"80px",maxWidth:"100px",backgroundColor:t.neutralLighter,borderColor:t.neutralLighter,color:t.neutralPrimary,selectors:{"&.ms-Button--primary":{backgroundColor:t.themePrimary,color:t.white},"&.ms-Button--primary:hover":{backgroundColor:t.themeDarkAlt,color:t.white},"&.ms-Button--primary:active":{backgroundColor:t.themeDark,color:t.white},"&.is-disabled, &.ms-Button--primary.is-disabled":{backgroundColor:t.neutralLighter,color:t.neutralTertiary},"&.ms-Button--default:hover":{backgroundColor:t.neutralLight,color:t.black},"&.ms-Button--default:active":{backgroundColor:t.neutralTertiaryAlt,color:t.neutralDark}}},ghostedSaveBar:{display:"flex",flexDirection:"row"},ghostedButton:{margin:"14px 12px 0px 0px",height:"32px",maxWidth:"80px",minWidth:"80px",backgroundColor:n,borderColor:n},ghostedAddMoreButton:{display:"flex",flexDirection:"column",margin:"20px 0px 0px 0px",padding:"0px",minWidth:"120px",maxWidth:"120px",height:"22px",backgroundColor:n,borderColor:n},spinner:{width:"100%",margin:"auto"}})}),io=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),so=function(){return(so=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return io(t,e),t.prototype.render=function(){return-1!==["saving","failed"].indexOf(this.props.editorState)?y.createElement(Jr.a,null,lo(this.props)):y.createElement(lo,so({},this.props))},t}(y.Component);function lo(e){var t="loading"===e.editorState||"loadErrorDialogOpen"===e.editorState,n=ao(e.theme),r="editing"===e.editorState;return y.createElement("div",{className:e.className},t?y.createElement("div",{className:n.ghostedSaveBar},y.createElement("span",{className:n.ghostedButton}),y.createElement("span",{className:n.ghostedButton}),y.createElement("span",{className:n.ghostedAddMoreButton})):y.createElement("div",null,y.createElement(uo,so({},e)),y.createElement(po,so({},e)),y.createElement(oo,{disabled:!r,caption:e.strings.addMore,isEnterprise:e.isEnterprise})),"discardDialogOpen"===e.editorState?y.createElement(ho,so({},e)):null,"loadErrorDialogOpen"===e.editorState?y.createElement(fo,so({},e)):null)}function uo(e){var t=ao(e.theme),n=!e.hasChanges,r="failed"===e.editorState?e.onCancel:e.onSave;return y.createElement(Gr.a,{className:t.button,onClick:r,disabled:n,"data-log-name":"ContactEditorSave",onFocus:e.onSaveButtonFocus,theme:e.theme},function(e){switch(e.editorState){case"saving":case"discardDialogOpen":return y.createElement(Zr.a,{className:ao(e.theme).spinner,size:$r.a.medium});case"failed":return e.strings.close;case"editing":return e.createMode?e.strings.create:e.strings.save;case"idle":case"loading":case"loadErrorDialogOpen":return"";default:return Object(o.g)(e.editorState)}}(e))}function po(e){var t=ao(e.theme),n="saving"===e.editorState||"failed"===e.editorState;return y.createElement(_r.a,{className:t.button,onClick:e.onCancel,disabled:n,"data-log-name":"ContactEditorCancel",theme:e.theme},e.createMode?e.strings.discard:e.strings.cancel)}function mo(e){var t=e.onNotSaveInDialog,n=e.onCancelInDialog,r=e.strings,o=e.theme,a=ao(o);return y.createElement(zr.a,null,y.createElement(Gr.a,{onClick:t,text:r.discardDialogYes,"data-log-name":"EditContactSaveDialogNo",theme:o,className:a.button}),y.createElement(_r.a,{onClick:n,text:r.discardDialogCancel,"data-log-name":"EditContactSaveDialogCancel",theme:o,className:a.button}))}function ho(e){var t=e.onCancelInDialog,n=e.strings;return y.createElement(go,{onCancel:t,title:n.discardDialogTitle,subText:n.discardDialogSubText,dialogType:Kr.a.close,renderButtons:function(){return y.createElement(mo,so({},e))}})}function fo(e){var t=e.onCancelInDialog,n=e.strings,r=e.theme,o=ao(r);return y.createElement(go,{onCancel:t,title:n.loadErrorDialogTitle,dialogType:Kr.a.normal,renderButtons:function(){return y.createElement(zr.a,null,y.createElement(Gr.a,{onClick:e.onCancelInDialog,text:n.errorDialogClose,theme:r,className:o.button}))}})}function go(e){return y.createElement(Xr.a,{"data-log-name":"EditContactSaveDialog",hidden:!1,onDismiss:e.onCancel,dialogContentProps:{type:e.dialogType||Kr.a.normal,title:e.title,subText:e.subText},modalProps:{isBlocking:!0}},e.renderButtons())}function bo(e){if(0===e.workDetails.length)return null;var t=e.workDetails.map(function(t,n){var r=t.propertyUri+"-"+t.index;return y.createElement(gr,{componentRef:function(r){return e.textFieldRef(t.propertyUri,r,e.focusIndex+n/e.workDetails.length)},id:r,key:r,dataLogName:r,label:qe(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>rt?e.strings.inputLengthErrorMessage:"",onChanged:Object(o.b)(function(n){return e.onUpdateWorkDetail(Object(o.k)(t,{newValue:n}))}),onReturnPressed:e.onReturnPressed,attributions:t.attributions})});return y.createElement($n,{header:e.strings.workDetailsHeader},y.createElement(Kn,null,t))}var yo=Object(Fn.b)(function(e){var t=e.palette,n={leftPaneTitle:e.fonts.xxLarge,leftPaneSubTitle:e.fonts.medium,leftPaneText:e.fonts.medium};return Object(Rn.W)(n,{editorRoot:{border:"1px solid transparent",width:"798px",maxHeight:"calc(100vh - 78px)",display:"flex",flexDirection:"row",overflow:"hidden",selectors:{"& h1, & h2, & h3":{marginTop:0,marginBottom:0}}},svg:{margin:"auto",height:"200px",width:"80%",display:"block"},primaryStroke:{stroke:t.themePrimary,fill:"none"},secondaryStroke:{stroke:t.themeTertiary,fill:"none"},leftPane:{boxSizing:"border-box",minWidth:"300px",backgroundColor:t.neutralLighter,paddingLeft:"32px",paddingRight:"32px",paddingTop:"40px",paddingBottom:"40px",overflow:"auto",color:t.neutralPrimary,lineHeight:"18px"},leftPaneTitle:{paddingBottom:"40px",paddingTop:"10px",lineHeight:"1.2"},leftPaneSubTitle:{fontWeight:"600"},leftPaneText:{marginTop:"0px",whiteSpace:"pre-wrap"},rightPane:{minWidth:"500px",display:"flex",flexDirection:"column"},rightBodyTopBorder:{selectors:{"div&":{borderTop:"1px solid "+t.neutralLighter}}},rightBody:{borderTop:"1px solid "+t.white,maxHeight:"calc(100vh - 179px)",padding:"0px",overflowY:"auto",marginTop:"39px"},rightBodyContent:{position:"relative",maxWidth:"404px",paddingRight:"8px",paddingLeft:"48px",paddingTop:"0px",paddingBottom:"0px",selectors:{"& .ms-Persona-initials":{color:"#FFFFFF"}}},rightFooter:{minHeight:"60px",height:"60px",padding:"0px 48px",borderTop:"1px solid "+t.neutralLighter,boxSizing:"border-box"},rightHeader:{paddingLeft:"48px",maxWidth:"435px",height:"10px",paddingTop:"0px",margin:"0px"},closeButtonOuter:{width:"31px",textAlign:"center",position:"absolute",right:"1px",top:0},closeButton:{marginTop:"2px",color:t.neutralSecondary,selectors:{"&:hover .ms-Button--icon ":{color:t.themeDarker}}},errorBar:{margin:"0 auto 20px auto",maxWidth:"404px",selectors:{"& .ms-MessageBar-icon":{margin:"8px 0 8px 8px"},"& .ms-MessageBar-text":{margin:"8px"}}},errorBarMessage:{color:t.black},editorOverlay:{zIndex:100,backgroundColor:t.white,opacity:.7},doughboy:{selectors:{"& .ms-Persona-coin .ms-Persona-initials":{fontSize:"32px",backgroundColor:t.neutralQuaternaryAlt}}}})}),Po=n(1101),So=n(1197),xo=n(1206);function vo(e){var t=e.styles;return y.createElement("svg",{id:"Layer_1",className:t.svg,"data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 187.03 110.33","aria-hidden":"true"},y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"21.53",y1:"94.83",x2:"26.53",y2:"94.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"132.53",y1:"94.83",x2:"149.53",y2:"94.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"34.53",y1:"94.83",x2:"41.53",y2:"94.83"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M104.75,71.56l.06.06a4.62,4.62,0,0,0,6.54,0h0",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M100.16,83.1A9.51,9.51,0,0,0,108,87.3a9,9,0,0,0,7.89-4.2",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M98.13,67.75A4,4,0,0,0,94.8,66a3.79,3.79,0,0,0-3.34,1.78",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M124.46,67.75A4,4,0,0,0,121.13,66a3.79,3.79,0,0,0-3.34,1.78",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M132,55V74.71a24,24,0,0,1-24,24h0a24,24,0,0,1-24-24V55.05",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M84,64.62h-.51A5.41,5.41,0,0,0,78,70v.17a5.41,5.41,0,0,0,5.41,5.41H84",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M132,64.62h.16A5.41,5.41,0,0,1,137.52,70v.17a5.41,5.41,0,0,1-5.41,5.41H132",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M153,125.5v-5.33a19.56,19.56,0,0,0-19.56-19.56H124",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M92,100.62H82.51A19.56,19.56,0,0,0,63,120.17v5.33",transform:"translate(-17.97 -15.67)"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"6",className:t.primaryStroke,x1:"73.98",y1:"76.95",x2:"73.98",y2:"84.95"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M91.94,101.06s-.36,15.56,15.56,15.56c16.45,0,16.45-15.56,16.45-15.56V92.62",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M131.55,72.91",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M91.57,98.06c-1.77-.83-3.27-4.3-4.89-5.37s-4.72-.18-6.19-1.48-1-4.55-2.31-6.05S73.7,83.65,72.65,82s.26-4.66-.55-6.47-3.88-2.74-4.43-4.66,1.54-4.38,1.27-6.36-3-3.73-3-5.75,2.69-3.81,3-5.75-1.81-4.48-1.27-6.36S71.29,43.76,72.1,42s-.5-4.81.55-6.47,4.27-1.69,5.54-3.19.84-4.75,2.31-6.05,4.55-.4,6.19-1.48,2.1-4.32,3.88-5.14,4.47.93,6.35.37,3.2-3.53,5.15-3.81,4,2.19,6,2.19,4.09-2.46,6-2.19,3.3,3.26,5.15,3.81,4.59-1.19,6.35-.37,2.25,4.07,3.88,5.14,4.72.18,6.19,1.48,1,4.55,2.31,6.05,4.48,1.52,5.54,3.19-.26,4.66.55,6.47,3.88,2.74,4.43,4.66S146.86,51,147.14,53s3,3.73,3,5.75-2.69,3.81-3,5.75,1.81,4.48,1.27,6.36-3.63,2.87-4.43,4.66.5,4.81-.55,6.47-4.27,1.69-5.54,3.19-.84,4.75-2.31,6.05-4.55.4-6.19,1.48-3.09,4.54-4.87,5.37",transform:"translate(-17.97 -15.67)"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M84,55.23a2.29,2.29,0,0,0,1.65-.64c1.7-1.12,2.19-4.5,4-5.36s4.66,1,6.62.38,3.34-3.68,5.37-4,4.19,2.28,6.24,2.28,4.26-2.57,6.24-2.28,3.44,3.4,5.37,4,4.79-1.24,6.62-.38,2.35,4.25,4,5.36a3.51,3.51,0,0,0,1.23.47",transform:"translate(-17.97 -15.67)"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"77.5",y1:"109.83",x2:"147.53",y2:"109.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"30.5",y1:"109.83",x2:"60.53",y2:"109.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"0.5",y1:"109.83",x2:"19.53",y2:"109.83"}),y.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"156.5",y1:"109.83",x2:"186.53",y2:"109.83"}))}var Eo={title:((_e.declareString)("contactEditorStrings.infoTextNewContact.title")),description:((_e.declareStringWithPlaceholders)("contactEditorStrings.infoTextNewContact.description"))},Ao={title:((_e.declareString)("contactEditorStrings.infoTextAddContact.title")),description:((_e.declareStringWithPlaceholders)("contactEditorStrings.infoTextAddContact.description"))},Co={title:((_e.declareString)("contactEditorStrings.infoTextEditContact.title")),description:((_e.declareStringWithPlaceholders)("contactEditorStrings.infoTextEditContact.description"))},No={title:((_e.declareString)("contactEditorStrings.infoTextEditLinkedContact.title")),description:((_e.declareStringWithPlaceholders)("contactEditorStrings.infoTextEditLinkedContact.description")),subTitle:((_e.declareString)("contactEditorStrings.infoTextEditLinkedContact.subTitle")),subDescription:((_e.declareStringWithPlaceholders)("contactEditorStrings.infoTextEditLinkedContact.subDescription"))};function Oo(e){var t=e.styles,n=e.strings,r=e.editorMode,a=e.containsNonWritable,i=function(e,t){switch(e){case"NewContact":return Eo;case"AddContact":return Ao;case"EditContact":return t?No:Co;default:return Object(o.g)(e),Eo}}(r,e.isLinkedContact);return y.createElement("section",{className:t.leftPane,role:"region","aria-labelledby":"lpc-contact-editor-title"},y.createElement("h2",{className:t.leftPaneTitle,id:"lpc-contact-editor-title"},i.title()),y.createElement("p",{className:t.leftPaneText},y.createElement(Po.a,{text:i.description,placeholders:{p0:y.createElement("strong",null,n.addMore)}})),y.createElement(vo,{styles:t}),a&&i.subTitle&&y.createElement("h2",{className:t.leftPaneSubTitle},i.subTitle()),a&&i.subDescription&&y.createElement("p",{className:t.leftPaneText},y.createElement(Po.a,{text:i.subDescription,placeholders:{p0:y.createElement(So.a,{iconName:"Info"})}})),i.link&&i.linkLabel&&y.createElement(xo.a,{href:i.link()},i.linkLabel()))}var wo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ko=function(){return(ko=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Vo=function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((r=r.apply(e,t||[])).next())})},jo=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Do=Object(a.memoizeFunction)(function(e){return ko({},e,{save:((_e.declareString)("contactEditorStrings.save"))(),edit:((_e.declareString)("contactEditorStrings.edit"))(),remove:((_e.declareString)("contactEditorStrings.remove"))(),cancel:((_e.declareString)("contactEditorStrings.cancel"))(),close:((_e.declareString)("contactEditorStrings.close"))(),saving:((_e.declareString)("contactEditorStrings.saving"))(),create:((_e.declareString)("contactEditorStrings.create"))(),tryAgain:((_e.declareString)("contactEditorStrings.tryAgain"))(),discard:((_e.declareString)("contactEditorStrings.discard"))(),closeButtonAccessibilityTitle:((_e.declareString)("contactEditorStrings.closeButtonAccessibilityTitle"))(),discardDialogTitle:((_e.declareString)("contactEditorStrings.discardDialogTitle"))(),discardDialogSubText:((_e.declareString)("contactEditorStrings.discardDialogSubText"))(),saveErrorDialogTitleEmailError:((_e.declareString)("contactEditorStrings.saveErrorDialogTitleEmailError"))(),saveErrorDialogTitleError:((_e.declareString)("contactEditorStrings.saveErrorDialogTitleError"))(),saveErrorDialogTextEmailError:((_e.declareString)("contactEditorStrings.saveErrorDialogTextEmailError"))(),loadErrorDialogTitle:((_e.declareString)("contactEditorStrings.loadErrorDialogTitle"))(),discardDialogYes:((_e.declareString)("contactEditorStrings.discardDialogYes"))(),discardDialogCancel:((_e.declareString)("contactEditorStrings.discardDialogCancel"))(),errorDialogCancel:((_e.declareString)("contactEditorStrings.errorDialogCancel"))(),errorDialogClose:((_e.declareString)("contactEditorStrings.errorDialogClose"))(),emailErrorMessage:((_e.declareString)("contactEditorStrings.emailErrorMessage"))(),navigationWarning:((_e.declareString)("contactEditorStrings.navigationWarning"))(),inputLengthErrorMessage:((_e.declareString)("contactEditorStrings.inputLengthErrorMessage"))(),addToFavorites:((_e.declareString)("contactEditorStrings.addToFavorites"))(),removeFromFavorites:((_e.declareString)("contactEditorStrings.removeFromFavorites"))(),contactEditFormAriaLabel:((_e.declareString)("contactEditorStrings.contactEditFormAriaLabel"))(),contactInformation:((_e.declareString)("contactEditorStrings.contactInformation"))(),workDetailsHeader:((_e.declareString)("contactEditorStrings.workDetailsHeader"))(),postalAddressesHeader:((_e.declareString)("contactEditorStrings.postalAddressesHeader"))(),otherPropertiesHeader:((_e.declareString)("contactEditorStrings.otherPropertiesHeader"))(),privateNotes:((_e.declareString)("contactEditorStrings.privateNotes"))(),privateNotesSection:((_e.declareStringWithPlaceholders)("contactEditorStrings.privateNotesSection")),privateNotesPlaceholder:((_e.declareString)("contactEditorStrings.privateNotesPlaceholder"))(),addMore:((_e.declareString)("contactEditorStrings.addMore"))(),dayNames:{monday:((_e.declareString)("contactEditorStrings.contactEditorDayNamesStrings.monday"))(),tuesday:((_e.declareString)("contactEditorStrings.contactEditorDayNamesStrings.tuesday"))(),wednesday:((_e.declareString)("contactEditorStrings.contactEditorDayNamesStrings.wednesday"))(),thursday:((_e.declareString)("contactEditorStrings.contactEditorDayNamesStrings.thursday"))(),friday:((_e.declareString)("contactEditorStrings.contactEditorDayNamesStrings.friday"))(),saturday:((_e.declareString)("contactEditorStrings.contactEditorDayNamesStrings.saturday"))(),sunday:((_e.declareString)("contactEditorStrings.contactEditorDayNamesStrings.sunday"))()},dayShortNames:{monday:((_e.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.monday"))(),tuesday:((_e.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.tuesday"))(),wednesday:((_e.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.wednesday"))(),thursday:((_e.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.thursday"))(),friday:((_e.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.friday"))(),saturday:((_e.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.saturday"))(),sunday:((_e.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.sunday"))()},contactEditorDatePickerLocale:((_e.declareString)("contactEditorStrings.contactEditorDatePickerLocale"))(),removeDate:((_e.declareString)("contactEditorStrings.removeDate"))(),addContactPhotoFor:((_e.declareStringWithPlaceholders)("contactEditorStrings.addContactPhotoFor")),changeContactPhotoFor:((_e.declareStringWithPlaceholders)("contactEditorStrings.changeContactPhotoFor")),addContactPhoto:((_e.declareString)("contactEditorStrings.addContactPhoto"))(),changeContactPhoto:((_e.declareString)("contactEditorStrings.changeContactPhoto"))()})});function Lo(e,t,n){n||ct(t.changeSet,t.originalContact,t.editorMode)||"failed"===t.editorState?(t.onClose(null),e(ne())):e(Q())}function To(e){return"string"==typeof e?e:e instanceof Error?e.message:"Error"}var Uo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusTargets={},t.focusOrder=[],t.formContainer=null,t.focusRef=function(e,n,r){e&&n&&(t.focusTargets[e]=n),n&&t.focusOrder&&Object(l.a)(t.focusOrder,function(e){return e.element===n})<0&&(t.focusOrder.push({focusIndex:r,element:n}),t.focusOrder.sort(function(e,t){return e.focusIndex-t.focusIndex}))},t.focusNextElement=function(e){var n=Object(l.a)(t.focusOrder,function(t){return t.element===e});if(!(n<0))for(var r=document.activeElement,o=n+1;o<t.focusOrder.length;o++){var a=t.focusOrder[o].element;if(a.focus(),r!==document.activeElement)return void(a.select&&document.activeElement&&"TEXTAREA"!==document.activeElement.tagName&&a.select())}},t.handleExternalCancel=function(){t.props.onExternalCancel()},t.handleNavigation=function(e){if(!ct(t.props.changeSet,t.props.originalContact,t.props.editorMode)){var n=t.props.strings.navigationWarning;return e.returnValue=n,n}return null},t}return wo(t,e),t.prototype.render=function(){var e=this;if("idle"===this.props.editorState)return null;var t=this.props.originalContact||{},n=hn(t,this.props.changeSet),r=Pt(t,this.props.changeSet),o=un(t,this.props.changeSet),a=Wt(t,this.props.changeSet),i=function(e,t){return ht(Vt(e),t.updatedEmails)}(t,this.props.changeSet),s=Yt(t,this.props.changeSet),c=Jt(t,this.props.changeSet),l=Et(t,this.props.changeSet),m=Pn(r)||Pn(o)||Pn(a)||Pn(i)||Pn(s)||Pn(l)||Pn(c),h=t.DisplayNameFirstLast||t.DisplayName||(t.GivenName&&t.Surname?t.GivenName+" "+t.Surname:void 0),P=r.length>0||i.length>0||l.length>0,S="loading"===this.props.editorState||"loadErrorDialogOpen"===this.props.editorState,x=yo(this.props.theme),v=(!i.length||i.some(function(e){return e.isWritable}))&&!t.ADObjectId;return this.focusOrder=[],y.createElement("main",{id:"lpc-contact-editor",className:x.editorRoot,"data-log-name":"ContactEditor"},y.createElement(Oo,{styles:x,strings:this.props.strings,editorMode:this.props.editorMode,containsNonWritable:m,isLinkedContact:Bo(t)}),y.createElement("section",{className:x.rightPane,role:"region","aria-label":this.props.strings.contactEditFormAriaLabel},y.createElement("div",{className:Object(b.a)(x.rightBody,this.formContainer&&this.formContainer.scrollTop>0&&x.rightBodyTopBorder),onScroll:function(){e.formContainer&&0===e.formContainer.scrollTop===e.formContainer.classList.contains(x.rightBodyTopBorder)&&e.formContainer.classList.toggle(x.rightBodyTopBorder)},ref:function(t){e.formContainer=t}},this.props.errorState&&y.createElement(u.a,{messageBarType:p.a.error,className:x.errorBar},y.createElement("div",{role:"alert",className:x.errorBarMessage},this.props.errorState.message)),S?y.createElement(Jn,{theme:this.props.theme,styling:x.rightBodyContent}):y.createElement("div",{className:x.rightBodyContent},y.createElement(_n,null,y.createElement(Kn,null,y.createElement(f.a,{imageUrl:this.props.changeSet.updatedProfilePhoto||(this.props.profilePhotoUrl?this.props.profilePhotoUrl.uri:void 0),size:g.c.extraLarge,text:h,className:h?"":x.doughboy,hidePersonaDetails:!0}),v&&y.createElement(Yr,{personDisplayName:h||"",personImageUrl:this.props.changeSet.updatedProfilePhoto||this.props.profilePhotoUrl&&this.props.profilePhotoUrl.uri||"",title:Mo(this.props),strings:this.props.strings.profilePhotoPickerStrings,onUpload:this.props.onUpdateProfilePhoto})),y.createElement(Sr,{names:n,focusIndex:0,textFieldRef:this.focusRef,strings:this.props.strings,onUpdateName:this.props.onUpdateName,onReturnPressed:this.focusNextElement})),P?y.createElement($n,{header:this.props.strings.contactInformation},y.createElement(br,{emails:i,focusIndex:1,textFieldRef:this.focusRef,strings:this.props.strings,onBlurEmail:this.props.onBlurEmail,onUpdateEmail:this.props.onUpdateEmail,onReturnPressed:this.focusNextElement}),y.createElement(yr,{ims:l,focusIndex:2,textFieldRef:this.focusRef,onUpdateIM:this.props.onUpdateIm,strings:this.props.strings,onReturnPressed:this.focusNextElement}),y.createElement(Tr,{phones:r,focusIndex:3,textFieldRef:this.focusRef,strings:this.props.strings,onUpdatePhone:this.props.onUpdatePhone,onReturnPressed:this.focusNextElement})):null,y.createElement(bo,{workDetails:o,focusIndex:4,strings:this.props.strings,textFieldRef:this.focusRef,onUpdateWorkDetail:this.props.onUpdateWorkDetail,onReturnPressed:this.focusNextElement}),y.createElement(Rr,{postalAddresses:a,focusIndex:5,strings:this.props.strings,textFieldRef:this.focusRef,onAddressEditStarted:this.props.onPostalAddressEditStarted,onUpdatePostalAddress:this.props.onUpdatePostalAddress,onReturnPressed:this.focusNextElement}),y.createElement(Vr,{otherContactProps:s,focusIndex:6,strings:this.props.strings,focusTargetRef:this.focusRef,onUpdateOtherContactProp:this.props.onUpdateOtherContactProp,onRemoveOtherContactDateProp:this.props.onRemoveOtherContactDateProp,onReturnPressed:this.focusNextElement}),y.createElement(Dr,{notes:c,focusIndex:7,onUpdatePersonalNote:this.props.onUpdatePersonalNote,textFieldRef:this.focusRef,strings:this.props.strings}),y.createElement(Wo,ko({},this.props)))),y.createElement(co,{className:x.rightFooter,strings:this.props.strings,editorState:this.props.editorState,hasChanges:!ct(this.props.changeSet,this.props.originalContact,this.props.editorMode),onSave:this.props.onSaveButtonClick,onCancel:this.props.onCancelButtonClick,onNotSaveInDialog:this.props.onNotSaveButtonInDialogClick,onCancelInDialog:this.props.onCancelButtonInDialogClick,onRetryLoadInDialog:this.props.onRetryLoadInDialogClick,createMode:"AddContact"===this.props.editorMode||"NewContact"===this.props.editorMode,theme:this.props.theme,onSaveButtonFocus:this.props.onResetErrorState,isEnterprise:this.props.isEnterprise}),y.createElement("div",{className:x.closeButtonOuter},y.createElement(d.a,{theme:this.props.theme,className:x.closeButton,ariaLabel:this.props.strings.closeButtonAccessibilityTitle,title:this.props.strings.closeButtonAccessibilityTitle,onClick:this.props.onCancelButtonClick,iconProps:{iconName:"Cancel"},"data-log-name":"ContactEditorClose"}))))},t.prototype.componentDidMount=function(){this.updateComponentRef(void 0,this.props),window.addEventListener("beforeunload",this.handleNavigation),this.updateFocus()},t.prototype.componentWillUnmount=function(){window.removeEventListener("beforeunload",this.handleNavigation),this.props.componentRef&&this.props.componentRef(null)},t.prototype.componentDidUpdate=function(e){if(null!==this.props.errorState&&this.formContainer){this.props.strings.saveErrorDialogTitleError!==this.props.errorState.message||yn(this.props.changeSet)||this.props.onResetErrorState();var t=this.focusTargets[this.props.errorState.propertyUri];t&&(e.errorState&&e.errorState.propertyUri)!==this.props.errorState.propertyUri?t.focus():(e.errorState&&e.errorState.message)!==this.props.errorState.message&&(this.formContainer.scrollTop=0)}else e.focusPropertyUri===this.props.focusPropertyUri&&e.mostRecentPropertyUri===this.props.mostRecentPropertyUri&&e.editorState===this.props.editorState||this.updateFocus()},t.prototype.componentWillReceiveProps=function(e){this.updateComponentRef(this.props,e)},t.prototype.updateComponentRef=function(e,t){var n=this;(!e&&t.componentRef||e&&e.componentRef!==t.componentRef)&&(e&&e.componentRef&&e.componentRef(null),t.componentRef&&t.componentRef({cancel:function(){return n.handleExternalCancel()}}))},t.prototype.updateFocus=function(){var e=this.props.mostRecentPropertyUri&&this.focusTargets[this.props.mostRecentPropertyUri]||this.focusTargets.PersonaGivenNames;e&&setTimeout(function(t){e.focus()},15)},t}(y.Component);function Bo(e){return!!e&&(e.AttributionsArray?e.AttributionsArray.filter(function(e){return!e.IsHidden&&"RecipientCache"!==e.DisplayName}):[""]).length>1}function Wo(e){var t=e.editorState;if(-1===["saving","failed","discardDialogOpen"].indexOf(t))return null;var n=yo(e.theme);return y.createElement(h.a,{"data-log-name":"ContactEditorOverlay",className:n.editorOverlay})}function Mo(e){var t=e.changeSet.updatedNames.PersonaGivenNames&&e.changeSet.updatedNames.PersonaGivenNames.newValue||e.originalContact&&e.originalContact.GivenName,n=e.changeSet.updatedNames.PersonaSurnames&&e.changeSet.updatedNames.PersonaSurnames.newValue||e.originalContact&&e.originalContact.Surname,r=t||n,o=e.changeSet.updatedProfilePhoto||e.profilePhotoUrl&&e.profilePhotoUrl.uri;return r?(o?e.strings.changeContactPhotoFor:e.strings.addContactPhotoFor)({p0:t||"",p1:n||""}):o?e.strings.changeContactPhoto:e.strings.addContactPhoto}var Ro=Object(c.a)(Object(P.b)(function(e,t){var n=Un.getSelectors(e);return{editorState:n.editorState,originalContact:n.originalContact,changeSet:n.changeSet,errorState:n.errorState,mostRecentPropertyUri:n.mostRecentPropertyUri,strings:Do(t.contactEditorStrings)}},function(e,t){return{dispatch:e,onUpdateWorkDetail:function(t){return e(z({workDetail:t}))},onUpdateName:function(t,n,r){return e(k({fieldType:t,oldValue:n,newValue:r}))},onUpdatePhone:function(t){return e(j({phone:t}))},onPostalAddressEditStarted:function(t){return e(D({postalAddress:t}))},onUpdatePostalAddress:function(t){return e(T({postalAddress:t}))},onUpdateOtherContactProp:function(t){return e(B({otherContactProp:t}))},onRemoveOtherContactDateProp:function(t){return e(W({otherContactDateProp:t}))},onUpdateIm:function(t){return e(R({im:t}))},onBlurEmail:function(t){return e(I({email:t}))},onUpdateEmail:function(t){return e(H({email:t}))},onUpdatePersonalNote:function(t){return e(G({note:t}))},onFavoriteStarClicked:function(t){return e(oe({newIsFavoriteValue:t}))},onUpdateProfilePhoto:function(t){return e(ae({dataUri:t}))},onResetErrorState:function(){return e(ie())}}},function(e,t,n){var r=ko({},n,e,t);return ko({},r,{onSaveButtonClick:function(){return function(e,t){if("saving"!==t.editorState){var n=yn(t.changeSet);n?e(X({message:t.strings.saveErrorDialogTitleError,propertyUri:n})):(e(K()),function(e,t){Vo(this,void 0,void 0,function(){var n,r;return jo(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.saveChanges(t.originalContact&&t.originalContact.PersonaId&&t.originalContact.PersonaId.Id||null,t.originalContact,(a=$t(t.changeSet,t.originalContact||void 0),a.map(function(e){return"PersonaBodies"===e.propertyUri?nt({},e,{newValue:e.newValue||" "}):e})),t.changeSet.updatedProfilePhoto)];case 1:return(n=o.sent()).success?(t.onClose(n.owsPersona&&n.owsPersona.PersonaId&&n.owsPersona.PersonaId.Id||null),e(te())):e(re({error:n.message})),[3,3];case 2:return r=o.sent(),e(re({error:To(r)})),[3,3];case 3:return[2]}var a})})}(e,t))}}(t.dispatch,r)},onCancelButtonClick:function(){return function(e,t){e(J()),Lo(e,t,!1)}(t.dispatch,r)},onNotSaveButtonInDialogClick:function(){return function(e,t){e(Z()),Lo(e,t,!0)}(t.dispatch,r)},onCancelButtonInDialogClick:function(){return function(e,t){"loadErrorDialogOpen"===t.editorState&&Lo(e,t,!0),e(q())}(t.dispatch,r)},onRetryLoadInDialogClick:function(){return function(e,t){e($()),t.onRetryLoad()}(t.dispatch,r)},onExternalCancel:function(){return function(e,t){e(ee()),Lo(e,t,!1)}(t.dispatch,r)}})})(Uo)),Fo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getOriginalContact=function(){return Vo(t,void 0,void 0,function(){var e,t,n,a,s;return jo(this,function(c){switch(c.label){case 0:e=Object(i.b)(this).reduxStore||Object(r.throwError)("redux store not found"),t=e.dispatch,n=void 0,a=void 0,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.props.getOriginalContact()];case 2:return n=c.sent(),[3,4];case 3:return s=c.sent(),a=s,[3,4];case 4:switch(this.props.editorMode){case"AddContact":n&&t(O({originalContact:n})),t(C({originalContact:null}));break;case"NewContact":t(C({originalContact:null}));break;case"EditContact":a?t(N({error:To(a)})):n?n.PersonaId&&n.PersonaId.Id?t(C({originalContact:n,focusPropertyUri:this.props.focusPropertyUri})):t(N({error:"GetOriginalContactReturnedEmptyPersona"})):t(N({error:"GetOriginalContactReturnedNull"}));break;default:return[2,Object(o.g)(this.props.editorMode)]}return[2]}})})},t}return wo(t,e),t.prototype.componentWillMount=function(){this.props.isOpen&&this.startEditing()},t.prototype.componentWillReceiveProps=function(e){!this.props.isOpen&&e.isOpen&&this.startEditing()},t.prototype.render=function(){var e=this.props.isOpen?y.createElement(Ro,ko({},this.props,{onRetryLoad:this.getOriginalContact})):null;return y.createElement(m.a,{isBlocking:!0,isOpen:this.props.isOpen,className:"lpc_nested_popup",titleAriaId:"lpc-contact-editor-title"},e)},t.prototype.startEditing=function(){var e=Object(i.b)(this).reduxStore||Object(r.throwError)("redux store not found");"NewContact"===this.props.editorMode?e.dispatch(A({focusPropertyUri:this.props.focusPropertyUri||null,initialValues:this.props.initialValues||[]})):(e.dispatch(E({focusPropertyUri:this.props.focusPropertyUri||null})),this.getOriginalContact())},t.contextTypes=ko({},s.b),t}(y.Component);n.d(t,"ContactEditor",function(){return Fo}),n.d(t,"ContactEditorStore",function(){return Un})},717:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(2),o=n.n(r),a=n(680),i=n(570),s=n(4),c=n(440),l=function(){return(l=o.a||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},d=Object(a.b)(function(e){return l({},e,{disableGlobalClassNames:!0})}),u=Object(c.a)(function(e){return s.createElement(i.a,{settings:{theme:d(e.theme)}},e.children)})},766:function(e,t,n){"use strict";var r=n(1087),o=n(4),a=n(717),i=n(440),s=n(90),c=n(26),l=n(680),d=Object(l.b)(function(e){var t=document.documentElement&&document.documentElement.getAttribute("dir"),n=e.palette;return Object(c.W)({root:{position:"absolute",width:"36px",height:"36px",transform:t===s.a.RightToLeft?"translate(50%, 100%)":"translate(-50%, 100%)",zIndex:1,boxSizing:"border-box",top:"-4px",padding:0,color:n.white,backgroundColor:n.neutralSecondary,borderRadius:"50%",border:"2px solid "+n.white,backgroundClip:"padding-box"},icon:{color:n.white},rootHovered:{width:"40px",height:"40px",top:"-10px",backgroundColor:n.neutralPrimaryAlt}})});n.d(t,"a",function(){return u});var u=Object(i.a)(function(e){var t=e.children,n=e.onClick,i=e.title,s=e.theme,c=d(s);return o.createElement(a.a,null,o.createElement(r.a,{iconProps:{iconName:"Camera"},onClick:n,"data-log-name":"PhotoPickerButton",ariaLabel:i,title:i,styles:c}),t)})}}]);