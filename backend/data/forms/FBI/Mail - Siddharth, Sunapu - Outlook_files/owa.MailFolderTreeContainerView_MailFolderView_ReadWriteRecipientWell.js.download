self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[47],{2070:function(e,t,n){"use strict";var r=n(1),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=i},2427:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(4),i=n(2070),a=n(15);function s(e,t,n,i){return o(u(e),t,n,i,function(t,n){Object(a.o)("RecipientCacheHitIndex",[Math.ceil(n/50),!Object(r.g)(e),t.sessionAdd])})}function c(e,t,n,r){return o(e,t,n,r)}function o(e,t,n,r,a){for(var s=[],c=0;s.length<t&&i.a.recipientCache&&c<i.a.recipientCache.length;){var o=i.a.recipientCache[c];if(e(o)){var u=!1,d=o.EmailAddress;n&&l(d,n)&&(u=!0),r&&r.indexOf(d.MailboxType)>=0&&(u=!0),u||(s.push(o),a&&a(o,c))}c++}return s}var u=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}};function l(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}},2434:function(e,t,n){"use strict";function r(e){if(e){var t=(e=(e=e.replace(/['"]+/g,"")).trim()).split(/([<\[\({])+/g),n=void 0,r=e;return t.length>=3&&(n=t.slice(0,t.length-2).join("").trim(),r=t[t.length-1].split(/([>\]\)}])+/g)[0].trim()),{EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:r,Name:n||r}}}return{EmailAddress:{EmailAddress:e}}}n.d(t,"a",function(){return r})},3291:function(e,t,n){"use strict";var r=n(1505),i=n(8);t.a=Object(i.action)("updateFindResultTransactionId")(function(e,t){var n,i="";t&&(Object(r.a)()?(n=t).Groups&&n.Instrumentation&&(i=n.Instrumentation.TraceId):"Success"==(n=t).ResponseClass&&n.ResultSet&&(i=n.TransactionId));e.findResultTransactionId=i})},3293:function(e,t,n){"use strict";var r=n(4),i=n(8),a=n(3446),s=n.n(a),c=n(3447),o=n.n(c),u=n(27),l=n(11);function d(e){var t=o()({EntityFeedbackEntries:e});return s()({Header:Object(u.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){if(e&&e.Body){var t=e.Body;l.c.info(Object(r.b)("addEntityFeedback Error count: {0}",t.ErrorCount)),l.c.info(Object(r.b)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(d(e.entityFeedbackEntries),l.c.info(Object(r.b)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},3295:function(e,t,n){"use strict";var r=n(0),i=n(5),a=n(1515),s=n.n(a),c=n(855),o=n.n(c),u=n(1372),l=n.n(u),d=n(515),f=n.n(d),p=n(1088),b=n.n(p),m=n(65),O=n.n(m),h=n(1090),v=n.n(h),S=n(27),g=20,j=10,y="owa.react.compose",R="NewMail.To";function E(e){return f()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:e?g:j})}function A(e){return{__type:"FindPeopleContextInfo:#Exchange",RecipientsTo:e}}function I(e){if(Object(i.e)("rp-requestPersonaResponseShape")){var t=[O()({FieldURI:"PersonaEmailAddress"}),O()({FieldURI:"EmailAddresses"}),O()({FieldURI:"PersonaDisplayName"}),O()({FieldURI:"PersonaDisplayNames"}),O()({FieldURI:"PersonaId"}),O()({FieldURI:"PersonaType"})];return e&&t.push(O()({FieldURI:"FeatureData"})),b()({BaseShape:"IdOnly",AdditionalProperties:t})}return b()({BaseShape:"Default"})}function T(e){var t=e?R:y;return[s()({Key:"AppName",Value:"OWA"}),s()({Key:"AppScenario",Value:t})]}function P(e,t,n,r,i){var a=function(e,t,n,r,i){var a=["Mailbox"];return t&&a.push("Directory"),l()({IndexedPageItemView:E(t),PersonaShape:I(n),QuerySources:a,QueryString:e,SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,IncludeImplicitGroups:r,Context:T(r),ContextInfo:A(i||[])})}(e,t,n,r,i);return v()(o()({Header:Object(S.getJsonRequestHeader)(),Body:a})).then(function(e){return e.Body})}var _=n(3498),w=n(1505);function F(){return Object(w.a)()?_.a:P}var C=n(8),x=n(3328),D=n(3423),k=n(3297),N=Object(C.action)("postProcessSuggestionsResult")(function(e,t,n,r){1==e.findResultSet.length&&r&&Object(D.a)(e)?Object(x.a)(e,[{isValid:!0,newPersona:e.findResultSet[0],newEmailAddress:null}]):(e.findResultType=n,Object(k.a)(e,!0,!1,t))}),M=n(3428);function q(e,t){Object(w.a)()?function(e,t){var n,i;try{for(var a=r.__values(t.Groups),s=a.next();!s.done;s=a.next()){var c=s.value;if("People"===c.Type){var o=c.Suggestions.filter(function(t){return null==e[t.EmailAddresses?t.EmailAddresses[0]:""]});c.Suggestions=o;break}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e,t):function(e,t){var n=t.ResultSet.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]});t.ResultSet=n}(e,t)}var L=n(3575),W=Object(C.action)("processResponseResults")(function(e,t,n,r,i){if(n){var a=new Map;e.forEach(function(e){a[e.EmailAddress.EmailAddress]=e}),q(a,t)}Object(w.a)()?Object(M.a)(e,t,n,r,i):Object(L.a)(e,t,n,r)}),J=n(3306),G=n(3305),U=n(3324),Q=n(3291),B=n(6),V=n(2213),H=n(4),z=n(3293),K=n(3314),X=n(66),$=n(11),Y=Object(C.action)("transactionCompleted")(function(e,t,n,r,i,a,s,c){if(void 0===c&&(c=null),e&&e.hasSessionStarted){var o={TransactionRequestTime:Object(B.mb)(i),TransactionRequestDuration:Object(B.w)(Object(B.Jb)(),i),QueryString:Object(H.g)(t)?"":t,QueryStringLength:Object(X.b)(t)?0:t.length,PersonaTypeList:s,ImpressionId:r};c&&Object.keys(c).forEach(function(e){o[e]=c[e]}),a&&(o.Context=a);var u=JSON.stringify(o),l=JSON.stringify(n),d=Object(K.a)(e,r,"TransactionCompleted",l,0,u);Object(z.a)(e,d,!1),$.c.info(Object(H.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),Z=n(3427);function ee(e,t){var n=[];e.findResultSet&&e.findResultSet.length>0&&e.findResultSet.forEach(function(e){n.push(Z.a[e.PersonaTypeString])});var r,i;Y(e.findPeopleFeedbackManager,e.queryString,(r=e.findResultSet,i=[],r&&r.forEach(function(e,t){i[t]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name}),i),e.findResultTransactionId,t,{Action:"Type Down"},n)}var te=Object(C.action)("autoSearchDirectory")(function(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var a,s,c;return r.__generator(this,function(r){switch(r.label){case 0:return a=F(),s=Object(B.Jb)(),Object(J.b)(e,s,null,!0),[4,a(n,!0)];case 1:return c=r.sent(),Object(G.a)(e,!1),e.queryString.trim()==n&&(20,Object(U.a)(e,n),W(e.findResultSet,c,!1,20,!0),Object(J.b)(e,s,c,!0),Object(Q.a)(e,c),ee(e,s),e.directorySearchType=V.a.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),N(e,t,V.b.SearchDirectory,i)),[2]}})})}),ne=n(1),re=n(3429),ie=n(3536),ae=n(3557),se=(Object(ne.orchestrator)(re.a,function(e){var t=e.targetRecipientWell,n=e.personaToRemove,r=e.shouldRemoveAllOccurrences,i=t.recipients.filter(function(e){return Object(ie.a)(e.persona,n)});if(i&&i.length>0){for(var a=r?i.length-1:0,s=[],c=0;c<=a;c++)i[c]&&!i[c].blockWellItemRemoval&&s.push(i[c]);s.length>0&&Object(ae.a)(t,s)}}),n(3558)),ce=(Object(ne.orchestrator)(se.a,function(e){var t=e.recipientWells;t&&0!==t.length&&e.emailAddresses.forEach(function(e){var n={EmailAddress:e};t.filter(function(e){return!!e}).forEach(function(e){return Object(re.a)(e,n,!0)})})}),n(3351)),oe=Object(ne.action)("addRecipientsToRecipientWell",function(e,t){return{newRecipients:e,recipientWellRecipients:t}}),ue=oe;Object(ne.mutator)(oe,function(e){var t,n=e.recipientWellRecipients;(t=n.recipients).splice.apply(t,r.__spread([n.recipients.length,0],e.newRecipients)),n.isDirty=!0});var le=Object(ne.mutatorAction)("resetRecipientWell",function(e){e&&(e.queryString="",e.findResultType=V.b.None)}),de=n(3474),fe=n(2070),pe=n(3559),be=Object(C.action)("addToCache")(function(e){e&&0!=e.length&&e.forEach(function(e){if("LinkedIn"!=e.PersonaTypeString){var t=Object(pe.a)(e);if(t&&!fe.a.allKeys[t]){var n=r.__assign({},e,{sessionAdd:!0});fe.a.recipientCache.push(n),fe.a.allKeys[t]=!0}}})}),me=n(3408),Oe=(Object(ne.orchestrator)(x.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,i,a,s,c,o,u,l,d,f,p,b,m,O;return r.__generator(this,function(h){switch(h.label){case 0:t=e.recipientWell,n=e.recipientData,i=e.resetFindResult,a=[];try{for(s=r.__values(n),c=s.next();!c.done;c=s.next())o=c.value,d=Object(ce.a)(o.newPersona,o.isValid,o.newEmailAddress),a.push(d)}catch(e){p={error:e}}finally{try{c&&!c.done&&(b=s.return)&&b.call(s)}finally{if(p)throw p.error}}ue(a,t),h.label=1;case 1:h.trys.push([1,7,8,9]),u=r.__values(a),l=u.next(),h.label=2;case 2:return l.done?[3,6]:(d=l.value,i&&t?(le(t),Object(k.a)(t,!0,!0),t.inForceResolve?[4,Object(de.a)(t,t.recipients)]:[3,4]):[3,4]);case 3:h.sent(),h.label=4;case 4:d.isValid&&be([d.persona]),h.label=5;case 5:return l=u.next(),[3,2];case 6:return[3,9];case 7:return f=h.sent(),m={error:f},[3,9];case 8:try{l&&!l.done&&(O=u.return)&&O.call(u)}finally{if(m)throw m.error}return[7];case 9:return Object(me.a)(t,n),[2]}})})}),Object(ne.createStore)("readwriterecipientwell",{pendingFindPeopleRequests:0})()),he=Object(C.action)("transactionFailed")(function(e,t,n,r,i,a){if(void 0===a&&(a=null),e&&e.hasSessionStarted){var s={TransactionRequestTime:Object(B.mb)(r),TransactionRequestDuration:Object(B.w)(Object(B.Jb)(),r),QueryString:Object(H.g)(t)?"":t,QueryStringLength:Object(X.b)(t)?0:t.length,ImpressionId:n};a&&Object.keys(a).forEach(function(e){s[e]=a[e]}),i&&(s.Context=i);var c=JSON.stringify(s),o=Object(K.a)(e,n,"TransactionFailed",null,0,c);Object(z.a)(e,o,!1),$.c.info(Object(H.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}});function ve(e,t){he(e.findPeopleFeedbackManager,e.queryString,e.findResultTransactionId,t,{Action:"Type Down"})}var Se=Object(C.action)("backfillCache")(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i;return r.__generator(this,function(r){return Oe.pendingFindPeopleRequests++,n=F(),i=Object(B.Jb)(),Object(J.b)(e,i,null),[2,n(t,!1,!1).then(function(n){try{var r=function(e){if(Object(w.a)()){var t=[];return Object(M.a)(t,e,!1),t}return e.ResultSet}(n);if(be(r),Oe.pendingFindPeopleRequests--,!function(e){if(Object(w.a)()){var t=e;return!t||!t.Groups}var t=e;return"Success"!=t.ResponseClass||0==t.ResultSet.length}(n)&&e.queryString==t){var a=e.findResultSet.length>0;Object(J.b)(e,i,n),W(e.findResultSet,n,a,5),Object(Q.a)(e,n),ee(e,i)}}catch(t){ve(e,i)}})]})})});var ge=n(3435),je=n(15),ye=Object(C.action)("setFindResultSet")(function(e,t){e.findResultSet=t});var Re=n(3353),Ee=Object(C.action)("processCacheResult")(function(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var s;return r.__generator(this,function(c){return i&&(s=new Map,e.findResultSet.forEach(function(e){s[e.EmailAddress.EmailAddress]=e}),t=function(e,t){return t.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]})}(s,t),(t=r.__spread(e.findResultSet,t)).splice(5)),Object(G.a)(e,!1),ye(e,t),Object(Q.a)(e),Object(Re.a)(e),N(e,n,V.b.Cache,a),[2]})})}),Ae=n(2427);function Ie(e,t){var n=Object(Ae.a)(e,5,t);return 0==n.length?[]:n.map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString}})}var Te=n(3321),Pe=Object(C.action)("findPeopleCacheFirst")(function(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var s,c,o;return r.__generator(this,function(r){switch(r.label){case 0:if(s=V.b.Cache,c=new je.a(ge.a.SearchCacheFirst.name),e.directorySearchType=V.a.None,Object(G.a)(e,!0),function(e,t,n,r,i){var a=Object(B.Jb)(),s=Ie(e,Object(Te.a)(t));Object(J.a)(n,a,s),Ee(n,s,t,r,i)}(t,n,e,i,a),Object(U.a)(e,t),!(e.findResultSet.length<5))return[3,6];r.label=1;case 1:return r.trys.push([1,5,,6]),e.findResultSet.length>0&&Oe.pendingFindPeopleRequests<3?(Se(e,t),s=V.b.MixedCacheLive,[3,4]):[3,2];case 2:return 0!=e.findResultSet.length?[3,4]:[4,Se(e,t)];case 3:r.sent(),s=V.b.FindPeople,r.label=4;case 4:return[3,6];case 5:return o=r.sent(),Oe.pendingFindPeopleRequests--,c.endWithError("ServerError",o),[3,6];case 6:return e.findResultSet.length>0?(N(e,n,s,a),[3,9]):[3,7];case 7:return[4,te(e,n,t,a)];case 8:r.sent(),s=V.b.SearchDirectory,r.label=9;case 9:return Object(G.a)(e,!1),c.addCustomData([s,t==e.queryString]),c.end(),[2]}})})}),_e=5;var we=n(3424),Fe=n(3440),Ce=Object(C.action)("searchCacheFallback")(function(e,t,n,i,a,s){return r.__awaiter(this,void 0,void 0,function(){var c,o;return r.__generator(this,function(r){return e.queryString.trim()==t.trim()&&(c=Object(B.Jb)(),o=Ie(t,Object(Te.a)(n)),Object(J.a)(e,c,o,!0),Object(U.a)(e,t),e.directorySearchType=V.a.None,o.length>0?Ee(e,o,n,i,a):s&&(s.isCacheEmpty=!0)),[2]})})});t.a=Object(C.action)("findReadWriteRecipient")(Object(C.select)({store:function(){return Oe}})(function(e,t,n,a,s,c,o,u){return r.__awaiter(this,void 0,void 0,function(){var l,d,f,p,b,m,O,h,v,S,g,j,y,R,E,A,I;return r.__generator(this,function(T){switch(T.label){case 0:return n||Object(J.c)(e),l=Object(we.a)(e,s),d=!1,e.shouldShowFindResult||Object(k.a)(e,!0,!1,l),c&&c.length>0&&(f=function(e,t){var n=[];if(t){var r=0;for(e=e.toLowerCase();n.length<_e&&r<t.length;){var i=t[r].persona.EmailAddress;(i.EmailAddress&&0==i.EmailAddress.toLowerCase().indexOf(e)||i.Name&&0==i.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:i}),r++}}return n}(t,c))&&f.length>0&&(e.findResultSet=f,d=!0),!o&&!Object(i.e)("rp-peopleSuggestionsCacheFirst")||n?[3,2]:[4,Pe(e,t,l,d,a)];case 1:return T.sent(),[2];case 2:return p=!1,u.store.pendingFindPeopleRequests<3?(I=new je.a(ge.a.SearchPeopleIndex.name),Object(G.a)(e,!0),b=e.currentRenderedQueryString,m=e.directorySearchType,Object(i.e)("rp-optimizeAutoSearchDirectory")&&""!=b&&!n&&m==V.a.Auto&&b.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)?[4,te(e,l,t,a)]:[3,4]):[3,14];case 3:return T.sent(),p=!0,I.addCustomData([!1,!0,!0,!1,!0,Object(w.a)()]),I.end(),[3,13];case 4:O={isTimedOut:!1,isCacheEmpty:!1},h=n||Object(Fe.a)()?null:setTimeout(function(e,t,n,i,a,s){return function(){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return s.isTimedOut=!0,[4,Ce(e,n,t,i,a,s)];case 1:return r.sent(),[2]}})})}}(e,l,t,d,a,O),1e3),v=Object(B.Jb)(),T.label=5;case 5:return T.trys.push([5,11,,13]),u.store.pendingFindPeopleRequests++,S=F(),g=[],l.forEach(function(e){g.push(e.persona.EmailAddress.EmailAddress)}),Object(J.b)(e,v,null,n),[4,S(t,n,null,Object(i.e)("cmp-implicitgroups"),g)];case 6:return j=T.sent(),u.store.pendingFindPeopleRequests--,clearTimeout(h),y=e.queryString==t,Object(J.b)(e,v,j,n),O.isTimedOut&&!O.isCacheEmpty||!y?[3,10]:(Object(U.a)(e,t),e.directorySearchType=n?V.a.Manual:V.a.None,R=n?20:5,W(e.findResultSet,j,d,R,n),ee(e,v),e.findResultSet.length>0?(Object(G.a)(e,!1),Object(Q.a)(e,j),E=n?V.b.SearchDirectory:V.b.FindPeople,N(e,l,E,a),[3,10]):[3,7]);case 7:return[4,Ce(e,t,l,d,a)];case 8:return T.sent(),0!==e.findResultSet.length?[3,10]:(p=!0,[4,te(e,l,t,a)]);case 9:T.sent(),T.label=10;case 10:return I.addCustomData([O.isTimedOut,y,n,O.isCacheEmpty,p,Object(w.a)()]),I.end(),[3,13];case 11:return A=T.sent(),I.endWithError("ServerError",A),ve(e,v),[4,Ce(e,t,l,d,a)];case 12:return T.sent(),[3,13];case 13:return[3,16];case 14:return I=new je.a("FindPeopleThresholdHit"),[4,Ce(e,t,l,d,a)];case 15:T.sent(),I.end(),T.label=16;case 16:return Object(G.a)(e,!1),[2]}})})}))},3297:function(e,t,n){"use strict";var r=n(3291),i=n(3424),a=n(3425),s=n(3426),c=n(3402),o=n(3353),u=n(3321),l=n(8);t.a=Object(l.action)("showHideFindResult")(function(e,t,n,l){var d=e.findResultSet?e.findResultSet.length:0;if(e.findResultHightlightIndex=-1,n&&d&&e.findResultSet.splice(0,d),t)if(Object(s.a)(e.findPeopleFeedbackManager),0!=e.queryString.length||e.inForceResolve)e.findResultHightlightIndex=0;else{var f=Object(i.a)(e,l);Object(c.a)(e.findResultSet,Object(u.a)(f)),Object(r.a)(e),Object(o.a)(e)}else Object(a.a)(e.findPeopleFeedbackManager);e.shouldShowFindResult=t})},3305:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setIsSearching")(function(e,t){e.isSearching!=t&&(e.isSearching=t)})},3306:function(e,t,n){"use strict";var r=n(6),i=n(1505);n.d(t,"c",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var a="Cache",s="Mailbox",c="Directory",o=" Fallback";function u(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function l(e,t,n,a){if(i.a&&e.peopleFeedbackState){var o={TraceId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};o.TimeStamp=Object(r.wb)(t),o.QueryString=e.queryString,o.SuggestionSource=a?c:s;var u=n;o.RawResponse=u?JSON.stringify(u):"pending",u&&u.Instrumentation&&(o.TraceId=u.Instrumentation.TraceId),a?e.peopleFeedbackState.directory=o:e.peopleFeedbackState.live=o}}function d(e,t,n,s){if(Object(i.a)()&&e.peopleFeedbackState){var c={TraceId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};c.QueryString=e.queryString,c.TimeStamp=Object(r.wb)(t),c.SuggestionSource=s?a+o:a,c.RawResponse=JSON.stringify(n),e.peopleFeedbackState.cache=c}}},3314:function(e,t,n){"use strict";var r=n(4),i=n(8),a=Object(i.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),s=n(66),c=n(11),o=n(6);function u(e,t,n,i,u,l,d,f){if(void 0===f&&(f=Object(o.Jb)()),!e)return c.c.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(s.b)(e.clientSessionId))return c.c.warn(Object(r.b)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var p={ClientEventTimeUtc:Object(o.ob)(f),ClientEventTimeLocal:Object(o.mb)(f),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:l,ScenarioName:d||e.entityScenarioName};return a(e),p}n.d(t,"a",function(){return u})},3321:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map(function(e){return e.persona})),t}n.d(t,"a",function(){return r})},3324:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("updateCurrentRenderedQueryString")(function(e,t){e.currentRenderedQueryString=t})},3328:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("addReadWriteRecipients",function(e,t,n){return void 0===n&&(n=!0),{recipientWell:e,recipientData:t,resetFindResult:n}});t.a=i},3351:function(e,t,n){"use strict";var r=n(2074),i=n(1219),a=n(41),s=n(3512);t.a=function(e,t,n){e||(e={EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:n,Name:n}});var c=!e.EmailAddress.Name||Object(s.a)(e.EmailAddress.Name)?e.EmailAddress.EmailAddress:e.EmailAddress.Name;if(!Object(a.a)()){var o=e.EmailAddress.EmailAddress?e.EmailAddress.EmailAddress.split("@")[1]:"",u="ExternalMailbox"===e.EmailAddress.MailboxType||"LinkedIn"===e.EmailAddress.MailboxType;!c||Object(i.a)(c)&&c.split("@")[1]===o||!u||(c=c+" ("+o+")")}return{persona:e,displayText:c,isValid:t,isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:r.a.None,members:[]}}},3353:function(e,t,n){"use strict";var r=n(4),i=n(3293),a=n(3314),s=n(6),c=n(66),o=n(11),u=n(8),l=n(86),d=Object(u.action)("localCacheTransactionCompleted")(function(e,t,n,u,d,f){if(void 0===f&&(f=Object(s.Jb)()),e&&e.hasSessionStarted){var p={TransactionRequestTime:Object(s.mb)(f),TransactionRequestDuration:Object(s.w)(Object(s.Jb)(),f),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(c.b)(t)?0:t.length,FeatureData:null!=u?u:void 0,personaTypeList:d,ImpressionId:Object(l.a)()},b=JSON.stringify(p),m=JSON.stringify(n),O=Object(a.a)(e,"","LocalCacheTransactionCompleted",m,0,b);Object(i.a)(e,O,!1),o.c.info(Object(r.b)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),f=n(3427);function p(e){if(e.findResultSet&&e.findResultSet.length>0){var t=[];e.findResultSet.forEach(function(e){t.push(f.a[e.PersonaTypeString])}),d(e.findPeopleFeedbackManager,e.queryString,(n=e.findResultSet,r=[],n&&n.forEach(function(e,t){r[t]=e.EmailAddress.EmailAddress}),r),null,t)}var n,r}n.d(t,"a",function(){return p})},3358:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setCommonWellItemSelectedState")(function(e,t){e.isSelected=t})},3380:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(4),i=n(3314),a=n(11);function s(e,t){if(Object(r.g)(e.clientSessionId))return a.c.warn(Object(r.b)("{0} - Attempting to create session feedback entry with empty client session id",e.entityScenarioName)),null;var n="";t&&(n=null==t.recipientEmailAddresses?"":JSON.stringify(t.recipientEmailAddresses));var s="";if(!Object(r.g)(t.endSessionAction)){var c={EndSessionAction:t.endSessionAction};s=JSON.stringify(c)}return Object(i.a)(e,"",t.eventType,n,0,s)}},3387:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("updateIsEditing")(function(e,t){e.isEditing=t})},3402:function(e,t,n){"use strict";var r=n(0),i=n(2427),a=n(8);t.a=Object(a.action)("getAndPopulateSuggestedContacts")(function(e,t){var n=Object(i.a)("",5,t).map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId}});e.splice.apply(e,r.__spread([0,e.length],n))})},3403:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setForceResolveState")(function(e,t){e.inForceResolve=t})},3408:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("onRecipientsChanged",function(e,t){return{recipientWellRecipients:e,recipientData:t}});t.a=i},3423:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}n.d(t,"a",function(){return r})},3424:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3423);function i(e,t){return Object(r.a)(e)?e.recipients:t||[]}},3425:function(e,t,n){"use strict";var r=n(4),i=n(3293),a=n(3380),s=n(11),c=n(8);t.a=Object(c.action)("pauseSession")(function(e){if(e&&e.hasSessionStarted&&!e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionPaused",recipientEmailAddresses:null,endSessionAction:null});Object(i.a)(e,t,!1),e.isSessionPaused=!0,s.c.info(Object(r.b)("{0} pauseSession : Session paused. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},3426:function(e,t,n){"use strict";var r=n(4),i=n(3293),a=n(3380),s=n(11),c=n(8);t.a=Object(c.action)("resumeSession")(function(e){if(e&&e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionResumed",recipientEmailAddresses:null,endSessionAction:null});Object(i.a)(e,t,!1),e.isSessionPaused=!1,s.c.info(Object(r.b)("{0} FeedbackManagerBase.ResumeSession: Session resumed. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},3427:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},3428:function(e,t,n){"use strict";var r=n(0),i=n(8),a=n(3533);t.a=Object(i.action)("processSubstrateSuggestionsResponse")(function(e,t,n,i,s){var c,o;if(!t||!t.Groups)throw new Error("Response groups should not be null");var u=[];i=i||20,i=n?i-e.length:i;try{for(var l=r.__values(t.Groups),d=l.next();!d.done;d=l.next()){var f=d.value;if("People"===f.Type){f.Suggestions.forEach(function(e){if(u.length<i){var t=Object(a.a)(e,s);t&&u.push(t)}});break}}}catch(e){c={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(c)throw c.error}}n?e.push.apply(e,r.__spread(u)):e.splice.apply(e,r.__spread([0,e.length],u))})},3429:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("removePersonaFromWell",function(e,t,n){return void 0===n&&(n=!1),{targetRecipientWell:e,personaToRemove:t,shouldRemoveAllOccurrences:n}});t.a=i},3435:function(e,t,n){"use strict";t.a={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:function(e,t){return{index:(e>23?23:e).toString(),source:t.toString()}}},SearchCacheFirst:{name:"SearchCacheFirst"}}},3440:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2070);function i(){return null===r.a.recipientCache||0==r.a.recipientCache.length}},3446:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),i=n(3473);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("AddEntityFeedback",e,t)}},3447:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackRequest:#Exchange"},e)}},3473:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackJsonRequest:#Exchange"},e)}},3474:function(e,t,n){"use strict";var r=n(0),i=n(3588),a=n(3403),s=n(3297),c=n(3387),o=n(8),u=n(15);t.a=Object(o.action)("resolveAllUnresolvedRecipients")(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var o,l,d;return r.__generator(this,function(r){switch(r.label){case 0:return Object(a.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(n&&n(),[4,Object(i.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(o=-1,l=0;l<t.length;l++)if(t[l].persona&&t[l].persona.EmailAddress&&!t[l].persona.EmailAddress.EmailAddress&&"PrivateDL"!=(d=t[l].persona).EmailAddress.MailboxType&&Object(u.o)("EmptyEmailAddress",[d.EmailAddress.MailboxType,d.EmailAddress.RoutingType]),!t[l].isValid){o=l;break}-1!=o?Object(c.a)(t[o],!0):(Object(a.a)(e,!1),Object(s.a)(e,!1)),r.label=3;case 3:return[2]}})})})},3484:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"]},3498:function(e,t,n){"use strict";var r=n(0),i=n(3303);function a(){return"Bound"==Object(i.e)().status}var s=n(5),c=n(86),o=n(67),u=n(41),l=n(3484),d=n(267),f=n(11),p=n(229);n.d(t,"a",function(){return j});var b="/search/api/v1/init?",m="https://outlook.office365.com/search",O="https://substrate.office.com/SubstrateSearch-Internal.ReadWrite",h="/search/api/v1/suggestions?",v="owa.react.compose",S="20",g="5";function j(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var i,s,u,l;return r.__generator(this,function(r){switch(r.label){case 0:return""!=e?[3,1]:[2,y()];case 1:return[4,R(e,t,n,a)];case 2:return i=r.sent(),s=function(e){return{AppName:"OWA",Scenario:{Name:v},Cvid:Object(c.a)(),EntityRequests:[e]}}(i),u=o.d,l=[h+A(),s,void 0,!1],[4,I()];case 3:return[2,u.apply(void 0,l.concat([r.sent(),void 0,void 0,!1])).then(function(e){return e}).catch(function(e){return f.c.error(e),null})]}})})}function y(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return Object(u.a)()&&Object(s.e)("rp-linkedInPeopleSuggestions")&&a()?((e={}).headers=new Headers,[4,Object(d.getDelegationTokenForOwa)(O)]):[3,3];case 1:return t=r.sent(),e.headers.set("X-User-Context","litoken=bearer"),e.headers.set("Authorization","Bearer "+t),(n=Object(p.getDefaultAnchorMailboxCookie)())&&e.headers.append("X-AnchorMailbox",n),e.method="GET",[4,fetch(window.location.origin+b+A(),e)];case 2:return(i=r.sent())&&200==i.status?[2,i]:(f.c.error("makeInitRequest: Unsuccessful response status"),[2,null]);case 3:return c=o.b,l=[b+A(),void 0,!0],[4,I()];case 4:return[2,c.apply(void 0,l.concat([r.sent(),void 0,!1])).then(function(e){return e.json()}).catch(function(e){return f.c.error(e),null})]}})})}function R(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var c,o;return r.__generator(this,function(r){return c=Object(s.e)("rp-linkedInPeopleSuggestions")&&a(),o={Query:{QueryString:e},EntityType:"People",Provenances:E(t,c),Size:t?S:g},i&&i.length>0&&(o.Context=function(e){var t={};e&&(t.RecipientsTo=e.toString());return t}(i)),o.Fields=l.a,n&&o.Fields.push("FeatureData"),[2,o]})})}function E(e,t){var n=["Mailbox"];return e&&n.push("Directory"),t&&n.push("LinkedIn"),n}function A(){var e={scenario:v};return Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")}function I(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return Object(s.e)("rp-linkedInPeopleSuggestions")&&a()?Object(u.a)()?[2,{"X-User-Context":"litoken=bearer"}]:[4,Object(d.getAccessTokenforResource)(m)]:[3,2];case 1:return[2,{"X-User-Context":"litoken="+e.sent()}];case 2:return[2,null]}})})}},3512:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=["\t","\n","\v","\f","\r"," ",""," "," "," "," "," "," "," "," "," "," "," "," "," ","\u2028","\u2029"," "," ","　","؜","​","‌","‍","‎","‏","\u2028","\u2029","‪","‫","‬","‭","‮"," ","⁠","⁦","⁧","⁨","⁩"],i=null,a=function(e){return null===i&&(i=new Set,r.forEach(function(e){return i.add(e)})),e.split("").every(function(e){return i.has(e)})}},3533:function(e,t,n){"use strict";var r=n(4),i=n(1512);function a(e,t){var n=e.EmailAddresses,a=e.DisplayName,u=e.Text,l=e.PDLItemId,d=e.ADObjectId,f=e.PersonaId,p=e.FeatureData,b=e.Id,m=e.ImAddress,O=e.JobTitle,h=e.PeopleSubtype,v=n?n[0]:null;if(!t&&function(e){return Object(i.b)().sessionMaskedRecipients[e]}(v))return null;var S={EmailAddress:v,Name:Object(r.g)(a)?u:a,MailboxType:o(h),RoutingType:s(h),ItemId:l?{Id:l,__type:"ItemId:#Exchange"}:null};return{DisplayName:a,ADObjectId:d,FeatureData:p,Id:b,ImAddress:m,EmailAddress:S,EmailAddresses:[S],PersonaTypeString:c(h),PersonaId:{Id:f},Title:O}}function s(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function c(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function o(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}n.d(t,"a",function(){return a})},3536:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",function(){return r})},3537:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("removeRecipientFromRecipientWell",function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,selectToRight:n,onRecipientDeletedCallback:r}});t.a=i,Object(r.orchestrator)(i,function(e){e.recipientWellRecipients.isDirty=!0;var t=e.recipientWellRecipients.recipients.splice(e.recipientIndex,1);e.onRecipientDeletedCallback(t,e.recipientIndex,e.recipientWellRecipients,e.selectToRight)})},3557:function(e,t,n){"use strict";var r=n(0),i=n(3408),a=n(3537),s=n(3358),c=n(8);function o(e,t,n,r){e[0].isSelected&&n.recipients.length>0&&Object(s.a)(n.recipients[r?Math.min(t,n.recipients.length-1):Math.max(0,t-1)],!0)}t.a=Object(c.action)("removeReadWriteRecipients")(function(e,t,n,s){var c,u;void 0===s&&(s=!0);var l=!1;try{for(var d=r.__values(t),f=d.next();!f.done;f=d.next()){var p=f.value,b=-1;if((b="number"==typeof p?p:e.recipients.indexOf(p))>=0){if(e.recipients[b].blockWellItemRemoval)return;Object(a.a)(b,e,n,o),l=!0}}}catch(e){c={error:e}}finally{try{f&&!f.done&&(u=d.return)&&u.call(d)}finally{if(c)throw c.error}}s&&l&&Object(i.a)(e)})},3558:function(e,t,n){"use strict";var r=n(1),i=Object(r.action)("removeRecipientsFromRecipientWells",function(e,t){return{emailAddresses:e,recipientWells:t}});t.a=i},3559:function(e,t,n){"use strict";function r(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}n.d(t,"a",function(){return r})},3575:function(e,t,n){"use strict";var r=n(0),i=n(8);t.a=Object(i.action)("processFindPeopleResult")(function(e,t,n,i){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;for(var c=[],o=0;o<i;o++){var u=t.ResultSet[o];u.EmailAddress?c.push({EmailAddress:a(u.EmailAddress),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName}):"ImplicitGroup"==u.PersonaTypeString&&c.push({EmailAddress:s(u),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,Members:u.Members,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName})}n?e.push.apply(e,r.__spread(c)):e.splice.apply(e,r.__spread([0,e.length],c))});var a=function(e){return e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?r.__assign({},e,{EmailAddress:e.OriginalDisplayName}):e},s=function(e){return{EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"}}},3588:function(e,t,n){"use strict";var r=n(0),i=n(3328),a=n(3295),s=n(8),c=Object(s.action)("setDirectorySearchType")(function(e,t){e.directorySearchType=t}),o=n(3305),u=n(3297),l=n(2434),d=n(2213),f=n(1219);t.a=Object(s.action)("resolveQueryStringToRecipient")(function(e,t,n,s){return r.__awaiter(this,void 0,void 0,function(){var p,b;return r.__generator(this,function(r){switch(r.label){case 0:return c(e,n?d.a.Manual:d.a.None),(p=e.queryString.trim())?t?(Object(o.a)(e,!1),b=Object(l.a)(p),Object(i.a)(e,[{isValid:Object(f.a)(b.EmailAddress.EmailAddress),newPersona:b}]),[3,4]):[3,1]:[3,5];case 1:return e.queryString.indexOf("@")>=0&&e.inForceResolve?(Object(o.a)(e,!1),Object(i.a)(e,[{isValid:Object(f.a)(p),newPersona:null,newEmailAddress:p}]),[3,4]):[3,2];case 2:return Object(o.a)(e,!0),[4,Object(a.a)(e,e.queryString,n,s)];case 3:r.sent(),r.label=4;case 4:return[3,6];case 5:Object(o.a)(e,!1),Object(u.a)(e,!0,!0),r.label=6;case 6:return[2]}})})})}}]);
//# sourceMappingURL=owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js.map
self.scriptsLoaded['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = (new Date()).getTime();