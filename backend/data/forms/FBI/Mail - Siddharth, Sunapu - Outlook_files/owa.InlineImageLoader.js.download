self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.InlineImageLoader.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[271],{1369:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(467),o=n(468),a=n(469),i=n(223);t.getJsonRequestHeader=function(e){return r.default({RequestServerVersion:"Exchange2015",TimeZoneContext:o.default({TimeZoneDefinition:a.default({Id:null!=e?e:"Pacific Standard Time"})})})},t.getExtendedPropertyUri=function(e,t,n){return i.default({PropertySetId:e,PropertyName:t,PropertyType:n})}},1743:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return h});var r=n(0),o=n(4),a=n(2424),i=n(2433),u=n.n(i),c=n(9),s=n(15),d=n(11),f=Object(a.b)({timeBetweenRetryInMS:function(){return 3e4}}),l=function(){function e(e,t,n){var a=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(a,void 0,void 0,function(){function e(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,u()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),d.c.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,o,a,i=this;return r.__generator(this,function(u){switch(u.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=f(function(){return r.__awaiter(i,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,o=new s.b("AttachmentRefreshDownloadToken"),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,n()];case 2:return u.sent(),o.addCustomData([t]),o.end(),[3,4];case 3:return a=u.sent(),d.c.warn("Retry to refresh token failed: "+a),o.addCustomData([t]),o.endWithError("ServerError",a),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(o.g)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(c.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function m(){return l.getInstance().getDownloadToken()}function g(){return l.getInstance().getUseDownloadUrlBase()}function h(){return l.getInstance().getDownloadUrlBase()}},1744:function(e,t,n){"use strict";var r=n(2423);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var o=n(1743);n.d(t,"c",function(){return o.a})},2423:function(e,t,n){"use strict";var r=n(4),o=n(1743),a=n(41),i=n(180),u="/owa/",c="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",d="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",f="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",l="service.svc/s/GetAttachmentThumbnail?id={0}",m="pdfprint.aspx?id={0}",g="pdfprint.aspx?id={0}&location={1}",h=n(125),b=n(13);var v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var p=n(91);function w(e,t,n,o,a,c,d,l){var m;switch(void 0===a&&(a=0),void 0===c&&(c=0),void 0===d&&(d=!0),void 0===l&&(l=null),n){case 0:m=s;break;case 3:m=g;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&v.indexOf(t.toLowerCase())>=0}(l))return null;m=f;break;default:Object(p.a)(n)}var h=o?c:a;!h&&a&&(h=a);var b=Object(r.b)("{0}{1}&permissionLevel={2}",u,Object(r.b)(m,encodeURIComponent(e.Id),encodeURIComponent(t)),h);d&&(b=b+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)());return b}function O(e,t,n,s,f){var g;switch(void 0===s&&(s=!1),void 0===f&&(f=!0),n){case 0:g=c;break;case 1:g=d;break;case 2:g=l;break;case 3:g=m;break;default:return Object(p.a)(n)}return Object(r.g)(g)?null:Object(r.b)("{0}{1}{2}",function(e,t,n,c,s){if(void 0===s&&(s=!1),!t||!t.Id)return null;var d=Object(r.b)(n,encodeURIComponent(t.Id));if(!Object(o.c)()||s&&"Firefox"===Object(h.a)().browser)return u+d+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)();var f="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(a.a)()&&(f+="&isc=1");var l=Object(r.b)(f,Object(o.b)(),e,d,window.location.hostname,Object(b.j)()||"unofficial");return c&&(l+="&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)(),l+="&token="+Object(o.a)()),l}(e,t,g,f,3===n),s?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return w}),n.d(t,"a",function(){return O})},2424:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,o=!1,a=function(i,u){o?u(new Error("The function retry was cancelled")):(r++,e().then(function(e){return i(e)}).catch(function(e){t&&r>=t?u(e):setTimeout(function(){return a(i,u)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return a(e,t)})},cancel:function(){return o=!0}}}}function o(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o})},2433:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},3454:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(3844);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetClientAccessToken",e,t)}},3455:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},3457:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return u}),n.d(t,"f",function(){return c}),n.d(t,"q",function(){return s}),n.d(t,"m",function(){return d}),n.d(t,"l",function(){return f}),n.d(t,"j",function(){return l}),n.d(t,"k",function(){return m}),n.d(t,"g",function(){return g}),n.d(t,"o",function(){return h}),n.d(t,"n",function(){return b}),n.d(t,"p",function(){return v}),n.d(t,"i",function(){return p}),n.d(t,"h",function(){return w});var r="src",o="data-imagetype",a="crossorigin",i="data-itemid",u="data-inetid",c="use-credentials",s="AttachmentByCid",d="OnError",f="NullAttachmentUrl",l="DOMDetached",m="ImageMismatch",g="RP",h="DataUri",b="CrossDomain",v="SameDomain",p="ImageProxySkipForConsumerChild",w="ImageProxyConnectorsAuthTokenFalse"},3500:function(e,t,n){"use strict";function r(e,t){return e.hasAttribute(t)?e.getAttribute(t):""}n.d(t,"a",function(){return r})},3678:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(15),o=n(11),a=new RegExp("[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}","i");function i(e,t,n,i,u,c,s,d,f,l,m,g,h,b){void 0===i&&(i=""),void 0===u&&(u=""),void 0===c&&(c=""),void 0===s&&(s=""),void 0===d&&(d=""),void 0===f&&(f=""),void 0===l&&(l=""),void 0===m&&(m=""),void 0===g&&(g=""),void 0===h&&(h=""),void 0===b&&(b="");var v=[e,t,n,i,u,c,s=function(e){if(!e)return"";var t="",n=e,r=e.indexOf(":");return r>=0&&(t=e.slice(0,r+1),n=e.slice(r+1)),t+(n=n.match(a)?"<GUID>":"<PII>")}(s),d,f,l,m,g,h,b];Object(r.o)("InlineImageLoadError",v),o.c.info("InlineImageLoadError: "+v)}},3728:function(e,t,n){"use strict";function r(e,t,n,r,o,a,i){void 0===r&&(r=""),void 0===o&&(o=""),void 0===a&&(a=""),void 0===i&&(i=""),e.addCustomData([t,n,r,o,a,i]),r&&r.length>0?e.endWithError("ClientError"):e.end()}n.d(t,"a",function(){return r})},3729:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(552),o="onload";function a(e,t,n,o){e.onload=function(e){var t=e.target;i(t),n&&n(t)},e.onerror=function(e){var t=e.target;i(t),o&&o(t)},e.setAttribute(r.b,r.d),e.src=t}function i(e){e.removeAttribute(o),e.removeAttribute(r.b),e.onload=null,e.onerror=null}},3844:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},e)}},3859:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(3457),o=n(3500),a=n(38),i=n(11),u=n(552),c="deeplink/read/",s="/owa/?debugJS=true&viewmodel=ReadMessageItem&InternetMessageID=";function d(e,t,n,a){var c="Please engage nickhu@microsoft.com with below data:\n",s=Object(o.a)(e,r.d);s&&(c+="Deeplink (React): "+f(s,!0)+"\n");var d=Object(o.a)(e,r.c);d&&(c+="Deeplink (MVVM): "+f(d,!1)+"\n");var l=e.src;l&&(c+="Src: "+l+"\n");var m=Object(o.a)(e,u.c);if(m&&(c+="OriginalSrc: "+m+"\n"),n){var g=n.status,h=n.contentType,b=n.detectedFormat,v=n.first10BytesBase64;g&&(c+="Status: "+g+"\n"),h&&(c+="ContentType: "+h+"\n"),b&&(c+="DetectedFormat: "+b+"\n"),v&&(c+="First10Bytes: "+v+"\n"),c+="MimeMatch: "+n.mimeMatched}a&&a>0&&(c+="Retried: "+a),i.c.error("Error loading inline image: "+t+".\n"+c)}function f(e,t){void 0===t&&(t=!0);var n=Object(a.n)();return t?n+Object(a.l)()+c+e:n+s+e}},401:function(e,t,n){"use strict";var r=n(862),o=n(42),a={};function i(e){var t=e.toLocaleLowerCase();if(!a[t]){var n={type:o.a.GroupMailbox,deprecatedMailboxId:e,primarySmtpAddress:e,routingKey:Object(o.c)()+e,returnModernConversationItems:!1,requestOptions:Object(r.a)(e)};a[t]=n}return a[t]}var u=n(1),c=Object(u.action)("EDIT_GROUP_SUCCESS",function(e,t){return{groupSmtp:e,photoUrl:t}}),s=Object(u.action)("ADD_GROUP_MEMBER_SUCCESS",function(e){return{groupSmtp:e}}),d=Object(u.action)("POPUP_OPENED",function(){return{isOpen:!0}}),f=Object(u.action)("POPUP_CLOSED",function(){return{isOpen:!1}}),l=Object(u.action)("DELETE_GROUP_SUCCESS",function(e){return{groupSmtp:e}});n.d(t,"n",function(){return r.a}),n.d(t,"m",function(){return i}),n.d(t,"l",function(){return c}),n.d(t,"j",function(){return s}),n.d(t,"q",function(){return d}),n.d(t,"p",function(){return f}),n.d(t,"k",function(){return l}),n.d(t,"r",function(){return"SwitchGroup"}),n.d(t,"o",function(){return"NavigateFromMeToWe"}),n.d(t,"g",function(){return"GroupHeader_SendEmail_Button_Clicked"}),n.d(t,"c",function(){return"GroupHeader_Email_Button_Clicked"}),n.d(t,"d",function(){return"GroupHeader_Files_Button_Clicked"}),n.d(t,"a",function(){return"GroupHeader_Calendar_Button_Clicked"}),n.d(t,"e",function(){return"GroupHeader_Notebook_Button_Clicked"}),n.d(t,"f",function(){return"GroupHeader_Planner_Button_Clicked"}),n.d(t,"i",function(){return"GroupHeader_Site_Button_Clicked"}),n.d(t,"b",function(){return"GroupHeader_CustomLeaveGroup_Button_Clicked"}),n.d(t,"h",function(){return"GroupHeader_Settings_Button_Clicked"})},4012:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(15),o="2d",a="canvas",i="image/png";function u(e){try{var t=document.createElement(a),n=e.naturalWidth,u=e.naturalHeight;if(n>0&&u>0||(Object(r.o)("CreateDataURIMissingNaturalDimensions"),n=e.width,u=e.height),n>0&&u>0)return t.width=n,t.height=u,t.getContext(o).drawImage(e,0,0),t.toDataURL(i)}catch(e){}return null}},4016:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4326),o=n(15);function a(){return new o.a(r.a)}},4325:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(3457),o="RequestError",a="RequestTimeout",i="RequestAbort",u="ImageZeroBytes",c="ImageInvalidLength",s=[{format:"JPEG",signature:new Uint8Array([255,216,255,224]),mime:/^image\/p?jpe?g$/i,expectedMime:"image/jpeg"},{format:"EXIF",signature:new Uint8Array([255,216,255,225]),mime:/^image\/p?jpe?g$/i},{format:"SPIFF",signature:new Uint8Array([255,216,255,232]),mime:/^image\/p?jpe?g$/i},{format:"CannonEOS",signature:new Uint8Array([255,216,255,226]),mime:/^image\/p?jpe?g$/i},{format:"SamsungD500",signature:new Uint8Array([255,216,255,227]),mime:/^image\/p?jpe?g$/i},{format:"PNG",signature:new Uint8Array([137,80,78,71,13,10,26,10]),mime:/^image\/png$/i,expectedMime:"image/png"},{format:"GIF",signature:new Uint8Array([71,73,70,56]),mime:/^image\/gif$/i,expectedMime:"image/gif"},{format:"TIFF1",signature:new Uint8Array([73,32,73]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF2",signature:new Uint8Array([73,73,42,0]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF3",signature:new Uint8Array([77,77,0,42]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF4",signature:new Uint8Array([77,77,0,43]),mime:/^image\/(x-)?tiff$/i},{format:"BMP",signature:new Uint8Array([66,77]),mime:/^image\/bmp$/i}];function d(e,t){return void 0===t&&(t=!1),new Promise(function(n){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState){var e=d.status,t=d.getResponseHeader("Content-Type")||"";if(t.length>0){var o=t.indexOf(";");o>0&&(t=t.substr(0,o))}var a="",i=null,l="",m=!1,g="";if(200==e){var h=d.response;if(h&&0!=h.byteLength)if(h.byteLength<10)a=c;else{var b=function(e){for(var t=0;t<s.length;t++)for(var n=s[t],r=0;r<n.signature.length&&n.signature[r]==e[r];r++)if(r==n.signature.length-1)return n;return null}(i=new Uint8Array(d.response,0,10));b&&(l=b.format,(m=t&&b.mime.test(t))||(a=r.k,g=b.expectedMime))}else a=u}n({status:a,responseCode:e,contentType:t,detectedFormat:l,first10BytesBase64:i?f(i):"",mimeMatched:m,expectedMime:g})}},d.ontimeout=function(){n({status:a})},d.onerror=function(){n({status:o})},d.onabort=function(){n({status:i})},t&&(d.withCredentials=!0),d.open("GET",e,!0),d.responseType="arraybuffer",d.send()})}function f(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}},4326:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="InlineImageLoad"},4418:function(e,t,n){"use strict";var r,o,a=n(0),i=n(15),u=n(5),c=n(3455),s=n.n(c),d=n(3454),f=n.n(d),l=n(1369),m=n(41),g=n(267),h=n(460),b="GetConnectorsLTITokenFailure",v="GetConnectorsLTITokenException",p="GetConnectorsLTITokenNull",w="ConnectorsLtiToken",O="40B852DF-9693-420D-AA7D-10072C9CE077",j="https://outlook.office365.com/connectors",y="User.Read",C=5;function _(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return!Object(u.e)("rp-actionableMessages-aad-token")||Object(m.a)()?[3,2]:[4,I()];case 1:return[2,e.sent()];case 2:return Object(u.e)("rp-actionableMessages-msa-token")&&Object(m.a)()?[4,A()]:[3,4];case 3:return[2,e.sent()];case 4:return[4,T()];case 5:return[2,e.sent()]}})})}function A(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return[4,Object(g.getDelegationTokenForOwa)(y)];case 1:return[2,e.sent()]}})})}function I(){return a.__awaiter(this,void 0,void 0,function(){var e,t,n;return a.__generator(this,function(r){switch(r.label){case 0:return e=a.__read(Object(g.getAccessTokenforResourceAsLazy)(j),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}})})}function T(){return a.__awaiter(this,void 0,void 0,function(){var e,t,n;return a.__generator(this,function(a){switch(a.label){case 0:if(function(){if(!r)return!1;return Date.now()-o<1e3*(r.TTL-C)*60}())return k(r.TokenValue),[2,r.TokenValue];e={Header:Object(l.getJsonRequestHeader)(),Body:s()({TokenRequests:[{__type:"TokenRequest:#Exchange",Id:O,TokenType:"Connectors"}]})},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,f()(e)];case 2:return(t=a.sent())&&"Success"===t.Body.ResponseMessages.Items[0].ResponseClass?(i=t.Body.ResponseMessages.Items[0].Token,r=i,o=Date.now(),k(r.TokenValue),[2,r.TokenValue]):(D(b),[2,Promise.reject(new Error("getClientAuthToken failed"))]);case 3:return n=a.sent(),D(v),[2,Promise.reject(new Error("getClientAuthToken exception: "+n))];case 4:return[2]}var i})})}function D(e){Object(i.o)(e),r=void 0}function k(e){!function(e,t,n){if(!t)throw D(p),new Error("getClientAuthToken null");h.set(e,t,n)}(w,e,{path:"/actions/"})}n.d(t,"a",function(){return _}),n.d(t,"b",function(){return T})},4550:function(e,t,n){"use strict";n.d(t,"a",function(){return O});var r=n(3457),o=n(3728),a=n(95),i=n(4652),u=n(4722),c=n(3729),s=n(3678),d=n(3500),f=n(4016),l=n(3467),m=n(1744),g=n(552),h="naturalwidth",b="naturalheight",v="width",p="height",w="px";function O(e,t,n){void 0===n&&(n=!0);var O=Object(d.a)(e,g.a);if(0==O.length)return!1;var C=Object(d.a)(e,g.c),_=Object(d.a)(e,r.b),A=C.length>0?l.a.inlineImages[C]:null;if(A){var I=Object(f.a)();Object(c.a)(e,A,function(e){y(e),Object(o.a)(I,_,r.o,"",t)},function(e){Object(o.a)(I,_,r.o,r.m,t),Object(s.a)(_,r.o,r.m,"",t,"",C,"")})}else{var T={Id:decodeURIComponent(O),mailboxInfo:Object(u.a)(e)},D=Object(m.a)(T.mailboxInfo.routingKey,T,1);if(null!=D&&D.length>0){var k=e.style.display,R=n?function(e){var t="50px",n="50px";e.style.width&&e.style.height?(t=e.style.width,n=e.style.height):e.getAttribute(v)&&e.getAttribute(p)?(t=e.getAttribute(v)+w,n=e.getAttribute(p)+w):e.getAttribute(h)&&e.getAttribute(b)&&(t=e.getAttribute(h)+w,n=e.getAttribute(b)+w);var r=Object(a.g)(),o=document.createElement("div");if(o.style.display="inline-block",o.style.width=t,o.style.height=n,o.style.maxWidth="100%",o.style.maxHeight=e.style.maxHeight,o.style.borderWidth="1px",o.style.borderStyle="dashed",o.style.borderColor=r.themePrimary,o.style.boxSizing="border-box",e.style.display="none",e.parentNode.insertBefore(o,e),e.getAttribute(h)&&e.getAttribute(b)){var i=Math.min(parseInt(o.style.width),o.offsetWidth);o.style.height=Math.ceil(i/parseInt(e.getAttribute(h))*parseInt(e.getAttribute(b))).toString()}return o}(e):null;Object(i.a)(e,D,t,function(e){j(R),y(e),e.style.display=k},function(e){j(R),e.style.display="inline"},!0)}else Object(s.a)(_,"",r.l,"",t,"",C,""),e.removeAttribute("src")}return!0}function j(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function y(e){var t=e.style;e.hasAttribute("width")||t.width||e.hasAttribute("height")||t.height||(t.maxWidth="100%",t.height="auto")}},4652:function(e,t,n){"use strict";var r=n(3457),o=n(3728),a=n(4325),i=new RegExp("^https?://([^/]*)/.*","i"),u=window.location.hostname.toLowerCase();function c(e){if(e){var t=e.ownerDocument||document;return t&&t.documentElement.contains(e)}return!1}var s,d=n(3729),f=n(3859),l=n(3678),m=n(5),g="DataUri_Success",h="DataUri_RequestFailed",b="DataUri_OnError",v=new RegExp("^data:[a-z]+\\/[a-z-]+;","i");function p(e,t,n,r,a,i){n?r&&r(e):a&&a(e);var u=t.imageType,c=t.perfDataPoint,s=t.howLoad,d=t.context,h=t.loaderCode,b=t.originalSrc,v=t.owaDomain,p=t.downloadDomain,w=t.responseData,O=w.responseCode,j=w.status,y=w.contentType,C=w.detectedFormat,_=w.first10BytesBase64,A=w.mimeMatched,I=n?"":i||j||O.toString();c&&Object(o.a)(c,u,s,I,d,h,n?g:""),n||(Object(l.a)(u,s,I,O.toString(),d,h,b,y,v,p,C,_,A.toString()),Object(m.e)("mc-imageDiagnostics")&&Object(f.a)(e,I,w))}!function(e){e[e.NotStarted=0]="NotStarted",e[e.Pending=1]="Pending",e[e.Completed=2]="Completed"}(s||(s={}));var w=4,O=3,j=1e3,y=2e4,C="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7",_="RetryTimedOut",A=[],I=null;function T(e,t,n,o,a){var i={image:e,url:t,retryContext:n,currentRetry:0,status:s.NotStarted,whenQueued:Date.now(),onSuccessCallback:o,onErrorCallback:a};D(i),A.push(i),I||(I=setTimeout(function(){return function e(){if(A.length>0){var t=Date.now(),n=[],o=[],a=[];A.forEach(function(e){e.status!=s.Completed&&(t-e.whenQueued>y?k(e,!1,_):e.status==s.Pending?(a.push(e),n.push(e)):e.status==s.NotStarted&&(o.push(e),n.push(e)))});var i=w-a.length;i>0&&o.length>0&&(u=o.slice(0,Math.min(i,o.length)))&&u.length>0&&u.forEach(function(e){e.currentRetry++,e.status=s.Pending,c(e.image)?Object(d.a)(e.image,e.url,function(t){k(e,!0)},function(t){e.currentRetry>=O?k(e,!1):D(e)}):k(e,!1,r.j+"_R"+e.currentRetry)}),A=n}var u;I=A.length>0?setTimeout(function(){return e()},j):null}()},j))}function D(e){e.status=s.NotStarted,e.image.src=C}function k(e,t,n){if(void 0===n&&(n=""),e.status!=s.Completed){var r=e.image,a=e.onSuccessCallback,i=e.onErrorCallback,u=e.currentRetry;t?a&&a(r):i&&i(r);var c=e.retryContext,d=c.imageType,g=c.perfDataPoint,h=c.howLoad,b=c.context,v=c.loaderCode,p=c.originalSrc,w=c.owaDomain,O=c.downloadDomain,j=c.responseData,y=j.responseCode,C=j.status,_=j.contentType,A=j.detectedFormat,I=j.first10BytesBase64,T=j.mimeMatched,D=t?"":n||C||y.toString();g&&Object(o.a)(g,d,h,D,b,v,u.toString()),t||(Object(l.a)(d,h,D,y.toString(),b,v,p,_,w,O,A,I,T.toString(),u.toString()),Object(m.e)("mc-imageDiagnostics")&&200==y&&Object(f.a)(r,D,j)),e.status=s.Completed}}var R=n(3500),S=n(4016),x=n(11),E=n(552);n.d(t,"a",function(){return M});var U="ZeroNaturalWidth";function M(e,t,n,s,g,w){void 0===w&&(w=!1);var O,j=Object(S.a)(),y=null!=(O=t.match(i))&&O.length>1&&O[1].toLowerCase()!=u,C=y?r.n:r.p,_=Object(R.a)(e,E.c),A=Object(R.a)(e,r.b);0==A.length&&(A=r.q);var I="";y&&(e.setAttribute(r.a,r.f),I=r.f),x.c.info("InlineImage: Load attachment, Url: "+t+", crossDomain: "+y+", crossOrigin: "+I);var D=y?u:"",k=y?function(e){var t=e.match(i);return null!=t&&t.length>1?t[1].toLowerCase():u}(t):"";Object(d.a)(e,t,function(e){s&&s(e);var t=e.naturalWidth>0;Object(o.a)(j,A,C,t?"":U,n,I),t||Object(l.a)(A,C,U,"",n,I,_,"",D,k)},function(i){var u=r.m;n!=r.g||c(i)?Object(a.a)(t,y).then(function(a){if(w&&200==a.responseCode&&a.mimeMatched)T(i,t,{imageType:A,howLoad:C,context:n,loaderCode:I,originalSrc:_,owaDomain:D,downloadDomain:k,responseData:a,perfDataPoint:j},s,g);else if(a.status==r.k&&a.expectedMime)!function(e,t,n,o,a){var i=new XMLHttpRequest;i.onload=function(){var t=new FileReader;t.onloadend=function(){if(t.result){var r=t.result.replace(v,"data:"+n.responseData.expectedMime+";");Object(d.a)(e,r,function(){return p(e,n,!0,o,a)},function(){return p(e,n,!1,o,a,b)})}},t.readAsDataURL(i.response)},i.ontimeout=i.onerror=function(){p(e,n,!1,o,a,h)},e.crossOrigin==r.f&&(i.withCredentials=!0),i.open("GET",t,!0),i.responseType="blob",i.send()}(i,t,{imageType:A,howLoad:C,context:n,loaderCode:I,originalSrc:_,owaDomain:D,downloadDomain:k,responseData:a,perfDataPoint:j},s,g);else{g&&g(i);var c=a.status,O=a.responseCode,y=a.contentType,R=a.detectedFormat,S=a.first10BytesBase64,x=a.mimeMatched;u=c||O.toString(),Object(o.a)(j,A,C,u,n,I),Object(l.a)(A,C,u,O.toString(),n,I,_,y,D,k,R,S,x.toString()),Object(m.e)("mc-imageDiagnostics")&&(404!=O&&0!=O&&200!=O||Object(f.a)(e,u,200==O?a:null))}}):(g&&g(i),u=r.j,Object(o.a)(j,A,C,u,n,I),Object(l.a)(A,C,u,"",n,I,_,"",D,k))})}},4654:function(e,t,n){"use strict";n.r(t);var r=n(3467),o=n(8),a=Object(o.action)("clearInlineImageStore")(function(){r.a.inlineImages={}}),i=n(3457),u=n(3500),c=n(4012),s=Object(o.action)("addInlineImageToStore")(function(e,t){r.a.inlineImages[e]=t}),d=n(552);function f(e){var t=Object(u.a)(e,i.e),n=Object(u.a)(e,d.c);if(t.length>0&&n.length>0){var r=Object(c.a)(e);r&&s(n,r)}}var l=n(4652),m=n(4550),g=n(4668),h=n(4826),b=n(3678),v=n(15),p=n(11);function w(e){var t=[e];Object(v.o)("InlineImageAttachmentUpload",t),p.c.info("InlineImageAttachmentUpload: "+t)}n.d(t,"clearInlineImageStore",function(){return a}),n.d(t,"cacheInlineImage",function(){return f}),n.d(t,"loadFromAttachmentServiceUrl",function(){return l.a}),n.d(t,"loadFromAttachment",function(){return m.a}),n.d(t,"loadFromProxy",function(){return g.a}),n.d(t,"loadFromImageTag",function(){return h.a}),n.d(t,"logImageLoadError",function(){return b.a}),n.d(t,"logImageUpload",function(){return w}),n.d(t,"tryCreateDataURIFromImage",function(){return c.a})},4668:function(e,t,n){"use strict";var r=n(0),o=n(4723),a=n(1239),i=n(3500),u=n(552),c=n(15),s="https://imgproxy.services.web.outlook.com/proxy/?u=",d="ImageProxyModelD";function f(e,t){return new Promise(function(n){e.onload=function(t){l(e),n(!0)},e.onerror=function(t){l(e),n(!1)},e.src=t})}function l(e){e.onload=null,e.onerror=null}var m=n(5);n.d(t,"a",function(){return h});var g="onload";function h(e,t){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Object(o.a)(e)];case 1:return(t=n.sent())?(e.removeAttribute(g),e.onload=null,Object(a.a)()?Object(m.e)("rp-imageProxyOnModelD")?function(e,t){r.__awaiter(this,void 0,void 0,function(){var n,o,a,l,m,g;return r.__generator(this,function(r){switch(r.label){case 0:return(n=Object(i.a)(e,u.c))?(o=new c.a(d),a=document.createElement("img"),l=s+encodeURIComponent(n),m=f(e,t),[4,f(a,l)]):[3,4];case 1:return r.sent()?(o.end(),[3,4]):[3,2];case 2:return[4,m];case 3:g=r.sent(),o.addCustomData({resultB:g}),o.endWithError("ServerError"),r.label=4;case 4:return[2]}})})}(e,t):e.src=t:e.src="",[2,!0]):[2,!1]}})})}},4722:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(4),o=n(401),a=n(42),i=n(3500),u="explicitlogon";function c(e){var t=Object(i.a)(e,u);return Object(r.g)(t)?Object(a.e)():Object(o.m)(t)}},4723:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r=n(0),o=n(3457),a=n(4418),i=n(127),u=n(9),c=n(15),s=n(3500),d=n(552),f="data-imageproxyendpoint",l="data-connectorsauthtoken",m="u",g="i",h="d",b="ClientId";function v(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,h;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(s.a)(e,d.c),n=Object(s.a)(e,f),a=Object(s.a)(e,l),t&&n?Object(u.a)().IsConsumerChild?(Object(c.o)(o.i),[2,t]):"1"!=a?[3,2]:[4,p(n,t)]:[2,""];case 1:return h=r.sent(),[3,3];case 2:h=function(e,t){var n=Object(i.getCookie)(b);if(!n)return null;if("/actions/ei"==e.toLowerCase())return Object(c.o)(o.h),null;return e+"?"+m+"="+encodeURIComponent(t)+"&"+g+"="+encodeURIComponent(n)}(n,t),r.label=3;case 3:return[2,h]}})})}function p(e,t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(a.b)()];case 1:return n.sent(),[3,3];case 2:return n.sent(),[2,null];case 3:return[2,e+"?"+m+"="+encodeURIComponent(t)+"&"+h+"="+encodeURIComponent((new Date).toISOString())]}})})}},4826:function(e,t,n){"use strict";var r=n(4550),o=n(4668),a=n(3457),i=n(3728),u=n(4325),c=n(3729),s=n(3859),d=n(4326),f=n(15);var l=n(3678),m=n(3500),g=n(4016),h=n(5),b=n(552),v="data-imageerror",p="data-outlook-trace",w="CidTildeWrd",O="AttNotFound",j=new RegExp("^cid:\\s?~WRD","i"),y=new RegExp("f:([0-9]+)","i"),C=new RegExp("t:([0-9]+)","i");function _(e,t){var n=Object(m.a)(e,v),r=Object(m.a)(e,a.b),o=Object(m.a)(e,b.c);if(n&&n.length>0){var _=n;if(o&&j.test(o))_=w;else if(n==O){var A=function(e){var t="";if(e){var n=y.exec(e),r=C.exec(e);if(n&&2==n.length&&r&&2==r.length){var o=parseInt(n[1]),a=parseInt(r[1]);isNaN(o)||isNaN(a)||(0==o?t="PreEWS":o>0&&(o<a?t="MidEWS":o==a&&(t="PostEWS")))}}else t="NoTrace";return t}(Object(m.a)(e,p));A&&(_=O+"_"+A)}!function(e,t,n,r,o,a){void 0===n&&(n=""),void 0===r&&(r=""),void 0===o&&(o=""),void 0===a&&(a="");var i=new f.a(d.a),u=[e,t,n,r,o,a];i.addCustomData(u),n&&n.length>0?i.endWithError("ClientError"):i.end()}(r,"",_,t),Object(l.a)(r,"",_,"",t,"",o,""),e.onload=null,e.removeAttribute("src"),Object(h.e)("mc-imageDiagnostics")&&(n!=O&&0!=n.indexOf("NotImage")||Object(s.a)(e,n))}else if(o){var I=Object(g.a)();Object(c.a)(e,o,function(e){Object(i.a)(I,r,"","",t)},function(e){Object(i.a)(I,r,"",a.m,t),Object(u.a)(o).then(function(e){var n=e.status,a=e.responseCode,i=e.contentType,u=n||a.toString();Object(l.a)(r,"",u,a.toString(),t,"",o,i)})})}}function A(e,t,n){var a=t||"";Object(r.a)(e,a,!!n)||Object(o.a)(e,a)||_(e,a)}n.d(t,"a",function(){return A})},862:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(145);function o(e){return{headers:Object(r.c)(e,"GroupMailbox")}}}},0,[486,98,70,110,468,470]]);
//# sourceMappingURL=owa.InlineImageLoader.js.map
self.scriptsLoaded['owa.InlineImageLoader.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.InlineImageLoader.js'] = (new Date()).getTime();