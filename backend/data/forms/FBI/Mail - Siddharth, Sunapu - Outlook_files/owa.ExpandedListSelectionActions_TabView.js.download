self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ExpandedListSelectionActions~TabView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[65],{1730:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),function(e){e[e.None=0]="None",e[e.AmpDisabled=1]="AmpDisabled",e[e.MessageUnsafe=2]="MessageUnsafe",e[e.SenderNotAllowed=3]="SenderNotAllowed",e[e.BrowserNotSupported=4]="BrowserNotSupported",e[e.AmpNotValidated=5]="AmpNotValidated",e[e.AmpValidationFailed=6]="AmpValidationFailed",e[e.AmpValidated=7]="AmpValidated"}(a||(a={}))},1762:function(e,t,n){"use strict";t.a=function(e,t){void 0===t&&(t=!0);var n=t?23:24;return e>=n?n:e}},1881:function(e,t,n){"use strict";n.d(t,"b",function(){return r});var a=n(2537),o=n(2477);function r(e){return Math.min(Math.floor(e/2),24)}t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:function(e,t,n){return[n?1:0,!e.isExpanded]}},RPCountExpCollItemPart:{name:"RPCountExpCollItemPart",customData:function(e,t,n){return[t||n?e.isExpanded?"EC":"CE":e==Object(a.b)()?"SC":e.isExpanded?"ES":"CS",t]}},RPCountExpCollSubject:{name:"RPCountExpCollSubject",customData:function(e){return[e&&!e.isSubjectExpanded]}},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollItemsRollUp:{name:"RPCountExpCollItemsRollUp",customData:function(e,t){return[r(Object(o.a)(e)),t]}},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:function(e,t){return[e,t]}},PrintItem:{name:"PrintItem",actionSource:function(e,t){return t}},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:function(e,t,n,a){return a}},ToggleIsCalendarRollUpExpanded:{name:function(e){return e.isExpanded?"RPCollapseCalendarRollUp":"RPExpandCalendarRollUp"}},ToggleCalendarRollUpItemPartExpanded:{name:function(e){return e.isExpanded?"RPCollapseCalendarRollUpItemPart":"RPExpandCalendarRollUpItemPart"}}}},1996:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(466);function o(e){return e&&e.ItemId&&0===e.ItemId.Id.indexOf(a.m)}},2078:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(9);function o(){var e=Object(a.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},2108:function(e,t,n){"use strict";var a=n(2552),o=n(1638),r=n(1881),i=n(2589),c=n(2590),s=n(2591),d=n(2562),u=n(2134),l=n(2553),f=n(25),m=n(5),b=n(181),p=n(271),I=n(142),v=n(1193),g=n(2250),O=n(1753),j=n(2118),h=n(1756),R=n(2344),S=n(1996),P=function(e){return e&&e.Smime&&e.Smime.ErrorState||0},C=n(1767),w=n(914),x=n(745),M=n(11),y=n(15),E=function(e,t){M.c.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(h.a)());var n=new y.a("RPProcessSmimeItem",{isCore:!0});return v.q.import().then(function(t){return t(e)}).then(function(){U(e,n,t)}).catch(function(){U(e,n,t)})};function N(e,t,n,r,u,f){if(e.itemId==t.Id){var m=t&&t.Id&&Object(I.b)().items.get(t.Id);e.itemViewState=function(e,t){return{itemId:e.Id,isContextMenuShown:!1,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,infoBarIds:Object(i.a)(),loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,isYammerThread:Object(d.a)(t),ampViewState:Object(c.a)(t)}}(t,m),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!m,e.instrumentationContext=n,m&&(r.addCustomData(Object(s.b)(m,f,u)),o.e.import().then(function(e){e(m)}),Object(l.d)(m)?e.isUnsupportedItem=!0:Object(a.a)(e.itemViewState,!1,{item:m}))}}var A=function(e,t,n,a){return a?a(e):Object(p.i)(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(h.a)())},V=function(e,t,n,a,o){var r;return Object(m.e)("rp-smime")&&Object(x.a)(n)?g.a.import().then(function(){return Object(h.a)()&&Object(R.a)(n)?(r=!0,A(e,t,a,o)):n}).then(function(){return E(e,r)}):Promise.resolve()};function U(e,t,n){var a=Object(I.b)().items.get(e&&e.Id);t.addCustomData({smimeInstallationStatus:O.a.installationStatus,smimeType:Object(C.a)(a),numAttachments:_(a),wasReloaded:n}),Object(w.a)(a)?t.end():t.endWithError("ClientError",new Error(P(a).toString()))}function _(e){return e&&e.Attachments&&e.Attachments.length}t.a=Object(f.b)("loadItemReadingPane",r.a.RPPerfLoadItemReadingPane)(function(e,t,n,a,o,i){var c=function(e,t){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(b.b)(),isUnsupportedItem:!1,isSubjectExpanded:!1,instrumentationContext:null,showDownlevelContent:!1}}(e,a);n(c);var s=Object(y.q)(function(e){return e.eventName==r.a.RPPerfLoadItemReadingPane.name}),d=Object(I.b)().items.get(e.Id);!Object(m.e)("ring-dogfood")||a||o||Object(y.o)("RPMailStoreItemsCount",{count:Object(I.b)().items.size});var l=Object(R.a)(d),f=Object(x.a)(d);return f&&d.Smime&&!Object(w.a)(d)&&(d.Smime.ErrorState=0),d&&(d.NormalizedBody&&!l||Object(S.a)(d))?(Object(u.a)(null,e.Id),Object(m.e)("rp-smime")&&f&&!Object(w.a)(d)?(new y.a("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),E(e,!1).then(function(){return N(c,e,t,s,a,o)})):(N(c,e,t,s,a,o),Promise.resolve())):new Promise(function(e){return f&&l&&!Object(j.a)()?g.a.import().then(e):e()}).then(function(){return function(e,t,n,a,o,r,i){return A(t,a,r,i).then(function(e){return V(t,a,e,r,i)}).then(function(){Object(u.a)(null,t.Id),N(e,t,n,a,o,r)}).catch(function(t){return e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0,Promise.reject(t)})}(c,e,t,s,a,o,i).then(function(){Object(u.a)(null,e.Id)})})})},2111:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a="defaultProvider"},2118:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(1753),o=n(2441);function r(){var e=Object(a.b)();return Object(o.k)(e.installationStatus)}},2134:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(2592),o=n(5),r=n(29),i=n(2630);function c(e,t){var n;Object(o.e)("mc-voting")&&(e||t)&&((n=e?Object(a.a)(e):Object(r.t)().items.get(t))&&n.ItemId&&n.ItemId.Id&&i.c.import().then(function(e){return e(n.ItemId.Id)}))}},2135:function(e,t,n){"use strict";var a;!function(e){e[e.Open=0]="Open",e[e.VotingOptionMin=1]="VotingOptionMin",e[e.VotingOptionMax=31]="VotingOptionMax",e[e.First=100]="First",e[e.ReplyToSender=102]="ReplyToSender",e[e.ReplyToAll=103]="ReplyToAll",e[e.Forward=104]="Forward",e[e.ReplyToFolder=108]="ReplyToFolder"}(a||(a={})),t.a=a},2157:function(e){e.exports={c:"mGb",b:"nGb",a:"oGb"}},2339:function(e,t,n){"use strict";var a=n(1),o=Object(a.createStore)("ampstore",{allowedSenders:[]});t.a=o()},2344:function(e,t,n){"use strict";var a=n(2106),o=n(914),r=n(745),i=n(5),c=n(2118),s=n(1756),d=function(){return!!Object(c.a)()&&!Object(s.a)()};t.a=function(e){return Object(i.e)("rp-smime")&&!Object(o.a)(e)&&!d()&&Object(r.a)(e)&&!Object(a.a)(e)}},2374:function(e){e.exports={b:"kGb",a:"lGb"}},2464:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(a||(a={}))},2469:function(e,t,n){"use strict";var a=n(0),o=n(935),r=n(8),i=Object(r.action)("addInfoBarMessage")(function(e,t,n,r){void 0===n&&(n="0"),-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=a.__spread(e.infoBarIds),r&&(o.b[n]||(o.b[n]={}),o.b[n][t]=r)});t.a=i},2477:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return c});var a=n(142);function o(e){return e&&e.conversationNodeIdsInCollapsedItemsRollUp&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function r(e){var t=a.a.conversations.get(e.conversationId.Id);return o(e)||t&&t.canLoadMore}function i(e,t){return e&&e.conversationNodeIdsInCollapsedItemsRollUp&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function c(e){if(!o(e))return 0;var t=e.conversationNodeIdsInCollapsedItemsRollUp,n=e.itemPartsMap,a=t.length;return t.forEach(function(e){var t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(a+=t.oofRollUpViewState.oofReplyNodeIds.length),t.calendarRollUpViewState&&t.calendarRollUpViewState.calendarReponseNodeIds&&(a+=t.calendarRollUpViewState.calendarReponseNodeIds.length)}),a}},2537:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return d});var a=n(2464),o=n(454),r=n(8),i=Object(r.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.itemPart:null}),c=Object(r.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null}),s=Object(r.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.initiallySelectedItemPart?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null}),d=Object(r.select)({conversationReadingPaneState:function(){return o.a.conversationReadingPaneViewState}})(function(e,t){var n=i(t),o=c(t);return n==e&&o==a.a.Item})},2542:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(1),o={options:void 0,activeProviders:[n(2111).a],referenceItemId:void 0},r=Object(a.createStore)("mailVotingStore",o);r()},2552:function(e,t,n){"use strict";var a=n(0),o=n(2588),r=n(142),i=n(1049),c=n(8);t.a=Object(c.select)({item:function(e){return r.a.items.get(e.itemId)}})(Object(c.action)("initializeExtendedStateForItemViewState")(function(e,t,n){return void 0===t&&(t=!1),a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){switch(a.label){case 0:return[4,Object(o.a)(e,n.item,t)];case 1:return a.sent(),n.item&&i.s.importAndExecute(e,n.item.ItemClass),[2]}})})}))},2553:function(e,t,n){"use strict";n.d(t,"d",function(){return b}),n.d(t,"c",function(){return p}),n.d(t,"a",function(){return I}),n.d(t,"b",function(){return v});var a=n(21),o=n(142),r=n(28),i="IPM.Appointment",c="IPM.Contact",s="IPM.DistList",d="IPM.Task",u="calendar",l="contacts",f="tasks",m="inbox";function b(e){return e&&(g(e.ItemClass)||O(e.ItemClass)||j(e.ItemClass)||h(e.ItemClass))}function p(e){var t=o.a.conversations.get(e),n=o.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){var a=n.itemIds[0];if(b(o.a.items.get(a)))return a}return null}function I(e){var t=o.a.items.get(e);return g(t.ItemClass)?Object(r.a)(u):O(t.ItemClass)||j(t.ItemClass)?Object(r.a)(l):h(t.ItemClass)?Object(r.a)(f):Object(r.a)(m)}function v(e){var t="",n=a.n.folderTable.get(e);return n&&(t=n.DisplayName),t}function g(e){return 0==e.indexOf(i)}function O(e){return 0==e.indexOf(c)}function j(e){return 0==e.indexOf(s)}function h(e){return 0==e.indexOf(d)}},2561:function(e,t,n){"use strict";var a=n(8),o=n(2469),r=Object(a.action)("addInfoBarMessageInReadingPane")(function(e,t,n){Object(o.a)(e,t,e.itemId,n)});t.a=r},2562:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(4),o=n(5),r="Beta-Yammer-Outlook-PoC-2019";function i(e){if(!Object(o.e)("rp-yammer")||!e)return!1;var t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(a.g)(t)&&t.indexOf(r)>-1}},2588:function(e,t,n){"use strict";var a=n(0),o=n(2561),r=n(857),i=n(721),c=n(2106),s=n(914),d=n(745),u=n(8);t.a=Object(u.action)("initializeAttachmentsForItem")(function(e,t,n){return void 0===n&&(n=!1),a.__awaiter(this,void 0,void 0,function(){var u;return a.__generator(this,function(a){switch(a.label){case 0:return!t||Object(d.a)(t)&&!function(e,t){if(!Object(c.a)(t))return!0;if(!e.isConversationItemPart&&Object(s.a)(t))return!0;return!1}(e,t)?[2]:e.attachmentWell?[3,2]:[4,i.j.import()];case 1:u=a.sent(),e.attachmentWell=u(!0,!1,""),a.label=2;case 2:return n?[4,i.r.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0)]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,i.o.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1)];case 5:a.sent(),a.label=6;case 6:return Object(r.e)(t.Attachments).map(r.h).forEach(function(t){return Object(o.a)(e,t)}),[2]}})})})},2589:function(e,t,n){"use strict";function a(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged","infoMessageClassification"]}n.d(t,"a",function(){return a})},2590:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(2631);function o(e){return{preferAmp:!0,ampAvailability:Object(a.a)(e)}}},2591:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return m});var a=n(2078),o=n(454),r=n(142),i=n(1762),c=n(1049),s=n(9),d=n(745),u="Meeting",l="Message";function f(e){var t=0,n=0,s=0,d=0,u=o.a.conversationReadingPaneViewState.itemPartsMap;return u.forEach(function(e){e.isExpanded&&d++;var a=r.a.items.get(e.itemId);a&&(a.IsRead||t++,a.IsDraft&&n++,Object(c.p)(a)&&s++)}),{owa_1:p(),owa_2:Object(a.a)(),owa_3:Object(i.a)(u.size),owa_4:Object(i.a)(d),owa_5:Object(i.a)(t),owa_6:Object(i.a)(s),owa_7:Object(i.a)(n),owa_8:e}}function m(e,t,n){return{owa_1:p(),owa_2:b(e),owa_3:t,owa_4:n,owa_5:Object(d.a)(e)}}function b(e){return Object(c.p)(e)?u:l}function p(){return Object(s.a)().UserOptions.GlobalReadingPanePositionReact}},2592:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c});var a=n(454),o=n(2078),r=n(142);function i(e){var t=Object(r.b)(),n=c(e),a=n?n.itemId:null;return t.items.get(a)}function c(e){var t,n=Object(r.b)().conversations.get(e),i=n&&n.conversationNodeIds,c=i?i.length:0;if(c>0){var s=Object(a.b)().conversationReadingPaneViewState,d=s&&s.itemPartsMap;if(d){var u=Object(o.a)()?0:c-1;t=d.get(i[u])}}return t}},2625:function(e,t,n){"use strict";function a(e){return e.From&&e.From.Mailbox?e.From.Mailbox.EmailAddress:null}n.d(t,"a",function(){return a})},2626:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(2542);function o(){var e=Object(a.a)();return e&&e.options?e.options:[]}},2630:function(e,t,n){"use strict";var a=n(3),o=n(2374),r=n(4),i=n(2135),c=n(6),s=n(1292),d=n(2157),u=n(2626),l=n(2111),f=n(15);function m(e){Object(f.o)("VotingOpportunityOnMessage",{hasUserVoted:e})}var b=n(5),p=n(42);function I(e,t,n){if(Object(b.e)("mc-voting")){var a=e.VotingInformation,f=a.UserOptions.length,I=Number(t(e)),v=I<=f&&I>=i.a.VotingOptionMin&&I<=i.a.VotingOptionMax?a.UserOptions[I-i.a.VotingOptionMin].DisplayName:null;if(v){m(!0);var g=n(e);if(g){var j=Object(c.Z)(Object(c.cc)(g));return Object(r.b)(Object(r.a)(o.b),v,j)}return Object(r.b)(Object(r.a)(o.a),v)}if(!Object(s.a)(e.ParentFolderId.Id)&&e.MailboxInfo.type===p.a.UserMailbox)return function(e){var t=Object(u.a)(),n=t;0==t.length&&e&&e.UserOptions.length>0?n=e.UserOptions.map(function(e){return{provider:l.a,displayName:e.DisplayName}}):m(!1);var a=n.map(function(e){return{displayName:e.displayName,value:e}});return{preActionText:Object(r.a)(d.c),actionLinkText:Object(r.a)(d.b),options:a,onSelect:function(e){return O.importAndExecute(e)},hasSelectionConfirmationDialog:!0,selectionConfirmDialogFormatString:Object(r.a)(d.a)}}(a)}return null}n.d(t,"c",function(){return g}),n.d(t,"b",function(){return O}),n.d(t,"a",function(){return I});var v=new a.c(function(){return n.e(288).then(n.bind(null,13667))}),g=new a.b(v,function(e){return e.loadActiveVotingProviders}),O=new a.a(v,function(e){return e.castVoteForProvider})},2631:function(e,t,n){"use strict";var a=n(4);var o=n(2625),r=n(1384),i=n(79),c=n(1730),s=n(2339),d=n(214);function u(e){if(!function(e){return e&&!Object(a.g)(e.AmpHtmlBody)}(e))return c.a.None;if(!Object(r.a)())return c.a.AmpDisabled;if(!function(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}(e))return c.a.MessageUnsafe;var t=Object(o.a)(e);return null==t||!function(e){var t=Object(d.c)(d.a.AmpDeveloper);return t.enabled&&t.allowedSender.some(function(t){return l(t,e)})}(t)&&!function(e){return s.a.allowedSenders&&s.a.allowedSenders.some(function(t){return l(t,e)})}(t)?c.a.SenderNotAllowed:Object(i.c)()||Object(i.e)()?c.a.BrowserNotSupported:c.a.AmpNotValidated}function l(e,t){return e.toLowerCase()==t.toLowerCase()}n.d(t,"a",function(){return u})},3701:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"c",function(){return u}),n.d(t,"b",function(){return l});var a=n(0),o=n(142),r=n(1516),i=n(181),c=n(9),s=n(340);function d(e){var t,n,c=e&&e.itemIds?e.itemIds.length:0;if(0==c)return[null,!1,!1];var d=null,u=2==Object(i.c)().type||!Object(i.b)();if(1==c){if(!(d=o.a.items.get(e.itemIds[0])))return[null,!1,!1];u=u||d.ParentFolderId&&d.ParentFolderId.Id==Object(i.b)()}else{var l=null;try{for(var f=a.__values(e.itemIds),m=f.next();!m.done;m=f.next()){var b=m.value,p=o.a.items.get(b);if(!p)return[null,!1,!1];if(p.ParentFolderId&&p.ParentFolderId.Id==Object(i.b)()){d=p,u=!0;break}Object(s.a)(p.ParentFolderId.Id,"sentitems")&&(l=p)}}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}d||(d=l||o.a.items.get(e.itemIds[0]))}return[d,u,Object(r.a)(d.ParentFolderId.Id)]}function u(e,t,n){var a=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||a)&&t&&!n)}function l(e){var t=o.a.conversationNodes.get(e),n=a.__read(d(t),3),r=n[0],i=n[1];return u(r,n[2],i)?r:null}},4149:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"e",function(){return d}),n.d(t,"c",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"i",function(){return m}),n.d(t,"f",function(){return b}),n.d(t,"h",function(){return p}),n.d(t,"g",function(){return I});var a=n(5),o=n(142),r=n(454),i=n(2078),c=/ipm.schedule.meeting.resp/i,s=/^ipm\.schedule\.meeting\.resp\.pos/i,d=/^ipm\.schedule\.meeting\.resp\.tent/i,u=/^ipm\.schedule\.meeting\.resp\.neg/i,l=/^ipm\.schedule\.meeting\.canceled/i,f=/^ipm\.schedule\.meeting\.request/i;function m(){return Object(a.e)("rp-calendarRollup")&&!Object(a.e)("cal-mf-mailCalendarCard")}function b(e){return{isCalendarResponse:c.test(e),isCalendarRequest:f.test(e),calendarReponseNodeIds:[],acceptedAttendees:[],tentativeAttendees:[],declinedAttendees:[],proposedNewTimeAttendeesCount:0,isExpanded:!1,isLoading:!0}}function p(e){if(!m())return!1;var t=!1;return e&&e.itemPartsMap&&e.itemPartsMap.forEach(function(e){e.calendarRollUpViewState.calendarReponseNodeIds.length&&(t=!0)}),t}function I(){var e=r.a.conversationReadingPaneViewState;if(!e)return null;var t=o.a.conversations.get(e.conversationId.Id);if(!t||!t.conversationNodeIds.length)return null;for(var n=t.conversationNodeIds,a=Object(i.a)(),c=a?n.length-1:0,s=a?-1:1;c>=0&&c<=n.length-1;){var d=n[c],u=e.itemPartsMap.get(d);if(u&&u.calendarRollUpViewState.isCalendarRequest)return d;c+=s}return null}},4202:function(e,t,n){"use strict";var a=n(0),o=n(6632),r=n(1881),i=n(2589),c=n(454),s=n(2591),d=n(2562),u=n(2590),l=n(1909),f=n(2134),m=n(4149),b=n(6281),p=n(7),I=n(15),v=n(25),g=n(5),O=n(72),j=n(142);function h(e){var t=O.a.conversationItems.get(e);if(t){var n=function(e){var t,n,o,r,i={unreadItemCount:0,totalItemCount:0},c=j.a.conversations.get(e);try{for(var s=a.__values(c.conversationNodeIds),d=s.next();!d.done;d=s.next()){var u=d.value,l=j.a.conversationNodes.get(u);if(!l){i.totalItemCount=0;break}i.totalItemCount+=l.itemIds.length;try{for(var f=(o=void 0,a.__values(l.itemIds)),m=f.next();!m.done;m=f.next()){var b=m.value,p=j.a.items.get(b);if(!p){i.totalItemCount=0;break}i.unreadItemCount+=p.IsRead?0:1}}catch(e){o={error:e}}finally{try{m&&!m.done&&(r=f.return)&&r.call(f)}finally{if(o)throw o.error}}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return i}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var R=n(181),S=n(271),P=n(8),C=n(29),w=n(3701);n.d(t,"a",function(){return M});var x=[];var M=Object(P.select)({conversationNodes:function(){return C.H.conversationNodes}})(function(e,t){var n,o=t.conversationNodes.get(e.Id),r=(n=a.__read(Object(w.a)(o),3))[0],c=n[1],s=n[2];if(!Object(w.c)(r,s,c))return[null,null];var l={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},f=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(r,c,s),p={mailboxInfo:e.mailboxInfo,Id:r.ItemId.Id};return[{conversationNodeId:e.Id,itemId:p.Id,isConversationItemPart:!0,isExpanded:f,isLocal:c,isDeleted:s,isContextMenuShown:!1,attachmentWell:null,quotedBodyViewState:l,isFossilizedTextExpanded:f,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,infoBarIds:Object(i.a)(),loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,calendarRollUpViewState:Object(m.f)(r.ItemClass),oofRollUpViewState:Object(b.b)(r.ItemClass),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},isYammerThread:Object(d.a)(r),ampViewState:Object(u.a)(r)},r]});t.b=Object(P.select)({readingPaneStore:function(){return c.a},conversationNodes:function(){return C.H.conversationNodes},conversations:function(){return C.h}})(Object(v.b)("loadConversationReadingPane",r.a.RPPerfLoadConversationReadingPane)(function(e,t,n,a,r,i){var c,d=Promise.resolve();i.readingPaneStore.conversationReadingPaneViewState=function(e,t,n,a,o){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:o,itemPartsMap:new p.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(R.b)(),isSubjectExpanded:!1,unsupportedItemId:null,instrumentationContext:a,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,isCalendarCardOpen:!1,showDownlevelContent:!1}}(e,n,a,t,r);var u=Object(l.a)(e.Id),m=Object(I.q)();if(Object(g.e)("ring-dogfood")){var b=!1;x.includes(e.Id)?b=!0:x.push(e.Id),Object(I.o)("RPCacheStatus",{hasValidConversationCache:u,hasOpened:b,OpenedCount:x.length})}return u&&(c="Valid",i.conversations.getAndTouch(e.Id),Object(o.a)(e.Id)),u&&!h(e.Id)||(c=u?"Stale":"Not",d=Object(S.h)(e,"LoadConversationReadingPane",m)),d.then(function(){Object(f.a)(e.Id),m.addCustomData(Object(s.a)(c))})}))},5320:function(e,t,n){"use strict";function a(e,t,n){var a=n.get(e);return a?t.get(a.parentInternetMessageId):null}n.d(t,"a",function(){return a})},5321:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(6280);function o(e,t){var n=t?t.Value:"",o=Object(a.a)(e);return o||n}},5716:function(e,t,n){"use strict";var a=n(1);t.a=Object(a.action)("tryInitializeCalendarCard",function(e){return{conversationId:e}})},6277:function(e,t,n){"use strict";var a=n(0),o=n(2588),r=n(2078),i=n(721),c=n(874),s=n(142),d=n(8);t.a=Object(d.action)("initializeAttachmentsForConversationWell")(Object(d.select)({mailStoreItems:function(){return s.a.items}})(function(e,t){return a.__awaiter(this,void 0,void 0,function(){var n,s,d,u,l,f,m,b,p;return a.__generator(this,function(I){switch(I.label){case 0:return e.itemPartsMap.size>1?e.attachmentWell?[3,4]:[4,c.a.getAttachmentsForConversationWell(e.conversationId)]:[3,11];case 1:return n=a.__read.apply(void 0,[I.sent(),3]),s=n[0],d=n[1],u=n[2],[4,i.l.import()];case 2:return l=I.sent(),e.attachmentWell=l(d,u),[4,i.o.importAndExecute(s,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)];case 3:I.sent(),I.label=4;case 4:f=a.__spread(e.itemPartsMap.keys()),m=0,I.label=5;case 5:return m<f.length?(b=e.itemPartsMap.get(f[m]))&&(p=t.mailStoreItems.get(b.itemId))?[4,Object(o.a)(b,p,!1)]:[3,8]:[3,9];case 6:return I.sent(),[4,i.p.importAndExecute(b.attachmentWell,e.attachmentWell,a.__assign({},p.ItemId,{mailboxInfo:p.MailboxInfo}),p.DateTimeReceived)];case 7:I.sent(),I.label=8;case 8:return m++,[3,5];case 9:return[4,i.t.importAndExecute(e.attachmentWell,Object(r.a)())];case 10:I.sent(),I.label=11;case 11:return[2]}})})}))},6278:function(e,t,n){"use strict";var a=n(5320),o=n(8);t.a=Object(o.action)("tryAddCalendarNodesInRollUp")(function(e,t,n,o,r){o&&e.forEach(function(e){e.calendarRollUpViewState.calendarReponseNodeIds=[]}),n.forEach(function(n){var i=e.get(n);if(i&&i.calendarRollUpViewState.isCalendarResponse){i.isInRollUp=!1;var c=Object(a.a)(n,e,t);c&&(i.isInRollUp=!0,c.calendarRollUpViewState.calendarReponseNodeIds.push(n),i.isExpanded&&!c.calendarRollUpViewState.isExpanded&&(c.calendarRollUpViewState.isExpanded=!o||r&&r.includes(n)))}})})},6279:function(e,t,n){"use strict";var a=n(5320),o=n(8);t.a=Object(o.action)("tryAddOofNodesInRollUp")(function(e,t,n,o){o&&e.forEach(function(e){e.oofRollUpViewState.oofReplyNodeIds=[]}),n.forEach(function(n){var o=e.get(n);if(o&&o.oofRollUpViewState.isOofItem){o.isInRollUp=!1;var r=Object(a.a)(n,e,t);r&&!r.isInRollUp&&(o.isInRollUp=!0,r.oofRollUpViewState.oofReplyNodeIds.push(n))}})})},6280:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(7086),o=n(4);function r(e){var t;if(e&&e.RightsManagedMessageDecryptionStatus&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(o.b)(Object(o.a)(a.d),i());break;case-2147160010:t=Object(o.a)(a.a);break;case-2147168507:t=Object(o.b)(Object(o.a)(a.l),i());break;case-2147160014:t=Object(o.a)(a.j);break;case-2147160054:case-2147160055:t=Object(o.a)(a.h);break;case-2147160064:case-2147160013:t=Object(o.a)(a.g);break;case-2147160051:t=Object(o.a)(a.c);break;case-2147160060:t=Object(o.a)(a.k);break;case-2147160009:default:t=Object(o.b)(Object(o.a)(a.i),e.RightsManagedMessageDecryptionStatus)}return t}function i(){var e=Object(o.b)('<a href="{0}" target="_blank">{1}</a>',Object(o.a)(a.f),Object(o.a)(a.e));return Object(o.b)(Object(o.a)(a.b),e)}},6281:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var a=/ipm.note.rules.ooftemplate.microsoft/i;function o(e){return{isOofItem:a.test(e),oofReplyNodeIds:[],isOofRollUpExpanded:!1}}},6632:function(e,t,n){"use strict";var a=n(0),o=n(6277),r=n(2552),i=n(4202),c=n(1881),s=n(2477),d=n(2078),u=n(15),l=n(8),f=Object(l.action)("markConversationCollapsedItemsRollUp")(function(e,t,n){var a=t.length;if(!(a<5)){var o=[],r=Object(d.a)()?1:a-2,i=Object(d.a)()?1:-1;n&&(r-=i);for(var l=r;l<=a-1&&l>=0&&!t[l].isExpanded;l+=i)o.push(t[l].conversationNodeId);if(o.length>=3){if(o.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=o,!n){var f=Object(d.a)()?0:a-1;e.nodeIdBundledWithSeeMoreMessages=t[f].conversationNodeId}Object(u.o)("RPCountRenderCollItemsRollUp",[Object(c.b)(Object(s.a)(e))])}}}),m=n(6645),b=n(6278),p=n(6279),I=n(5716),v=n(2464),g=n(454),O=n(5321),j=n(12);var h=n(4149),R=n(2553),S=n(5),P=n(142),C=n(3701);function w(e,t,n,o){var c=[],s=t.itemPartsMap,d=t.itemIdToScrollTo,u=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach(function(t){var n=a.__read(Object(i.a)({mailboxInfo:e.conversationId.mailboxInfo,Id:t}),1)[0];n&&s.set(t,n)}),Object(h.i)()&&(Object(b.a)(s,n,e.conversationNodeIds,!1),Object(m.a)()),Object(p.a)(s,n,e.conversationNodeIds,!1);var l=!1;e.conversationNodeIds.forEach(function(e){var t=s.get(e);if(t&&!t.isInRollUp){c.push(t);var n=o.get(t.itemId);(function(e){var t=Object(j.C)();if(t&&t.highlightTerms){var n=Object(O.a)(e.RightsManagementLicenseData,e.UniqueBody),a=document.createElement("div");return a.innerHTML=n,t.highlightTerms.some(function(e){return a.innerText.toLowerCase().indexOf(e)>=0})}return!1})(n)&&(t.isExpanded=!0),l=l||t.isExpanded&&!n.IsDraft}});var I="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,a){var o=n.length;if(0!=o&&!t){for(var r=null,i=e?o-1:0,c=i,s=e?-1:1,d=function(e){var t=a.get(e);return Object(C.a)(t)[1]};c>=0&&c<o;){var u=n[c],l=u.oofRollUpViewState.oofReplyNodeIds.some(d);if(!u.isExpanded&&(u.isLocal||l)){r=u;break}c+=s}r||(r=n[i]),r.isExpanded=!0,r.isFossilizedTextExpanded=!0}}(I,l,c,n),u=function(e,t){for(var n=e.length,a=0;a<n;a++){var o=e[a],r=o.itemId;if(t){if(r==t)return o.isExpanded=!0,{itemPart:o,focusedItemArea:v.a.Item}}else{if(o.isExpanded)return{itemPart:o,focusedItemArea:v.a.Item};if(o.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:o,focusedItemArea:v.a.Oof}}}return null}(c,d),c.forEach(function(e){e.isExpanded&&Object(r.a)(e)}),c.length){var g=I?0:e.conversationNodeIds.length-1,R=e.conversationNodeIds[g],S=s.has(R);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=R),Object(h.h)(t)||f(t,c,e.canLoadMore&&!S)}}return u}t.a=Object(l.select)({loadedConversation:function(e){return P.a.conversations.get(e)},conversationNodes:function(){return P.a.conversationNodes},conversationReadingPaneState:function(){return g.a.conversationReadingPaneViewState},items:function(){return P.a.items}})(Object(l.action)("firstLoadConversationReadingPane")(function(e,t){if(t.conversationReadingPaneState.conversationId.Id==e){var n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){var a=Object(R.c)(e);if(n.unsupportedItemId=a,!a){var r=w(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=r,Object(o.a)(n),Object(S.e)("cal-mf-mailCalendarCard")&&Object(I.a)(e)}}}}))},6645:function(e,t,n){"use strict";var a=n(0),o=n(29),r=n(1898),i=n.n(r),c=n(453),s=n.n(c),d=n(1899),u=n.n(d),l=n(27);function f(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return[2,m(e).then(function(e){return Object(o.g)(e[0])?e[0].Items[0]:null}).catch(function(){return null})]})})}function m(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return[2,u()({Header:Object(l.getJsonRequestHeader)(),Body:i()({EventIds:[e],ItemShape:s()({BaseShape:"IdOnly"})})},null).then(function(e){return e.Body.ResponseMessages.Items})]})})}var b=n(454),p=n(2078),I=n(3701),v=n(1049),g=n(8),O=n(4149);t.a=Object(g.select)({loadedConversation:function(){return o.H.conversations.get(b.a.conversationReadingPaneViewState.conversationId.Id)},itemPartsMap:function(){return b.a.conversationReadingPaneViewState.itemPartsMap},items:function(){return o.H.items}})(Object(g.action)("generateSummaryForCalendarRollUp")(function(e){return a.__awaiter(this,void 0,void 0,function(){var t,n,o,r,i,c,s,d,u,l,m,b;return a.__generator(this,function(g){switch(g.label){case 0:if((t=e.loadedConversation.conversationNodeIds).length<=1)return[2];n=Object(p.a)()?t.length-1:0,o=Object(p.a)()?-1:1,r=!1,i=n,g.label=1;case 1:return i<=t.length-1&&i>=0?(c=t[i],e.itemPartsMap.has(c)?(s=e.itemPartsMap.get(c),d=s.calendarRollUpViewState,u=e.items.get(s.itemId),d.calendarReponseNodeIds.length>=1?(l=u,!r&&l&&l.AssociatedCalendarItemId?[4,f(l.AssociatedCalendarItemId)]:[3,3]):[3,5]):[3,6]):[3,7];case 2:return b=g.sent(),[3,4];case 3:b=null,g.label=4;case 4:m=b,function(e){e.acceptedAttendees=[],e.tentativeAttendees=[],e.declinedAttendees=[],e.proposedNewTimeAttendeesCount=0}(d),m&&function(e,t){a.__spread(t.RequiredAttendees,t.OptionalAttendees).forEach(function(t){var n=[];switch(t.ResponseType){case"Accept":n=e.acceptedAttendees;break;case"Tentative":n=e.tentativeAttendees;break;case"Decline":n=e.declinedAttendees}n.push({Mailbox:t.Mailbox}),t.ProposedStart&&t.ProposedEnd&&e.proposedNewTimeAttendeesCount++})}(d,m),0==function(e){var t=e.acceptedAttendees,n=e.tentativeAttendees,a=e.declinedAttendees;return t.length+n.length+a.length}(d)&&function(e){var t={},n=e.calendarReponseNodeIds,a=e.acceptedAttendees,o=e.tentativeAttendees,r=e.declinedAttendees;n.forEach(function(e){var n=Object(I.b)(e),a=n&&n.From?n.From:n.Sender,o=a&&a.Mailbox&&a.Mailbox.EmailAddress&&a.Mailbox.EmailAddress.toLowerCase();o&&(!t[o]||Date.parse(n.DateTimeSent)>Date.parse(t[o].DateTimeSent))&&(t[o]=n)}),Object.keys(t).forEach(function(e){var n=t[e],i=n.ItemClass,c=n.From?n.From:n.Sender;i.match(O.a)?a.push(c):i.match(O.e)?o.push(c):i.match(O.c)&&r.push(c)})}(d),g.label=5;case 5:d.isLoading=!1,!r&&u&&Object(v.q)(u.ItemClass)&&(r=!0),g.label=6;case 6:return i+=o,[3,1];case 7:return[2]}})})}))},7086:function(e){e.exports={d:"wIb",a:"xIb",l:"yIb",j:"zIb",h:"AIb",g:"BIb",c:"CIb",k:"DIb",i:"EIb",f:"FIb",e:"GIb",b:"HIb"}}}]);
//# sourceMappingURL=owa.ExpandedListSelectionActions~TabView.js.map
self.scriptsLoaded['owa.ExpandedListSelectionActions~TabView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ExpandedListSelectionActions~TabView.js'] = (new Date()).getTime();