self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ConversationAttachment.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[175],{1065:function(e,t,n){"use strict";var r=n(1190);function o(e){window.open(e,"_blank")}function a(e,t,n,r){if(t)o(e);else{var a=document.createElement("a");a.style.display="none",a.href=e,a.download=r||"",n||(n=document.activeElement&&document.activeElement.parentElement||document.body),n.appendChild(a),a.click(),n.removeChild(a)}}var i=n(679);function c(e,t){a(Object(r.a)(e,t,0,Object(i.b)(t),!1,!0),!1)}var s=n(0),u=n(452),d=n(2460),l=n(2086);function p(e,t){return s.__awaiter(this,void 0,void 0,function(){var n,o;return s.__generator(this,function(a){switch(a.label){case 0:return".pdf"!==Object(u.a)(t.Name).toLowerCase()?[3,1]:(n=Object(r.a)(e,t,3,Object(i.b)(t),!1),window.open(n,"_blank"),[3,3]);case 1:return Object(u.c)(t.Name)?[4,Object(d.a)(e,t,Object(i.b)(t))]:[3,3];case 2:o=a.sent(),l.a.importAndExecute(function(e){var t=document.createElement("div"),n=document.createElement("img");return n.src=e,t.appendChild(n),t.innerHTML}(o),"img {max-width: 100%; max-height: 100%; width: auto;  }"),a.label=3;case 3:return[2]}})})}var m=n(2461),f=n(2462),h=n(857);function v(e){var t=Object(h.f)(e,!0),n=Object(u.a)(e.Name);return Object(f.a)(t,e,n)}function b(e){var t=Object(u.a)(e.Name);return v(e)&&t&&(".pdf"===t.toLowerCase()&&Object(m.a)()||Object(u.c)(e.Name))}n.d(t,"a",function(){return c}),n.d(t,"f",function(){return p}),n.d(t,"d",function(){return b}),n.d(t,"c",function(){return v}),n.d(t,"b",function(){return a}),n.d(t,"e",function(){return o})},1086:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return m});var r,o=n(1747),a=n(1373),i=n(452),c={};function s(e){return e in c?c[e]:(c[e]={extraSmall:Object(a.a)(e+"_16x16"),small:Object(a.a)(e+"_20x20"),medium:Object(a.a)(e+"_32x32"),large:Object(a.a)(e+"_64x64"),cdn:-1===p.indexOf(e)?Object(o.a)(e+"_16x16"):Object(o.a)("generic_16x16")},c[e])}var u="generic",d=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":u,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),l=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"}),p=["gdoc","gform","gsheet","gslide"];function m(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(a.a)("folder_20x20"),medium:Object(a.a)("folder_32x32"),large:Object(a.a)("folder_64x64"),cdn:Object(o.a)("folder_16x16")};var c,p=Object(i.a)(e);return p&&(c=d[p.toLowerCase()]),!c&&n&&n in l&&(c=l[n]),s(c||u)}},1235:function(e,t){e.exports=function(e){return e instanceof Date}},12664:function(e,t,n){var r=n(12665),o=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},12665:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'._1pPFwx5rYgxcgAElMzLbAd{display:block;width:261px}html[dir] ._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:focus,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE ._302eciisr8EpJrDSwH_Sbx,._1pPFwx5rYgxcgAElMzLbAd:hover ._302eciisr8EpJrDSwH_Sbx{width:142px}._Y2ypFk_xp-nvQtuGu_-h{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;position:relative}._3wcJ_rB4jUxKLkaKrKj_GZ{display:block}html[dir] ._3wcJ_rB4jUxKLkaKrKj_GZ{margin:6px 8px}._2Pr_qifjTGwPB6L_eo24_B{font-size:24px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._2Pr_qifjTGwPB6L_eo24_B{background:transparent}._1Ra5rtzVEB6uogdqQiC2rx{display:block;white-space:nowrap;position:relative;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._1Ra5rtzVEB6uogdqQiC2rx{padding:6px 4px}._3EsA8G8nIiVlrwi7EvfneN{font-size:14px}._3EsA8G8nIiVlrwi7EvfneN,._302eciisr8EpJrDSwH_Sbx{font-weight:400;max-width:194px}._302eciisr8EpJrDSwH_Sbx{font-size:11px}html[dir] ._302eciisr8EpJrDSwH_Sbx{padding-top:3px}._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{font-size:12px;font-weight:400;font-weight:600;position:relative;top:2px}html[dir=ltr] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-right:4px}html[dir=rtl] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-left:4px}._302eciisr8EpJrDSwH_Sbx ._1DD8d7Q5IxT7aE8KaVPUKa{color:#107c10}._302eciisr8EpJrDSwH_Sbx ._23Ys9CLV_lGJ3w0LIHTfLi{color:#e81123}._2Tuvy48k5aBpiLeRkrcceY{overflow:hidden;text-overflow:ellipsis}._2aO0rTKW0ac8YNFb8bLNnA{height:26px;width:52px;position:absolute;bottom:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir=ltr] ._2aO0rTKW0ac8YNFb8bLNnA{right:0}html[dir=rtl] ._2aO0rTKW0ac8YNFb8bLNnA{left:0}.CO4JS_CRPsg_js1AAXe-d{display:block;height:100%;width:26px;position:absolute;bottom:0}html[dir=ltr] .CO4JS_CRPsg_js1AAXe-d{right:0}html[dir=rtl] .CO4JS_CRPsg_js1AAXe-d{left:0}html[dir] .CO4JS_CRPsg_js1AAXe-d:focus,html[dir] .CO4JS_CRPsg_js1AAXe-d:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}.GeukVsgtTix5zrmhP2k1C{font-size:14px}html[dir] .GeukVsgtTix5zrmhP2k1C{margin:0}.KLhaPYQ6nYXemE5yXxev7{font-size:12px;font-weight:400;line-height:30px;cursor:pointer;width:261px;-webkit-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}html[dir=ltr] .KLhaPYQ6nYXemE5yXxev7{padding:0 20px 0 54px}html[dir=rtl] .KLhaPYQ6nYXemE5yXxev7{padding:0 54px 0 20px}html[dir] .KLhaPYQ6nYXemE5yXxev7:focus,html[dir] .KLhaPYQ6nYXemE5yXxev7:hover{background:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._1pk_VDuef6gt4o_QRNLHAe{margin-top:-4px}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator-itemName{display:none}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{padding:0}',""]),t.locals={container:"_1pPFwx5rYgxcgAElMzLbAd",active:"_3JHQes77teu7GToIsCc_xE",secondLine:"_302eciisr8EpJrDSwH_Sbx",innerContainer:"_Y2ypFk_xp-nvQtuGu_-h",thumbnailDiv:"_3wcJ_rB4jUxKLkaKrKj_GZ",placeholder:"_2Pr_qifjTGwPB6L_eo24_B",infoDiv:"_1Ra5rtzVEB6uogdqQiC2rx",firstLine:"_3EsA8G8nIiVlrwi7EvfneN",icon:"GeukVsgtTix5zrmhP2k1C",success:"_1DD8d7Q5IxT7aE8KaVPUKa",failure:"_23Ys9CLV_lGJ3w0LIHTfLi",textOverFlow:"_2Tuvy48k5aBpiLeRkrcceY",actionsContainer:"_2aO0rTKW0ac8YNFb8bLNnA",menuButton:"CO4JS_CRPsg_js1AAXe-d",menuItem:"KLhaPYQ6nYXemE5yXxev7",progressIndicator:"_1pk_VDuef6gt4o_QRNLHAe"}},12666:function(e,t,n){var r=n(12667),o=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},12667:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,"._3h6BOcXe5rgJt2gWiPg7WW{overflow-y:auto;overflow-x:hidden}",""]),t.locals={container:"_3h6BOcXe5rgJt2gWiPg7WW"}},12668:function(e){e.exports={a:"QKb"}},12669:function(e,t,n){var r=n(12670),o=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},12670:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'._2I3DVKJX90XpSU9E0jOrPI{color:"[theme:neutralDark, default:#212121]"}html[dir] ._2I3DVKJX90XpSU9E0jOrPI{border-radius:2px;border-color:transparent}html[dir] ._2I3DVKJX90XpSU9E0jOrPI:not(:hover){background-color:transparent}._2I3DVKJX90XpSU9E0jOrPI.ms-Button{min-width:50px}html[dir] ._2I3DVKJX90XpSU9E0jOrPI.ms-Button{padding:0}html[dir=ltr] .jflLAFNOz_OPbbqzYM9gl{margin-left:2px}html[dir=rtl] .jflLAFNOz_OPbbqzYM9gl{margin-right:2px}._1kEgpc1Wh6CbzQbd6iET2p{font-size:10px}html[dir] ._1kEgpc1Wh6CbzQbd6iET2p{margin:2px 6px 0 6px}._3JXvFMglzZ7tMbYPkjKuKC{font-size:14px;font-weight:400}html[dir] ._3JXvFMglzZ7tMbYPkjKuKC{margin:0}',""]),t.locals={button:"_2I3DVKJX90XpSU9E0jOrPI",icon:"jflLAFNOz_OPbbqzYM9gl",menuIcon:"_1kEgpc1Wh6CbzQbd6iET2p",label:"_3JXvFMglzZ7tMbYPkjKuKC"}},1373:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2881),o="fileType-icon";function a(e){return r[function(e){return o+"-"+e}(e)]}},13759:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(18),a=n(1189),i=n(1763),c=n(60),s=n(15),u=n(4009),d=n(1),l=Object(d.mutatorAction)("setConversationAttachmentWellVisible",function(e,t){e.isVisible=t}),p=n(4),m=n(7492),f=n(2),h=n(6451),v=Object(d.mutatorAction)("updateConversationAttachmentWellMaxHeight",function(e){e.maxHeight=(window.innerHeight||document.body.clientHeight)-200}),b=n(8208),g=n(1633),O=n(17),_=n(46),w=n(1560),x=n(394),C=n(5473),I=n(52),j=n(478),y=n(7489),S=n(8219),A=n(7803),P=n(258),k=n(1403),T=n(3953),E=n(2563),D=n(5),M=n(452),N=n(927),V=n(6057),L=n(156),R=n(364),F=n(11),z=n(12664),B=n(115).bind(z),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyDown=function(e){e.keyCode!==I.a.enter&&e.keyCode!==I.a.space||t.onClick()},t.keyDownForMenuButton=function(e){e.keyCode!==I.a.enter&&e.keyCode!==I.a.space||(F.c.info("AttachmentMenuButton.keyDown enter|space"),e.stopPropagation())},t.onClick=function(e){var n=Object(j.e)(t.props.attachmentViewState.strategy);if(n!==j.a.NoAction){var r=y.c.OnClick,o=r.name,a=r.customData;Object(s.o)(o,a(n)),Object(T.c)(t.props.attachmentViewState,R.c.ConversationAttachmentWell,t.props.instrumentationContext,t.props.parentItemId,!1,t.props.onBeforePreview,t.props.createImageGallery,t.containerElement.parentElement)}},t.onContextMenu=function(e){e.preventDefault(),Object(u.a)(t.props.attachmentViewState,t.contextMenuJustOpened=!0)},t.onMenuButtonClicked=function(e){e.stopPropagation(),Object(u.a)(t.props.attachmentViewState,t.contextMenuJustOpened=!t.props.attachmentViewState.shouldShowContextMenu)},t.onContainerElementUpdate=function(e){t.containerElement=e},t.onFocusOrMouseOver=function(){t.props.onFocus&&t.props.onFocus(t.props.attachmentViewState.attachmentId.Id)},t}return r.__extends(t,e),t.prototype.render=function(){var e=Object(k.a)(this.props.attachmentViewState.attachmentId),t=13===e.attachmentClass&&Object(D.e)("cal-ics-preview");return f.createElement("div",{"aria-label":e.model.Name,ref:this.onContainerElementUpdate,onFocus:this.onFocusOrMouseOver,onKeyDown:this.keyDown,onMouseOver:this.onFocusOrMouseOver,className:B(z.container,{active:this.props.attachmentViewState.shouldShowContextMenu}),tabIndex:0,"data-is-focusable":!0,onClick:this.onClick,onContextMenu:this.onContextMenu},f.createElement("div",{className:z.innerContainer},this.renderIcon(e),this.renderInfo(e),this.props.attachmentViewState.strategy.showActionsMenu&&this.props.attachmentViewState.shouldShowActionsContainer&&f.createElement("div",{className:z.actionsContainer},f.createElement(y.a,{attachmentViewState:this.props.attachmentViewState,isForImageView:!1,previewState:R.a.None,shouldNotHandleOnBlur:!0,isForAddToCalendar:t}),f.createElement(w.a,{"data-is-focusable":!1,className:z.menuButton,onClick:this.onMenuButtonClicked,title:Object(p.a)(V.a),ariaLabel:Object(p.a)(V.a),onKeyDown:this.keyDownForMenuButton,iconProps:{iconName:this.props.attachmentViewState.shouldShowContextMenu?"ChevronUp":"ChevronDown",styles:{root:z.icon}}}))),this.renderProgressIndicator(),this.props.attachmentViewState.shouldShowContextMenu?this.renderContextMenu(e):null)},t.prototype.renderIcon=function(e){var t=P.o.tryImportForRender();if(t&&t(e.model)){var n=e.model.Name,r=Object(N.e)(n),o=null,a=Object(O.getIconClassName)("Photo2");return Object(M.d)(n)&&(o=r.small,a=r.small),f.createElement("div",{className:z.thumbnailDiv},f.createElement(E.c,{attachmentViewState:this.props.attachmentViewState,placeHolderCSSClass:B(a,z.placeholder),fileIconCssClass:o,imageLoadErrorCSSClass:r.small,thumbnailWidth:32,thumbnailHeight:32}))}return f.createElement(E.b,{attachmentId:this.props.attachmentViewState.attachmentId})},t.prototype.renderInfo=function(e){var t=1!==e.type&&0===this.props.attachmentViewState.actionMessage?{text:Object(L.a)(this.props.itemReceivedTime),title:null,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1}:Object(S.a)(this.props.attachmentViewState,e);return f.createElement("div",{className:z.infoDiv},f.createElement("div",{className:B(z.firstLine,z.textOverFlow),title:e.model.Name},e.model.Name),f.createElement("div",{className:B(z.secondLine,z.textOverFlow),title:t.title},t.shouldDisplaySuccessIcon?f.createElement(x.a,{iconName:"Accept",className:B(z.icon,z.success)}):null,t.shouldDisplayFailureIcon?f.createElement(x.a,{iconName:"Cancel",className:B(z.icon,z.failure)}):null,t.text))},t.prototype.renderContextMenu=function(e){var t=this,n=y.d.tryImportForRender(),r=n?n(this.props.attachmentViewState,e,{viewState:this.props.attachmentViewState,previewPaneSelectionSource:R.c.ConversationAttachmentWell,parentItemId:this.props.parentItemId,isDraft:!1,onBeforePreview:this.props.onBeforePreview,createImageGallery:this.props.createImageGallery,instrumentationContext:this.props.instrumentationContext},this.props.parentItemId,null,this.containerElement.parentElement,null):[];return f.createElement("div",null,r.map(function(e){return f.createElement(W,{key:e.key,attachmentViewState:t.props.attachmentViewState,menuItem:e})}))},t.prototype.renderProgressIndicator=function(){return Object(A.a)(this.props.attachmentViewState)?f.createElement("div",{className:z.progressIndicator},f.createElement(C.a,{percentComplete:this.props.attachmentViewState.actionCompletePercent})):null},t.prototype.componentDidUpdate=function(e,t){if(this.contextMenuJustOpened&&(this.contextMenuJustOpened=!1,this.props.attachmentViewState.shouldShowContextMenu)){var n=this.containerElement.parentElement.clientHeight,r=this.containerElement.parentElement.scrollTop,o=this.containerElement.offsetHeight,a=this.containerElement.offsetTop;o+a>n+r?this.containerElement.parentElement.scrollTop=o+a-n:a<r&&(this.containerElement.parentElement.scrollTop=a)}},t=r.__decorate([o.observer],t)}(f.Component),W=Object(_.a)(function(e){var t=f.useCallback(function(t){t.stopPropagation(),e.menuItem.onClick(t,e.menuItem),Object(u.a)(e.attachmentViewState,!1)},[e.menuItem,e.attachmentViewState]),n=f.useCallback(function(t){t.keyCode!==I.a.enter&&t.keyCode!==I.a.space||(t.stopPropagation(),e.menuItem.onClick(),Object(u.a)(e.attachmentViewState,!1))},[e.menuItem,e.attachmentViewState]);return f.createElement("div",{tabIndex:0,"data-is-focusable":!0,className:z.menuItem,onClick:t,onKeyDown:n},e.menuItem.name)}),q=n(12666),X=n(115).bind(q),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onItemFocused=function(e){t.props.viewState.docViewAttachments.forEach(function(t){Object(h.a)(t,t.attachmentId.Id===e),t.shouldShowContextMenu&&t.attachmentId.Id!==e&&Object(u.a)(t,!1)})},t.onResize=function(){v(t.props.viewState)},t.createImageGallery=function(){return r.__awaiter(t,void 0,void 0,function(){return r.__generator(this,function(e){return[2,Object(b.a)(this.props.viewState,!0)]})})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.onResize(),g.a.importAndExecute(this.onResize)},t.prototype.componentWillUnmount=function(){g.c.importAndExecute(this.onResize)},t.prototype.render=function(){var e=this;return f.createElement("div",{className:X("disableTextSelection","customScrollBar",q.container),style:{maxHeight:this.props.viewState.maxHeight+"px"}},this.props.viewState.docViewAttachments.map(function(t){return f.createElement(H,{key:"convoWell_"+t.attachmentId.Id,attachmentViewState:t,parentItemId:e.props.viewState.parentItemIdMap[t.attachmentId.Id],itemReceivedTime:e.props.viewState.itemReceivedTimeMap[t.attachmentId.Id],instrumentationContext:e.props.instrumentationContext,onBeforePreview:e.props.onBeforePreview,onFocus:e.onItemFocused,createImageGallery:e.createImageGallery})}))},t=r.__decorate([o.observer],t)}(f.Component),J=n(12668),U=n(12669),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dataPointLogged=!1,t.onComponentMountOrUpdate=function(){!t.dataPointLogged&&t.props.viewState.docViewAttachments.length>0&&(t.dataPointLogged=!0,Object(s.o)("ConversationAttachmentWellButtonShown"))},t.dismissCallout=function(){l(t.props.viewState,!1),t.props.viewState.docViewAttachments.forEach(function(e){Object(u.a)(e,!1)})},t.onShowMenuClicked=function(){t.props.viewState.isVisible?t.dismissCallout():(l(t.props.viewState,!0),Object(s.o)("ConversationAttachmentWellButtonClicked",null,{cosmosOnlyData:JSON.stringify({numberOfAttachments:t.props.viewState.docViewAttachments.length})}))},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.viewState.docViewAttachments.length;if(0===t)return null;var n=t+(this.props.canLoadMore?"+":"");return f.createElement("div",{className:this.props.className||""},f.createElement("div",{ref:function(t){return e.buttonElement=t}},f.createElement(a.a,{onClick:this.onShowMenuClicked,text:n,className:U.button,iconProps:{iconName:"Attach",styles:{root:U.icon}},menuIconProps:{iconName:"ChevronDown",styles:{root:U.menuIcon}},ariaLabel:this.getAriaLabel(),styles:{label:U.label}})),this.props.viewState.isVisible?f.createElement(i.a,{setInitialFocus:!0,isBeakVisible:!1,target:this.buttonElement,onDismiss:this.dismissCallout,directionalHint:c.a.bottomRightEdge},f.createElement(Y,{viewState:this.props.viewState,instrumentationContext:this.props.instrumentationContext,onBeforePreview:this.dismissCallout})):null)},t.prototype.componentDidMount=function(){this.onComponentMountOrUpdate()},t.prototype.componentDidUpdate=function(){this.onComponentMountOrUpdate()},t.prototype.getAriaLabel=function(){var e=this.props.viewState.docViewAttachments.length;return e>1?Object(p.b)(Object(p.a)(m.a),e):Object(p.b)(Object(p.a)(J.a),e)},t=r.__decorate([o.observer],t)}(f.Component);n.d(t,"ConversationAttachmentWellButton",function(){return G})},1747:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=1;function o(e){return"https://r"+(r++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},2086:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),o=new r.c(function(){return n.e(351).then(n.bind(null,3225))}),a=new r.a(o,function(e){return e.print})},2226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},2230:function(e,t,n){var r=n(2871),o=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*o)}},2234:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setShouldShowImageOverlay")(function(e,t){e.shouldShowImageOverlay=t})},2428:function(e,t,n){"use strict";var r=n(2473),o=n(2234),a=n(2494),i=n(8);t.a=Object(i.action)("setOngoingActionAndActionMessage")(function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(a.a)(e)?Object(o.a)(e,!0):Object(o.a)(e,!1)})},2429:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r,o=n(1086),a=n(1747);function i(e,t,n,i,c){if(n)return r=r||{extraSmall:Object(o.b)("generic").extraSmall,small:Object(o.b)("generic").small,medium:Object(o.b)("blockedfile").medium,large:Object(o.b)("generic").large,cdn:Object(a.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":return Object(o.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(o.b)("calendar")}return i?Object(o.b)("sharedfolder"):Object(o.a)(e,!1,t)||Object(o.b)("generic")}},2437:function(e,t,n){"use strict";var r=n(2475),o=n(4),a=n(2458),i=n(2428);var c=n(374),s=n(679),u=n(857),d=n(258),l=n(8);n.d(t,"b",function(){return m});var p=null;function m(){return p||(p=Object.keys(c.a).reduce(function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e},[])),p}t.a=Object(l.action)("initializeAttachmentFullViewState")(function(e,t,n){var l;n&&0!==n.length||(l=t.model,n=Object(d.e)(l)?function(e){return 2===Object(d.c)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(l):m());var p=Object(u.f)(t.model,!0),f=Object(u.k)(),h=Object(s.a)(t),v=Object(r.a)(f,p,t.attachmentClass,t.model,h?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,n,e.isReadOnly);e.strategy=v,function(e,t,n){n&&!Object(o.g)(t.model.AttachmentOriginalUrl)&&(Object(a.a)(e,2),Object(i.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)})},2439:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(2226);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2458:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("addCompletedAction")(function(e,t){e.completedActions.push(t)})},2473:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setOngoingAction")(function(e,t){e.ongoingAction=t})},2475:function(e,t,n){"use strict";var r=n(0),o=n(4),a=n(857),i=n(374),c=n(91),s=n(478);function u(e){switch(e){case i.a.Download:return s.a.Download;case i.a.OpenInNewTab:return s.a.OpenInNewTab;case i.a.Preview:return s.a.Preview;case i.a.ImportCalendarEventAttachment:case i.a.ChangePermissions:case i.a.CopyLink:case i.a.SaveToCloud:case i.a.ViewInProvider:case i.a.ConvertClassicToCloudy:case i.a.ConvertCloudyToClassic:case i.a.MoveAttachmentToInline:case i.a.RefreshLink:case i.a.IgnoreExpiration:return null;default:return Object(c.a)(e)}}function d(e){switch(e){case s.a.Download:return i.a.Download;case s.a.OpenInNewTab:return i.a.OpenInNewTab;case s.a.Preview:return i.a.Preview;case s.a.NoAction:return null;default:return Object(c.a)(e)}}var l=n(2082),p=n(41);var m=Object(l.a)(function(e){switch(e){case 0:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},r.__assign({},t,{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return r.__assign({},e,{supportConvertCloudyToClassic:Object(p.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(c.a)(e)}var t}),f=m.getDataProviderInfo,h=m.getDefaultDataProviderInfo,v=f;var b=n(258);function g(e,t,n,o,i,c,l,p,m){var f=Object(s.d)(t,n,o);!function(e,t){var n=function(e,t,n){void 0===n&&(n=!1);var r=e.filter(function(e){return-1!==t.indexOf(e)});return n&&(r=r.filter(function(e,t,n){return n.indexOf(e)===t})),r}(e.supportedOpenActions.map(d).filter(function(e){return!!e}),t);e.supportedOpenActions=n.map(u)}(f,p);var h,g=function(e){return e.__type===b.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||e.__type===b.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(o),_=Object(a.j)(o,g,m),w=function(e,t){return e}(g),x=O(g,c),C=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,g,m),I=function(e,t,n,r,o){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var a=v(o);return a&&a.supportConvertCloudyToClassic||!1}return!1}(e,g,m,l,i),j=function(e,t,n){return 2===e&&!t&&!n}(n,g,m);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:h=function(e,t,n,o,a,i,c,s){return r.__assign({},e,{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:o,isViewingInProviderSupported:a,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:s,showActionsMenu:!0,supportedMenuActions:[]})}(f,_,g,w,x,C,I,j);break;case 1:h=function(e){return r.__assign({},e,{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(f);break;default:h=g?function(e,t,n,o){return r.__assign({},e,{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:o,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(f,w,x,I):function(e,t,n,o){return r.__assign({},e,{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:o,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(f,_,x,C)}return h.supportedMenuActions=p,h}function O(e,t){if(e)return!1;var n=Object(p.a)(),r=h(n);return!Object(o.g)(t)&&(n||r&&r.supportViewInProvider)}n.d(t,"a",function(){return g}),n.d(t,"b",function(){return O})},2494:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",function(){return r})},2563:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var r=n(3),o=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(11),n.e(119)]).then(n.bind(null,3238))}),a=Object(r.d)(o,function(e){return e.AttachmentThumbnailView}),i=Object(r.d)(o,function(e){return e.AttachmentIconView}),c=Object(r.d)(o,function(e){return e.AttachmentDocInfoView})},2871:function(e,t,n){var r=n(973);e.exports=function(e,t){var n=r(e).getTime(),o=Number(t);return new Date(n+o)}},3341:function(e,t,n){"use strict";var r=n(0),o=n(3919),a=n(2458),i=n(2428),c={},s=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent,this.updatePropertyHandler=this.updatePropertyHandler.bind(this)}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout(function(){return e.updatePropertyHandler(1.1)},500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function u(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function d(e,t,n,r){var o=new s(e,t,n);c[r.Id]=o,o.start()}var l=n(4115),p=n(1);Object(p.orchestrator)(o.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:o=e.attachment,Object(i.a)(o,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,o){u(e,!0),Object(a.a)(n,o),Object(i.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var o})})});var m=n(374),f=n(4047),h=n(4310),v=n.n(h),b=n(4898),g=n.n(b);function O(e,t,n,r,o){var a=function(e,t,n,r,o){return v()({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:o})}(e,t,n,r,o);return g()({requestObject:a})}var _=n(15),w=n(1403),x=n(3950),C=n(375),I=n(8),j={},y=Object(I.action)("convertClassicToCloudy")(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var o,a,c;return r.__generator(this,function(r){switch(r.label){case 0:return o=new _.a("AttachmentConvertClassicToCloudy"),function(e){Object(i.a)(e,5,8)}(e),a=function(t){if(A(e,t.ResultCode),P(o,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){A(e,1),n(!1,null),P(o,e.attachmentId,1,t)},[4,S(e.attachmentId,t,a,c)];case 1:return r.sent(),[2]}})})});function S(e,t,n,o){return r.__awaiter(this,void 0,void 0,function(){var a,i,c,s,u,d;return r.__generator(this,function(l){switch(l.label){case 0:return[4,Object(x.a)(n)];case 1:a=r.__read.apply(void 0,[l.sent(),4]),i=a[0],c=a[1],s=a[2],u=a[3],j[e.Id]=i,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,O(e.Id,t,i,u,i)];case 3:return l.sent(),[3,5];case 4:return d=l.sent(),o(d.message),C.g.importAndExecute(c,s),[3,5];case 5:return[2]}})})}function A(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,9)}delete j[e.attachmentId.Id]}function P(e,t,n,r){var o=Object(w.a)(t);e.addCosmosOnlyData(JSON.stringify({size:o.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var k={name:"CancelConvertClassicToCloudy"},T={name:"CancelConvertCloudyToClassic"},E=n(4311),D=n.n(E),M=n(4899),N=n.n(M);function V(e){var t=function(e){return D()({cancellationId:e})}(e);return N()(t)}var L=n(25),R=Object(L.b)("cancelConvertClassicToCloudy",k)(function(e){var t,n=(t=e.attachmentId.Id,j[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(i.a)(e,5,10),V(n)}),F=n(4526),z=n(3920),B=n(4409),H=n(2475),W=Object(I.action)("updateIsViewingInProviderSupported")(function(e,t){e.strategy.isViewingInProviderSupported=t}),q=Object(I.action)("saveToCloud")(function(e,t,n){var r=new _.a("AttachmentSaveToCloud");Y(e);Object(B.b)(e.attachmentId,null,function(o){var a=0===o.ResultCode;return J(e,a,a?o.Item.Location:null),t(a),X(r,e.attachmentId,o.ResultCode,"ServerError",o.Exception,n),!0},function(o,a,i){J(e,!1,null),t(!1),X(r,e.attachmentId,a,i,o,n)})});function X(e,t,n,r,o,a){var i=Object(w.a)(t);e.addCustomData({entryPoint:a,result:n}),e.addCosmosOnlyData(JSON.stringify({size:i.model.Size,fileType:Object(z.a)(i)})),0===n?e.end():e.endWithError(r,new Error(o))}function Y(e){Object(i.a)(e,2,1)}function J(e,t,n){if(t){Object(a.a)(e,2),Object(F.a)(e.attachmentId,n);var r=Object(H.b)(!1,n);W(e,r)}Object(i.a)(e,0,t?3:4)}var U=Object(I.action)("setActionCompletePercent")(function(e,t){e.actionCompletePercent=t}),G=n(4009),Q=n(3770),K=(n(2234),n(2437)),Z=n(3857),$=n(478),ee=n(3898),te=n(4008),ne=n(4434),re=n(679),oe=Object(I.action)("updateAttachment")(function(e,t,n,o,a){Object(te.a)(e.attachmentId);var c=r.__assign({},o.AttachmentId,{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,o.Name&&(n.Name=o.Name),o.Size&&(n.Size=o.Size),o.ContentType&&(n.ContentType=o.ContentType),o.__type&&(n.__type=o.__type),n.IsInline&&(n.ContentId=o.ContentId),Object(re.b)(o)){var s=n;s.AttachLongPathName=o.AttachLongPathName,s.PermissionType=o.PermissionType,s.ProviderType=o.ProviderType,s.AttachmentThumbnailUrl=o.AttachmentThumbnailUrl,s.AttachmentPreviewUrl=o.AttachmentPreviewUrl}if(Object(ee.a)([{attachmentId:c,attachment:n,permissionInfo:a}],!1),e.attachmentId=c,Object(Z.a)(e))Object(Q.a)(e,1);else{Object($.g)(e,!1),setTimeout(function(){U(e,1.1)},500),Object(i.a)(e,0,0);var u=Object(w.a)(c);Object(K.a)(e,u,e.strategy.supportedMenuActions),u.download.url||Object(ne.a)(c,e.isReadOnly,!0)}}),ae=n(4312),ie=n.n(ae),ce=n(4900),se=n.n(ce);function ue(e,t,n,r,o,a,i,c){var s=function(e,t,n,r,o,a,i,c){return ie()({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:o,fullPathLocation:a,attachmentDataProviderId:c,PermissionLevel:i})}(e,t,n,r,o,a,i,c);return se()({requestObject:s})}function de(e){return he(Object(w.a)(e).model.Size)}function le(e){return 2856+.00145*e}function pe(e){return 4*he(e)}function me(e){return 4*he(e)}function fe(e){return 2*he(e)}function he(e){return Math.round(e/256)}var ve=n(4226),be=n.n(ve),ge={},Oe=Object(p.action)("convertCloudyToClassic",function(e,t,n,r,o,a){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:o,source:a}}),_e=Oe;function we(e,t,n,o,a,i){return r.__awaiter(this,void 0,void 0,function(){var c,s,u,d,l,p;return r.__generator(this,function(m){switch(m.label){case 0:return[4,Object(x.a)(a)];case 1:c=r.__read.apply(void 0,[m.sent(),4]),s=c[0],u=c[1],d=c[2],l=c[3],ge[e.Id]=s,m.label=2;case 2:return m.trys.push([2,4,,5]),[4,ue(e.Id,t,s,l,s,n,o)];case 3:return m.sent(),[3,5];case 4:return p=m.sent(),i(p.message),C.g.importAndExecute(u,d),[3,5];case 5:return[2]}})})}function xe(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,12)}delete ge[e.attachmentId.Id]}function Ce(e,t,n,r,o){var a=Object(w.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size,attachmentId:a.model.AttachmentId&&a.model.AttachmentId.Id})),e.addCustomData([n,o]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}Object(p.orchestrator)(Oe,function(e){var t=e.attachment;!function(e,t,n,o,a,c){r.__awaiter(this,void 0,void 0,function(){var s,u,d;return r.__generator(this,function(r){switch(r.label){case 0:return s=new _.a("AttachmentConvertCloudyToClassic"),function(e){Object(i.a)(e,6,11)}(e),u=function(t){if(xe(e,t.ResultCode),Ce(s,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=be()({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});a(!0,n)}else a(!1,null);return!0},d=function(t){xe(e,1),a(!1,null),Ce(s,e.attachmentId,1,t,c)},[4,we(e.attachmentId,t,n,o,u,d)];case 1:return r.sent(),[2]}})})}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):u(t.attachmentId,n)},e.source),d(de(t.attachmentId),.1,function(e){U(t,e)},t.attachmentId)});var Ie=n(4313),je=n.n(Ie),ye=n(4901),Se=n.n(ye);function Ae(e){var t=function(e){return je()({cancellationId:e})}(e);return Se()(t)}var Pe=Object(p.action)("cancel_ConvertCloudyToClassic",function(e){return Object(L.a)(T,{attachmentViewState:e})}),ke=Pe;Object(p.orchestrator)(Pe,function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,ge[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(i.a)(e.attachmentViewState,6,10),Ae(n)});var Te=n(857),Ee=n(3430),De=n(258);function Me(e){return r.__awaiter(this,void 0,void 0,function(){var t=this;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Ee.h.import()];case 1:return n.sent()(e.model.AttachLongPathName).then(function(n){return r.__awaiter(t,void 0,void 0,function(){var t,o;return r.__generator(this,function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(Te.f)(e.model,!0),[4,De.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return o=r.sent(),De.m.importAndExecute(e.id,o),Object(De.p)(e.id),[2]}})})}),[2]}})})}var Ne=n(3856),Ve=n(1507);function Le(e,t,n,r,o){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===o&&(o=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:Ve.a.Inline,skipProcessInlineImage:o}}function Re(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}n.d(t,"g",function(){return f.a}),n.d(t,"b",function(){return R}),n.d(t,"d",function(){return y}),n.d(t,"s",function(){return q}),n.d(t,"u",function(){return Y}),n.d(t,"t",function(){return J}),n.d(t,"v",function(){return U}),n.d(t,"w",function(){return G.a}),n.d(t,"x",function(){return Q.a}),n.d(t,"y",function(){return i.a}),n.d(t,"B",function(){return oe}),n.d(t,"p",function(){return K.a}),n.d(t,"m",function(){return K.b}),n.d(t,"c",function(){return ke}),n.d(t,"e",function(){return _e}),n.d(t,"l",function(){return Me}),n.d(t,"z",function(){return d}),n.d(t,"A",function(){return u}),n.d(t,"j",function(){return le}),n.d(t,"k",function(){return me}),n.d(t,"o",function(){return pe}),n.d(t,"i",function(){return fe}),n.d(t,"f",function(){return Ne.a}),n.d(t,"h",function(){return Le}),n.d(t,"n",function(){return de}),n.d(t,"r",function(){return Re}),n.d(t,"q",function(){return Z.a}),n.d(t,"a",function(){return m.a})},3488:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55);t.default=function(e,t){return r.makeServiceRequest("GetWacAttachmentInfo",e,t)}},3698:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function o(e){return e&&void 0!==e.fetchErrorType}function a(e,t){e.addCustomProperty("ErrorInformation",t)}function i(e,t){a(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return i})},3770:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setInlineAttachmentStatus")(function(e,t){e.status=t})},3856:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),o=n(478),a=n(1507);function i(e,t,n,i,c,s,u){void 0===c&&(c=a.a.Unknown),void 0===s&&(s=!1),void 0===u&&(u=null);var d=Object(o.c)(e,t,i,s,c,u),l=d.strategy;return r.__assign({},d,{attachmentType:0,strategy:r.__assign({},l,{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},3857:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",function(){return r})},3919:function(e,t,n){"use strict";var r=n(1),o=n(25),a=Object(r.action)("addCalendarEventsAttachment",function(e,t){return Object(o.a)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})});t.a=a},3920:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(452);function o(e){var t="";return e&&e.model&&(t=Object(r.b)(e.model.Name||"")||e.model.ContentType||""),t}},3950:function(e,t,n){"use strict";var r=n(0),o=n(86),a=n(375);function i(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(o.a)(),n={subscriptionId:t,requiresExplicitSubscribe:!1,subscriptionParameters:null},i=function(t){e(t)&&a.g.importAndExecute(n,i)},[4,a.f.import()];case 1:return r.sent()(n,i),[4,a.b.import()];case 2:return c=r.sent()(),[2,[t,n,i,c]]}})})}n.d(t,"a",function(){return i})},3953:function(e,t,n){"use strict";var r=n(0),o=n(258),a=n(1403),i=n(1065),c=n(1193);function s(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var s,u;return r.__generator(this,function(r){switch(r.label){case 0:return(s=Object(a.a)(e))?Object(o.e)(s.model)?[4,c.e.import()]:[3,2]:[2];case 1:return r.sent()(s.model),[3,3];case 2:(u=s.download.url)&&Object(i.b)(u,t,n),r.label=3;case 3:return[2]}})})}var u=n(3),d=n(364);n.d(t,"c",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"a",function(){return d.c}),n.d(t,"b",function(){return s});var l=new u.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(11),n.e(119)]).then(n.bind(null,13870))}),p=new u.a(l,function(e){return e.clickAttachment}).importAndExecute,m=new u.a(l,function(e){return e.previewAttachment})},3979:function(e,t,n){"use strict";function r(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",function(){return r})},4008:function(e,t,n){"use strict";var r=n(905),o=n(8);t.a=Object(o.action)("deleteAttachment")(function(e){Object(r.a)().attachments.delete(e.Id)})},4009:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")(function(e,t){e.shouldShowContextMenu=t})},4047:function(e,t,n){"use strict";var r=n(2437),o=n(0),a=n(185),i=n(207);var c=n(4142);function s(e){return o.__awaiter(this,void 0,void 0,function(){var t;return o.__generator(this,function(n){switch(n.label){case 0:return e.strategy.previewMethod!==i.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===i.a.Wac&&(r.previewMethod=i.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter(function(e){return e!==a.a.Preview})),n.label=2;case 2:return[2]}var r})})}var u=n(3856),d=n(1507),l=n(3898),p=n(1403);function m(e,t,n,o,a,i,c,m){void 0===i&&(i=null),void 0===m&&(m=!1),Object(l.a)([{attachmentId:e,attachment:t}],n,a);var f=Object(p.a)(e),h=Object(u.a)(e,n,o,1===f.type,d.a.Unknown,!1,i);return Object(r.a)(h,f,c),m&&s(h),h}n.d(t,"a",function(){return m})},4052:function(e){e.exports={a:"Pqb"}},4078:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3488),o=n.n(r);function a(e,t,n,r,a){if(a){var i="getWacAttachmentInfo"+a;(r=r||{}).headers=r.headers||new Headers,r.headers.set("X-OWA-ActionName",i)}return o()({attachmentId:e,isEdit:t,draftId:n,appId:null},r)}},4079:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}},4115:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(102),o=n.n(r),a=n(4116),i=n.n(a),c=n(4118),s=n.n(c),u=n(266),d=n.n(u),l=n(27);function p(e,t,n){return i()({Header:Object(l.getJsonRequestHeader)(),Body:s()({Content:e,ImportedItemFolderId:d()({BaseFolderId:o()({Id:t})}),AttachmentId:n})},{datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}}).then(function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")})}},4116:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(4117);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("ImportCalendarEvent",e,t)}},4117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ImportCalendarEventJsonRequest:#Exchange"},e)}},4118:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ImportCalendarEventRequest:#Exchange"},e)}},4142:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),o=n(15),a=n(3698),i=n(4078),c={},s={},u=[],d=0,l=2;function p(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var i,c;return r.__generator(this,function(s){return i=new o.a("InitializeWacUrl"),n&&i.addCustomProperty("actionSource",n),(c=f(e,t,i))?[2,c]:[2,new Promise(function(o,c){var s={attachmentId:e,isEdit:t,actionSource:n,datapoint:i,resolve:o,reject:c};a?m(s):(u.push(s),function e(){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:if(!u.length)return[2];if(d>=l)return[2];t=u.shift(),d++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,m(t)];case 2:return n.sent(),[3,4];case 3:return d--,e(),[7];case 4:return[2]}})})}())})]})})}function m(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o,u,d,l,p,m,h;return r.__generator(this,function(r){switch(r.label){case 0:if(t=e.attachmentId,n=e.isEdit,o=e.actionSource,u=e.datapoint,d=e.resolve,l=e.reject,p=f(t,n,u))return d(p),[2];u.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(i.a)(t.Id,n,null,t.mailboxInfo&&t.mailboxInfo.requestOptions,o)];case 2:return 0===(m=r.sent()).Status&&((n?s:c)[t.Id]={expireTime:(new Date).getTime()+36e5,value:m}),m.WacUrl||u.addCustomProperty("WacUrlIsEmpty",!0),u.addCustomProperty("WacAttachmentResponseStatus",m.Status.toString()),u.end(),d(m),[3,4];case 3:return h=r.sent(),Object(a.a)(h)&&Object(a.c)(u,h.response),Object(a.d)(u,h.toString()),u.endWithError("ServerError"),l(h),[3,4];case 4:return[2]}})})}function f(e,t,n){var r=t?s:c,o=r[e.Id];if(o){if(o.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),o.value;delete r[e.Id]}return null}},4226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FileAttachment:#Exchange"},e)}},4310:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}},4311:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}},4312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}},4313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}},4409:function(e,t,n){"use strict";var r=n(0),o=n(1);var a=Object(o.action)("saveAttachmentsToCloud",function(e,t,n,r,o){return void 0===o&&(o=null),{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:o}}),i=n(42),c=n(4079),s=n.n(c),u=n(4527),d=n.n(u);function l(e,t,n,r,o){var a=function(e,t,n,r,o){return s()({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:o,channelId:r})}(e,t,n,r,o.type===i.a.GroupMailbox?o.deprecatedMailboxId:null);return d()({requestObject:a},o.requestOptions)}var p=n(3950),m=n(375),f=n(258),h=n(15),v={},b=5e3,g=12;function O(e,t,n,o,a){var i=new h.a("SaveToCloudProgressManager"),c=setInterval(function(){!function(e,t,n,o,a,i,c){r.__awaiter(this,void 0,void 0,function(){var s;return r.__generator(this,function(r){switch(r.label){case 0:return(s=c[e])?(s.counter++,s.counter>i?(_(e,c),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),a&&a(),[2]):[4,f.g.import()]):[2];case 1:return r.sent()(t,n,e,0,function(e){o&&o(e.NotificationPayloads)}),[2]}})})}(n,e,t,o,a,g,v)},b);v[n]={timer:c,counter:0,datapoint:i}}function _(e,t){void 0===t&&(t=null),t||(t=v);var n=t[e];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}}Object(o.orchestrator)(a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,o,a,i,c,s,u;return r.__generator(this,function(d){switch(d.label){case 0:return t=!0,n=e.attachmentId||e.itemId,o=function(r){if(!r)return!1;if(23===r.ResultCode)return!1;var o=e.notificationHandler(r);return o&&(_(n.Id),t=!1),o},[4,Object(p.a)(o)];case 1:return a=r.__read.apply(void 0,[d.sent(),4]),i=a[0],c=a[1],s=a[2],u=a[3],function(e,t,n,o,a,i,c){r.__awaiter(this,void 0,void 0,function(){var s;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,l(e?e.Id:null,t?t.Id:null,n,i,t?t.mailboxInfo:e.mailboxInfo)];case 1:return[2,r.sent()];case 2:return s=r.sent(),c(s,1,"ServerError"),m.g.importAndExecute(o,a),[2,null];case 3:return[2]}})})}(e.attachmentId,e.itemId,i,c,s,u,e.serviceCallFailureCallback),t&&O(e.attachmentId,e.itemId,n.Id,function(e){e.forEach(function(e){o(e)})},function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout")}),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,c,s),[2]}})})});var w=Object(o.action)("cancelSaveAttachmentsToCloud",function(e){return{operationId:e}});Object(o.orchestrator)(w,function(e){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(t){return _(e.operationId),[2]})})});n.d(t,"b",function(){return a}),n.d(t,"a",function(){return w})},4526:function(e,t,n){"use strict";var r=n(1403),o=n(8);t.a=Object(o.action)("setAttachmentOriginalUrl")(function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t})},4527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(4079);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=o.default(e.requestObject)),r.makeServiceRequest("SaveAttachmentsToCloud",e,t)}},4696:function(e){e.exports={a:"qCb"}},4726:function(e){e.exports={a:"Jqb"}},4898:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(4310);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=o.default(e.requestObject)),r.makeServiceRequest("ConvertLocalToRefAttachment",e,t)}},4899:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(4311);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CancelConvertLocalToRefAttachment",e,t)}},4900:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(4312);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=o.default(e.requestObject)),r.makeServiceRequest("ConvertRefToLocalAttachment",e,t)}},4901:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(4313);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CancelConvertRefToLocalAttachment",e,t)}},5159:function(e){e.exports={a:"fCb"}},5392:function(e,t,n){"use strict";var r=n(0),o=n(4726),a=n(5159),i=n(4),c=n(18),s=n(1560),u=n(52),d=n(15),l=n(3341),p=n(6449),m=n(5956),f=n(6450),h=n(258),v=n(1403),b=n(3920),g=n(1065),O=n(1193),_=n(364),w=n(11),x=n(2),C=n(5393),I=n(3979),j=n(5),y=n(177),S=n(7490),A=function(e){function t(t){var n=e.call(this,t)||this;return n.keyDown=function(e){e.keyCode!==u.a.enter&&e.keyCode!==u.a.space||(w.c.info("AttachmentSurfaceActionButton.keyDown enter|space"),e.stopPropagation(),n.props.isForAddToCalendar?Object(f.a)(n.props.attachmentViewState,m.a.SurfaceAction):n.downloadAttachment())},n.handleOnFocus=function(){return Object(C.b)(n.props.attachmentViewState,n.props.isForImageView)},n.handleOnBlur=function(){n.props.shouldNotHandleOnBlur||Object(C.a)(n.props.attachmentViewState,n.props.isForImageView)},n.downloadAttachment=function(){return r.__awaiter(n,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return(e=Object(v.a)(this.props.attachmentViewState.attachmentId))?(Object(d.o)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:this.props.attachmentViewState.isCloudy,isCompose:!this.props.attachmentViewState.isReadOnly},{cosmosOnlyData:JSON.stringify({size:e.model.Size,fileType:Object(b.a)(e),attachmentId:e.model.AttachmentId&&e.model.AttachmentId.Id})}),Object(h.e)(e.model)?[4,O.e.import()]:[3,2]):(w.c.error("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return t.sent()(e.model),[3,3];case 2:Object(g.b)(e.download.url,this.props.attachmentViewState.isCloudy,document.body),t.label=3;case 3:return[2]}})})},n.onClickButton=n.onClickButton.bind(n),n}return r.__extends(t,e),t.prototype.render=function(){if(this.getShouldHideButton())return null;var e=void 0,t=this.getAttachmentStyle(this.props.previewState);e=this.props.isForImageView?y([S.downloadButton,S.downloadButtonForImageView,this.props.customClassName]):this.props.attachmentViewState.isReadOnly?y([S.downloadButton,t,this.props.customClassName]):y([S.downloadButton,t,S.downloadButtonForDocViewInCompose,this.props.customClassName]);var n=this.props.isForAddToCalendar?"AddEvent":"Download",r=this.props.isForAddToCalendar?Object(i.a)(a.a):Object(i.a)(o.a);return x.createElement(s.a,{onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onKeyDown:this.keyDown,ariaLabel:r,title:r,onClick:this.onClickButton,className:e,iconProps:{iconName:n,styles:{root:S.icon}}})},t.prototype.onClickButton=function(e){w.c.info("AttachmentSurfaceActionButton.onclick"),e.stopPropagation(),this.props.isForAddToCalendar?Object(f.a)(this.props.attachmentViewState,m.a.SurfaceAction):this.downloadAttachment()},t.prototype.getShouldHideButton=function(){var e=this.props.attachmentViewState;return!Object(I.a)(l.a.Download,e)||!Object(p.a)(e)||0!==e.ongoingAction||!this.props.attachmentViewState.strategy.showActionsMenu},t.prototype.getAttachmentStyle=function(e){switch(e){case _.a.Edit:return Object(j.e)("doc-attachment-editingVisualFeature")?S.editWithVisualFeature:S.edit;case _.a.NotSelectedAndSaving:return S.notSelectedAndSaving;case _.a.OtherSaving:return S.attachmentView;case _.a.Selected:return S.selected;case _.a.SelectedAndPending:return S.selectedAndPending;case _.a.SelectedAndSaving:return S.selectedAndSaving;default:return S.default}},t=r.__decorate([c.observer],t)}(x.Component);t.a=A},5393:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return l});var r=n(6451),o=n(2234),a=n(2494),i={},c=null;function s(e,t){i[e.attachmentId.Id]&&(clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(r.a)(e,!0),t&&!Object(a.a)(e)&&Object(o.a)(e,!0)}function u(e,t){i[e.attachmentId.Id]&&clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=setTimeout(function(){Object(r.a)(e,!1),t&&!Object(a.a)(e)&&Object(o.a)(e,!1),e.attachmentId.Id===c&&(c=null),i[e.attachmentId.Id]=null},40)}function d(e,t){Object(r.a)(e,!0),t&&!Object(a.a)(e)&&Object(o.a)(e,!0)}function l(e,t){e.attachmentId.Id!==c&&(Object(r.a)(e,!1),t&&!Object(a.a)(e)&&Object(o.a)(e,!1))}},5394:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},5473:function(e,t,n){"use strict";var r=n(1707),o=n(0),a=n(2),i=n(1392),c=Object(i.a)(),s=.01,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderProgress=function(e){var n=t.props,r=n.ariaValueText,o=n.barHeight,i=n.className,u=n.styles,d=n.theme,l="number"==typeof t.props.percentComplete?Math.min(100,Math.max(0,100*t.props.percentComplete)):void 0,p=c(u,{theme:d,className:i,barHeight:o,indeterminate:void 0===l}),m={width:void 0!==l?l+"%":void 0,transition:void 0!==l&&l<s?"none":void 0},f=void 0!==l?0:void 0,h=void 0!==l?100:void 0,v=void 0!==l?Math.floor(l):void 0;return a.createElement("div",{className:p.itemProgress},a.createElement("div",{className:p.progressTrack}),a.createElement("div",{className:p.progressBar,style:m,role:"progressbar","aria-valuemin":f,"aria-valuemax":h,"aria-valuenow":v,"aria-valuetext":r}))},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.barHeight,n=e.className,r=e.label,i=void 0===r?this.props.title:r,s=e.description,u=e.styles,d=e.theme,l=e.progressHidden,p=e.onRenderProgress,m=void 0===p?this._onRenderProgress:p,f="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,h=c(u,{theme:d,className:n,barHeight:t,indeterminate:void 0===f});return a.createElement("div",{className:h.root},i?a.createElement("div",{className:h.itemName},i):null,l?null:m(o.__assign({},this.props,{percentComplete:f}),this._onRenderProgress),s?a.createElement("div",{className:h.itemDescription},s):null)},t.defaultProps={label:"",description:"",width:180},t}(a.Component),d=n(17),l=n(362),p={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},m=Object(d.keyframes)({"0%":{left:"-30%"},"100%":{left:"100%"}}),f=Object(d.keyframes)({"100%":{right:"-30%"},"0%":{right:"100%"}});n.d(t,"a",function(){return h});var h=Object(r.a)(u,function(e){var t,n,r=Object(l.a)(),o=e.className,a=e.indeterminate,i=e.theme,c=e.barHeight,s=void 0===c?2:c,u=i.palette,h=i.semanticColors,v=Object(d.getGlobalClassNames)(p,i),b=u.neutralLight;return{root:[v.root,i.fonts.medium,{fontWeight:d.FontWeights.regular},o],itemName:[v.itemName,d.noWrap,{color:h.bodyText,fontSize:d.FontSizes.medium,paddingTop:4,lineHeight:20}],itemDescription:[v.itemDescription,{color:h.bodySubtext,fontSize:d.FontSizes.xSmall,lineHeight:18}],itemProgress:[v.itemProgress,{position:"relative",overflow:"hidden",height:s,padding:"8px 0"}],progressTrack:[v.progressTrack,{position:"absolute",width:"100%",height:s,backgroundColor:b,selectors:(t={},t[d.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:u.themePrimary,height:s,position:"absolute",transition:"width .3s ease",width:0,selectors:(n={},n[d.HighContrastSelector]={backgroundColor:"WindowText"},n)},a?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+b+" 0%, "+u.themePrimary+" 50%, "+b+" 100%)",animation:(r?f:m)+" 3s infinite"}:{transition:"width .15s linear"},v.progressBar]}},void 0,{scope:"ProgressIndicator"})},5956:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},5957:function(e){e.exports={a:"_Bb"}},6056:function(e){e.exports={a:"HCb"}},6057:function(e){e.exports={a:"LCb"}},6162:function(e,t,n){"use strict";function r(e,t){var n,r,o=(n=e,null!=(r=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$","i").exec(n))&&r.length>1?r[1].toLowerCase():null);return null!=o?o:t}var o=n(6408),a=n(452);function i(e,t){var n=t.model.Name;if(e.isCloudy){var r=t;if(r.openUrl)n+="\n \n"+r.openUrl;else{var o=t.model;o.AttachLongPathName&&(n+="\n \n"+o.AttachLongPathName)}}return n}function c(e,t){if(e.isCloudy){var n=t.model;if(e.isReadOnly)return{text:r(t.openUrl,n.AttachLongPathName||null),title:null};var i=t.info&&t.info.sharingInfo&&t.info.sharingInfo.expirationDate,c=Object(o.a)(n.PermissionType,n.ProviderType,i,e.isPlaceholderAttachment);return{text:c,title:c}}var s=t.model.Size>0?Object(a.e)(t.model.Size):null;return{text:s,title:s}}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c})},6408:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(7360),o=n(4),a=n(3739),i=n(5),c=n(6);function s(e,t,n,s){return void 0===n&&(n=null),void 0===s&&(s=!1),null==e||s?null:Object(i.e)("doc-attachment-referenceAttachmentExpiration")&&n&&Object(c.Bb)(n,Object(c.Jb)())?Object(o.b)(Object(o.a)(r.a),n):Object(a.e)(e,t)}},6449:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(258),o=n(1403);function a(e){var t=Object(o.a)(e.attachmentId);return!!t&&(!!Object(r.e)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},6450:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return h});var r=n(5159),o=n(4),a=n(15),i=n(3341),c=n(3919),s=n(2428),u=n(5956),d=n(1403),l=n(3920),p=n(5),m=n(3979);function f(e,t){var n=Object(d.a)(e.attachmentId),r=Object(l.a)(n);Object(a.o)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:r})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(s.a)(e,0,15):(Object(i.z)(Object(i.i)(n.model.Size),.1,function(t){Object(i.v)(e,t)},e.attachmentId),Object(c.a)(e,0))}function h(e){var t=Object(d.a)(e.attachmentId);return Object(m.a)(i.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass&&Object(p.e)("cal-ics-preview")?{name:Object(o.a)(r.a),key:"AddToCalendar",onClick:function(){f(e,u.a.ContextMenu)}}:null}},6451:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setShouldShowActionsContainer")(function(e,t){e.shouldShowActionsContainer=t})},6452:function(e){e.exports={a:"$Bb"}},7360:function(e){e.exports={a:"oCb"}},7489:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"d",function(){return s});var r=n(5392);n.d(t,"a",function(){return r.a});var o=n(3),a=n(5394);n.d(t,"c",function(){return a.a});var i=new o.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(11),n.e(119)]).then(n.bind(null,9080))}),c=Object(o.d)(i,function(e){return e.AttachmentView}),s=new o.b(i,function(e){return e.getContextMenus})},7490:function(e,t,n){var r=n(7491),o=n(37);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},7491:function(e,t,n){(t=e.exports=n(36)(!1)).push([e.i,'._3QZNNyRu4bsfxs-OL7OQfF{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:25px;width:26px}html[dir] ._3QZNNyRu4bsfxs-OL7OQfF{padding:4px;text-align:center}._3QZNNyRu4bsfxs-OL7OQfF:focus,._3QZNNyRu4bsfxs-OL7OQfF:hover,._3OW4PWuPDMXJ3j1YO3R8q_{color:"[theme:neutralSecondary, default:#666666]"}._3OW4PWuPDMXJ3j1YO3R8q_{display:block}._9IveE8fsson3asxDhih-X{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._9IveE8fsson3asxDhih-X{right:26px}html[dir=rtl] ._9IveE8fsson3asxDhih-X{left:26px}._9IveE8fsson3asxDhih-X:focus,._9IveE8fsson3asxDhih-X:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._9IveE8fsson3asxDhih-X:focus,html[dir] ._9IveE8fsson3asxDhih-X:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] ._9IveE8fsson3asxDhih-X:focus,html[dir=ltr] ._9IveE8fsson3asxDhih-X:hover{border-bottom-right-radius:2px}html[dir=rtl] ._9IveE8fsson3asxDhih-X:focus,html[dir=rtl] ._9IveE8fsson3asxDhih-X:hover{border-bottom-left-radius:2px}._3YIYA63PW-wIVkxR2Su9w3{font-size:14px}html[dir] ._3YIYA63PW-wIVkxR2Su9w3{margin:0}html[dir] ._1-hVXxvfDp0xe0VVvmfkXI:focus,html[dir] ._1-hVXxvfDp0xe0VVvmfkXI:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .tbC07jvl9ABO08CjRkR9G,html[dir] .u4MtH9lbDLor4YGZBCHkj,html[dir] .pjl51ZJco7p4lHev54DwN,html[dir] .hnWaZkVaaCryiaMDmw1gh,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .tbC07jvl9ABO08CjRkR9G:focus,html[dir] .tbC07jvl9ABO08CjRkR9G:hover,html[dir] .u4MtH9lbDLor4YGZBCHkj:focus,html[dir] .u4MtH9lbDLor4YGZBCHkj:hover,html[dir] .pjl51ZJco7p4lHev54DwN:focus,html[dir] .pjl51ZJco7p4lHev54DwN:hover,html[dir] .hnWaZkVaaCryiaMDmw1gh:focus,html[dir] .hnWaZkVaaCryiaMDmw1gh:hover,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0:focus,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0:hover,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6:focus,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6:hover,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-:focus,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .u4MtH9lbDLor4YGZBCHkj{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={downloadButton:"_3QZNNyRu4bsfxs-OL7OQfF",downloadButtonForDocViewInCompose:"_3OW4PWuPDMXJ3j1YO3R8q_",downloadButtonForImageView:"_9IveE8fsson3asxDhih-X",icon:"_3YIYA63PW-wIVkxR2Su9w3",default:"_1-hVXxvfDp0xe0VVvmfkXI",edit:"tbC07jvl9ABO08CjRkR9G",editWithVisualFeature:"u4MtH9lbDLor4YGZBCHkj",notSelectedAndSaving:"pjl51ZJco7p4lHev54DwN",selected:"hnWaZkVaaCryiaMDmw1gh",selectedAndPending:"_2WYO4FLw4GnoQDNjqX1tF0",selectedAndSaving:"_2mWLOTqEFbyTpIo_Dy3kO6",thematic:"_3Rg1o7_N0DLI2zwxeFuP5-"}},7492:function(e){e.exports={a:"eCb"}},7802:function(e){e.exports={j:"rCb",k:"sCb",l:"tCb",h:"uCb",i:"vCb",f:"wCb",g:"xCb",n:"yCb",o:"zCb",p:"ACb",b:"BCb",m:"CCb",d:"DCb",c:"ECb",a:"FCb",e:"GCb"}},7803:function(e,t,n){"use strict";function r(e){return e.actionCompletePercent>0&&e.actionCompletePercent<=1}n.d(t,"a",function(){return r})},8208:function(e,t,n){"use strict";var r=n(0),o=n(258),a=n(11);function i(e,t){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,function(){var n,i,c,s,u,d,l,p,m,f,h;return r.__generator(this,function(r){switch(r.label){case 0:return n=[],[4,o.i.import()];case 1:return i=r.sent(),[4,o.l.import()];case 2:return c=r.sent(),t?[4,o.o.import()]:[3,4];case 3:return u=r.sent(),[3,5];case 4:u=null,r.label=5;case 5:s=u,d=t?e.docViewAttachments:e.imageViewAttachments,l=0,r.label=6;case 6:if(!(l<d.length))return[3,12];if(p=d[l],m=i(p.attachmentId),t&&!s(m.model))return[3,11];r.label=7;case 7:return r.trys.push([7,9,,10]),[4,c(p.attachmentId,e.isReadOnly)];case 8:return r.sent(),[3,10];case 9:return f=r.sent(),a.c.warn("Unable to refresh thumbnail image for "+p.attachmentId+". Got error "+f),[3,10];case 10:h={downloadUrl:m.download.url,id:p.attachmentId,previewUrl:m.previewImage.url,thumbnailUrl:m.thumbnailImage.url},n.push(h),r.label=11;case 11:return l++,[3,6];case 12:return[2,n]}})})}n.d(t,"a",function(){return i})},8219:function(e,t,n){"use strict";var r=n(4696),o=n(4052),a=n(6056),i=n(6452),c=n(7802),s=n(5957),u=n(4),d=n(6);function l(e){return e&&e.info&&e.info.sharingInfo&&e.info.sharingInfo.expirationDate&&Object(d.Bb)(e.info.sharingInfo.expirationDate,Object(d.Jb)())}var p=n(91),m=n(478),f=n(5),h=n(42),v=n(41),b=n(6162);function g(e,t){return t?Object(u.a)(c.h):Object(u.b)(Object(u.a)(c.i),e?Object(u.a)(i.a):Object(u.a)(s.a))}function O(e,t){var n,d=Object(v.a)(),O=void 0!==t.id.mailboxInfo&&t.id.mailboxInfo.type==h.a.GroupMailbox;if(0===e.actionMessage)return function(e,t){var n=Object(b.b)(e,t);return{text:n.text,title:n.title,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1,useExpiredAttachmentStyling:Object(f.e)("doc-attachment-referenceAttachmentExpiration")&&l(t)}}(e,t);var _=!1,w=!1;switch(e.actionMessage){case 1:n=function(e,t){if(t)return Object(u.a)(c.j);var n=Object(m.f)();return e?Object(u.b)(Object(u.a)(c.k),Object(u.a)(i.a)):Object(u.b)(Object(u.a)(c.l),n)}(d,O);break;case 5:n=Object(u.a)(c.b);break;case 2:n=g(d,O);break;case 3:n=g(d,O),_=!0;break;case 4:case 9:n=function(e,t){return t?Object(u.a)(c.f):Object(u.b)(Object(u.a)(c.g),e?Object(u.a)(i.a):Object(u.a)(s.a))}(d,O),w=!0;break;case 7:n=Object(u.a)(c.m);break;case 6:n=Object(u.a)(c.d);break;case 8:n=function(e,t){if(t)return Object(u.a)(c.n);var n=Object(m.f)();return e?Object(u.b)(Object(u.a)(c.o),n,Object(u.a)(i.a)):Object(u.b)(Object(u.a)(c.p),n)}(d,O);break;case 10:n=Object(u.a)(c.c);break;case 11:n=Object(u.a)(c.a);break;case 12:n=Object(u.a)(c.e),w=!0;break;case 16:n=Object(u.a)(c.c);break;case 14:n=Object(u.a)(a.a),_=!0;break;case 15:n=Object(u.a)(o.a),w=!0;break;case 13:n=Object(u.a)(r.a);break;case 17:n=Object(u.a)(c.m);break;default:Object(p.a)(e.actionMessage)}return{text:n,title:n,shouldDisplaySuccessIcon:_,shouldDisplayFailureIcon:w,useExpiredAttachmentStyling:!1}}n.d(t,"a",function(){return O})},927:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1373);n.d(t,"c",function(){return r.a});var o=n(2429);n.d(t,"d",function(){return o.a});var a=n(1086);n.d(t,"e",function(){return a.a}),n.d(t,"b",function(){return a.b});var i=n(3),c=new i.c(function(){return n.e(215).then(n.bind(null,3219))}),s=Object(i.d)(c,function(e){return e.CloudIconWithOverlay})},973:function(e,t,n){var r=n(1235),o=36e5,a=6e4,i=2,c=/[T ]/,s=/:/,u=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,p=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,f=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,_=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/([Z+-].*)$/,x=/^(Z)$/,C=/^([+-])(\d{2})$/,I=/^([+-])(\d{2}):?(\d{2})$/;function j(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var o=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+o),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?i:Number(n);var y=function(e){var t,n={},r=e.split(c);if(s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var o=w.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),S=function(e,t){var n,r=d[t],o=p[t];if(n=l.exec(e)||o.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=u.exec(e)||r.exec(e)){var i=n[1];return{year:100*parseInt(i,10),restDateString:e.slice(i.length)}}return{year:null}}(y.date,n),A=S.year,P=function(e,t){if(null===t)return null;var n,r,o,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.exec(e))return r=new Date(0),o=parseInt(n[1],10)-1,r.setUTCFullYear(t,o),r;if(n=f.exec(e)){r=new Date(0);var i=parseInt(n[1],10);return r.setUTCFullYear(t,0,i),r}if(n=h.exec(e)){r=new Date(0),o=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,o,c),r}if(n=v.exec(e))return a=parseInt(n[1],10)-1,j(t,a);if(n=b.exec(e)){a=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return j(t,a,s)}return null}(S.restDateString,A);if(P){var k,T=P.getTime(),E=0;return y.time&&(E=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*o;if(t=O.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*o+r*a;if(t=_.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*o+r*a+1e3*i}return null}(y.time)),y.timezone?(D=y.timezone,k=(M=x.exec(D))?0:(M=C.exec(D))?(N=60*parseInt(M[2],10),"+"===M[1]?-N:N):(M=I.exec(D))?(N=60*parseInt(M[2],10)+parseInt(M[3],10),"+"===M[1]?-N:N):0):(k=new Date(T+E).getTimezoneOffset(),k=new Date(T+E+k*a).getTimezoneOffset()),new Date(T+E+k*a)}var D,M,N;return new Date(e)}}},0,[6,7,9,11,119,12,43,115,486,98,70,110,530,321,215,392]]);
//# sourceMappingURL=owa.ConversationAttachment.js.map
self.scriptsLoaded['owa.ConversationAttachment.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ConversationAttachment.js'] = (new Date()).getTime();