self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RecipientCache.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[361],{1088:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"PersonaResponseShape:#Exchange"},e)}},1090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),i=n(855);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("FindPeople",e,t)}},1372:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindPeopleRequest:#Exchange"},e)}},13773:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(3559),a=n(5),s=n(1515),u=n.n(s),o=n(855),c=n.n(o),l=n(1372),d=n.n(l),p=n(515),f=n.n(p),I=n(1088),h=n.n(I),P=n(65),b=n.n(P),_=n(1090),v=n.n(_),y=n(27),m=500,g="owa.react.compose";function O(){if(Object(a.e)("rp-requestPersonaResponseShape")){var e=h()({BaseShape:"IdOnly",AdditionalProperties:[b()({FieldURI:"PersonaEmailAddress"}),b()({FieldURI:"EmailAddresses"}),b()({FieldURI:"PersonaDisplayName"}),b()({FieldURI:"PersonaDisplayNames"}),b()({FieldURI:"PersonaId"}),b()({FieldURI:"PersonaType"}),b()({FieldURI:"PersonaImAddress"}),b()({FieldURI:"PersonaTitle"})]});return Object(a.e)("rp-3SLocalSearchRanking")&&e.AdditionalProperties.push(b()({FieldURI:"FeatureData"})),e}return h()({BaseShape:"Default"})}function w(){var e=d()({IndexedPageItemView:f()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:m}),PersonaShape:O(),QuerySources:["Mailbox"],QueryString:"",SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,Context:[u()({Key:"AppName",Value:"OWA"}),u()({Key:"AppScenario",Value:g})]});return v()(c()({Header:Object(y.getJsonRequestHeader)(),Body:e})).then(function(e){return e.Body})}var A=n(86),R=n(67),S=n(3484),j="/search/api/v1/suggestions?",D="owa.react.recipientcache",E=500;function x(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,C()];case 1:return e=n.sent(),t=function(e){return{AppName:"OWA",Scenario:{Name:D},Cvid:Object(A.a)(),EntityRequests:[e]}}(e),[2,Object(R.d)(j,t,null,!1,null,!0,void 0,!1).then(function(e){return e},function(e){throw new Error(e.message)})]}})})}function C(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return[2,{Query:{QueryString:""},EntityType:"People",Provenances:["Mailbox"],Size:E,Fields:S.a}]})})}var F=n(3533),L=n(11),M=n(25),U=Object(M.b)("tryInitializeCacheWithSource",{name:"RecipientCacheInitialization",custonData:function(e,t){return[e,t]}})(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var t,a,s,u;return r.__generator(this,function(o){switch(o.label){case 0:switch(o.trys.push([0,6,,7]),t=void 0,e){case 0:return[3,1];case 1:return[3,3]}return[3,5];case 1:return[4,x()];case 2:return a=o.sent(),t=function(e){var t,n,i=[];if(e&&e.Groups)try{for(var a=r.__values(e.Groups),s=a.next();!s.done;s=a.next()){var u=s.value;if("People"===u.Type){i=u.Suggestions.map(function(e){return Object(F.a)(e)});break}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}else L.c.warn("Response groups should not be null");return i}(a),[3,5];case 3:return[4,w()];case 4:return s=o.sent(),t=s.ResultSet,[3,5];case 5:return t&&t.length>0&&(t.forEach(function(e){var t=Object(i.a)(e);t&&(n.store.allKeys[t]=!0)}),n.store.recipientCache=t),[3,7];case 6:return u=o.sent(),L.c.warn(u.message),[3,7];case 7:return[2]}})})});var T=n(2070),G=n(1505),k=n(8),z=Object(k.action)("initializeCache")(Object(k.select)({store:function(){return T.a}})(function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return t=Object(G.a)(),[4,U(t?0:1,!1,e)];case 1:return n.sent(),!t||e.store.recipientCache?[3,3]:[4,U(1,!0,e)];case 2:n.sent(),n.label=3;case 3:return e.store.recipientCache||(e.store.recipientCache=[]),[2]}})})}));n.d(t,"initializeCache",function(){return z})},1515:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ContextProperty:#Exchange"},e)}},2070:function(e,t,n){"use strict";var r=n(1),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=i},3484:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"]},3533:function(e,t,n){"use strict";var r=n(4),i=n(1512);function a(e,t){var n=e.EmailAddresses,a=e.DisplayName,c=e.Text,l=e.PDLItemId,d=e.ADObjectId,p=e.PersonaId,f=e.FeatureData,I=e.Id,h=e.ImAddress,P=e.JobTitle,b=e.PeopleSubtype,_=n?n[0]:null;if(!t&&function(e){return Object(i.b)().sessionMaskedRecipients[e]}(_))return null;var v={EmailAddress:_,Name:Object(r.g)(a)?c:a,MailboxType:o(b),RoutingType:s(b),ItemId:l?{Id:l,__type:"ItemId:#Exchange"}:null};return{DisplayName:a,ADObjectId:d,FeatureData:f,Id:I,ImAddress:h,EmailAddress:v,EmailAddresses:[v],PersonaTypeString:u(b),PersonaId:{Id:p},Title:P}}function s(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function u(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function o(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}n.d(t,"a",function(){return a})},3559:function(e,t,n){"use strict";function r(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}n.d(t,"a",function(){return r})},855:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindPeopleJsonRequest:#Exchange"},e)}}},0,[486,98]]);
//# sourceMappingURL=owa.RecipientCache.js.map
self.scriptsLoaded['owa.RecipientCache.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RecipientCache.js'] = (new Date()).getTime();